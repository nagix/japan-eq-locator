!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("h3")):"function"==typeof define&&define.amd?define(["h3"],e):"object"==typeof exports?exports.deck=e(require("h3")):t.deck=e(t.h3)}(window,(function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=265)}([function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e,n){t.exports=n(296)},function(t,e,n){var r=n(220);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return r}))},function(t,e,n){var r=n(26),i=n(9);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?i(t):e}},function(t,e){function n(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise((function(i,o){var a=t.apply(e,r);function s(t){n(a,i,o,s,u,"next",t)}function u(t){n(a,i,o,s,u,"throw",t)}s(void 0)}))}}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,n){var r=n(286);function i(e,n,o){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=i=Reflect.get:t.exports=i=function(t,e,n){var i=r(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}},i(e,n,o||e)}t.exports=i},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){"use strict";var r=new(n(328).a)({id:"luma.gl"});function i(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function o(t){return"undefined"!=typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||("undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version)))}function a(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function s(t){return a(t)?t:null}function u(t){return i(o(t),"Invalid WebGLRenderingContext"),t}function c(t){return i(a(t),"Requires WebGL2"),t}var l={};function f(t,e){var n;l[t]=!0,void 0!==e&&(n=e,globalThis.console&&globalThis.console.error&&globalThis.console.error(n))}var h=function t(e){var n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(var r=0;r<this.attribs.length;r++){var i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};(h.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var d=function(t){var e=this;this.gl=t,function(t){var e=t.getError;t.getError=function(){var n;do{0!==(n=e.apply(t))&&(l[n]=!0)}while(0!==n);for(n in l)if(l[n])return delete l[n],parseInt(n,10);return 0}}(t);var n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){var r=e.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,t);var i=r.attribs[t];return i.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){var r=e.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,t);var i=r.attribs[t];return i.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,r){switch(t){case 34962:e.currentArrayBuffer=r;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=r}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,r){var i=e.currentVertexArrayObject,o=i.attribs[t];switch(r){case 34975:return o.buffer;case 34338:return o.enabled;case 34339:return o.size;case 34340:return o.stride;case 34341:return o.type;case 34922:return o.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,r,i,o,a,s){var u=e.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,t);var c=u.attribs[t];return c.buffer=e.currentArrayBuffer,c.size=r,c.type=i,c.normalized=o,c.stride=a,c.offset=s,c.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",(function(){var t;t="OESVertexArrayObject emulation library context restored",globalThis.console&&globalThis.console.log&&globalThis.console.log(t),e.reset_()}),!0),this.reset_()};d.prototype.VERTEX_ARRAY_BINDING_OES=34229,d.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(var t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;var e=this.gl;this.maxVertexAttribs=e.getParameter(34921),this.defaultVertexArrayObject=new h(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},d.prototype.createVertexArrayOES=function(){var t=new h(this);return this.vertexArrayObjects.push(t),t},d.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},d.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof h&&t.hasBeenBound&&t.ext===this)},d.prototype.bindVertexArrayOES=function(t){var e=this.gl;if(!t||t.isAlive){var n=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;var i=this.currentVertexArrayObject;if(r!==i){r&&i.elementArrayBuffer===r.elementArrayBuffer||n.bindBuffer.call(e,34963,i.elementArrayBuffer);for(var o=this.currentArrayBuffer,a=Math.max(r?r.maxAttrib:0,i.maxAttrib),s=0;s<=a;s++){var u=i.attribs[s],c=r?r.attribs[s]:null;if(r&&u.enabled===c.enabled||(u.enabled?n.enableVertexAttribArray.call(e,s):n.disableVertexAttribArray.call(e,s)),u.enabled){var l=!1;r&&u.buffer===c.buffer||(o!==u.buffer&&(n.bindBuffer.call(e,34962,u.buffer),o=u.buffer),l=!0),(l||u.cached!==c.cached)&&n.vertexAttribPointer.call(e,s,u.size,u.type,u.normalized,u.stride,u.offset)}}this.currentArrayBuffer!==o&&n.bindBuffer.call(e,34962,this.currentArrayBuffer)}}else f(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject")};var p,v,g=n(0),y=n.n(g),m=function(t){return a(t)?void 0:0},b=(p={},y()(p,3074,(function(t){return a(t)?void 0:36064})),y()(p,35723,(function(t){return a(t)?void 0:4352})),y()(p,35977,m),y()(p,32937,m),y()(p,36795,(function(t,e){var n=a(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0})),y()(p,37445,(function(t,e){var n=t.getExtension("WEBGL_debug_renderer_info");return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)})),y()(p,37446,(function(t,e){var n=t.getExtension("WEBGL_debug_renderer_info");return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)})),y()(p,34047,(function(t,e){var n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1})),y()(p,32883,m),y()(p,35071,m),y()(p,37447,m),y()(p,36063,(function(t,e){if(!a(t)){var n=t.getExtension("WEBGL_draw_buffers");return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}})),y()(p,35379,m),y()(p,35374,m),y()(p,35377,m),y()(p,34852,(function(t){if(!a(t)){var e=t.getExtension("WEBGL_draw_buffers");return e?e.MAX_DRAW_BUFFERS_WEBGL:0}})),y()(p,36203,(function(t){return t.getExtension("OES_element_index")?2147483647:65535})),y()(p,33001,(function(t){return t.getExtension("OES_element_index")?16777216:65535})),y()(p,33e3,(function(t){return 16777216})),y()(p,37157,m),y()(p,35373,m),y()(p,35657,m),y()(p,36183,m),y()(p,37137,m),y()(p,34045,m),y()(p,35978,m),y()(p,35979,m),y()(p,35968,m),y()(p,35376,m),y()(p,35375,m),y()(p,35659,m),y()(p,37154,m),y()(p,35371,m),y()(p,35658,m),y()(p,35076,m),y()(p,35077,m),y()(p,35380,m),p);var A=(v={},y()(v,"OES_vertex_array_object",{meta:{suffix:"OES"},createVertexArray:function(){i(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:function(){},bindVertexArray:function(){},isVertexArray:function(){return!1}}),y()(v,"ANGLE_instanced_arrays",{meta:{suffix:"ANGLE"},vertexAttribDivisor:function(t,e){i(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:function(){},drawArraysInstanced:function(){}}),y()(v,"WEBGL_draw_buffers",{meta:{suffix:"WEBGL"},drawBuffers:function(){i(!1)}}),y()(v,"EXT_disjoint_timer_query",{meta:{suffix:"EXT"},createQuery:function(){i(!1)},deleteQuery:function(){i(!1)},beginQuery:function(){i(!1)},endQuery:function(){},getQuery:function(t,e){return this.getQueryObject(t,e)},getQueryParameter:function(t,e){return this.getQueryObject(t,e)},getQueryObject:function(){}}),v),_={readBuffer:function(t,e,n){a(t)&&e(n)},getVertexAttrib:function(t,e,n,r){var i,o=function(t,e){return{webgl2:a(t),ext:t.getExtension(e)}}(t,"ANGLE_instanced_arrays"),s=o.webgl2,u=o.ext;switch(r){case 35069:i=!!s&&void 0;break;case 35070:i=s||u?void 0:0}return void 0!==i?i:e(n,r)},getProgramParameter:function(t,e,n,r){if(!a(t))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,r)},getInternalformatParameter:function(t,e,n,r,i){if(!a(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter:function(t,e,n,r){switch(r){case 34046:var i=t.luma.extensions.EXT_texture_filter_anisotropic;r=i&&i.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,r)},getParameter:function(t,e,n){var r=b[n],i="function"==typeof r?r(t,e,n):r;return void 0!==i?i:e(n)},hint:function(t,e,n,r){return e(n,r)}};function O(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function x(t,e){var n=e.extension,r=e.target,o=e.target2,a=A[n];i(a);for(var s=a.meta,u=(void 0===s?{}:s).suffix,c=void 0===u?"":u,l=t.getExtension(n),f=function(){var e=d[h],n="".concat(e).concat(c),i=null;"meta"===e||"function"==typeof t[e]||(l&&"function"==typeof l[n]?i=function(){return l[n].apply(l,arguments)}:"function"==typeof a[e]&&(i=a[e].bind(r))),i&&(r[e]=i,o[e]=i)},h=0,d=Object.keys(a);h<d.length;h++)f()}globalThis.polyfillContext=function(t){t.luma=t.luma||{};var e=t.luma;return e.polyfilled||(!function(t){if("function"!=typeof t.createVertexArray){var e=t.getSupportedExtensions;t.getSupportedExtensions=function(){var t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};var n=t.getExtension;t.getExtension=function(e){var r=n.call(this,e);return r||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new d(this)),this.__OESVertexArrayObject))}}}(t),function(t){t.luma.extensions={};var e,n=O(t.getSupportedExtensions()||[]);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.luma[r]=t.getExtension(r)}}catch(t){n.e(t)}finally{n.f()}}(t),function(t,e){var n,r=O(Object.getOwnPropertyNames(e));try{for(r.s();!(n=r.n()).done;){var i=n.value;"overrides"!==i&&x(t,{extension:i,target:t.luma,target2:t})}}catch(t){r.e(t)}finally{r.f()}}(t,A),function(t,e){var n=e.target,r=e.target2;Object.keys(_).forEach((function(e){if("function"==typeof _[e]){var i=t[e]?t[e].bind(t):function(){},o=_[e].bind(null,t,i);n[e]=o,r[e]=o}}))}(t,{target:e,target2:t}),e.polyfilled=!0),t};var C,P,S,B=n(15),k=n.n(B),E=n(27),T=n.n(E),j=(C={},y()(C,3042,!1),y()(C,32773,new Float32Array([0,0,0,0])),y()(C,32777,32774),y()(C,34877,32774),y()(C,32969,1),y()(C,32968,0),y()(C,32971,1),y()(C,32970,0),y()(C,3106,new Float32Array([0,0,0,0])),y()(C,3107,[!0,!0,!0,!0]),y()(C,2884,!1),y()(C,2885,1029),y()(C,2929,!1),y()(C,2931,1),y()(C,2932,513),y()(C,2928,new Float32Array([0,1])),y()(C,2930,!0),y()(C,3024,!0),y()(C,36006,null),y()(C,2886,2305),y()(C,33170,4352),y()(C,2849,1),y()(C,32823,!1),y()(C,32824,0),y()(C,10752,0),y()(C,32938,1),y()(C,32939,!1),y()(C,3089,!1),y()(C,3088,new Int32Array([0,0,1024,1024])),y()(C,2960,!1),y()(C,2961,0),y()(C,2968,4294967295),y()(C,36005,4294967295),y()(C,2962,519),y()(C,2967,0),y()(C,2963,4294967295),y()(C,34816,519),y()(C,36003,0),y()(C,36004,4294967295),y()(C,2964,7680),y()(C,2965,7680),y()(C,2966,7680),y()(C,34817,7680),y()(C,34818,7680),y()(C,34819,7680),y()(C,2978,[0,0,1024,1024]),y()(C,3333,4),y()(C,3317,4),y()(C,37440,!1),y()(C,37441,!1),y()(C,37443,37444),y()(C,35723,4352),y()(C,36010,null),y()(C,35977,!1),y()(C,3330,0),y()(C,3332,0),y()(C,3331,0),y()(C,3314,0),y()(C,32878,0),y()(C,3316,0),y()(C,3315,0),y()(C,32877,0),C),M=function(t,e,n){return e?t.enable(n):t.disable(n)},I=function(t,e,n){return t.hint(n,e)},R=function(t,e,n){return t.pixelStorei(n,e)};function D(t){return Array.isArray(t)||ArrayBuffer.isView(t)}var L=(P={},y()(P,3042,M),y()(P,32773,(function(t,e){return t.blendColor.apply(t,T()(e))})),y()(P,32777,"blendEquation"),y()(P,34877,"blendEquation"),y()(P,32969,"blendFunc"),y()(P,32968,"blendFunc"),y()(P,32971,"blendFunc"),y()(P,32970,"blendFunc"),y()(P,3106,(function(t,e){return t.clearColor.apply(t,T()(e))})),y()(P,3107,(function(t,e){return t.colorMask.apply(t,T()(e))})),y()(P,2884,M),y()(P,2885,(function(t,e){return t.cullFace(e)})),y()(P,2929,M),y()(P,2931,(function(t,e){return t.clearDepth(e)})),y()(P,2932,(function(t,e){return t.depthFunc(e)})),y()(P,2928,(function(t,e){return t.depthRange.apply(t,T()(e))})),y()(P,2930,(function(t,e){return t.depthMask(e)})),y()(P,3024,M),y()(P,35723,I),y()(P,36006,(function(t,e){var n=a(t)?36009:36160;return t.bindFramebuffer(n,e)})),y()(P,2886,(function(t,e){return t.frontFace(e)})),y()(P,33170,I),y()(P,2849,(function(t,e){return t.lineWidth(e)})),y()(P,32823,M),y()(P,32824,"polygonOffset"),y()(P,10752,"polygonOffset"),y()(P,35977,M),y()(P,32938,"sampleCoverage"),y()(P,32939,"sampleCoverage"),y()(P,3089,M),y()(P,3088,(function(t,e){return t.scissor.apply(t,T()(e))})),y()(P,2960,M),y()(P,2961,(function(t,e){return t.clearStencil(e)})),y()(P,2968,(function(t,e){return t.stencilMaskSeparate(1028,e)})),y()(P,36005,(function(t,e){return t.stencilMaskSeparate(1029,e)})),y()(P,2962,"stencilFuncFront"),y()(P,2967,"stencilFuncFront"),y()(P,2963,"stencilFuncFront"),y()(P,34816,"stencilFuncBack"),y()(P,36003,"stencilFuncBack"),y()(P,36004,"stencilFuncBack"),y()(P,2964,"stencilOpFront"),y()(P,2965,"stencilOpFront"),y()(P,2966,"stencilOpFront"),y()(P,34817,"stencilOpBack"),y()(P,34818,"stencilOpBack"),y()(P,34819,"stencilOpBack"),y()(P,2978,(function(t,e){return t.viewport.apply(t,T()(e))})),y()(P,3333,R),y()(P,3317,R),y()(P,37440,R),y()(P,37441,R),y()(P,37443,R),y()(P,3330,R),y()(P,3332,R),y()(P,3331,R),y()(P,36010,(function(t,e){return t.bindFramebuffer(36008,e)})),y()(P,3314,R),y()(P,32878,R),y()(P,3316,R),y()(P,3315,R),y()(P,32877,R),y()(P,"framebuffer",(function(t,e){var n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)})),y()(P,"blend",(function(t,e){return e?t.enable(3042):t.disable(3042)})),y()(P,"blendColor",(function(t,e){return t.blendColor.apply(t,T()(e))})),y()(P,"blendEquation",(function(t,e){e=D(e)?e:[e,e],t.blendEquationSeparate.apply(t,T()(e))})),y()(P,"blendFunc",(function(t,e){e=D(e)&&2===e.length?[].concat(T()(e),T()(e)):e,t.blendFuncSeparate.apply(t,T()(e))})),y()(P,"clearColor",(function(t,e){return t.clearColor.apply(t,T()(e))})),y()(P,"clearDepth",(function(t,e){return t.clearDepth(e)})),y()(P,"clearStencil",(function(t,e){return t.clearStencil(e)})),y()(P,"colorMask",(function(t,e){return t.colorMask.apply(t,T()(e))})),y()(P,"cull",(function(t,e){return e?t.enable(2884):t.disable(2884)})),y()(P,"cullFace",(function(t,e){return t.cullFace(e)})),y()(P,"depthTest",(function(t,e){return e?t.enable(2929):t.disable(2929)})),y()(P,"depthFunc",(function(t,e){return t.depthFunc(e)})),y()(P,"depthMask",(function(t,e){return t.depthMask(e)})),y()(P,"depthRange",(function(t,e){return t.depthRange.apply(t,T()(e))})),y()(P,"dither",(function(t,e){return e?t.enable(3024):t.disable(3024)})),y()(P,"derivativeHint",(function(t,e){t.hint(35723,e)})),y()(P,"frontFace",(function(t,e){return t.frontFace(e)})),y()(P,"mipmapHint",(function(t,e){return t.hint(33170,e)})),y()(P,"lineWidth",(function(t,e){return t.lineWidth(e)})),y()(P,"polygonOffsetFill",(function(t,e){return e?t.enable(32823):t.disable(32823)})),y()(P,"polygonOffset",(function(t,e){return t.polygonOffset.apply(t,T()(e))})),y()(P,"sampleCoverage",(function(t,e){return t.sampleCoverage.apply(t,T()(e))})),y()(P,"scissorTest",(function(t,e){return e?t.enable(3089):t.disable(3089)})),y()(P,"scissor",(function(t,e){return t.scissor.apply(t,T()(e))})),y()(P,"stencilTest",(function(t,e){return e?t.enable(2960):t.disable(2960)})),y()(P,"stencilMask",(function(t,e){var n=e=D(e)?e:[e,e],r=k()(n,2),i=r[0],o=r[1];t.stencilMaskSeparate(1028,i),t.stencilMaskSeparate(1029,o)})),y()(P,"stencilFunc",(function(t,e){var n=e=D(e)&&3===e.length?[].concat(T()(e),T()(e)):e,r=k()(n,6),i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],c=r[5];t.stencilFuncSeparate(1028,i,o,a),t.stencilFuncSeparate(1029,s,u,c)})),y()(P,"stencilOp",(function(t,e){var n=e=D(e)&&3===e.length?[].concat(T()(e),T()(e)):e,r=k()(n,6),i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],c=r[5];t.stencilOpSeparate(1028,i,o,a),t.stencilOpSeparate(1029,s,u,c)})),y()(P,"viewport",(function(t,e){return t.viewport.apply(t,T()(e))})),P);function F(t,e,n){return void 0!==e[t]?e[t]:n[t]}var G={blendEquation:function(t,e,n){return t.blendEquationSeparate(F(32777,e,n),F(34877,e,n))},blendFunc:function(t,e,n){return t.blendFuncSeparate(F(32969,e,n),F(32968,e,n),F(32971,e,n),F(32970,e,n))},polygonOffset:function(t,e,n){return t.polygonOffset(F(32824,e,n),F(10752,e,n))},sampleCoverage:function(t,e,n){return t.sampleCoverage(F(32938,e,n),F(32939,e,n))},stencilFuncFront:function(t,e,n){return t.stencilFuncSeparate(1028,F(2962,e,n),F(2967,e,n),F(2963,e,n))},stencilFuncBack:function(t,e,n){return t.stencilFuncSeparate(1029,F(34816,e,n),F(36003,e,n),F(36004,e,n))},stencilOpFront:function(t,e,n){return t.stencilOpSeparate(1028,F(2964,e,n),F(2965,e,n),F(2966,e,n))},stencilOpBack:function(t,e,n){return t.stencilOpSeparate(1029,F(34817,e,n),F(34818,e,n),F(34819,e,n))}},N={enable:function(t,e){return t(y()({},e,!0))},disable:function(t,e){return t(y()({},e,!1))},pixelStorei:function(t,e,n){return t(y()({},e,n))},hint:function(t,e,n){return t(y()({},e,n))},bindFramebuffer:function(t,e,n){var r;switch(e){case 36160:return t((r={},y()(r,36006,n),y()(r,36010,n),r));case 36009:return t(y()({},36006,n));case 36008:return t(y()({},36010,n));default:return null}},blendColor:function(t,e,n,r,i){return t(y()({},32773,new Float32Array([e,n,r,i])))},blendEquation:function(t,e){var n;return t((n={},y()(n,32777,e),y()(n,34877,e),n))},blendEquationSeparate:function(t,e,n){var r;return t((r={},y()(r,32777,e),y()(r,34877,n),r))},blendFunc:function(t,e,n){var r;return t((r={},y()(r,32969,e),y()(r,32968,n),y()(r,32971,e),y()(r,32970,n),r))},blendFuncSeparate:function(t,e,n,r,i){var o;return t((o={},y()(o,32969,e),y()(o,32968,n),y()(o,32971,r),y()(o,32970,i),o))},clearColor:function(t,e,n,r,i){return t(y()({},3106,new Float32Array([e,n,r,i])))},clearDepth:function(t,e){return t(y()({},2931,e))},clearStencil:function(t,e){return t(y()({},2961,e))},colorMask:function(t,e,n,r,i){return t(y()({},3107,[e,n,r,i]))},cullFace:function(t,e){return t(y()({},2885,e))},depthFunc:function(t,e){return t(y()({},2932,e))},depthRange:function(t,e,n){return t(y()({},2928,new Float32Array([e,n])))},depthMask:function(t,e){return t(y()({},2930,e))},frontFace:function(t,e){return t(y()({},2886,e))},lineWidth:function(t,e){return t(y()({},2849,e))},polygonOffset:function(t,e,n){var r;return t((r={},y()(r,32824,e),y()(r,10752,n),r))},sampleCoverage:function(t,e,n){var r;return t((r={},y()(r,32938,e),y()(r,32939,n),r))},scissor:function(t,e,n,r,i){return t(y()({},3088,new Int32Array([e,n,r,i])))},stencilMask:function(t,e){var n;return t((n={},y()(n,2968,e),y()(n,36005,e),n))},stencilMaskSeparate:function(t,e,n){return t(y()({},1028===e?2968:36005,n))},stencilFunc:function(t,e,n,r){var i;return t((i={},y()(i,2962,e),y()(i,2967,n),y()(i,2963,r),y()(i,34816,e),y()(i,36003,n),y()(i,36004,r),i))},stencilFuncSeparate:function(t,e,n,r,i){var o;return t((o={},y()(o,1028===e?2962:34816,n),y()(o,1028===e?2967:36003,r),y()(o,1028===e?2963:36004,i),o))},stencilOp:function(t,e,n,r){var i;return t((i={},y()(i,2964,e),y()(i,2965,n),y()(i,2966,r),y()(i,34817,e),y()(i,34818,n),y()(i,34819,r),i))},stencilOpSeparate:function(t,e,n,r,i){var o;return t((o={},y()(o,1028===e?2964:34817,n),y()(o,1028===e?2965:34818,r),y()(o,1028===e?2966:34819,i),o))},viewport:function(t,e,n,r,i){return t(y()({},2978,[e,n,r,i]))}},U=function(t,e){return t.isEnabled(e)},z=(S={},y()(S,3042,U),y()(S,2884,U),y()(S,2929,U),y()(S,3024,U),y()(S,32823,U),y()(S,32926,U),y()(S,32928,U),y()(S,3089,U),y()(S,2960,U),y()(S,35977,U),S),H=n(1),V=n.n(H),J=n(3),W=n.n(J);function K(t){for(var e in t)return!1;return!0}function X(t,e){if(t===e)return!0;var n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function q(t,e){var n=t[e].bind(t);t[e]=function(){var e=arguments.length<=0?void 0:arguments[0];return e in t.state.cache&&t.state.enable?t.state.cache[e]:n.apply(void 0,arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function Q(t,e,n){var r=t[e].bind(t);t[e]=function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];var a=n.apply(void 0,[t.state._updateCache].concat(i)),s=a.valueChanged,u=a.oldValue;return s&&r.apply(void 0,i),u},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function Z(t){var e=t.useProgram.bind(t);t.useProgram=function(n){t.state.program!==n&&(e(n),t.state.program=n)}}var Y=function(){function t(e){V()(this,t);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.copyState,i=void 0!==r&&r,o=n.log,a=void 0===o?function(){}:o;this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=i?it(e):Object.assign({},j),this.log=a,this._updateCache=this._updateCache.bind(this),Object.seal(this)}return W()(t,[{key:"push",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.stateStack.push({})}},{key:"pop",value:function(){i(this.stateStack.length>0);var t=this.stateStack[this.stateStack.length-1];rt(this.gl,t),this.stateStack.pop()}},{key:"_updateCache",value:function(t){var e,n=!1,r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(var o in t){i(void 0!==o);var a=t[o],s=this.cache[o];X(a,s)||(n=!0,e=s,!r||o in r||(r[o]=s),this.cache[o]=a)}return{valueChanged:n,oldValue:e}}}]),t}();function $(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.enable,r=void 0===n||n,o=e.copyState;if(i(void 0!==o),!t.state){var a=globalThis.polyfillContext;for(var s in a&&a(t),t.state=new Y(t,{copyState:o}),Z(t),N){var u=N[s];Q(t,s,u)}q(t,"getParameter"),q(t,"isEnabled")}return t.state.enable=r,t}function tt(t){i(t.state),t.state.pop()}function et(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return nt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function rt(t,e){if(i(o(t),"setParameters requires a WebGL context"),!K(e)){var n={};for(var r in e){var a=Number(r),s=L[r];s&&("string"==typeof s?n[s]=!0:s(t,e[r],a))}var u=t.state&&t.state.cache;if(u)for(var c in n){(0,G[c])(t,e,u)}}}function it(t,e){if("number"==typeof(e=e||j)){var n=e,r=z[n];return r?r(t,n):t.getParameter(n)}var i,o={},a=et(Array.isArray(e)?e:Object.keys(e));try{for(a.s();!(i=a.n()).done;){var s=i.value,u=z[s];o[s]=u?u(t,Number(s)):t.getParameter(Number(s))}}catch(t){a.e(t)}finally{a.f()}return o}function ot(t){rt(t,j)}function at(t,e,n){if(K(e))return n(t);var r,i=e.nocatch,o=void 0===i||i;if(function(t){t.state||$(t,{copyState:!1}),t.state.push()}(t),rt(t,e),o)r=n(t),tt(t);else try{r=n(t)}finally{tt(t)}return r}var st=n(152);function ut(t){var e=t.luma;if(t.canvas&&e){var n=e.canvasSizeInfo.clientWidth;return n?t.drawingBufferWidth/n:1}return 1}function ct(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=ut(t),i=t.drawingBufferWidth,o=t.drawingBufferHeight;return ft(e,r,i,o,n)}function lt(t){var e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function ft(t,e,n,r,i){var o,a=ht(t[0],e,n),s=dt(t[1],e,r,i),u=ht(t[0]+1,e,n),c=u===n-1?u:u-1;return u=dt(t[1]+1,e,r,i),i?(o=s,s=u=0===u?u:u+1):o=u===r-1?u:u-1,{x:a,y:s,width:Math.max(c-a+1,1),height:Math.max(o-s+1,1)}}function ht(t,e,n){return Math.min(Math.round(t*e),n-1)}function dt(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}var pt=Object(st.a)(),vt=pt&&"undefined"!=typeof document,gt={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function yt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(pt,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils");var e,n=t=Object.assign({},gt,t),r=n.width,o=n.height;function a(e){if(t.throwOnError)throw new Error(e);return console.error(e),null}t.onError=a;var s=t,u=s.canvas,c=_t({canvas:u,width:r,height:o,onError:a});return(e=At(c,t))?(Ot(e=mt(e,t)),e):null}function mt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||wt(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};var n=e=Object.assign({},gt,e),i=n.manageState,o=n.debug;return i&&$(t,{copyState:!1,log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return r.log.apply(r,[1].concat(e))()}}),pt&&o&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),r.level=Math.max(r.level,1)):r.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function bt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.canvas){var n=lt(e.useDevicePixels);xt(t,n,e)}else{var r=t.getExtension("STACKGL_resize_drawingbuffer");r&&"width"in e&&"height"in e&&r.resize(e.width,e.height)}}function At(t,e){var n=e.onError,r=null,i=function(t){return r=t.statusMessage||r};t.addEventListener("webglcontextcreationerror",i,!1);var o=e.webgl1,a=void 0===o||o,s=e.webgl2,u=void 0===s||s,c=null;return u&&(c=(c=c||t.getContext("webgl2",e))||t.getContext("experimental-webgl2",e)),a&&(c=(c=c||t.getContext("webgl",e))||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),c?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),c):n("Failed to create ".concat(u&&!a?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function _t(t){var e,n=t.canvas,r=t.width,i=void 0===r?800:r,o=t.height,a=void 0===o?600:o,s=t.onError;"string"==typeof n?(vt&&"complete"===document.readyState||s("createGLContext called on canvas '".concat(n,"' before page was loaded")),e=document.getElementById(n)):n?e=n:((e=document.createElement("canvas")).id="lumagl-canvas",e.style.width=Number.isFinite(i)?"".concat(i,"px"):"100%",e.style.height=Number.isFinite(a)?"".concat(a,"px"):"100%",document.body.insertBefore(e,document.body.firstChild));return e}function Ot(t){var e=a(t)?"WebGL2":"WebGL1",n=function(t){var e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info");return{vendor:r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",o=t.debug?" debug":"";r.info(1,"".concat(e).concat(o," context ").concat(i))()}function wt(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext?2:1}function xt(t,e,n){var i="width"in n?n.width:t.canvas.clientWidth,o="height"in n?n.height:t.canvas.clientHeight;i&&o||(r.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,o=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};var a=t.luma.canvasSizeInfo;if(a.clientWidth!==i||a.clientHeight!==o||a.devicePixelRatio!==e){var s=e,u=Math.floor(i*s),c=Math.floor(o*s);t.canvas.width=u,t.canvas.height=c,t.drawingBufferWidth===u&&t.drawingBufferHeight===c||(r.warn("Device pixel ratio clamped")(),s=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/o),t.canvas.width=Math.floor(i*s),t.canvas.height=Math.floor(o*s)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:o,devicePixelRatio:e})}}n.d(e,"k",(function(){return r})),n.d(e,"i",(function(){return o})),n.d(e,"j",(function(){return a})),n.d(e,"g",(function(){return s})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return c})),n.d(e,"f",(function(){return it})),n.d(e,"n",(function(){return rt})),n.d(e,"l",(function(){return ot})),n.d(e,"o",(function(){return at})),n.d(e,"c",(function(){return yt})),n.d(e,"m",(function(){return bt})),n.d(e,"h",(function(){return mt})),n.d(e,"e",(function(){return ut})),n.d(e,"d",(function(){return ct}))},function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return r}))},function(t,e,n){t.exports=n(287)},function(t,e,n){var r=n(283),i=n(284),o=n(285);t.exports=function(t,e){return r(t)||i(t,e)||o()}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o}));var r=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,o=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},function(t,e){function n(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise((function(i,o){var a=t.apply(e,r);function s(t){n(a,i,o,s,u,"next",t)}function u(t){n(a,i,o,s,u,"throw",t)}s(void 0)}))}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return u}));var r=n(31),i={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(i,"IDENTITY",{get:function(){return r.a.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0}});var o={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},a={common:0,meters:1,pixels:2},s={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},u={DRAW:"draw",MASK:"mask"}},function(t,e,n){"use strict";n.r(e);var r=n(20),i=n(151),o=n(164),a=n(118),s=n(1),u=n.n(s),c=n(3),l=n.n(c),f=n(0),h=n.n(f),d=n(155);function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){h()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var g=[255,255,255],y=[0,0,1],m=[0,0,1],b=0,A=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u()(this,t),h()(this,"id",void 0),h()(this,"color",void 0),h()(this,"intensity",void 0),h()(this,"type","point"),h()(this,"position",void 0),h()(this,"attenuation",void 0),h()(this,"projectedLight",void 0);var n=e.color,r=void 0===n?g:n,i=e.intensity,o=void 0===i?1:i,a=e.position,s=void 0===a?m:a;this.id=e.id||"point-".concat(b++),this.color=r,this.intensity=o,this.type="point",this.position=s,this.attenuation=_(e),this.projectedLight=v({},this)}return l()(t,[{key:"getProjectedLight",value:function(t){var e=t.layer,n=this.projectedLight,i=e.context.viewport,o=e.props,a=o.coordinateSystem,s=o.coordinateOrigin,u=Object(d.b)(this.position,{viewport:i,coordinateSystem:a,coordinateOrigin:s,fromCoordinateSystem:i.isGeospatial?r.a.LNGLAT:r.a.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return n.color=this.color,n.intensity=this.intensity,n.position=u,n}}]),t}();function _(t){return t.attenuation?t.attenuation:"intensity"in t?[0,0,t.intensity||0]:y}var O=n(5),w=n.n(O),x=n(7),C=n.n(x),P=n(2),S=n.n(P),B=n(137);function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C()(this,n)}}var E=function(t){w()(n,t);var e=k(n);function n(){return u()(this,n),e.apply(this,arguments)}return l()(n,[{key:"getProjectedLight",value:function(t){var e=t.layer,n=this.projectedLight,r=e.context.viewport,i=e.props,o=i.coordinateSystem,a=i.coordinateOrigin,s=i.modelMatrix,u=Object(B.b)({viewport:r,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a}).project_uCameraPosition;return n.color=this.color,n.intensity=this.intensity,n.position=u,n}}]),n}(A),T=n(15),j=n.n(T),M=n(9),I=n.n(M),R=Math.PI/180,D=23.4397*R;function L(t,e,n){var r,i,o,a,s,u,c=R*-n,l=R*e,f=function(t){return function(t){return("number"==typeof t?t:t.getTime())/864e5-.5+2440588}(t)-2451545}(t),h=(r=R*(357.5291+.98560028*f),i=R*(1.9148*Math.sin(r)+.02*Math.sin(2*r)+3e-4*Math.sin(3*r)),o=r+i+102.9372*R+Math.PI,{declination:(a=o,s=0,u=a,Math.asin(Math.sin(s)*Math.cos(D)+Math.cos(s)*Math.sin(D)*Math.sin(u))),rightAscension:G(o,0)}),d=function(t,e){return R*(280.147+360.9856235*t)-e}(f,c)-h.rightAscension;return{azimuth:N(d,l,h.declination),altitude:U(d,l,h.declination)}}function F(t,e,n){var r=L(t,e,n),i=r.azimuth,o=r.altitude;return[Math.sin(i)*Math.cos(o),Math.cos(i)*Math.cos(o),-Math.sin(o)]}function G(t,e){var n=t;return Math.atan2(Math.sin(n)*Math.cos(D)-Math.tan(e)*Math.sin(D),Math.cos(n))}function N(t,e,n){var r=t,i=e,o=n;return Math.atan2(Math.sin(r),Math.cos(r)*Math.sin(i)-Math.tan(o)*Math.cos(i))}function U(t,e,n){var r=t,i=e,o=n;return Math.asin(Math.sin(i)*Math.sin(o)+Math.cos(i)*Math.cos(o)*Math.cos(r))}function z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C()(this,n)}}var H=function(t){w()(n,t);var e=z(n);function n(t){var r;return u()(this,n),r=e.call(this,t),h()(I()(r),"timestamp",void 0),r.timestamp=t.timestamp,r}return l()(n,[{key:"getProjectedLight",value:function(t){var e=t.layer.context.viewport;if(e.resolution&&e.resolution>0){var n=F(this.timestamp,0,0),r=j()(n,3),i=r[0],o=r[1],a=r[2];this.direction=[i,-a,o]}else{var s=e.latitude,u=e.longitude;this.direction=F(this.timestamp,s,u)}return this}}]),n}(a.a),V=n(194),J=n(82);function W(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C()(this,n)}}var K=[-1,-1,1,-1,-1,1,1,1],X=function(t){w()(n,t);var e=W(n);function n(t,r){var i;u()(this,n);var o=K.map((function(t){return-1===t?0:t}));return(i=e.call(this,t,Object.assign({},r,{vs:"attribute vec2 aClipSpacePosition;\nattribute vec2 aTexCoord;\nattribute vec2 aCoordinate;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main(void) {\n  gl_Position = vec4(aClipSpacePosition, 0., 1.);\n  position = aClipSpacePosition;\n  coordinate = aCoordinate;\n  uv = aTexCoord;\n}\n",geometry:new J.a({drawMode:5,vertexCount:4,attributes:{aClipSpacePosition:{size:2,value:new Float32Array(K)},aTexCoord:{size:2,value:new Float32Array(o)},aCoordinate:{size:2,value:new Float32Array(o)}}})}))).setVertexCount(4),i}return n}(V.a),q=n(12),Q=n(197);function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C()(this,n)}}var Y=function(t){w()(n,t);var e=Z(n);function n(t,r){var i;u()(this,n),i=e.call(this,t,r),h()(I()(i),"model",void 0);var o=r.module,a=r.fs,s=r.id;return i.model=new X(t,{id:s,fs:a,modules:[o]}),i}return l()(n,[{key:"render",value:function(t){var e=this,n=this.gl;Object(q.n)(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),Object(q.o)(n,{framebuffer:t.outputBuffer,clearColor:[0,0,0,0]},(function(){return e._renderPass(n,t)}))}},{key:"delete",value:function(){this.model.delete(),this.model=null}},{key:"_renderPass",value:function(t,e){var n=e.inputBuffer;Object(Q.a)(t,{color:!0}),this.model.draw({moduleSettings:this.props.moduleSettings,uniforms:{texture:n,texSize:[n.width,n.height]},parameters:{depthWrite:!1,depthTest:!1}})}}]),n}(n(189).a),$=n(211);function tt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return et(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var nt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};u()(this,t),h()(this,"id",void 0),h()(this,"props",void 0),h()(this,"module",void 0),h()(this,"passes",void 0),this.id="".concat(e.name,"-pass"),this.props=n,Object($.b)(e),this.module=e}return l()(t,[{key:"preRender",value:function(){}},{key:"postRender",value:function(t,e){var n=this.passes||function(t,e,n,r){if(!e.passes){var i=ot(e);return[new Y(t,{id:n,module:e,fs:i,moduleSettings:r})]}return e.passes.map((function(i,o){var a=ot(e,i),s="".concat(n,"-").concat(o);return new Y(t,{id:s,module:e,fs:a,moduleSettings:r})}))}(t,this.module,this.id,this.props);this.passes=n;for(var r=e.target,i=e.inputBuffer,o=e.swapBuffer,a=0;a<this.passes.length;a++){r&&a===this.passes.length-1&&(o=r),this.passes[a].render({inputBuffer:i,outputBuffer:o});var s=o;o=i,i=s}return i}},{key:"cleanup",value:function(){if(this.passes){var t,e=tt(this.passes);try{for(e.s();!(t=e.n()).done;){t.value.delete()}}catch(t){e.e(t)}finally{e.f()}this.passes=void 0}}}]),t}();var rt=function(t){return"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = texture2D(texture, texCoord);\n  gl_FragColor = ".concat(t,"(gl_FragColor, texSize, texCoord);\n}\n")},it=function(t){return"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = ".concat(t,"(texture, texSize, texCoord);\n}\n")};function ot(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(e.filter){var n="string"==typeof e.filter?e.filter:"".concat(t.name,"_filterColor");return rt(n)}if(e.sampler){var r="string"==typeof e.sampler?e.sampler:"".concat(t.name,"_sampleColor");return it(r)}return null}var at=n(94),st=n(240),ut=n(182),ct=n(177),lt=n(176),ft=n(203),ht=n(184),dt=n(62),pt=n(102),vt=n(175),gt=n(98),yt=n(33);function mt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function bt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mt(Object(n),!0).forEach((function(e){h()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function At(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C()(this,n)}}var _t=Math.PI/180;function Ot(t){var e=t.height,n=t.focalDistance,r=t.orbitAxis,i=t.rotationX,o=t.rotationOrbit,a=t.zoom,s="Z"===r?[0,0,1]:[0,1,0],u="Z"===r?[0,-n,0]:[0,0,n],c=(new gt.a).lookAt({eye:u,up:s});c.rotateX(i*_t),"Z"===r?c.rotateZ(o*_t):c.rotateY(o*_t);var l=Math.pow(2,a)/e;return c.scale(l),c}var wt=function(t){w()(n,t);var e=At(n);function n(t){var r;u()(this,n);var i=t.height,o=t.projectionMatrix,a=t.fovy,s=void 0===a?50:a,c=t.orbitAxis,l=void 0===c?"Z":c,f=t.target,d=void 0===f?[0,0,0]:f,p=t.rotationX,v=void 0===p?0:p,g=t.rotationOrbit,y=void 0===g?0:g,m=t.zoom,b=void 0===m?0:m,A=o?o[5]/2:Object(yt.e)(s);return r=e.call(this,bt(bt({},t),{},{longitude:void 0,viewMatrix:Ot({height:i||1,focalDistance:A,orbitAxis:l,rotationX:v,rotationOrbit:y,zoom:b}),fovy:s,focalDistance:A,position:d,zoom:b})),h()(I()(r),"projectedCenter",void 0),r.projectedCenter=r.project(r.center),r}return l()(n,[{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,i=j()(t,3),o=i[0],a=i[1],s=i[2],u=void 0===s?this.projectedCenter[2]:s,c=r?a:this.height-a,l=Object(yt.n)([o,c,u],this.pixelUnprojectionMatrix),f=j()(l,3),h=f[0],d=f[1],p=f[2];return[h,d,p]}},{key:"panByPosition",value:function(t,e){var n=this.project(t),r=[this.width/2+n[0]-e[0],this.height/2+n[1]-e[1],this.projectedCenter[2]];return{target:this.unproject(r)}}}]),n}(dt.a),xt=n(171),Ct=n(257),Pt=n.n(Ct),St=n(54),Bt=n.n(St),kt=n(55),Et=n.n(kt);function Tt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var jt=n(106),Mt=n(24),It=n(39),Rt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.phi,r=void 0===n?0:n,i=e.theta,o=void 0===i?0:i,a=e.radius,s=void 0===a?1:a,u=e.bearing,c=e.pitch,l=e.altitude,f=e.radiusScale,h=void 0===f?6371e3:f;Bt()(this,t),Tt(this,"phi",void 0),Tt(this,"theta",void 0),Tt(this,"radius",void 0),Tt(this,"radiusScale",void 0),this.phi=r,this.theta=o,this.radius=s||l||1,this.radiusScale=h||1,void 0!==u&&(this.bearing=u),void 0!==c&&(this.pitch=c),this.check()}return Et()(t,[{key:"toString",value:function(){return this.formatString(Mt.b)}},{key:"formatString",value:function(t){var e=t.printTypes,n=void 0!==e&&e,r=Mt.e;return"".concat(n?"Spherical":"","[rho:").concat(r(this.radius),",theta:").concat(r(this.theta),",phi:").concat(r(this.phi),"]")}},{key:"equals",value:function(t){return Object(Mt.d)(this.radius,t.radius)&&Object(Mt.d)(this.theta,t.theta)&&Object(Mt.d)(this.phi,t.phi)}},{key:"exactEquals",value:function(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}},{key:"bearing",get:function(){return 180-Object(Mt.c)(this.phi)},set:function(t){this.phi=Math.PI-Object(Mt.h)(t)}},{key:"pitch",get:function(){return Object(Mt.c)(this.theta)},set:function(t){this.theta=Object(Mt.h)(t)}},{key:"longitude",get:function(){return Object(Mt.c)(this.phi)}},{key:"latitude",get:function(){return Object(Mt.c)(this.theta)}},{key:"lng",get:function(){return Object(Mt.c)(this.phi)}},{key:"lat",get:function(){return Object(Mt.c)(this.theta)}},{key:"z",get:function(){return(this.radius-1)*this.radiusScale}},{key:"set",value:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this.check()}},{key:"clone",value:function(){return(new t).copy(this)}},{key:"copy",value:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}},{key:"fromLngLatZ",value:function(t){var e=Pt()(t,3),n=e[0],r=e[1],i=e[2];return this.radius=1+i/this.radiusScale,this.phi=Object(Mt.h)(r),this.theta=Object(Mt.h)(n),this.check()}},{key:"fromVector3",value:function(t){return this.radius=It.i(t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(Object(Mt.a)(t[2]/this.radius,-1,1))),this.check()}},{key:"toVector3",value:function(){return new jt.a(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}},{key:"makeSafe",value:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}},{key:"check",value:function(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}}]),t}();function Dt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Lt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Dt(Object(n),!0).forEach((function(e){h()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C()(this,n)}}var Gt=function(t){w()(n,t);var e=Ft(n);function n(t){var r;u()(this,n);var i=t.longitude,o=t.latitude,a=t.modelMatrix,s=t.bearing,c=void 0===s?0:s,l=t.pitch,f=void 0===l?0:l,d=t.up,p=void 0===d?[0,0,1]:d,v=new Rt({bearing:c,pitch:-90===f?1e-4:90+f}).toVector3().normalize(),g=a?new gt.a(a).transformAsVector(v):v,y=Number.isFinite(o)?Object(yt.i)({latitude:o}):0,m=Math.pow(2,y),b=(new gt.a).lookAt({eye:[0,0,0],center:g,up:p}).scale(m);return r=e.call(this,Lt(Lt({},t),{},{zoom:y,viewMatrix:b})),h()(I()(r),"longitude",void 0),h()(I()(r),"latitude",void 0),r.latitude=o,r.longitude=i,r}return n}(dt.a),Nt=n(247),Ut=n(120),zt=n(228),Ht=n(248),Vt=n(136),Jt=n(81),Wt=n(165),Kt=n(80),Xt=n(138),qt=n(52),Qt=n(71);function Zt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Yt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zt(Object(n),!0).forEach((function(e){h()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $t(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C()(this,n)}}var te=function(t){w()(n,t);var e=$t(n);function n(t){u()(this,n);var r=t.width,i=t.height,o=t.position,a=void 0===o?[0,0,0]:o,s=t.bearing,c=void 0===s?0:s,l=t.pitch,f=void 0===l?0:l,h=t.longitude,d=void 0===h?null:h,p=t.latitude,v=void 0===p?null:p,g=t.maxPitch,y=void 0===g?90:g,m=t.minPitch,b=void 0===m?-90:m,A=t.startRotatePos,_=t.startBearing,O=t.startPitch,w=t.startZoomPosition;return e.call(this,{width:r,height:i,position:a,bearing:c,pitch:f,longitude:d,latitude:v,maxPitch:y,minPitch:b},{startRotatePos:A,startBearing:_,startPitch:O,startZoomPosition:w})}return l()(n,[{key:"panStart",value:function(){return this}},{key:"pan",value:function(){return this}},{key:"panEnd",value:function(){return this}},{key:"rotateStart",value:function(t){var e=t.pos;return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}},{key:"rotate",value:function(t){var e,n=t.pos,r=t.deltaAngleX,i=void 0===r?0:r,o=t.deltaAngleY,a=void 0===o?0:o,s=this.getState(),u=s.startRotatePos,c=s.startBearing,l=s.startPitch,f=this.getViewportProps(),h=f.width,d=f.height;if(!u||void 0===c||void 0===l)return this;n?e={bearing:c-180*((n[0]-u[0])/h),pitch:l-90*((n[1]-u[1])/d)}:e={bearing:c-i,pitch:l-a};return this._getUpdatedState(e)}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startRotatePos:null,startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(){return this._getUpdatedState({startZoomPosition:this.getViewportProps().position})}},{key:"zoom",value:function(t){var e=t.scale,n=this.getState().startZoomPosition;n||(n=this.getViewportProps().position);var r=this.getDirection();return this._move(r,20*Math.log2(e),n)}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomPosition:null})}},{key:"moveLeft",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,e=this.getDirection(!0);return this._move(e.rotateZ({radians:Math.PI/2}),t)}},{key:"moveRight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,e=this.getDirection(!0);return this._move(e.rotateZ({radians:-Math.PI/2}),t)}},{key:"moveUp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,e=this.getDirection(!0);return this._move(e,t)}},{key:"moveDown",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,e=this.getDirection(!0);return this._move(e.negate(),t)}},{key:"rotateLeft",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}},{key:"rotateRight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}},{key:"rotateUp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}},{key:"rotateDown",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}},{key:"zoomIn",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this.zoom({scale:t})}},{key:"zoomOut",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this.zoom({scale:1/t})}},{key:"shortestPathFrom",value:function(t){var e=t.getViewportProps(),n=Yt({},this.getViewportProps()),r=n.bearing,i=n.longitude;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),null!==i&&null!==e.longitude&&Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}},{key:"_move",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getViewportProps().position,r=t.scale(e);return this._getUpdatedState({position:new jt.a(n).add(r)})}},{key:"getDirection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=new Rt({bearing:this.getViewportProps().bearing,pitch:t?90:90+this.getViewportProps().pitch}),n=e.toVector3().normalize();return n}},{key:"_getUpdatedState",value:function(t){return new n(Yt(Yt(Yt({},this.getViewportProps()),this.getState()),t))}},{key:"applyConstraints",value:function(t){var e=t.pitch,n=t.maxPitch,r=t.minPitch,i=t.longitude,o=t.bearing;return t.pitch=Object(Mt.a)(e,r,n),null!==i&&(i<-180||i>180)&&(t.longitude=Object(qt.e)(i+180,360)-180),(o<-180||o>180)&&(t.bearing=Object(qt.e)(o+180,360)-180),t}}]),n}(Xt.a),ee=function(t){w()(n,t);var e=$t(n);function n(){var t;u()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),h()(I()(t),"ControllerState",te),h()(I()(t),"transition",{transitionDuration:300,transitionInterpolator:new Qt.a(["position","pitch","bearing"])}),t}return n}(Kt.a);function ne(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C()(this,n)}}var re=function(t){w()(n,t);var e=ne(n);function n(){return u()(this,n),e.apply(this,arguments)}return l()(n,[{key:"ViewportType",get:function(){return Gt}},{key:"ControllerType",get:function(){return ee}}]),n}(Jt.a);h()(re,"displayName","FirstPersonView");var ie=n(130);function oe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C()(this,n)}}var ae=function(t){w()(n,t);var e=oe(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u()(this,n),(t=e.call(this,r)).props.orbitAxis=r.orbitAxis||"Z",t}return l()(n,[{key:"ViewportType",get:function(){return wt}},{key:"ControllerType",get:function(){return ie.b}}]),n}(Jt.a);h()(ae,"displayName","OrbitView");var se=n(170),ue=n(10),ce=n.n(ue),le=n(128);function fe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C()(this,n)}}var he=function(t){w()(n,t);var e=fe(n);function n(){return u()(this,n),e.apply(this,arguments)}return l()(n,[{key:"applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;t.zoom=Object(Mt.a)(r,n,e);var i=t.longitude,o=t.latitude;return(i<-180||i>180)&&(t.longitude=Object(qt.e)(i+180,360)-180),t.latitude=Object(Mt.a)(o,-89,89),t}}]),n}(le.a),de=function(t){w()(n,t);var e=fe(n);function n(){var t;u()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),h()(I()(t),"ControllerState",he),h()(I()(t),"transition",{transitionDuration:300,transitionInterpolator:new Qt.a(["longitude","latitude","zoom"])}),h()(I()(t),"dragMode","pan"),t}return l()(n,[{key:"setProps",value:function(t){ce()(S()(n.prototype),"setProps",this).call(this,t),this.dragRotate=!1,this.touchRotate=!1}}]),n}(Kt.a);function pe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C()(this,n)}}var ve=function(t){w()(n,t);var e=pe(n);function n(){return u()(this,n),e.apply(this,arguments)}return l()(n,[{key:"ViewportType",get:function(){return vt.a}},{key:"ControllerType",get:function(){return de}}]),n}(Jt.a);h()(ve,"displayName","GlobeView");var ge=n(172),ye=n(204),me=n(166),be=n(129);function Ae(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return _e(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _e(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Oe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function we(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Oe(Object(n),!0).forEach((function(e){h()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function xe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=S()(t);if(e){var i=S()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C()(this,n)}}var Ce=["bearing","pitch"],Pe={speed:1.2,curve:1.414},Se=function(t){w()(n,t);var e=xe(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u()(this,n),t=e.call(this,{compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}),h()(I()(t),"opts",void 0),t.opts=we(we({},Pe),r),t}return l()(n,[{key:"interpolateProps",value:function(t,e,n){var r,i=Object(yt.d)(t,e,n,this.opts),o=Ae(Ce);try{for(o.s();!(r=o.n()).done;){var a=r.value;i[a]=Object(Mt.g)(t[a]||0,e[a]||0,n)}}catch(t){o.e(t)}finally{o.f()}return i}},{key:"getDuration",value:function(t,e){var n=e.transitionDuration;return"auto"===n&&(n=Object(yt.h)(t,e,this.opts)),n}}]),n}(be.a),Be=n(31),ke=n(44),Ee=n(75),Te=n(229),je=n(89),Me=n(173),Ie=n(101),Re=n(174),De=n(150);n.d(e,"COORDINATE_SYSTEM",(function(){return r.a})),n.d(e,"OPERATION",(function(){return r.c})),n.d(e,"UNIT",(function(){return r.e})),n.d(e,"LightingEffect",(function(){return i.a})),n.d(e,"AmbientLight",(function(){return o.a})),n.d(e,"DirectionalLight",(function(){return a.a})),n.d(e,"PointLight",(function(){return A})),n.d(e,"_CameraLight",(function(){return E})),n.d(e,"_SunLight",(function(){return H})),n.d(e,"PostProcessEffect",(function(){return nt})),n.d(e,"_LayersPass",(function(){return at.a})),n.d(e,"Deck",(function(){return st.a})),n.d(e,"LayerManager",(function(){return ut.a})),n.d(e,"AttributeManager",(function(){return ct.a})),n.d(e,"Layer",(function(){return lt.a})),n.d(e,"CompositeLayer",(function(){return ft.a})),n.d(e,"DeckRenderer",(function(){return ht.a})),n.d(e,"Viewport",(function(){return dt.a})),n.d(e,"WebMercatorViewport",(function(){return pt.a})),n.d(e,"_GlobeViewport",(function(){return vt.a})),n.d(e,"OrbitViewport",(function(){return wt})),n.d(e,"OrthographicViewport",(function(){return xt.a})),n.d(e,"FirstPersonViewport",(function(){return Gt})),n.d(e,"picking",(function(){return Nt.a})),n.d(e,"project",(function(){return Ut.a})),n.d(e,"project32",(function(){return zt.a})),n.d(e,"gouraudLighting",(function(){return Ht.a})),n.d(e,"phongLighting",(function(){return Ht.b})),n.d(e,"shadow",(function(){return Vt.a})),n.d(e,"View",(function(){return Jt.a})),n.d(e,"MapView",(function(){return Wt.a})),n.d(e,"FirstPersonView",(function(){return re})),n.d(e,"OrbitView",(function(){return ae})),n.d(e,"OrthographicView",(function(){return se.a})),n.d(e,"_GlobeView",(function(){return ve})),n.d(e,"Controller",(function(){return Kt.a})),n.d(e,"MapController",(function(){return le.b})),n.d(e,"_GlobeController",(function(){return de})),n.d(e,"FirstPersonController",(function(){return ee})),n.d(e,"OrbitController",(function(){return ie.b})),n.d(e,"OrthographicController",(function(){return ge.a})),n.d(e,"LayerExtension",(function(){return ye.a})),n.d(e,"TRANSITION_EVENTS",(function(){return me.a})),n.d(e,"TransitionInterpolator",(function(){return be.a})),n.d(e,"LinearInterpolator",(function(){return Qt.a})),n.d(e,"FlyToInterpolator",(function(){return Se})),n.d(e,"log",(function(){return Be.a})),n.d(e,"assert",(function(){return ke.a})),n.d(e,"createIterable",(function(){return Ee.a})),n.d(e,"fp64LowPart",(function(){return qt.b})),n.d(e,"Tesselator",(function(){return Te.a})),n.d(e,"_fillArray",(function(){return je.a})),n.d(e,"_flatten",(function(){return je.b})),n.d(e,"_count",(function(){return Me.a})),n.d(e,"_memoize",(function(){return Ie.a})),n.d(e,"_mergeShaders",(function(){return Re.a})),n.d(e,"_compareProps",(function(){return De.a}))},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return s})),n.d(e,"h",(function(){return u})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return l})),n.d(e,"g",(function(){return f})),n.d(e,"d",(function(){return h}));n(187),n(154);var r=1/Math.PI*180,i=1/180*Math.PI,o={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.precision,r=void 0===n?o.precision:n;return t=d(t),"".concat(parseFloat(t.toPrecision(r)))}function s(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function u(t,e){return p(t,(function(t){return t*i}),e)}function c(t,e){return p(t,(function(t){return t*r}),e)}function l(t,e,n){return p(t,(function(t){return Math.max(e,Math.min(n,t))}))}function f(t,e,n){return s(t)?t.map((function(t,r){return f(t,e[r],n)})):n*e+(1-n)*t}function h(t,e,n){var r=o.EPSILON;n&&(o.EPSILON=n);try{if(t===e)return!0;if(s(t)&&s(e)){if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!h(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"==typeof t&&"number"==typeof e&&Math.abs(t-e)<=o.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{o.EPSILON=r}}function d(t){return Math.round(t/o.EPSILON)*o.EPSILON}function p(t,e,n){if(s(t)){var r=t;n=n||function(t){return t.clone?t.clone():new Array(t.length)}(r);for(var i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o}));var r=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,o=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e,n){var r=n(279),i=n(280),o=n(281);t.exports=function(t){return r(t)||i(t)||o()}},function(t,e,n){var r=n(237);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},,function(t,e,n){"use strict";var r={};function i(t){var e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}function o(t){var e=t&&t.lastIndexOf("/");return e>=0?t.substr(0,e):""}function a(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r="/";return(e=e.map((function(t,n){return n&&(t=t.replace(new RegExp("^".concat(r)),"")),n!==e.length-1&&(t=t.replace(new RegExp("".concat(r,"$")),"")),t}))).join(r)}n.r(r),n.d(r,"filename",(function(){return i})),n.d(r,"dirname",(function(){return o})),n.d(r,"join",(function(){return a}));n(161);var s=n(226);n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return s}))},function(t,e,n){"use strict";var r=n(328);e.a=new r.a({id:"deck"})},function(t,e,n){"use strict";n.d(e,"f",(function(){return s})),n.d(e,"h",(function(){return u})),n.d(e,"g",(function(){return c})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return f})),n.d(e,"e",(function(){return h})),n.d(e,"j",(function(){return d})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return v})),n.d(e,"i",(function(){return g})),n.d(e,"k",(function(){return y}));var r=n(23),i=n.n(r),o=function(t){return"boolean"==typeof t},a=function(t){return"function"==typeof t},s=function(t){return null!==t&&"object"===i()(t)},u=function(t){return s(t)&&t.constructor==={}.constructor},c=function(t){return s(t)&&a(t.then)},l=function(t){return t&&"function"==typeof t[Symbol.iterator]},f=function(t){return t&&"function"==typeof t[Symbol.asyncIterator]},h=function(t){return t&&a(t.next)},d=function(t){return"undefined"!=typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json},p=function(t){return"undefined"!=typeof Blob&&t instanceof Blob},v=function(t){return t&&"object"===i()(t)&&t.isBuffer},g=function(t){return function(t){return"undefined"!=typeof ReadableStream&&t instanceof ReadableStream||s(t)&&a(t.tee)&&a(t.cancel)&&a(t.getReader)}(t)||function(t){return s(t)&&a(t.read)&&a(t.pipe)&&o(t.readable)}(t)},y=function(t){return function(t){return s(t)&&a(t.abort)&&a(t.getWriter)}(t)||function(t){return s(t)&&a(t.end)&&a(t.write)&&o(t.writable)}(t)}},function(t,e,n){"use strict";n(157);var r=n(61),i=n.n(r);n(253),n(254);var o=n(53);function a(t,e){var n=Object(o.n)([],e,t);return Object(o.k)(n,n,1/n[3]),n}function s(t,e){var n=t%e;return n<0?e+n:n}function u(t,e,n){return t<e?e:t>n?n:t}var c=Math.log2||function(t){return Math.log(t)*Math.LOG2E},l=n(40),f=n(50),h=n(39);function d(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}var p=Math.PI,v=p/4,g=p/180,y=180/p;function m(t){return Math.pow(2,t)}function b(t){return c(t)}function A(t){var e=i()(t,2),n=e[0],r=e[1];d(Number.isFinite(n)),d(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");var o=r*g;return[512*(n*g+p)/(2*p),512*(p+Math.log(Math.tan(v+.5*o)))/(2*p)]}function _(t){var e=i()(t,2),n=e[0],r=e[1],o=n/512*(2*p)-p,a=2*(Math.atan(Math.exp(r/512*(2*p)-p))-v);return[o*y,a*y]}function O(t){var e=t.latitude;return d(Number.isFinite(e)),b(4003e4*Math.cos(e*g))-9}function w(t){var e=t.latitude,n=t.longitude,r=t.highPrecision,i=void 0!==r&&r;d(Number.isFinite(e)&&Number.isFinite(n));var o=Math.cos(e*g),a=512/360/o,s=512/4003e4/o,u={unitsPerMeter:[s,s,s],metersPerUnit:[1/s,1/s,1/s],unitsPerDegree:[512/360,a,s],degreesPerUnit:[.703125,1/a,1/s]};if(i){var c=g*Math.tan(e*g)/o,l=512/360*c/2,f=512/4003e4*c,h=f/a*s;u.unitsPerDegree2=[0,l,f],u.unitsPerMeter2=[h,0,h]}return u}function x(t,e){var n=i()(t,3),r=n[0],o=n[1],a=n[2],s=i()(e,3),u=s[0],c=s[1],l=s[2],f=w({longitude:r,latitude:o,highPrecision:!0}),h=f.unitsPerMeter,d=f.unitsPerMeter2,p=A(t);p[0]+=u*(h[0]+d[0]*c),p[1]+=c*(h[1]+d[1]*c);var v=_(p),g=(a||0)+(l||0);return Number.isFinite(a)||Number.isFinite(l)?[v[0],v[1],g]:v}function C(t){var e=t.height,n=t.pitch,r=t.bearing,i=t.altitude,o=t.scale,a=t.center,s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];l.p(s,s,[0,0,-i]),l.l(s,s,-n*g),l.n(s,s,r*g);var u=o/e;return l.o(s,s,[u,u,u]),a&&l.p(s,s,h.k([],a)),s}function P(t){var e=t.width,n=t.height,r=t.altitude,i=t.pitch,o=void 0===i?0:i,a=t.offset,s=t.center,c=t.scale,l=t.nearZMultiplier,f=void 0===l?1:l,h=t.farZMultiplier,d=void 0===h?1:h,p=t.fovy,v=void 0===p?S(1.5):p;void 0!==r&&(v=S(r));var y=v*g,m=o*g,b=B(v),A=b;s&&(A+=s[2]*c/Math.cos(m)/n);var _=y*(.5+(a?a[1]:0)/n),O=Math.sin(_)*A/Math.sin(u(Math.PI/2-m-_,.01,Math.PI-.01)),w=Math.sin(m)*O+A,x=10*A;return{fov:y,aspect:e/n,focalDistance:b,near:f,far:Math.min(w*d,x)}}function S(t){return 2*Math.atan(.5/t)*y}function B(t){return.5/Math.tan(.5*t*g)}function k(t,e){var n=i()(t,3),r=n[0],o=n[1],s=n[2],u=void 0===s?0:s;return d(Number.isFinite(r)&&Number.isFinite(o)&&Number.isFinite(u)),a(e,[r,o,u,1])}function E(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=i()(t,3),o=r[0],s=r[1],u=r[2];if(d(Number.isFinite(o)&&Number.isFinite(s),"invalid pixel coordinate"),Number.isFinite(u)){var c=a(e,[o,s,u,1]);return c}var l=a(e,[o,s,0,1]),h=a(e,[o,s,1,1]),p=l[2],v=h[2],g=p===v?0:((n||0)-p)/(v-p);return f.c([],l,h,g)}function T(t){var e=t.width,n=t.height,r=t.bounds,o=t.minExtent,a=void 0===o?0:o,s=t.maxZoom,l=void 0===s?24:s,f=t.offset,h=void 0===f?[0,0]:f,p=i()(r,2),v=i()(p[0],2),g=v[0],y=v[1],m=i()(p[1],2),b=m[0],O=m[1],w=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("number"==typeof t)return{top:t,bottom:t,left:t,right:t};return d(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t}(t.padding),x=A([g,u(O,-85.051129,85.051129)]),C=A([b,u(y,-85.051129,85.051129)]),P=[Math.max(Math.abs(C[0]-x[0]),a),Math.max(Math.abs(C[1]-x[1]),a)],S=[e-w.left-w.right-2*Math.abs(h[0]),n-w.top-w.bottom-2*Math.abs(h[1])];d(S[0]>0&&S[1]>0);var B=S[0]/P[0],k=S[1]/P[1],E=(w.right-w.left)/2/B,T=(w.bottom-w.top)/2/k,j=_([(C[0]+x[0])/2+E,(C[1]+x[1])/2+T]),M=Math.min(l,c(Math.abs(Math.min(B,k))));return d(Number.isFinite(M)),{longitude:j[0],latitude:j[1],zoom:M}}var j=Math.PI/180;function M(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t.width,o=t.height,a=t.unproject,s={targetZ:r},u=a([0,o],s),c=a([i,o],s),l=t.fovy?.5*t.fovy*j:Math.atan(.5/t.altitude),f=(90-t.pitch)*j;return l>f-.01?(e=I(t,0,r),n=I(t,i,r)):(e=a([0,0],s),n=a([i,0],s)),[u,c,n,e]}function I(t,e,n){var r=t.pixelUnprojectionMatrix,i=a(r,[e,0,1,1]),o=a(r,[e,t.height,1,1]),s=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(o[2]-i[2]),u=_(f.c([],i,o,s));return u.push(n),u}function R(t){var e=t.width,n=t.height,r=t.pitch,i=void 0===r?0:r,o=t.longitude,a=t.latitude,u=t.zoom,l=t.bearing,f=void 0===l?0:l;(o<-180||o>180)&&(o=s(o+180,360)-180),(f<-180||f>180)&&(f=s(f+180,360)-180);var h=c(n/512);if(u<=h)u=h,a=0;else{var d=n/2/Math.pow(2,u),p=_([0,d])[1];if(a<p)a=p;else{var v=_([0,512-d])[1];a>v&&(a=v)}}return{width:e,height:n,longitude:o,latitude:a,zoom:u,pitch:i,bearing:f}}var D=n(255),L=n.n(D);function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function G(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){L()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function N(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return U(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var z=["longitude","latitude","zoom"],H={curve:1.414,speed:1.2};function V(t,e,n,r){var i,o=W(t,e,r),a=o.startZoom,s=o.startCenterXY,u=o.uDelta,c=o.w0,l=o.u1,h=o.S,d=o.rho,p=o.rho2,v=o.r0;if(l<.01){var g,y={},m=N(z);try{for(m.s();!(g=m.n()).done;){var A=g.value,O=t[A],w=e[A];y[A]=(i=n)*w+(1-i)*O}}catch(t){m.e(t)}finally{m.f()}return y}var x=n*h,C=Math.cosh(v)/Math.cosh(v+d*x),P=c*((Math.cosh(v)*Math.tanh(v+d*x)-Math.sinh(v))/p)/l,S=a+b(1/C),B=f.e([],u,P);f.a(B,B,s);var k=_(B);return{longitude:k[0],latitude:k[1],zoom:S}}function J(t,e,n){var r,i=G(G({},H),n),o=i.screenSpeed,a=i.speed,s=i.maxDuration,u=W(t,e,i),c=u.S,l=u.rho,f=1e3*c;return r=Number.isFinite(o)?f/(o/l):f/a,Number.isFinite(s)&&r>s?0:r}function W(t,e,n){var r=(n=Object.assign({},H,n)).curve,i=t.zoom,o=[t.longitude,t.latitude],a=m(i),s=e.zoom,u=[e.longitude,e.latitude],c=m(s-i),l=A(o),h=A(u),d=f.f([],h,l),p=Math.max(t.width,t.height),v=p/c,g=f.b(d)*a,y=Math.max(g,.01),b=r*r,_=(v*v-p*p+b*b*y*y)/(2*p*b*y),O=(v*v-p*p-b*b*y*y)/(2*v*b*y),w=Math.log(Math.sqrt(_*_+1)-_),x=Math.log(Math.sqrt(O*O+1)-O);return{startZoom:i,startCenterXY:l,uDelta:d,w0:p,u1:g,S:(x-w)/r,rho:r,rho2:b,r0:w,r1:x}}n.d(e,"f",(function(){return M})),n.d(e,"c",(function(){return T})),n.d(e,"m",(function(){return R})),n.d(e,"d",(function(){return V})),n.d(e,"h",(function(){return J})),n.d(e,"l",(function(){return A})),n.d(e,"o",(function(){return _})),n.d(e,"p",(function(){return k})),n.d(e,"n",(function(){return E})),n.d(e,"b",(function(){return S})),n.d(e,"e",(function(){return B})),n.d(e,"i",(function(){return O})),n.d(e,"g",(function(){return w})),n.d(e,"a",(function(){return x})),n.d(e,"k",(function(){return C})),n.d(e,"j",(function(){return P}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a}));var r=n(24);function i(t,e){if(t.length!==e)return!1;for(var n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function o(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function a(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(r.b.debug&&!i(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}},,function(t,e,n){var r=n(297),i=n(298),o=n(225),a=n(299);t.exports=function(t){return r(t)||i(t)||o(t)||a()}},function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"d",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s}));var r={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},i=Symbol.for("component"),o=Symbol.for("asyncPropDefaults"),a=Symbol.for("asyncPropOriginal"),s=Symbol.for("asyncPropResolved")},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"i",(function(){return o})),n.d(e,"g",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"k",(function(){return u})),n.d(e,"l",(function(){return c})),n.d(e,"f",(function(){return l})),n.d(e,"d",(function(){return f})),n.d(e,"q",(function(){return h})),n.d(e,"p",(function(){return d})),n.d(e,"r",(function(){return p})),n.d(e,"m",(function(){return v})),n.d(e,"n",(function(){return g})),n.d(e,"o",(function(){return y})),n.d(e,"b",(function(){return m})),n.d(e,"j",(function(){return A})),n.d(e,"e",(function(){return _})),n.d(e,"h",(function(){return O}));var r=n(18);function i(){var t=new r.a(3);return r.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function a(t,e,n){var i=new r.a(3);return i[0]=t,i[1]=e,i[2]=n,i}function s(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function u(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function c(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function l(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function f(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function h(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function d(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function p(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],l=i*c-o*u,f=o*s-r*c,h=r*u-i*s,d=i*h-o*f,p=o*l-r*h,v=r*f-i*l,g=2*a;return l*=g,f*=g,h*=g,d*=2,p*=2,v*=2,t[0]=s+l+d,t[1]=u+f+p,t[2]=c+h+v,t}function v(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function g(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function y(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function m(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+a*a+s*s),c=u&&l(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}var b,A=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},_=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)},O=o;b=i()},function(t,e,n){"use strict";n.d(e,"q",(function(){return i})),n.d(e,"f",(function(){return o})),n.d(e,"a",(function(){return a})),n.d(e,"h",(function(){return s})),n.d(e,"p",(function(){return u})),n.d(e,"o",(function(){return c})),n.d(e,"k",(function(){return l})),n.d(e,"l",(function(){return f})),n.d(e,"m",(function(){return h})),n.d(e,"n",(function(){return d})),n.d(e,"e",(function(){return p})),n.d(e,"c",(function(){return v})),n.d(e,"d",(function(){return g})),n.d(e,"j",(function(){return y})),n.d(e,"i",(function(){return m})),n.d(e,"g",(function(){return b})),n.d(e,"b",(function(){return A}));var r=n(18);function i(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function o(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],p=e[12],v=e[13],g=e[14],y=e[15],m=n*s-r*a,b=n*u-i*a,A=n*c-o*a,_=r*u-i*s,O=r*c-o*s,w=i*c-o*u,x=l*v-f*p,C=l*g-h*p,P=l*y-d*p,S=f*g-h*v,B=f*y-d*v,k=h*y-d*g,E=m*k-b*B+A*S+_*P-O*C+w*x;return E?(E=1/E,t[0]=(s*k-u*B+c*S)*E,t[1]=(i*B-r*k-o*S)*E,t[2]=(v*w-g*O+y*_)*E,t[3]=(h*O-f*w-d*_)*E,t[4]=(u*P-a*k-c*C)*E,t[5]=(n*k-i*P+o*C)*E,t[6]=(g*A-p*w-y*b)*E,t[7]=(l*w-h*A+d*b)*E,t[8]=(a*B-s*P+c*x)*E,t[9]=(r*P-n*B-o*x)*E,t[10]=(p*O-v*A+y*m)*E,t[11]=(f*A-l*O-d*m)*E,t[12]=(s*C-a*S-u*x)*E,t[13]=(n*S-r*C+i*x)*E,t[14]=(v*b-p*_-g*m)*E,t[15]=(l*_-f*b+h*m)*E,t):null}function a(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11],d=t[12],p=t[13],v=t[14],g=t[15];return(e*a-n*o)*(f*g-h*v)-(e*s-r*o)*(l*g-h*p)+(e*u-i*o)*(l*v-f*p)+(n*s-r*a)*(c*g-h*d)-(n*u-i*a)*(c*v-f*d)+(r*u-i*s)*(c*p-l*d)}function s(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],v=e[12],g=e[13],y=e[14],m=e[15],b=n[0],A=n[1],_=n[2],O=n[3];return t[0]=b*r+A*s+_*f+O*v,t[1]=b*i+A*u+_*h+O*g,t[2]=b*o+A*c+_*d+O*y,t[3]=b*a+A*l+_*p+O*m,b=n[4],A=n[5],_=n[6],O=n[7],t[4]=b*r+A*s+_*f+O*v,t[5]=b*i+A*u+_*h+O*g,t[6]=b*o+A*c+_*d+O*y,t[7]=b*a+A*l+_*p+O*m,b=n[8],A=n[9],_=n[10],O=n[11],t[8]=b*r+A*s+_*f+O*v,t[9]=b*i+A*u+_*h+O*g,t[10]=b*o+A*c+_*d+O*y,t[11]=b*a+A*l+_*p+O*m,b=n[12],A=n[13],_=n[14],O=n[15],t[12]=b*r+A*s+_*f+O*v,t[13]=b*i+A*u+_*h+O*g,t[14]=b*o+A*c+_*d+O*y,t[15]=b*a+A*l+_*p+O*m,t}function u(t,e,n){var r,i,o,a,s,u,c,l,f,h,d,p,v=n[0],g=n[1],y=n[2];return e===t?(t[12]=e[0]*v+e[4]*g+e[8]*y+e[12],t[13]=e[1]*v+e[5]*g+e[9]*y+e[13],t[14]=e[2]*v+e[6]*g+e[10]*y+e[14],t[15]=e[3]*v+e[7]*g+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=d,t[11]=p,t[12]=r*v+s*g+f*y+e[12],t[13]=i*v+u*g+h*y+e[13],t[14]=o*v+c*g+d*y+e[14],t[15]=a*v+l*g+p*y+e[15]),t}function c(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function l(t,e,n,i){var o,a,s,u,c,l,f,h,d,p,v,g,y,m,b,A,_,O,w,x,C,P,S,B,k=i[0],E=i[1],T=i[2],j=Math.hypot(k,E,T);return j<r.b?null:(k*=j=1/j,E*=j,T*=j,o=Math.sin(n),s=1-(a=Math.cos(n)),u=e[0],c=e[1],l=e[2],f=e[3],h=e[4],d=e[5],p=e[6],v=e[7],g=e[8],y=e[9],m=e[10],b=e[11],A=k*k*s+a,_=E*k*s+T*o,O=T*k*s-E*o,w=k*E*s-T*o,x=E*E*s+a,C=T*E*s+k*o,P=k*T*s+E*o,S=E*T*s-k*o,B=T*T*s+a,t[0]=u*A+h*_+g*O,t[1]=c*A+d*_+y*O,t[2]=l*A+p*_+m*O,t[3]=f*A+v*_+b*O,t[4]=u*w+h*x+g*C,t[5]=c*w+d*x+y*C,t[6]=l*w+p*x+m*C,t[7]=f*w+v*x+b*C,t[8]=u*P+h*S+g*B,t[9]=c*P+d*S+y*B,t[10]=l*P+p*S+m*B,t[11]=f*P+v*S+b*B,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function f(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=u*i+h*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=h*i-u*r,t}function h(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-f*r,t[3]=u*i-h*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+f*i,t[11]=u*r+h*i,t}function d(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=u*i+h*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=h*i-u*r,t}function p(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,c,l),t}function v(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,d=i*s,p=i*u,v=o*a,g=o*s,y=o*u;return t[0]=1-f-p,t[1]=l+y,t[2]=h-g,t[3]=0,t[4]=l-y,t[5]=1-c-p,t[6]=d+v,t[7]=0,t[8]=h+g,t[9]=d-v,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}var y=function(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t};var m=function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t};function b(t,e,n,i){var o,a,s,u,c,l,f,h,d,p,v=e[0],g=e[1],y=e[2],m=i[0],b=i[1],A=i[2],_=n[0],O=n[1],w=n[2];return Math.abs(v-_)<r.b&&Math.abs(g-O)<r.b&&Math.abs(y-w)<r.b?function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(t):(f=v-_,h=g-O,d=y-w,o=b*(d*=p=1/Math.hypot(f,h,d))-A*(h*=p),a=A*(f*=p)-m*d,s=m*h-b*f,(p=Math.hypot(o,a,s))?(o*=p=1/p,a*=p,s*=p):(o=0,a=0,s=0),u=h*s-d*a,c=d*o-f*s,l=f*a-h*o,(p=Math.hypot(u,c,l))?(u*=p=1/p,c*=p,l*=p):(u=0,c=0,l=0),t[0]=o,t[1]=u,t[2]=f,t[3]=0,t[4]=a,t[5]=c,t[6]=h,t[7]=0,t[8]=s,t[9]=l,t[10]=d,t[11]=0,t[12]=-(o*v+a*g+s*y),t[13]=-(u*v+c*g+l*y),t[14]=-(f*v+h*g+d*y),t[15]=1,t)}function A(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],d=t[10],p=t[11],v=t[12],g=t[13],y=t[14],m=t[15],b=e[0],A=e[1],_=e[2],O=e[3],w=e[4],x=e[5],C=e[6],P=e[7],S=e[8],B=e[9],k=e[10],E=e[11],T=e[12],j=e[13],M=e[14],I=e[15];return Math.abs(n-b)<=r.b*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(i-A)<=r.b*Math.max(1,Math.abs(i),Math.abs(A))&&Math.abs(o-_)<=r.b*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-O)<=r.b*Math.max(1,Math.abs(a),Math.abs(O))&&Math.abs(s-w)<=r.b*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(u-x)<=r.b*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(c-C)<=r.b*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(l-P)<=r.b*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(f-S)<=r.b*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(h-B)<=r.b*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(d-k)<=r.b*Math.max(1,Math.abs(d),Math.abs(k))&&Math.abs(p-E)<=r.b*Math.max(1,Math.abs(p),Math.abs(E))&&Math.abs(v-T)<=r.b*Math.max(1,Math.abs(v),Math.abs(T))&&Math.abs(g-j)<=r.b*Math.max(1,Math.abs(g),Math.abs(j))&&Math.abs(y-M)<=r.b*Math.max(1,Math.abs(y),Math.abs(M))&&Math.abs(m-I)<=r.b*Math.max(1,Math.abs(m),Math.abs(I))}},,function(t,e,n){var r=n(315),i=n(316),o=n(225),a=n(317);t.exports=function(t,e){return r(t)||i(t,e)||o(t,e)||a()}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.default=t.exports,t.exports.__esModule=!0,n(e)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}n.d(e,"a",(function(){return r}))},function(t,e,n){t.exports=n(308)()},,function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return a}));var r=n(31),i={};function o(t){i=t}function a(t,e,n,o){r.a.level>0&&i[t]&&i[t].call(null,e,n,o)}},function(t,e,n){var r=n(23),i=n(64);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?i(t):e}},function(t,e,n){"use strict";n.d(e,"a",(function(){return C}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(5),l=n.n(c),f=n(7),h=n.n(f),d=n(2),p=n.n(d),v=n(57),g=n(85),y=n(76),m=n(12),b=n(17),A=n(153);function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var O={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},w={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:O},x={removedProps:O},C=function(t,e){l()(r,t);var n=_(r);function r(t){var e;i()(this,r);var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e=n.call(this,t,o)).stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),e.target=o.target||(e.gl.webgl2?36662:34962),e.initialize(o),Object.seal(u()(e)),e}return a()(r,[{key:e,get:function(){return"Buffer"}},{key:"getElementCount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/g.a.getBytesPerElement(t))}},{key:"getVertexCount",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/g.a.getBytesPerVertex(t))}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=Object(A.a)("Buffer",t,w),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}},{key:"setProps",value:function(t){return"accessor"in(t=Object(A.a)("Buffer",t,x))&&this.setAccessor(t.accessor),this}},{key:"setAccessor",value:function(t){return delete(t=Object.assign({},t)).buffer,this.accessor=new g.a(t),this}},{key:"reallocate",value:function(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}},{key:"setData",value:function(t){return this.initialize(t)}},{key:"subData",value:function(t){ArrayBuffer.isView(t)&&(t={data:t});var e=t,n=e.data,r=e.offset,i=void 0===r?0:r,o=e.srcOffset,a=void 0===o?0:o,s=t.byteLength||t.length;Object(b.a)(n);var u=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(u,this.handle),0!==a||void 0!==s?(Object(m.a)(this.gl),this.gl.bufferSubData(this.target,i,n,a,s)):this.gl.bufferSubData(u,i,n),this.gl.bindBuffer(u,null),this.debugData=null,this._inferType(n),this}},{key:"copyData",value:function(t){var e=t.sourceBuffer,n=t.readOffset,r=void 0===n?0:n,i=t.writeOffset,o=void 0===i?0:i,a=t.size,s=this.gl;return Object(m.a)(s),s.bindBuffer(36662,e.handle),s.bindBuffer(36663,this.handle),s.copyBufferSubData(36662,36663,r,o,a),s.bindBuffer(36662,null),s.bindBuffer(36663,null),this.debugData=null,this}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.dstData,n=void 0===e?null:e,r=t.srcByteOffset,i=void 0===r?0:r,o=t.dstOffset,a=void 0===o?0:o,s=t.length,u=void 0===s?0:s;Object(m.a)(this.gl);var c,l,f=Object(y.c)(this.accessor.type||5126,{clamped:!1}),h=this._getAvailableElementCount(i),d=a;n?c=(l=n.length)-d:l=d+(c=Math.min(h,u||h));var p=Math.min(h,c);return u=u||p,Object(b.a)(u<=p),n=n||new f(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,i,n,a,u),this.gl.bindBuffer(36662,null),n}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=void 0===e?this.target:e,r=t.index,i=void 0===r?this.accessor&&this.accessor.index:r,o=t.offset,a=void 0===o?0:o,s=t.size;return 35345===n||35982===n?void 0!==s?this.gl.bindBufferRange(n,i,this.handle,a,s):(Object(b.a)(0===a),this.gl.bindBufferBase(n,i,this.handle)):this.gl.bindBuffer(n,this.handle),this}},{key:"unbind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=void 0===e?this.target:e,r=t.index,i=void 0===r?this.accessor&&this.accessor.index:r,o=35345===n||35982===n;return o?this.gl.bindBufferBase(n,i,null):this.gl.bindBuffer(n,null),this}},{key:"getDebugData",value:function(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}},{key:"invalidateDebugData",value:function(){this.debugData=null}},{key:"_setData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.byteLength+e;Object(b.a)(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();var r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.usage),this.gl.bufferSubData(r,e,t),this.gl.bindBuffer(r,null),this.debugData=t.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);var i=Object(y.b)(t);return Object(b.a)(i),this.setAccessor(new g.a(this.accessor,{type:i})),this}},{key:"_setByteLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;Object(b.a)(t>=0),this._trackDeallocatedMemory();var n=t;0===t&&(n=new Float32Array(0));var r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,e),this.gl.bindBuffer(r,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}},{key:"_getTarget",value:function(){return this.gl.webgl2?36663:this.target}},{key:"_getAvailableElementCount",value:function(t){var e=t/Object(y.c)(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}},{key:"_inferType",value:function(t){this.accessor.type||this.setAccessor(new g.a(this.accessor,{type:Object(y.b)(t)}))}},{key:"_createHandle",value:function(){return this.gl.createBuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}},{key:"_getParameter",value:function(t){this.gl.bindBuffer(this.target,this.handle);var e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}},{key:"type",get:function(){return m.k.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}},{key:"bytes",get:function(){return m.k.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}},{key:"setByteLength",value:function(t){return m.k.deprecated("setByteLength","reallocate")(),this.reallocate(t)}},{key:"updateAccessor",value:function(t){return m.k.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new g.a(this.accessor,t),this}}]),r}(v.a,Symbol.toStringTag)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"e",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return u})),n.d(e,"g",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"i",(function(){return f})),n.d(e,"j",(function(){return h})),n.d(e,"f",(function(){return v}));var r=n(18);function i(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function o(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function a(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function s(t,e){return t[0]=-e[0],t[1]=-e[1],t}function u(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function c(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function l(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function f(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function h(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var d,p,v=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t};d=new r.a(2),r.a!=Float32Array&&(d[0]=0,d[1]=0),p=d},function(t,e,n){var r=n(227);t.exports=function(t){return new r(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return h})),n.d(e,"f",(function(){return d}));var r=n(90),i=n(106);function o(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function a(t,e){var n=t%e;return n<0?e+n:n}function s(t){return[t[12],t[13],t[14]]}function u(t){return{left:f(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:f(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:f(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:f(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:f(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:f(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}var c,l=new i.a;function f(t,e,n,r){l.set(t,e,n);var o=l.len();return{distance:r/o,normal:new i.a(-t/o,-e/o,-n/o)}}function h(t){return t-Math.fround(t)}function d(t,e){var n=e.size,i=void 0===n?1:n,o=e.startIndex,a=void 0===o?0:o,s=void 0!==e.endIndex?e.endIndex:t.length,u=(s-a)/i;c=r.a.allocate(c,u,{type:Float32Array,size:2*i});for(var l=a,f=0;l<s;){for(var d=0;d<i;d++){var p=t[l++];c[f+d]=p,c[f+d+i]=h(p)}f+=2*i}return c.subarray(0,u*i*2)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"g",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"l",(function(){return s})),n.d(e,"a",(function(){return u})),n.d(e,"k",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"m",(function(){return f})),n.d(e,"j",(function(){return h})),n.d(e,"d",(function(){return d})),n.d(e,"i",(function(){return p})),n.d(e,"n",(function(){return v})),n.d(e,"o",(function(){return g})),n.d(e,"f",(function(){return y})),n.d(e,"e",(function(){return m}));var r=n(18);function i(t){var e=new r.a(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function o(t,e,n,i){var o=new r.a(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function s(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function u(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function c(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function l(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function f(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function h(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a,t}function d(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function p(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t}function v(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function g(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,f=c*i+u*r-a*o,h=c*o+a*i-s*r,d=-a*r-s*i-u*o;return t[0]=l*c+d*-a+f*-u-h*-s,t[1]=f*c+d*-s+h*-a-l*-u,t[2]=h*c+d*-u+l*-s-f*-a,t[3]=e[3],t}function y(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function m(t,e){var n=t[0],i=t[1],o=t[2],a=t[3],s=e[0],u=e[1],c=e[2],l=e[3];return Math.abs(n-s)<=r.b*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=r.b*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=r.b*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(a-l)<=r.b*Math.max(1,Math.abs(a),Math.abs(l))}var b,A;b=new r.a(4),r.a!=Float32Array&&(b[0]=0,b[1]=0,b[2]=0,b[3]=0),A=b},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){"use strict";n(1),n(3),n(13),n(24);var r={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=o(t,n);return r!==e&&(s(t,n),!0)}function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Math.sign(a(t,e))}function a(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.start,r=void 0===n?0:n,i=e.end,o=void 0===i?t.length:i,a=e.size||2,s=0,u=r,c=o-a;u<o;u+=a)s+=(t[u]-t[c])*(t[u+1]+t[c+1]),c=u;return s/2}function s(t,e){for(var n=e.start,r=void 0===n?0:n,i=e.end,o=void 0===i?t.length:i,a=e.size,s=void 0===a?2:a,u=(o-r)/s,c=Math.floor(u/2),l=0;l<c;++l)for(var f=r+l*s,h=r+(u-1-l)*s,d=0;d<s;++d){var p=t[f+d];t[f+d]=t[h+d],t[h+d]=p}}function u(t,e){var n,r,i,o,a,s,u,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,h=arguments.length>3?arguments[3]:void 0,d=e&&e.length,p=d?e[0]*l:t.length,v=c(t,0,p,l,!0,h&&h[0]),y=[];if(!v||v.next===v.prev)return y;if(d&&(v=g(t,e,v,l,h)),t.length>80*l){o=r=t[0],a=i=t[1];for(var m=l;m<p;m+=l)(s=t[m])<o&&(o=s),(u=t[m+1])<a&&(a=u),s>r&&(r=s),u>i&&(i=u);n=0!==(n=Math.max(r-o,i-a))?1/n:0}return f(v,y,l,o,a,n),y}function c(t,e,n,r,i,o){var s,u;if(void 0===o&&(o=a(t,{start:e,end:n,size:r})),i===o<0)for(s=e;s<n;s+=r)u=T(s,t[s],t[s+1],u);else for(s=n-r;s>=e;s-=r)u=T(s,t[s],t[s+1],u);return u&&C(u,u.next)&&(j(u),u=u.next),u}function l(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!C(r,r.next)&&0!==x(r.prev,r,r.next))r=r.next;else{if(j(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function f(t,e,n,r,i,o,a){if(t){!a&&o&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=A(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(i=t,t=null,u=null,r=0;i;){for(r++,a=i,o=0,n=0;n<c&&(o++,a=a.nextZ);n++);for(s=c;o>0||s>0&&a;)0!==o&&(0===s||!a||i.z<=a.z)?(e=i,i=i.nextZ,o--):(e=a,a=a.nextZ,s--),u?u.nextZ=e:t=e,e.prevZ=u,u=e;i=a}u.nextZ=null,c*=2}while(r>1)}(i)}(t,r,i,o);for(var s,u,c=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?d(t,r,i,o):h(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),j(t),t=u.next,c=u.next;else if((t=u)===c){a?1===a?f(t=p(l(t),e,n),e,n,r,i,o,2):2===a&&v(t,e,n,r,i,o):f(l(t),e,n,r,i,o,1);break}}}function h(t){var e=t.prev,n=t,r=t.next;if(x(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(O(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&x(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function d(t,e,n,r){var i=t.prev,o=t,a=t.next;if(x(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=A(s,u,e,n,r),h=A(c,l,e,n,r),d=t.prevZ,p=t.nextZ;d&&d.z>=f&&p&&p.z<=h;){if(d!==t.prev&&d!==t.next&&O(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,p!==t.prev&&p!==t.next&&O(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&x(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;d&&d.z>=f;){if(d!==t.prev&&d!==t.next&&O(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=h;){if(p!==t.prev&&p!==t.next&&O(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&x(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function p(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!C(i,o)&&P(i,r,r.next,o)&&k(i,o)&&k(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),j(r),j(r.next),r=t=o),r=r.next}while(r!==t);return l(r)}function v(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&w(a,s)){var u=E(a,s);return a=l(a,a.next),u=l(u,u.next),f(a,e,n,r,i,o),void f(u,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function g(t,e,n,r,i){var o,a,s,u=[];for(o=0,a=e.length;o<a;o++)(s=c(t,e[o]*r,o<a-1?e[o+1]*r:t.length,r,!1,i&&i[o+1]))===s.next&&(s.steiner=!0),u.push(_(s));for(u.sort(y),o=0;o<u.length;o++)m(u[o],n),n=l(n,n.next);return n}function y(t,e){return t.x-e.x}function m(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n;var u,c=n,l=n.x,f=n.y,h=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&O(o<f?i:a,o,l,f,o<f?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),k(r,t)&&(u<h||u===h&&(r.x>n.x||r.x===n.x&&b(n,r)))&&(n=r,h=u)),r=r.next}while(r!==c);return n}(t,e)){var n=E(e,t);l(e,e.next),l(n,n.next)}}function b(t,e){return x(t.prev,t,e.prev)<0&&x(e.next,t,t.next)<0}function A(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function _(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function O(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function w(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&P(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(k(t,e)&&k(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(x(t.prev,t,e.prev)||x(t,e.prev,e))||C(t,e)&&x(t.prev,t,t.next)>0&&x(e.prev,e,e.next)>0)}function x(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function C(t,e){return t.x===e.x&&t.y===e.y}function P(t,e,n,r){var i=B(x(t,e,n)),o=B(x(t,e,r)),a=B(x(n,r,t)),s=B(x(n,r,e));return i!==o&&a!==s||(!(0!==i||!S(t,n,e))||(!(0!==o||!S(t,r,e))||(!(0!==a||!S(n,t,r))||!(0!==s||!S(n,e,r)))))}function S(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function B(t){return t>0?1:t<0?-1:0}function k(t,e){return x(t.prev,t,t.next)<0?x(t,e,t.next)>=0&&x(t,t.prev,e)>=0:x(t,e,t.prev)<0||x(t,t.next,e)<0}function E(t,e){var n=new M(t.i,t.x,t.y),r=new M(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function T(t,e,n,r){var i=new M(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function j(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function M(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(t,e){var n=e.length,r=t.length;if(r>0){for(var i=!0,o=0;o<n;o++)if(t[r-n+o]!==e[o]){i=!1;break}if(i)return!1}for(var a=0;a<n;a++)t[r+a]=e[a];return!0}function R(t,e){for(var n=e.length,r=0;r<n;r++)t[r]=e[r]}function D(t,e,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=r+e*n,a=0;a<n;a++)i[a]=t[o+a];return i}function L(t,e,n,r){var i,o,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(8&n)i=(r[3]-t[1])/(e[1]-t[1]),o=3;else if(4&n)i=(r[1]-t[1])/(e[1]-t[1]),o=1;else if(2&n)i=(r[2]-t[0])/(e[0]-t[0]),o=2;else{if(!(1&n))return null;i=(r[0]-t[0])/(e[0]-t[0]),o=0}for(var s=0;s<t.length;s++)a[s]=(1&o)===s?r[o]:i*(e[s]-t[s])+t[s];return a}function F(t,e){var n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function G(t,e){var n,r,i=e||{},o=i.size,a=void 0===o?2:o,s=i.broken,u=void 0!==s&&s,c=i.gridResolution,l=void 0===c?10:c,f=i.gridOffset,h=void 0===f?[0,0]:f,d=i.startIndex,p=void 0===d?0:d,v=i.endIndex,g=((void 0===v?t.length:v)-p)/a,y=[],m=[y],b=D(t,0,a,p),A=H(b,l,h,[]),_=[];I(y,b);for(var O=1;O<g;O++){for(r=F(n=D(t,O,a,p,n),A);r;){L(b,n,r,A,_);var w=F(_,A);w&&(L(b,_,w,A,_),r=w),I(y,_),R(b,_),V(A,l,r),u&&y.length>a&&(y=[],m.push(y),I(y,b)),r=F(n,A)}I(y,n),R(b,n)}return u?m:m[0]}function N(t,e){for(var n=0;n<e.length;n++)t.push(e[n]);return t}function U(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0;if(!t.length)return[];for(var r=n||{},i=r.size,o=void 0===i?2:i,a=r.gridResolution,s=void 0===a?10:a,u=r.gridOffset,c=void 0===u?[0,0]:u,l=r.edgeTypes,f=void 0!==l&&l,h=[],d=[{pos:t,types:f?new Array(t.length/o).fill(1):null,holes:e||[]}],p=[[],[]],v=[];d.length;){var g=d.shift(),y=g.pos,m=g.types,b=g.holes;J(y,o,b[0]||y.length,p),v=H(p[0],s,c,v);var A=F(p[1],v);if(A){var _=z(y,m,o,0,b[0]||y.length,v,A),O={pos:_[0].pos,types:_[0].types,holes:[]},w={pos:_[1].pos,types:_[1].types,holes:[]};d.push(O,w);for(var x=0;x<b.length;x++)(_=z(y,m,o,b[x],b[x+1]||y.length,v,A))[0]&&(O.holes.push(O.pos.length),O.pos=N(O.pos,_[0].pos),f&&(O.types=N(O.types,_[0].types))),_[1]&&(w.holes.push(w.pos.length),w.pos=N(w.pos,_[1].pos),f&&(w.types=N(w.types,_[1].types)))}else{var C={positions:y};f&&(C.edgeTypes=m),b.length&&(C.holeIndices=b),h.push(C)}}return h}function z(t,e,n,r,i,o,a){for(var s,u,c,l=(i-r)/n,f=[],h=[],d=[],p=[],v=[],g=D(t,l-1,n,r),y=Math.sign(8&a?g[1]-o[3]:g[0]-o[2]),m=e&&e[l-1],b=0,A=0,_=0;_<l;_++)s=D(t,_,n,r,s),u=Math.sign(8&a?s[1]-o[3]:s[0]-o[2]),c=e&&e[r/n+_],u&&y&&y!==u&&(L(g,s,a,o,v),I(f,v)&&d.push(m),I(h,v)&&p.push(m)),u<=0?(I(f,s)&&d.push(c),b-=u):d.length&&(d[d.length-1]=0),u>=0?(I(h,s)&&p.push(c),A+=u):p.length&&(p[p.length-1]=0),R(g,s),y=u,m=c;return[b?{pos:f,types:e&&d}:null,A?{pos:h,types:e&&p}:null]}function H(t,e,n,r){var i=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=o,r[2]=i+e,r[3]=o+e,r}function V(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function J(t,e,n,r){for(var i=1/0,o=-1/0,a=1/0,s=-1/0,u=0;u<n;u+=e){var c=t[u],l=t[u+1];i=c<i?c:i,o=c>o?c:o,a=l<a?l:a,s=l>s?l:s}return r[0][0]=i,r[0][1]=a,r[1][0]=o,r[1][1]=s,r}function W(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return K(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function X(t,e){var n=e||{},r=n.size,i=void 0===r?2:r,o=n.startIndex,a=void 0===o?0:o,s=n.endIndex,u=void 0===s?t.length:s,c=n.normalize,l=void 0===c||c,f=t.slice(a,u);Y(f,i,0,u-a);var h=G(f,{size:i,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(l){var d,p=W(h);try{for(p.s();!(d=p.n()).done;){$(d.value,i)}}catch(t){p.e(t)}finally{p.f()}}return h}function q(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=n||{},i=r.size,o=void 0===i?2:i,a=r.normalize,s=void 0===a||a,u=r.edgeTypes,c=void 0!==u&&u;e=e||[];for(var l=[],f=[],h=0,d=0,p=0;p<=e.length;p++){for(var v=e[p]||t.length,g=d,y=Q(t,o,h,v),m=y;m<v;m++)l[d++]=t[m];for(var b=h;b<y;b++)l[d++]=t[b];Y(l,o,g,d),Z(l,o,g,d,null==n?void 0:n.maxLatitude),h=v,f[p]=d}f.pop();var A=U(l,f,{size:o,gridResolution:360,gridOffset:[-180,-180],edgeTypes:c});if(s){var _,O=W(A);try{for(O.s();!(_=O.n()).done;){var w=_.value;$(w.positions,o)}}catch(t){O.e(t)}finally{O.f()}}return A}function Q(t,e,n,r){for(var i=-1,o=-1,a=n+1;a<r;a+=e){var s=Math.abs(t[a]);s>i&&(i=s,o=a-1)}return o}function Z(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:85.051129,o=t[n],a=t[r-e];if(Math.abs(o-a)>180){var s=D(t,0,e,n);s[0]+=360*Math.round((a-o)/360),I(t,s),s[1]=Math.sign(s[1])*i,I(t,s),s[0]=o,I(t,s)}}function Y(t,e,n,r){for(var i,o=t[0],a=n;a<r;a+=e){var s=(i=t[a])-o;(s>180||s<-180)&&(i-=360*Math.round(s/360)),t[a]=o=i}}function $(t,e){for(var n,r=t.length/e,i=0;i<r&&((n=t[i*e])+180)%360==0;i++);var o=360*-Math.round(n/360);if(0!==o)for(var a=0;a<r;a++)t[a*e]+=o}n.d(e,"g",(function(){return a})),n.d(e,"h",(function(){return i})),n.d(e,"a",(function(){return r})),n.d(e,"f",(function(){return u})),n.d(e,"b",(function(){return U})),n.d(e,"d",(function(){return G})),n.d(e,"e",(function(){return X})),n.d(e,"c",(function(){return q}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(12),u=n(144),c=n(69),l=n(17),f=n(67),h=n(186);function d(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var v="Resource subclass must define virtual methods",g=function(t){function e(t){i()(this,e);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(s.b)(t);var r=n.id,o=n.userData,a=void 0===o?{}:o;this.gl=t,this.gl2=t,this.id=r||Object(f.c)(this[Symbol.toStringTag]),this.userData=a,this._bound=!1,this._handle=n.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._initStats(),this._addStats()}return a()(e,[{key:t,get:function(){return"Resource"}},{key:"toString",value:function(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}},{key:"handle",get:function(){return this._handle}},{key:"delete",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.deleteChildren,n=void 0!==e&&e,r=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,r&&n&&r.filter(Boolean).forEach((function(t){return t.delete()})),this}},{key:"bind",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}},{key:"unbind",value:function(){this.bind(null)}},{key:"getParameter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=Object(c.b)(this.gl,t),Object(l.a)(t);var n=this.constructor.PARAMETERS||{},r=n[t];if(r){var i=Object(s.j)(this.gl),o=(!("webgl2"in r)||i)&&(!("extension"in r)||this.gl.getExtension(r.extension));if(!o){var a=r.webgl1,u="webgl2"in r?r.webgl2:r.webgl1,f=i?u:a;return f}}return this._getParameter(t,e)}},{key:"getParameters",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.parameters,r=e.keys,i=this.constructor.PARAMETERS||{},o=Object(s.j)(this.gl),a={},u=n||Object.keys(i),l=d(u);try{for(l.s();!(t=l.n()).done;){var f=t.value,h=i[f],p=h&&(!("webgl2"in h)||o)&&(!("extension"in h)||this.gl.getExtension(h.extension));if(p){var v=r?Object(c.a)(this.gl,f):f;a[v]=this.getParameter(f,e),r&&"GLenum"===h.type&&(a[v]=Object(c.a)(this.gl,a[v]))}}}catch(t){l.e(t)}finally{l.f()}return a}},{key:"setParameter",value:function(t,e){t=Object(c.b)(this.gl,t),Object(l.a)(t);var n=(this.constructor.PARAMETERS||{})[t];if(n){var r=Object(s.j)(this.gl);if(!((!("webgl2"in n)||r)&&(!("extension"in n)||this.gl.getExtension(n.extension))))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=Object(c.b)(e))}return this._setParameter(t,e),this}},{key:"setParameters",value:function(t){for(var e in t)this.setParameter(e,t[e]);return this}},{key:"stubRemovedMethods",value:function(t,e,n){return Object(h.a)(this,t,e,n)}},{key:"initialize",value:function(t){}},{key:"_createHandle",value:function(){throw new Error(v)}},{key:"_deleteHandle",value:function(){throw new Error(v)}},{key:"_bindHandle",value:function(t){throw new Error(v)}},{key:"_getOptsFromHandle",value:function(){throw new Error(v)}},{key:"_getParameter",value:function(t,e){throw new Error(v)}},{key:"_setParameter",value:function(t,e){throw new Error(v)}},{key:"_context",value:function(){return this.gl.luma=this.gl.luma||{},this.gl.luma}},{key:"_initStats",value:function(){this.gl.stats=this.gl.stats||new u.a}},{key:"_addStats",value:function(){var t=this[Symbol.toStringTag],e=u.b.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}},{key:"_removeStats",value:function(){var t=this[Symbol.toStringTag];u.b.get("Resource Counts").get("".concat(t,"s Active")).decrementCount()}},{key:"_trackAllocatedMemory",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._doTrackAllocatedMemory(t,e),this._doTrackAllocatedMemory(t,e,this.gl.stats.get("Memory Usage"))}},{key:"_doTrackAllocatedMemory",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.b.get("Memory Usage");n.get("GPU Memory").addCount(t),n.get("".concat(e," Memory")).addCount(t),this.byteLength=t}},{key:"_trackDeallocatedMemory",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._doTrackDeallocatedMemory(t),this._doTrackDeallocatedMemory(t,this.gl.stats.get("Memory Usage"))}},{key:"_doTrackDeallocatedMemory",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.b.get("Memory Usage");e.get("GPU Memory").subtractCount(this.byteLength),e.get("".concat(t," Memory")).subtractCount(this.byteLength),this.byteLength=0}}]),e}(Symbol.toStringTag)},function(t,e,n){var r=n(288);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var r=n(187).default,i=n(289);t.exports=function(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t){var e;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(e=t[Symbol.asyncIterator]))return e.call(t);if(Symbol.iterator&&null!=(e=t[Symbol.iterator]))return e.call(t)}throw new TypeError("Object is not async iterable")}},function(t,e,n){var r=n(293),i=n(294),o=n(222),a=n(295);t.exports=function(t,e){return r(t)||i(t,e)||o(t,e)||a()},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));var r=n(15),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(0),l=n.n(c),f=n(31),h=n(52),d=n(98),p=n(24),v=n(106),g=n(91),y=n(33),m=n(20),b=Math.PI/180,A=Object(h.a)(),_=[0,0,0],O={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};var w=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a()(this,t),l()(this,"id",void 0),l()(this,"x",void 0),l()(this,"y",void 0),l()(this,"width",void 0),l()(this,"height",void 0),l()(this,"padding",void 0),l()(this,"isGeospatial",void 0),l()(this,"zoom",void 0),l()(this,"focalDistance",void 0),l()(this,"position",void 0),l()(this,"modelMatrix",void 0),l()(this,"distanceScales",void 0),l()(this,"scale",void 0),l()(this,"center",void 0),l()(this,"cameraPosition",void 0),l()(this,"projectionMatrix",void 0),l()(this,"viewMatrix",void 0),l()(this,"viewMatrixUncentered",void 0),l()(this,"viewMatrixInverse",void 0),l()(this,"viewProjectionMatrix",void 0),l()(this,"pixelProjectionMatrix",void 0),l()(this,"pixelUnprojectionMatrix",void 0),l()(this,"resolution",void 0),l()(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||O,this.focalDistance=e.focalDistance||1,this.position=e.position||_,this.modelMatrix=e.modelMatrix||null;var n=e.longitude,r=e.latitude;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return u()(t,[{key:"metersPerPixel",get:function(){return this.distanceScales.metersPerUnit[2]/this.scale}},{key:"projectionMode",get:function(){return this.isGeospatial?this.zoom<12?m.d.WEB_MERCATOR:m.d.WEB_MERCATOR_AUTO_OFFSET:m.d.IDENTITY}},{key:"equals",value:function(e){return e instanceof t&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Object(p.d)(e.projectionMatrix,this.projectionMatrix)&&Object(p.d)(e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,o=this.projectPosition(t),a=Object(y.p)(o,this.pixelProjectionMatrix),s=i()(a,2),u=s[0],c=s[1],l=r?c:this.height-c;return 2===t.length?[u,l]:[u,l,a[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.topLeft,r=void 0===n||n,o=e.targetZ,a=i()(t,3),s=a[0],u=a[1],c=a[2],l=r?u:this.height-u,f=o&&o*this.distanceScales.unitsPerMeter[2],h=Object(y.n)([s,l,c],this.pixelUnprojectionMatrix,f),d=this.unprojectPosition(h),p=i()(d,3),v=p[0],g=p[1],m=p[2];return Number.isFinite(c)?[v,g,m]:Number.isFinite(o)?[v,g,o]:[v,g]}},{key:"projectPosition",value:function(t){var e=this.projectFlat(t),n=i()(e,2);return[n[0],n[1],(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}},{key:"unprojectPosition",value:function(t){var e=this.unprojectFlat(t),n=i()(e,2);return[n[0],n[1],(t[2]||0)*this.distanceScales.metersPerUnit[2]]}},{key:"projectFlat",value:function(t){if(this.isGeospatial){var e=Object(y.l)(t);return e[1]=Object(p.a)(e[1],-318,830),e}return t}},{key:"unprojectFlat",value:function(t){return this.isGeospatial?Object(y.o)(t):t}},{key:"getBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={targetZ:t.z||0},n=this.unproject([0,0],e),r=this.unproject([this.width,0],e),i=this.unproject([0,this.height],e),o=this.unproject([this.width,this.height],e);return[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])]}},{key:"getDistanceScales",value:function(t){return t?Object(y.g)({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}},{key:"containsPixel",value:function(t){var e=t.x,n=t.y,r=t.width,i=void 0===r?1:r,o=t.height,a=void 0===o?1:o;return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+a}},{key:"getFrustumPlanes",value:function(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,Object(h.d)(this.viewProjectionMatrix)),this._frustumPlanes)}},{key:"panByPosition",value:function(t,e){return null}},{key:"_initProps",value:function(t){var e=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=Object(y.i)({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||Object(y.g)({latitude:n,longitude:e}));var r=Math.pow(2,this.zoom);this.scale=r;var i=t.position,o=t.modelMatrix,a=_;if(i&&(a=o?new d.a(o).transformAsVector(i,[]):i),this.isGeospatial){var s=this.projectPosition([e,n,0]);this.center=new v.a(a).scale(this.distanceScales.unitsPerMeter).add(s)}else this.center=this.projectPosition(a)}},{key:"_initMatrices",value:function(t){var e=t.viewMatrix,n=void 0===e?A:e,r=t.projectionMatrix,i=void 0===r?null:r,o=t.orthographic,a=void 0!==o&&o,s=t.fovyRadians,u=t.fovy,c=void 0===u?75:u,l=t.near,y=void 0===l?.1:l,m=t.far,_=void 0===m?1e3:m,O=t.padding,w=void 0===O?null:O,x=t.focalDistance,C=void 0===x?1:x;this.viewMatrixUncentered=n,this.viewMatrix=(new d.a).multiplyRight(n).translate(new v.a(this.center).negate()),this.projectionMatrix=i||function(t){var e=t.width,n=t.height,r=t.orthographic,i=t.fovyRadians,o=t.focalDistance,a=t.padding,s=t.near,u=t.far,c=e/n,l=r?(new d.a).orthographic({fovy:i,aspect:c,focalDistance:o,near:s,far:u}):(new d.a).perspective({fovy:i,aspect:c,near:s,far:u});if(a){var f=a.left,h=void 0===f?0:f,v=a.right,g=void 0===v?0:v,y=a.top,m=void 0===y?0:y,b=a.bottom,A=void 0===b?0:b,_=Object(p.a)((h+e-g)/2,0,e)-e/2,O=Object(p.a)((m+n-A)/2,0,n)-n/2;l[8]-=2*_/e,l[9]+=2*O/n}return l}({width:this.width,height:this.height,orthographic:a,fovyRadians:s||c*b,focalDistance:C,padding:w,near:y,far:_});var P=Object(h.a)();g.b(P,P,this.projectionMatrix),g.b(P,P,this.viewMatrix),this.viewProjectionMatrix=P,this.viewMatrixInverse=g.a([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=Object(h.c)(this.viewMatrixInverse);var S=Object(h.a)(),B=Object(h.a)();g.c(S,S,[this.width/2,-this.height/2,1]),g.d(S,S,[1,-1,0]),g.b(B,S,this.viewProjectionMatrix),this.pixelProjectionMatrix=B,this.pixelUnprojectionMatrix=g.a(Object(h.a)(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||f.a.warn("Pixel project matrix not invertible")()}}]),t}();l()(w,"displayName","Viewport")},function(t,e,n){"use strict";var r=n(0),i=n.n(r);function o(t){var e=t.source,n=t.target,r=t.start,i=void 0===r?0:r,o=t.size,a=t.getData,s=t.end||n.length,u=e.length,c=s-i;if(u>c)n.set(e.subarray(0,c),i);else if(n.set(e,i),a)for(var l=u;l<c;)for(var f=a(l,e),h=0;h<o;h++)n[i+l]=f[h]||0,l++}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return l})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return d})),n.d(e,"f",(function(){return p}));var u={interpolation:{duration:0,easing:function(t){return t}},spring:{stiffness:.05,damping:.5}};function c(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});var n=t.type||"interpolation";return s(s(s(s({},u[n]),e),t),{},{type:n})}function l(t,e){var n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function f(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function h(t){t.push(t.shift())}function d(t,e){var n=t.doublePrecision,r=t.settings,i=t.value,o=t.size,a=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*o)*a}function p(t){var e=t.buffer,n=t.numInstances,r=t.attribute,i=t.fromLength,a=t.fromStartIndices,s=t.getData,u=void 0===s?function(t){return t}:s,c=r.doublePrecision&&r.value instanceof Float64Array?2:1,l=r.size*c,f=r.byteOffset,h=r.startIndices,p=a&&h,v=d(r,n),g=r.isConstant;if(p||!(i>=v)){var y=g?r.value:r.getBuffer().getData({srcByteOffset:f});if(r.settings.normalized&&!g){var m=u;u=function(t,e){return r.normalizeConstant(m(t,e))}}var b=g?function(t,e){return u(y,e)}:function(t,e){return u(y.subarray(t,t+l),e)},A=e.getData({length:i}),_=new Float32Array(v);!function(t){var e=t.source,n=t.target,r=t.size,i=t.getData,a=t.sourceStartIndices,s=t.targetStartIndices;if(!Array.isArray(s))return o({source:e,target:n,size:r,getData:i}),n;for(var u=0,c=0,l=i&&function(t,e){return i(t+c,e)},f=Math.min(a.length,s.length),h=1;h<f;h++){var d=a[h]*r,p=s[h]*r;o({source:e.subarray(u,d),target:n,start:c,end:p,size:r,getData:l}),u=d,c=p}c<n.length&&o({source:[],target:n,start:c,size:r,getData:l})}({source:A,target:_,sourceStartIndices:a,targetStartIndices:h,size:l,getData:b}),e.byteLength<_.byteLength+f&&e.reallocate(_.byteLength+f),e.subData({data:_,offset:f})}}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return c}));var r=n(22),i=n.n(r),o=n(122);function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t){var e;return!!t&&(Array.isArray(t)&&(t=t[0]),Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions))}function c(t){var e,n,r;return Object(o.a)(t,"null loader"),Object(o.a)(u(t),"invalid loader"),Array.isArray(t)&&(r=t[1],t=s(s({},t=t[0]),{},{options:s(s({},t.options),r)})),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}},function(t,e,n){"use strict";var r=n(22),i=n.n(r),o=n(32),a=n(119),s=n(11),u=n.n(s),c=n(16),l=n.n(c),f=n(6),h=n(23),d=n.n(h),p=n(36),v=n.n(p);function g(){return!("object"===("undefined"==typeof process?"undefined":d()(process))&&"[object process]"===String(process)&&!process.browser)||function(t){if("undefined"!=typeof window&&"object"===d()(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"===d()(process.versions)&&Boolean(process.versions.electron))return!0;var e="object"===("undefined"==typeof navigator?"undefined":d()(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}()}var y=g();function m(t){try{var e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(t){return null}}var b=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";u()(this,t),this.storage=m(r),this.id=e,this.config={},Object.assign(this.config,n),this._loadConfiguration()}return l()(t,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(t){return this.config={},this.updateConfiguration(t)}},{key:"updateConfiguration",value:function(t){if(Object.assign(this.config,t),this.storage){var e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}return this}},{key:"_loadConfiguration",value:function(){var t={};if(this.storage){var e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}]),t}();function A(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));var o=t.width*n,a=t.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),s]}var _={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function O(t){return"string"==typeof t?_[t.toUpperCase()]||_.WHITE:t}function w(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function C(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],r=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(r),o=w(i);try{var a=function(){var r=e.value;"function"==typeof t[r]&&(n.find((function(t){return r===t}))||(t[r]=t[r].bind(t)))};for(o.s();!(e=o.n()).done;)a()}catch(t){o.e(t)}finally{o.f()}}function P(t,e){if(!t)throw new Error(e||"Assertion failed")}var S={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":d()(process))&&process},B=S.window||S.self||S.global,k=S.process||{};console;function E(){var t;if(y&&B.performance)t=B.performance.now();else if(k.hrtime){var e=k.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}var T={debug:y&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},j={enabled:!0,level:0};function M(){}var I={},R={once:!0};function D(t){for(var e in t)for(var n in t[e])return n||"untitled";return"empty"}var L=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""},n=e.id;u()(this,t),this.id=n,this.VERSION="8.8.20",this._startTs=E(),this._deltaTs=E(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new b("__probe-".concat(this.id,"__"),j),this.userData={},this.timeStamp("".concat(this.id," started")),C(this),Object.seal(this)}return l()(t,[{key:"level",get:function(){return this.getLevel()},set:function(t){this.setLevel(t)}},{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((E()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((E()-this._deltaTs).toPrecision(10))}},{key:"priority",get:function(){return this.level},set:function(t){this.level=t}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:t}),this}},{key:"setLevel",value:function(t){return this._storage.updateConfiguration({level:t}),this}},{key:"assert",value:function(t,e){P(t,e)}},{key:"warn",value:function(t){return this._getLogFunction(0,t,T.warn,arguments,R)}},{key:"error",value:function(t){return this._getLogFunction(0,t,T.error,arguments)}},{key:"deprecated",value:function(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}},{key:"removed",value:function(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}},{key:"probe",value:function(t,e){return this._getLogFunction(t,e,T.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(t,e){return this._getLogFunction(t,e,T.debug,arguments)}},{key:"info",value:function(t,e){return this._getLogFunction(t,e,console.info,arguments)}},{key:"once",value:function(t,e){return this._getLogFunction(t,e,T.debug||T.info,arguments,R)}},{key:"table",value:function(t,e,n){return e?this._getLogFunction(t,e,console.table||M,n&&[n],{tag:D(e)}):M}},{key:"image",value:function(t){var e=t.logLevel,r=t.priority,i=t.image,o=t.message,a=void 0===o?"":o,s=t.scale,u=void 0===s?1:s;return this._shouldLog(e||r)?y?function(t){var e=t.image,n=t.message,r=void 0===n?"":n,i=t.scale,o=void 0===i?1:i;if("string"==typeof e){var a=new Image;return a.onload=function(){var t,e=A(a,r,o);(t=console).log.apply(t,v()(e))},a.src=e,M}var s=e.nodeName||"";if("img"===s.toLowerCase()){var u;return(u=console).log.apply(u,v()(A(e,r,o))),M}if("canvas"===s.toLowerCase()){var c=new Image;return c.onload=function(){var t;return(t=console).log.apply(t,v()(A(c,r,o)))},c.src=e.toDataURL(),M}return M}({image:i,message:a,scale:u}):function(t){var e=t.image,r=(t.message,t.scale),i=void 0===r?1:r,o=null;try{o=n(300)}catch(t){}if(o)return function(){return o(e,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then((function(t){return console.log(t)}))};return M}({image:i,message:a,scale:u}):M}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"get",value:function(t){return this._storage.config[t]}},{key:"set",value:function(t,e){this._storage.updateConfiguration(i()({},t,e))}},{key:"time",value:function(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}},{key:"timeEnd",value:function(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(t,e){return this._getLogFunction(t,e,console.timeStamp||M)}},{key:"group",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1},r=n=G({logLevel:t,message:e,opts:n}),i=r.collapsed;return n.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}},{key:"groupCollapsed",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}},{key:"groupEnd",value:function(t){return this._getLogFunction(t,"",console.groupEnd||M)}},{key:"withGroup",value:function(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(t){return this.isEnabled()&&this.getLevel()>=F(t)}},{key:"_getLogFunction",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4?arguments[4]:void 0;if(this._shouldLog(t)){var o;i=G({logLevel:t,message:e,args:r,opts:i}),P(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=E();var a=i.tag||i.message;if(i.once){if(I[a])return M;I[a]=E()}return e=N(this.id,i.message,i),(o=n).bind.apply(o,[console,e].concat(v()(i.args)))}return M}}]),t}();function F(t){if(!t)return 0;var e;switch(d()(t)){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return P(Number.isFinite(e)&&e>=0),e}function G(t){var e=t.logLevel,n=t.message;t.logLevel=F(e);for(var r=t.args?Array.from(t.args):[];r.length&&r.shift()!==n;);switch(t.args=r,d()(e)){case"string":case"function":void 0!==n&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"==typeof t.message&&(t.message=t.message());var i=d()(t.message);return P("string"===i||"object"===i),Object.assign(t,t.opts)}function N(t,e,n){if("string"==typeof e){var r=n.time?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}((s=n.total)<10?"".concat(s.toFixed(2),"ms"):s<100?"".concat(s.toFixed(1),"ms"):s<1e3?"".concat(s.toFixed(0),"ms"):"".concat((s/1e3).toFixed(2),"s")):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),i=e,o=n.color,a=n.background,y||"string"!=typeof i||(o&&(o=O(o),i="[".concat(o,"m").concat(i,"[39m")),a&&(o=O(a),i="[".concat(a+10,"m").concat(i,"[49m"))),e=i}var i,o,a,s;return e}L.VERSION="8.8.20";var U=new L({id:"loaders.gl"}),z=function(){function t(){u()(this,t)}return l()(t,[{key:"log",value:function(){return function(){}}},{key:"info",value:function(){return function(){}}},{key:"warn",value:function(){return function(){}}},{key:"error",value:function(){return function(){}}}]),t}(),H=function(){function t(){u()(this,t),Object(f.a)(this,"console",void 0),this.console=console}return l()(t,[{key:"log",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=this.console.log).bind.apply(t,[this.console].concat(n))}},{key:"info",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=this.console.info).bind.apply(t,[this.console].concat(n))}},{key:"warn",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=this.console.warn).bind.apply(t,[this.console].concat(n))}},{key:"error",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=this.console.error).bind.apply(t,[this.console].concat(n))}}]),t}(),V=n(93),J={fetch:null,mimeType:void 0,nothrow:!1,log:new H,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:V.c,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},W={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function K(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return X(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function X(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?q(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Z(){globalThis.loaders=globalThis.loaders||{};var t=globalThis.loaders;return t._state=t._state||{},t._state}n.d(e,"c",(function(){return Z})),n.d(e,"b",(function(){return Y})),n.d(e,"e",(function(){return $})),n.d(e,"d",(function(){return tt})),n.d(e,"a",(function(){return et}));var Y=function(){var t=Z();return t.globalOptions=t.globalOptions||Q({},J),t.globalOptions};function $(t){var e=Z(),n=Y();e.globalOptions=it(n,t)}function tt(t,e,n,r){return n=n||[],function(t,e){nt(t,null,J,W,e);var n,r=K(e);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=t&&t[i.id]||{},a=i.options&&i.options[i.id]||{},s=i.deprecatedOptions&&i.deprecatedOptions[i.id]||{};nt(o,i.id,a,s,e)}}catch(t){r.e(t)}finally{r.f()}}(t,n=Array.isArray(n)?n:[n]),it(e,t,r)}function et(t,e){var n=Y(),r=t||n;return"function"==typeof r.fetch?r.fetch:Object(o.f)(r.fetch)?function(t){return Object(a.a)(t,r)}:null!=e&&e.fetch?null==e?void 0:e.fetch:a.a}function nt(t,e,n,r,i){var a=e||"Top level",s=e?"".concat(e,"."):"";for(var u in t){var c=!e&&Object(o.f)(t[u]);if(!(u in n||"baseUri"===u&&!e||"workerUrl"===u&&e))if(u in r)U.warn("".concat(a," loader option '").concat(s).concat(u,"' no longer supported, use '").concat(r[u],"'"))();else if(!c){var l=rt(u,i);U.warn("".concat(a," loader option '").concat(s).concat(u,"' not recognized. ").concat(l))()}}}function rt(t,e){var n,r=t.toLowerCase(),i="",o=K(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;for(var s in a.options){if(t===s)return"Did you mean '".concat(a.id,".").concat(s,"'?");var u=s.toLowerCase();(r.startsWith(u)||u.startsWith(r))&&(i=i||"Did you mean '".concat(a.id,".").concat(s,"'?"))}}}catch(t){o.e(t)}finally{o.f()}return i}function it(t,e,n){var r=Q({},t.options||{});return function(t,e){!e||"baseUri"in t||(t.baseUri=e)}(r,n),null===r.log&&(r.log=new z),ot(r,Y()),ot(r,e),r}function ot(t,e){for(var n in e)if(n in e){var r=e[n];Object(o.h)(r)&&Object(o.h)(t[n])?t[n]=Q(Q({},t[n]),e[n]):t[n]=e[n]}}},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return s}));var r=n(17),i={};function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";i[t]=i[t]||1;var e=i[t]++;return"".concat(t,"-").concat(e)}function a(t){return Object(r.a)("number"==typeof t,"Input must be a number"),t&&0==(t&t-1)}function s(t){var e=!0;for(var n in t){e=!1;break}return e}},function(t,e,n){var r=n(302);t.exports=function(t){return function(){return new r(t.apply(this,arguments))}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(17);function i(t,e){if("string"!=typeof e)return e;var n=Number(e);if(!isNaN(n))return n;var i=t[e=e.replace(/^.*\./,"")];return Object(r.a)(void 0!==i,"Accessing undefined constant GL.".concat(e)),i}function o(t,e){for(var n in e=Number(e),t)if(t[n]===e)return"GL.".concat(n);return String(e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return u}));var r=n(23),i={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},o=i.global||i.self||i.window||{},a="object"!==("undefined"==typeof process?"undefined":n.n(r)()(process))||"[object process]"!==String(process)||process.browser,s="function"==typeof importScripts,u="undefined"!=typeof window&&void 0!==window.orientation,c="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);c&&parseFloat(c[1])},function(t,e,n){"use strict";n.d(e,"a",(function(){return B}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(10),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(129),A=n(24);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function w(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var P=["longitude","latitude","zoom","bearing","pitch"],S=["longitude","latitude","zoom"],B=function(t){h()(n,t);var e=C(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,n);var o=Array.isArray(r)?r:r.transitionProps,a=Array.isArray(r)?{}:r;return a.transitionProps=Array.isArray(o)?{compare:o,required:o}:o||{compare:P,required:S},t=e.call(this,a.transitionProps),m()(u()(t),"opts",void 0),t.opts=a,t}return a()(n,[{key:"initializeProps",value:function(t,e){var r=l()(g()(n.prototype),"initializeProps",this).call(this,t,e),i=this.opts,o=i.makeViewport,a=i.around;if(o&&a){var s=o(t),u=o(e),c=s.unproject(a);r.start.around=a,Object.assign(r.end,{around:u.project(c),aroundPosition:c,width:e.width,height:e.height})}return r}},{key:"interpolateProps",value:function(t,e,n){var r,i={},o=w(this._propsToExtract);try{for(o.s();!(r=o.n()).done;){var a=r.value;i[a]=Object(A.g)(t[a]||0,e[a]||0,n)}}catch(t){o.e(t)}finally{o.f()}if(e.aroundPosition&&this.opts.makeViewport){var s=this.opts.makeViewport(O(O({},e),i));Object.assign(i,s.panByPosition(e.aroundPosition,Object(A.g)(t.around,e.around,n)))}return i}}]),n}(b.a)},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return s}));var r=[],i=[];function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,o=r,a={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?o=t:t.length>0&&(i.length=t.length,o=i):o=r,(e>0||Number.isFinite(n))&&(o=(Array.isArray(o)?o:Array.from(o)).slice(e,n),a.index=e-1),{iterable:o,objectInfo:a}}function a(t){return t&&t[Symbol.asyncIterator]}function s(t,e){var n=e.size,r=e.stride,i=e.offset,o=e.startIndices,a=e.nested,s=t.BYTES_PER_ELEMENT,u=r?r/s:n,c=i?i/s:0,l=Math.floor((t.length-c)/u);return function(e,r){var i=r.index,s=r.target;if(!o){for(var f=i*u+c,h=0;h<n;h++)s[h]=t[f+h];return s}var d,p=o[i],v=o[i+1]||l;if(a){d=new Array(v-p);for(var g=p;g<v;g++){var y=g*u+c;s=new Array(n);for(var m=0;m<n;m++)s[m]=t[y+m];d[g-p]=s}}else if(u===n)d=t.subarray(p*n+c,v*n+c);else{d=new t.constructor((v-p)*n);for(var b=0,A=p;A<v;A++)for(var _=A*u+c,O=0;O<n;O++)d[b++]=t[_+O]}return d}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return a}));function r(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.clamped,r=void 0===n||n;switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return r?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function o(t){var e=t.data,n=t.width,r=t.height,i=t.bytesPerPixel,o=void 0===i?4:i,a=t.temp,s=n*o;a=a||new Uint8Array(s);for(var u=0;u<r/2;++u){var c=u*s,l=(r-u-1)*s;a.set(e.subarray(c,c+s)),e.copyWithin(c,l,l+s),e.set(a,l)}}function a(t){for(var e=t.data,n=t.width,r=t.height,i=Math.round(n/2),o=Math.round(r/2),a=new Uint8Array(i*o*4),s=0;s<o;s++)for(var u=0;u<i;u++)for(var c=0;c<4;c++)a[4*(s*i+u)+c]=e[4*(2*s*n+2*u)+c];return{data:a,width:i,height:o}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return P}));var r=n(15),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(5),l=n.n(c),f=n(7),h=n.n(f),d=n(2),p=n.n(d),v=n(12),g=n(57),y=n(49),m=n(104),b=n(17),A=n(67);function _(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var x=[9729,9728],C=globalThis.WebGLBuffer||function(){},P=function(t,e){l()(r,t);var n=w(r);function r(t,e){var i;a()(this,r);var o=e.id,s=void 0===o?Object(A.c)("texture"):o,u=e.handle,c=e.target;return(i=n.call(this,t,{id:s,handle:u})).target=c,i.textureUnit=void 0,i.loaded=!1,i.width=void 0,i.height=void 0,i.depth=void 0,i.format=void 0,i.type=void 0,i.dataFormat=void 0,i.border=void 0,i.textureUnit=void 0,i.mipmaps=void 0,i}return u()(r,[{key:e,get:function(){return"Texture"}},{key:"toString",value:function(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}},{key:"initialize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then((function(n){return t.initialize(Object.assign({},e,{pixels:n,data:n}))})),this;var r="undefined"!=typeof HTMLVideoElement&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",(function(){return t.initialize(e)})),this;var i=e.pixels,o=void 0===i?null:i,a=e.format,s=void 0===a?6408:a,u=e.border,c=void 0===u?0:u,l=e.recreate,f=void 0!==l&&l,h=e.parameters,d=void 0===h?{}:h,p=e.pixelStore,g=void 0===p?{}:p,y=e.textureUnit,m=void 0===y?void 0:y;n||(n=o);var b=e.width,A=e.height,_=e.dataFormat,O=e.type,w=e.compressed,x=void 0!==w&&w,C=e.mipmaps,P=void 0===C||C,S=e.depth,B=void 0===S?0:S,k=this._deduceParameters({format:s,type:O,dataFormat:_,compressed:x,data:n,width:b,height:A});return b=k.width,A=k.height,x=k.compressed,_=k.dataFormat,O=k.type,this.width=b,this.height=A,this.depth=B,this.format=s,this.type=O,this.dataFormat=_,this.border=c,this.textureUnit=m,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),P&&this._isNPOT()&&(v.k.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),P=!1,this._updateForNPOT(d)),this.mipmaps=P,this.setImageData({data:n,width:b,height:A,depth:B,format:s,type:O,dataFormat:_,border:c,mipmaps:P,parameters:g,compressed:x}),P&&this.generateMipmap(),this.setParameters(d),f&&(this.data=n),r&&(this._video={video:n,parameters:d,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}},{key:"update",value:function(){if(this._video){var t=this._video,e=t.video,n=t.parameters;if(t.lastTime===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}},{key:"resize",value:function(t){var e=t.height,n=t.width,r=t.mipmaps,i=void 0!==r&&r;return n!==this.width||e!==this.height?this.initialize({width:n,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}},{key:"generateMipmap",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(v.k.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Object(v.o)(this.gl,e,(function(){t.gl.generateMipmap(t.target)})),this.gl.bindTexture(this.target,null),this)}},{key:"setImageData",value:function(t){this._trackDeallocatedMemory("Texture");var e=t.target,n=void 0===e?this.target:e,r=t.pixels,o=void 0===r?null:r,a=t.level,s=void 0===a?0:a,u=t.format,c=void 0===u?this.format:u,l=t.border,f=void 0===l?this.border:l,h=t.offset,d=void 0===h?0:h,p=t.parameters,g=void 0===p?{}:p,y=t.data,A=void 0===y?null:y,O=t.type,w=void 0===O?this.type:O,x=t.width,C=void 0===x?this.width:x,P=t.height,S=void 0===P?this.height:P,B=t.dataFormat,k=void 0===B?this.dataFormat:B,E=t.compressed,T=void 0!==E&&E;A||(A=o);var j=this._deduceParameters({format:c,type:w,dataFormat:k,compressed:T,data:A,width:C,height:S});w=j.type,k=j.dataFormat,T=j.compressed,C=j.width,S=j.height;var M=this.gl;M.bindTexture(this.target,this.handle);var I,R,D=this._getDataType({data:A,compressed:T});A=D.data,I=D.dataType;var L=0;if(Object(v.o)(this.gl,g,(function(){switch(I){case"null":M.texImage2D(n,s,c,C,S,f,k,w,A);break;case"typed-array":M.texImage2D(n,s,c,C,S,f,k,w,A,d);break;case"buffer":(R=Object(v.a)(M)).bindBuffer(35052,A.handle||A),R.texImage2D(n,s,c,C,S,f,k,w,d),R.bindBuffer(35052,null);break;case"browser-object":Object(v.j)(M)?M.texImage2D(n,s,c,C,S,f,k,w,A):M.texImage2D(n,s,c,k,w,A);break;case"compressed":var t,e=_(A.entries());try{for(e.s();!(t=e.n()).done;){var r=i()(t.value,2),o=r[0],a=r[1];M.compressedTexImage2D(n,o,a.format,a.width,a.height,f,a.data),L+=a.levelSize}}catch(t){e.e(t)}finally{e.f()}break;default:Object(b.a)(!1,"Unknown image data type")}})),"compressed"===I)this._trackAllocatedMemory(L,"Texture");else if(A&&A.byteLength)this._trackAllocatedMemory(A.byteLength,"Texture");else{var F=m.a[this.dataFormat]||4,G=m.c[this.type]||1;this._trackAllocatedMemory(this.width*this.height*F*G,"Texture")}return this.loaded=!0,this}},{key:"setSubImageData",value:function(t){var e=this,n=t.target,r=void 0===n?this.target:n,i=t.pixels,o=void 0===i?null:i,a=t.data,s=void 0===a?null:a,u=t.x,c=void 0===u?0:u,l=t.y,f=void 0===l?0:l,h=t.width,d=void 0===h?this.width:h,p=t.height,g=void 0===p?this.height:p,m=t.level,A=void 0===m?0:m,_=t.format,O=void 0===_?this.format:_,w=t.type,x=void 0===w?this.type:w,P=t.dataFormat,S=void 0===P?this.dataFormat:P,B=t.compressed,k=void 0!==B&&B,E=t.offset,T=void 0===E?0:E,j=t.border,M=(void 0===j&&this.border,t.parameters),I=void 0===M?{}:M,R=this._deduceParameters({format:O,type:x,dataFormat:S,compressed:k,data:s,width:d,height:g});if(x=R.type,S=R.dataFormat,k=R.compressed,d=R.width,g=R.height,Object(b.a)(0===this.depth,"texSubImage not supported for 3D textures"),s||(s=o),s&&s.data){var D=s;s=D.data,d=D.shape[0],g=D.shape[1]}s instanceof y.a&&(s=s.handle),this.gl.bindTexture(this.target,this.handle),Object(v.o)(this.gl,I,(function(){if(k)e.gl.compressedTexSubImage2D(r,A,c,f,d,g,O,s);else if(null===s)e.gl.texSubImage2D(r,A,c,f,d,g,S,x,null);else if(ArrayBuffer.isView(s))e.gl.texSubImage2D(r,A,c,f,d,g,S,x,s,T);else if(s instanceof C){var t=Object(v.a)(e.gl);t.bindBuffer(35052,s),t.texSubImage2D(r,A,c,f,d,g,S,x,T),t.bindBuffer(35052,null)}else if(Object(v.j)(e.gl)){Object(v.a)(e.gl).texSubImage2D(r,A,c,f,d,g,S,x,s)}else e.gl.texSubImage2D(r,A,c,f,S,x,s)})),this.gl.bindTexture(this.target,null)}},{key:"copyFramebuffer",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return v.k.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}},{key:"getActiveUnit",value:function(){return this.gl.getParameter(34016)-33984}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit,e=this.gl;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}},{key:"unbind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit,e=this.gl;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}},{key:"_getDataType",value:function(t){var e=t.data,n=t.compressed;return void 0!==n&&n?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof y.a?{data:e.handle,dataType:"buffer"}:e instanceof C?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}},{key:"_deduceParameters",value:function(t){var e=t.format,n=t.data,r=t.width,i=t.height,o=t.dataFormat,a=t.type,s=t.compressed,u=m.b[e];o=o||u&&u.dataFormat,a=a||u&&u.types[0],s=s||u&&u.compressed;var c=this._deduceImageSize(n,r,i);return{dataFormat:o,type:a,compressed:s,width:r=c.width,height:i=c.height,format:e,data:n}}},{key:"_deduceImageSize",value:function(t,e,n){var r;return r="undefined"!=typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement?{width:t.width,height:t.height}:"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},Object(b.a)(r,"Could not deduced texture size"),Object(b.a)(void 0===e||r.width===e,"Deduced texture width does not match supplied width"),Object(b.a)(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}},{key:"_createHandle",value:function(){return this.gl.createTexture()}},{key:"_deleteHandle",value:function(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}},{key:"_getParameter",value:function(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);var e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}},{key:"_setParameter",value:function(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:Object(b.a)(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}},{key:"_isNPOT",value:function(){return!Object(v.j)(this.gl)&&(!(!this.width||!this.height)&&(!Object(A.b)(this.width)||!Object(A.b)(this.height)))}},{key:"_updateForNPOT",value:function(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}},{key:"_getNPOTParam",value:function(t,e){if(this._isNPOT())switch(t){case 10241:-1===x.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}],[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.format,r=e.linearFiltering,i=!0;return n&&(i=(i=i&&Object(m.d)(t,n))&&(!r||Object(m.e)(t,n))),i}}]),r}(g.a,Symbol.toStringTag)},function(t,e,n){"use strict";function r(t,e,n){var r=e[0],i=e[1],o=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/o,t[1]=(n[1]*r+n[5]*i)/o,t}function i(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o||1;return t[0]=(n[0]*r+n[4]*i+n[8]*o)/a,t[1]=(n[1]*r+n[5]*i+n[9]*o)/a,t[2]=(n[2]*r+n[6]*i+n[10]*o)/a,t}function o(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function a(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function s(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*o,t[1]=n[1]*r+n[4]*i+n[7]*o,t[2]=n[2]*r+n[5]*i+n[8]*o,t[3]=e[3],t}n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return s}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"i",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"e",(function(){return u})),n.d(e,"h",(function(){return c})),n.d(e,"f",(function(){return l})),n.d(e,"g",(function(){return f})),n.d(e,"c",(function(){return h}));var r=n(18);function i(){var t=new r.a(9);return r.a!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function o(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function a(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=l*a-s*c,h=-l*o+s*u,d=c*o-a*u,p=n*f+r*h+i*d;return p?(p=1/p,t[0]=f*p,t[1]=(-l*r+i*c)*p,t[2]=(s*r-i*a)*p,t[3]=h*p,t[4]=(l*n-i*u)*p,t[5]=(-s*n+i*o)*p,t[6]=d*p,t[7]=(-c*n+r*u)*p,t[8]=(a*n-r*o)*p,t):null}function s(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*(c*o-a*u)+n*(-c*i+a*s)+r*(u*i-o*s)}function u(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=n[0],d=n[1],p=n[2],v=n[3],g=n[4],y=n[5],m=n[6],b=n[7],A=n[8];return t[0]=h*r+d*a+p*c,t[1]=h*i+d*s+p*l,t[2]=h*o+d*u+p*f,t[3]=v*r+g*a+y*c,t[4]=v*i+g*s+y*l,t[5]=v*o+g*u+y*f,t[6]=m*r+b*a+A*c,t[7]=m*i+b*s+A*l,t[8]=m*o+b*u+A*f,t}function c(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=h*r+d*a+c,t[7]=h*i+d*s+l,t[8]=h*o+d*u+f,t}function l(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=Math.sin(n),d=Math.cos(n);return t[0]=d*r+h*a,t[1]=d*i+h*s,t[2]=d*o+h*u,t[3]=d*a-h*r,t[4]=d*s-h*i,t[5]=d*u-h*o,t[6]=c,t[7]=l,t[8]=f,t}function f(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function h(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,d=i*s,p=i*u,v=o*a,g=o*s,y=o*u;return t[0]=1-f-p,t[3]=l-y,t[6]=h+g,t[1]=l+y,t[4]=1-c-p,t[7]=d-v,t[2]=h-g,t[5]=d+v,t[8]=1-c-f,t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=n(166),l=n(71);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={transitionDuration:0},p=function(t){return 1-(1-t)*(1-t)},v=["wheel"],g=["panstart","panmove","panend"],y=["pinchstart","pinchmove","pinchend"],m=["tripanstart","tripanmove","tripanend"],b=["doubletap"],A=["keydown"],_={},O=function(){function t(e){var n=this;i()(this,t),u()(this,"props",void 0),u()(this,"state",{}),u()(this,"transitionManager",void 0),u()(this,"eventManager",void 0),u()(this,"onViewStateChange",void 0),u()(this,"onStateChange",void 0),u()(this,"makeViewport",void 0),u()(this,"_controllerState",void 0),u()(this,"_events",{}),u()(this,"_interactionState",{isDragging:!1}),u()(this,"_customEvents",[]),u()(this,"_eventStartBlocked",null),u()(this,"_panMove",!1),u()(this,"invertPan",!1),u()(this,"dragMode","rotate"),u()(this,"inertia",0),u()(this,"scrollZoom",!0),u()(this,"dragPan",!0),u()(this,"dragRotate",!0),u()(this,"doubleClickZoom",!0),u()(this,"touchZoom",!0),u()(this,"touchRotate",!1),u()(this,"keyboard",!0),this.transitionManager=new c.b(h(h({},e),{},{getControllerState:function(t){return new n.ControllerState(t)},onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)})),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||function(){},this.onStateChange=e.onStateChange||function(){},this.makeViewport=e.makeViewport}return a()(t,[{key:"events",set:function(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}},{key:"finalize",value:function(){for(var t in this._events){var e;if(this._events[t])null===(e=this.eventManager)||void 0===e||e.off(t,this.handleEvent)}this.transitionManager.finalize()}},{key:"handleEvent",value:function(t){this._controllerState=void 0;var e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}},{key:"controllerState",get:function(){return this._controllerState=this._controllerState||new this.ControllerState(h(h({makeViewport:this.makeViewport},this.props),this.state)),this._controllerState}},{key:"getCenter",value:function(t){var e=this.props,n=e.x,r=e.y,i=t.offsetCenter;return[i.x-n,i.y-r]}},{key:"isPointInBounds",value:function(t,e){var n=this.props,r=n.width,i=n.height;if(e&&e.handled)return!1;var o=t[0]>=0&&t[0]<=r&&t[1]>=0&&t[1]<=i;return o&&e&&e.stopPropagation(),o}},{key:"isFunctionKeyPressed",value:function(t){var e=t.srcEvent;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}},{key:"isDragging",value:function(){return this._interactionState.isDragging||!1}},{key:"blockEvents",value:function(t){var e=this,n=setTimeout((function(){e._eventStartBlocked===n&&(e._eventStartBlocked=null)}),t);this._eventStartBlocked=n}},{key:"setProps",value:function(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);var e=t.inertia;this.inertia=Number.isFinite(e)?e:!0===e?300:0;var n=t.scrollZoom,r=void 0===n||n,i=t.dragPan,o=void 0===i||i,a=t.dragRotate,s=void 0===a||a,u=t.doubleClickZoom,c=void 0===u||u,l=t.touchZoom,f=void 0===l||l,h=t.touchRotate,d=void 0!==h&&h,p=t.keyboard,_=void 0===p||p,O=Boolean(this.onViewStateChange);this.toggleEvents(v,O&&r),this.toggleEvents(g,O&&(o||s)),this.toggleEvents(y,O&&(f||d)),this.toggleEvents(m,O&&d),this.toggleEvents(b,O&&c),this.toggleEvents(A,O&&_),this.scrollZoom=r,this.dragPan=o,this.dragRotate=s,this.doubleClickZoom=c,this.touchZoom=f,this.touchRotate=d,this.keyboard=_}},{key:"updateTransition",value:function(){this.transitionManager.updateTransition()}},{key:"toggleEvents",value:function(t,e){var n=this;this.eventManager&&t.forEach((function(t){n._events[t]!==e&&(n._events[t]=e,e?n.eventManager.on(t,n.handleEvent):n.eventManager.off(t,n.handleEvent))}))}},{key:"updateViewport",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=h(h({},t.getViewportProps()),e),i=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),i){var o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}},{key:"_onTransition",value:function(t){this.onViewStateChange(h(h({},t),{},{interactionState:this._interactionState}))}},{key:"_setInteractionState",value:function(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}},{key:"_onPanStart",value:function(t){var e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;var n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);var r=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(r,d,{isDragging:!0}),!0}},{key:"_onPan",value:function(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}},{key:"_onPanEnd",value:function(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}},{key:"_onPanMove",value:function(t){if(!this.dragPan)return!1;var e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,d,{isDragging:!0,isPanning:!0}),!0}},{key:"_onPanMoveEnd",value:function(t){var e=this.inertia;if(this.dragPan&&e&&t.velocity){var n=this.getCenter(t),r=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(i,h(h({},this._getTransitionProps()),{},{transitionDuration:e,transitionEasing:p}),{isDragging:!1,isPanning:!0})}else{var o=this.controllerState.panEnd();this.updateViewport(o,null,{isDragging:!1,isPanning:!1})}return!0}},{key:"_onPanRotate",value:function(t){if(!this.dragRotate)return!1;var e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,d,{isDragging:!0,isRotating:!0}),!0}},{key:"_onPanRotateEnd",value:function(t){var e=this.inertia;if(this.dragRotate&&e&&t.velocity){var n=this.getCenter(t),r=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(i,h(h({},this._getTransitionProps()),{},{transitionDuration:e,transitionEasing:p}),{isDragging:!1,isRotating:!0})}else{var o=this.controllerState.rotateEnd();this.updateViewport(o,null,{isDragging:!1,isRotating:!1})}return!0}},{key:"_onWheel",value:function(t){if(!this.scrollZoom)return!1;t.srcEvent.preventDefault();var e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;var n=!0===this.scrollZoom?{}:this.scrollZoom,r=n.speed,i=void 0===r?.01:r,o=n.smooth,a=void 0!==o&&o,s=t.delta,u=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==u&&(u=1/u);var c=this.controllerState.zoom({pos:e,scale:u});return this.updateViewport(c,h(h({},this._getTransitionProps({around:e})),{},{transitionDuration:a?250:1}),{isZooming:!0,isPanning:!0}),!0}},{key:"_onTriplePanStart",value:function(t){var e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;var n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,d,{isDragging:!0}),!0}},{key:"_onTriplePan",value:function(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;var e=this.getCenter(t);e[0]-=t.deltaX;var n=this.controllerState.rotate({pos:e});return this.updateViewport(n,d,{isDragging:!0,isRotating:!0}),!0}},{key:"_onTriplePanEnd",value:function(t){if(!this.isDragging())return!1;var e=this.inertia;if(this.touchRotate&&e&&t.velocityY){var n=this.getCenter(t),r=[n[0],n[1]+=t.velocityY*e/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,h(h({},this._getTransitionProps()),{},{transitionDuration:e,transitionEasing:p}),{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{var o=this.controllerState.rotateEnd();this.updateViewport(o,null,{isDragging:!1,isRotating:!1})}return!0}},{key:"_onPinchStart",value:function(t){var e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;var n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return _._startPinchRotation=t.rotation,_._lastPinchEvent=t,this.updateViewport(n,d,{isDragging:!0}),!0}},{key:"_onPinch",value:function(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;var e=this.controllerState;if(this.touchZoom){var n=t.scale,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){var i=t.rotation;e=e.rotate({deltaAngleX:_._startPinchRotation-i})}return this.updateViewport(e,d,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),_._lastPinchEvent=t,!0}},{key:"_onPinchEnd",value:function(t){if(!this.isDragging())return!1;var e=this.inertia,n=_._lastPinchEvent;if(this.touchZoom&&e&&n&&t.scale!==n.scale){var r=this.getCenter(t),i=this.controllerState.rotateEnd(),o=Math.log2(t.scale),a=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),s=Math.pow(2,o+a*e/2);i=i.zoom({pos:r,scale:s}).zoomEnd(),this.updateViewport(i,h(h({},this._getTransitionProps({around:r})),{},{transitionDuration:e,transitionEasing:p}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{var u=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(u,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return _._startPinchRotation=null,_._lastPinchEvent=null,!0}},{key:"_onDoubleTap",value:function(t){if(!this.doubleClickZoom)return!1;var e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;var n=this.isFunctionKeyPressed(t),r=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}},{key:"_onKeyDown",value:function(t){if(!this.keyboard)return!1;var e,n=this.isFunctionKeyPressed(t),r=!0===this.keyboard?{}:this.keyboard,i=r.zoomSpeed,o=r.moveSpeed,a=r.rotateSpeedX,s=r.rotateSpeedY,u=this.controllerState,c={};switch(t.srcEvent.code){case"Minus":e=n?u.zoomOut(i).zoomOut(i):u.zoomOut(i),c.isZooming=!0;break;case"Equal":e=n?u.zoomIn(i).zoomIn(i):u.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":n?(e=u.rotateLeft(a),c.isRotating=!0):(e=u.moveLeft(o),c.isPanning=!0);break;case"ArrowRight":n?(e=u.rotateRight(a),c.isRotating=!0):(e=u.moveRight(o),c.isPanning=!0);break;case"ArrowUp":n?(e=u.rotateUp(s),c.isRotating=!0):(e=u.moveUp(o),c.isPanning=!0);break;case"ArrowDown":n?(e=u.rotateDown(s),c.isRotating=!0):(e=u.moveDown(o),c.isPanning=!0);break;default:return!1}return this.updateViewport(e,this._getTransitionProps(),c),!0}},{key:"_getTransitionProps",value:function(t){var e=this.transition;return e&&e.transitionInterpolator?t?h(h({},e),{},{transitionInterpolator:new l.a(h(h(h({},t),e.transitionInterpolator.opts),{},{makeViewport:this.controllerState.makeViewport}))}):e:d}}]),t}()},function(t,e,n){"use strict";var r=n(26),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(0),l=n.n(c),f=n(62),h=/([0-9]+\.?[0-9]*)(%|px)/;function d(t){switch(i()(t)){case"number":return{position:t,relative:!1};case"string":var e=h.exec(t);if(e&&e.length>=3){var n="%"===e[2],r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function p(t,e){return t.relative?Math.round(t.position*e):t.position}var v=n(83),g=n(44);function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n.d(e,"a",(function(){return b}));var b=function(){function t(e){a()(this,t),l()(this,"id",void 0),l()(this,"viewportInstance",void 0),l()(this,"_x",void 0),l()(this,"_y",void 0),l()(this,"_width",void 0),l()(this,"_height",void 0),l()(this,"_padding",void 0),l()(this,"props",void 0);var n=e||{},r=n.id,i=n.x,o=void 0===i?0:i,s=n.y,u=void 0===s?0:s,c=n.width,h=void 0===c?"100%":c,p=n.height,v=void 0===p?"100%":p,y=n.padding,b=void 0===y?null:y,A=n.viewportInstance;Object(g.a)(!A||A instanceof f.a),this.viewportInstance=A,this.id=r||this.constructor.displayName||"view",this.props=m(m({},e),{},{id:this.id}),this._x=d(o),this._y=d(u),this._width=d(h),this._height=d(v),this._padding=b&&{left:d(b.left||0),right:d(b.right||0),top:d(b.top||0),bottom:d(b.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}return u()(t,[{key:"equals",value:function(t){return this===t||(this.viewportInstance?!!t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):this.ViewportType===t.ViewportType&&Object(v.a)(this.props,t.props))}},{key:"makeViewport",value:function(t){var e=t.width,n=t.height,r=t.viewState;if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);var i=this.getDimensions({width:e,height:n});return new this.ViewportType(m(m(m({},r),this.props),i))}},{key:"getViewStateId",value:function(){var t=this.props.viewState;return"string"==typeof t?t:(null==t?void 0:t.id)||this.id}},{key:"filterViewState",value:function(t){if(this.props.viewState&&"object"===i()(this.props.viewState)){if(!this.props.viewState.id)return this.props.viewState;var e=m({},t);for(var n in this.props.viewState)"id"!==n&&(e[n]=this.props.viewState[n]);return e}return t}},{key:"getDimensions",value:function(t){var e=t.width,n=t.height,r={x:p(this._x,e),y:p(this._y,n),width:p(this._width,e),height:p(this._height,n)};return this._padding&&(r.padding={left:p(this._padding.left,e),top:p(this._padding.top,n),right:p(this._padding.right,e),bottom:p(this._padding.bottom,n)}),r}},{key:"controller",get:function(){var t=this.props.controller;return t?!0===t?{type:this.ControllerType}:"function"==typeof t?{type:t}:m({type:this.ControllerType},t):null}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(0),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(67),l=n(17);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var h={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},d=function(){function t(){a()(this,t);var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.id,r=void 0===n?Object(c.c)("geometry"):n,i=e.drawMode,o=void 0===i?h.TRIANGLES:i,s=e.attributes,u=void 0===s?{}:s,l=e.indices,f=void 0===l?null:l,d=e.vertexCount,p=void 0===d?null:d;this.id=r,this.drawMode=0|o,this.attributes={},this.userData={},this._setAttributes(u,f),this.vertexCount=p||this._calculateVertexCount(this.attributes,this.indices)}return u()(t,[{key:"mode",get:function(){return this.drawMode}},{key:"getVertexCount",value:function(){return this.vertexCount}},{key:"getAttributes",value:function(){return this.indices?function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({indices:this.indices},this.attributes):this.attributes}},{key:"_print",value:function(t){return"Geometry ".concat(this.id," attribute ").concat(t)}},{key:"_setAttributes",value:function(t,e){for(var n in e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e),t){var r=t[n];r=ArrayBuffer.isView(r)?{value:r}:r,Object(l.a)(ArrayBuffer.isView(r.value),"".concat(this._print(n),": must be typed array or object with value as typed array")),"POSITION"!==n&&"positions"!==n||r.size||(r.size=3),"indices"===n?(Object(l.a)(!this.indices),this.indices=r):this.attributes[n]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}},{key:"_calculateVertexCount",value:function(t,e){if(e)return e.value.length;var n=1/0;for(var r in t){var i=t[r],o=i.value,a=i.size;!i.constant&&o&&a>=1&&(n=Math.min(n,o.length/a))}return Object(l.a)(Number.isFinite(n)),n}}],[{key:"DRAW_MODE",get:function(){return h}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(t===e)return!0;if(!t||!e)return!1;for(var n in t){var i=t[n],o=e[n];if(!(i===o||Array.isArray(i)&&Array.isArray(o)&&r(i,o)))return!1}return!0}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";var r=n(32),i=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,o=/^([-\w.]+\/[-\w.+]+)/;function a(t){var e=i.exec(t);return e?e[1]:""}n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return c}));var s=/\?.*/;function u(t){if(Object(r.j)(t)){var e=l(t.url||""),n=t.headers.get("content-type")||"";return{url:e,type:(i=n,s=o.exec(i),(s?s[1]:i)||a(e))}}var i,s;return Object(r.b)(t)?{url:l(t.name||""),type:t.type||""}:"string"==typeof t?{url:l(t),type:a(t)}:{url:"",type:""}}function c(t){return Object(r.j)(t)?t.headers["content-length"]||-1:Object(r.b)(t)?t.size:"string"==typeof t?t.length:t instanceof ArrayBuffer?t.byteLength:ArrayBuffer.isView(t)?t.byteLength:-1}function l(t){return t.replace(s,"")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n(249),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(76),l=n(17),f=n(153),h={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},d={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}},p=function(){function t(){var e=this;a()(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach((function(t){return e._assign(t)})),Object.freeze(this)}return u()(t,[{key:"toString",value:function(){return JSON.stringify(this)}},{key:"BYTES_PER_ELEMENT",get:function(){return t.getBytesPerElement(this)}},{key:"BYTES_PER_VERTEX",get:function(){return t.getBytesPerVertex(this)}},{key:"_assign",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0!==(t=Object(f.a)("Accessor",t,d)).type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&("boolean"==typeof t.index?this.index=t.index?1:0:this.index=t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}],[{key:"getBytesPerElement",value:function(t){return Object(c.c)(t.type||5126).BYTES_PER_ELEMENT}},{key:"getBytesPerVertex",value:function(t){return Object(l.a)(t.size),Object(c.c)(t.type||5126).BYTES_PER_ELEMENT*t.size}},{key:"resolve",value:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return i()(t,[h].concat(n))}}]),t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return p})),n.d(e,"d",(function(){return m})),n.d(e,"c",(function(){return b}));var r=n(15),i=n.n(r),o=n(259),a=n.n(o),s=n(56);function u(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var l=s.a.CLOCKWISE,f=s.a.COUNTER_CLOCKWISE,h={isClosed:!0};function d(t){return"positions"in t?t.positions:t}function p(t){return"holeIndices"in t?t.holeIndices:null}function v(t,e,n,r){for(var i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function g(t,e,n,r,i){for(var o=e,a=n.length,u=0;u<a;u++)for(var c=0;c<r;c++)t[o++]=n[u][c]||0;if(!function(t){var e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(var l=0;l<r;l++)t[o++]=n[0][l]||0;return h.start=e,h.end=o,h.size=r,Object(s.h)(t,i,h),o}function y(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,u=(o=o||n.length)-i;if(u<=0)return e;for(var c=e,l=0;l<u;l++)t[c++]=n[i+l];if(!v(n,r,i,o))for(var f=0;f<r;f++)t[c++]=n[i+f];return h.start=e,h.end=c,h.size=r,Object(s.h)(t,a,h),c}function m(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);var n=[],r=[];if("positions"in t){var o=t,a=o.positions,s=o.holeIndices;if(s){for(var c=0,h=0;h<=s.length;h++)c=y(n,c,a,e,s[h-1],s[h],0===h?l:f),r.push(c);return r.pop(),{positions:n,holeIndices:r}}t=a}if(!function(t){return Array.isArray(t[0])}(t))return y(n,0,t,e,0,n.length,l),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){var d,p=0,v=u(t.entries());try{for(v.s();!(d=v.n()).done;){var m=i()(d.value,2),b=m[0];p=g(n,p,m[1],e,0===b?l:f),r.push(p)}}catch(t){v.e(t)}finally{v.f()}return r.pop(),{positions:n,holeIndices:r}}return g(n,0,t,e,l),n}function b(t,e,n){var r=p(t);r&&(r=r.map((function(t){return t/e})));var i=d(t);if(n){var o=i.length;i=i.slice();for(var s=[],u=0;u<o;u+=e){s[0]=i[u],s[1]=i[u+1];var c=n(s);i[u]=c[0],i[u+1]=c[1]}}return a()(i,r,e)}},function(e,n){e.exports=t},function(t,e,n){"use strict";n.r(e);var r=n(243),i=n(15),o=n.n(i),a=n(1),s=n.n(a),u=n(3),c=n.n(u),l=n(9),f=n.n(l),h=n(10),d=n.n(h),p=n(5),v=n.n(p),g=n(7),y=n.n(g),m=n(2),b=n.n(m),A=n(0),_=n.n(A),O=n(20),w=n(228),x=n(247),C=n(176),P=n(194),S=n(82),B=n(33),k=n(24),E=new Uint16Array([0,2,1,0,3,2]),T=new Float32Array([0,1,0,0,1,0,1,1]);function j(t,e){if(!e)return function(t){for(var e=new Float64Array(12),n=0;n<t.length;n++)e[3*n+0]=t[n][0],e[3*n+1]=t[n][1],e[3*n+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:E,texCoords:T}}(t);for(var n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,o=Math.ceil(r/e)+1,a=(i-1)*(o-1)*6,s=new Uint32Array(a),u=new Float32Array(i*o*2),c=new Float64Array(i*o*3),l=0,f=0,h=0;h<i;h++)for(var d=h/(i-1),p=0;p<o;p++){var v=p/(o-1),g=M(t,d,v);c[3*l+0]=g[0],c[3*l+1]=g[1],c[3*l+2]=g[2]||0,u[2*l+0]=d,u[2*l+1]=1-v,h>0&&p>0&&(s[f++]=l-o,s[f++]=l-o-1,s[f++]=l-1,s[f++]=l-o,s[f++]=l-1,s[f++]=l),l++}return{vertexCount:a,positions:c,indices:s,texCoords:u}}function M(t,e,n){return Object(k.g)(Object(k.g)(t[0],t[1],n),Object(k.g)(t[3],t[2],n),e)}var I="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  return mix(transparentColor, vec4(color, 1.0), alpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat("\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n","\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n");function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function L(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var F={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:O.a.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}},G=function(t){v()(n,t);var e=L(n);function n(){var t;s()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),_()(f()(t),"state",void 0),t}return c()(n,[{key:"getShaders",value:function(){return d()(b()(n.prototype),"getShaders",this).call(this,{vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:I,modules:[w.a,x.a]})}},{key:"initializeState",value:function(){var t=this,e=this.getAttributeManager();e.remove(["instancePickingColors"]);e.add({indices:{size:1,isIndexed:!0,update:function(e){return e.value=t.state.mesh.indices},noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:function(e){return e.value=t.state.mesh.positions},noAlloc:!0},texCoords:{size:2,update:function(e){return e.value=t.state.mesh.texCoords},noAlloc:!0}})}},{key:"updateState",value:function(t){var e=t.props,n=t.oldProps,r=t.changeFlags,i=this.getAttributeManager();if(r.extensionsChanged){var o,a=this.context.gl;null===(o=this.state.model)||void 0===o||o.delete(),this.state.model=this._getModel(a),i.invalidateAll()}if(e.bounds!==n.bounds){var s=this.state.mesh,u=this._createMesh();for(var c in this.state.model.setVertexCount(u.vertexCount),u)s&&s[c]!==u[c]&&i.invalidate(c);this.setState(D({mesh:u},this._getCoordinateUniforms()))}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}},{key:"getPickingInfo",value:function(t){var e=this.props.image,n=t.info;if(!n.color||!e)return n.bitmap=null,n;var r=e,i=r.width,a=r.height;n.index=0;var s,u,c,l,f,h=(s=n.color,u=o()(s,3),c=u[0],l=u[1],f=u[2],[(c+(15&f)/16)/256,(l+(240&f)/256)/256]),d=[Math.floor(h[0]*i),Math.floor(h[1]*a)];return n.bitmap={size:{width:i,height:a},uv:h,pixel:d},n}},{key:"disablePickingIndex",value:function(){this.setState({disablePicking:!0})}},{key:"restorePickingColors",value:function(){this.setState({disablePicking:!1})}},{key:"_updateAutoHighlight",value:function(t){d()(b()(n.prototype),"_updateAutoHighlight",this).call(this,D(D({},t),{},{color:this.encodePickingColor(0)}))}},{key:"_createMesh",value:function(){var t=this.props.bounds,e=t;return N(t)&&(e=[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]]]),j(e,this.context.viewport.resolution)}},{key:"_getModel",value:function(t){return t?new P.a(t,D(D({},this.getShaders()),{},{id:this.props.id,geometry:new S.a({drawMode:4,vertexCount:6}),isInstanced:!1})):null}},{key:"draw",value:function(t){var e=t.uniforms,n=t.moduleParameters,r=this.state,i=r.model,o=r.coordinateConversion,a=r.bounds,s=r.disablePicking,u=this.props,c=u.image,l=u.desaturate,f=u.transparentColor,h=u.tintColor;n.pickingActive&&s||c&&i&&i.setUniforms(e).setUniforms({bitmapTexture:c,desaturate:l,transparentColor:f.map((function(t){return t/255})),tintColor:h.slice(0,3).map((function(t){return t/255})),coordinateConversion:o,bounds:a}).draw()}},{key:"_getCoordinateUniforms",value:function(){var t=O.a.LNGLAT,e=O.a.CARTESIAN,n=O.a.DEFAULT,r=this.props._imageCoordinateSystem;if(r!==n){var i=this.props.bounds;if(!N(i))throw new Error("_imageCoordinateSystem only supports rectangular bounds");var o=this.context.viewport.resolution?t:e;if((r=r===t?t:e)===t&&o===e)return{coordinateConversion:-1,bounds:i};if(r===e&&o===t){var a=Object(B.l)([i[0],i[1]]),s=Object(B.l)([i[2],i[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],s[0],s[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}]),n}(C.a);function N(t){return Number.isFinite(t[0])}_()(G,"layerName","BitmapLayer"),_()(G,"defaultProps",F);var U=n(133),z=n(244),H=n(245),V=n(180),J=n(178),W=n(233),K=n(132),X=n(234),q=n(242),Q=n(179),Z=n(131),Y=n(183),$=n(181);n.d(e,"ArcLayer",(function(){return r.a})),n.d(e,"BitmapLayer",(function(){return G})),n.d(e,"IconLayer",(function(){return U.a})),n.d(e,"LineLayer",(function(){return z.a})),n.d(e,"PointCloudLayer",(function(){return H.a})),n.d(e,"ScatterplotLayer",(function(){return V.a})),n.d(e,"ColumnLayer",(function(){return J.a})),n.d(e,"GridCellLayer",(function(){return W.a})),n.d(e,"PathLayer",(function(){return K.a})),n.d(e,"PolygonLayer",(function(){return X.a})),n.d(e,"GeoJsonLayer",(function(){return q.a})),n.d(e,"TextLayer",(function(){return Q.a})),n.d(e,"SolidPolygonLayer",(function(){return Z.a})),n.d(e,"_MultiIconLayer",(function(){return Y.a})),n.d(e,"_TextBackgroundLayer",(function(){return $.a}))},function(t,e,n){"use strict";function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};return Array.isArray(t)?i(t,e,[]):e(t)?[t]:[]}function i(t,e,n){for(var r=-1;++r<t.length;){var o=t[r];Array.isArray(o)?i(o,e,n):e(o)&&n.push(o)}return n}function o(t){for(var e=t.target,n=t.source,r=t.start,i=void 0===r?0:r,o=t.count,a=void 0===o?1:o,s=n.length,u=a*s,c=0,l=i;c<s;c++)e[l++]=n[c];for(;c<u;)c<u-c?(e.copyWithin(i+c,i,i+c),c*=2):(e.copyWithin(i+c,i,i+u-c),c=u);return e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t),u()(this,"_pool",[]),u()(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}return a()(t,[{key:"setOptions",value:function(t){Object.assign(this.opts,t)}},{key:"allocate",value:function(t,e,n){var r=n.size,i=void 0===r?1:r,o=n.type,a=n.padding,s=void 0===a?0:a,u=n.copy,c=void 0!==u&&u,l=n.initialize,f=void 0!==l&&l,h=n.maxCount,d=o||t&&t.constructor||Float32Array,p=e*i+s;if(ArrayBuffer.isView(t)){if(p<=t.length)return t;if(p*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new d(t.buffer,0,p)}var v=1/0;h&&(v=h*i+s);var g=this._allocate(d,p,f,v);return t&&c?g.set(t):f||g.fill(0,0,4),this._release(t),g}},{key:"release",value:function(t){this._release(t)}},{key:"_allocate",value:function(t,e,n,r){var i=Math.max(Math.ceil(e*this.opts.overAlloc),1);i>r&&(i=r);var o=this._pool,a=t.BYTES_PER_ELEMENT*i,s=o.findIndex((function(t){return t.byteLength>=a}));if(s>=0){var u=new t(o.splice(s,1)[0],0,i);return n&&u.fill(0),u}return new t(i)}},{key:"_release",value:function(t){if(ArrayBuffer.isView(t)){var e=this._pool,n=t.buffer,r=n.byteLength,i=e.findIndex((function(t){return t.byteLength>=r}));i<0?e.push(n):(i>0||e.length<this.opts.poolSize)&&e.splice(i,0,n),e.length>this.opts.poolSize&&e.shift()}}}]),t}();e.a=new c},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return a}));n(25);function r(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],p=e[12],v=e[13],g=e[14],y=e[15],m=n*s-r*a,b=n*u-i*a,A=n*c-o*a,_=r*u-i*s,O=r*c-o*s,w=i*c-o*u,x=l*v-f*p,C=l*g-h*p,P=l*y-d*p,S=f*g-h*v,B=f*y-d*v,k=h*y-d*g,E=m*k-b*B+A*S+_*P-O*C+w*x;return E?(E=1/E,t[0]=(s*k-u*B+c*S)*E,t[1]=(i*B-r*k-o*S)*E,t[2]=(v*w-g*O+y*_)*E,t[3]=(h*O-f*w-d*_)*E,t[4]=(u*P-a*k-c*C)*E,t[5]=(n*k-i*P+o*C)*E,t[6]=(g*A-p*w-y*b)*E,t[7]=(l*w-h*A+d*b)*E,t[8]=(a*B-s*P+c*x)*E,t[9]=(r*P-n*B-o*x)*E,t[10]=(p*O-v*A+y*m)*E,t[11]=(f*A-l*O-d*m)*E,t[12]=(s*C-a*S-u*x)*E,t[13]=(n*S-r*C+i*x)*E,t[14]=(v*b-p*_-g*m)*E,t[15]=(l*_-f*b+h*m)*E,t):null}function i(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],v=e[12],g=e[13],y=e[14],m=e[15],b=n[0],A=n[1],_=n[2],O=n[3];return t[0]=b*r+A*s+_*f+O*v,t[1]=b*i+A*u+_*h+O*g,t[2]=b*o+A*c+_*d+O*y,t[3]=b*a+A*l+_*p+O*m,b=n[4],A=n[5],_=n[6],O=n[7],t[4]=b*r+A*s+_*f+O*v,t[5]=b*i+A*u+_*h+O*g,t[6]=b*o+A*c+_*d+O*y,t[7]=b*a+A*l+_*p+O*m,b=n[8],A=n[9],_=n[10],O=n[11],t[8]=b*r+A*s+_*f+O*v,t[9]=b*i+A*u+_*h+O*g,t[10]=b*o+A*c+_*d+O*y,t[11]=b*a+A*l+_*p+O*m,b=n[12],A=n[13],_=n[14],O=n[15],t[12]=b*r+A*s+_*f+O*v,t[13]=b*i+A*u+_*h+O*g,t[14]=b*o+A*c+_*d+O*y,t[15]=b*a+A*l+_*p+O*m,t}function o(t,e,n){var r,i,o,a,s,u,c,l,f,h,d,p,v=n[0],g=n[1],y=n[2];return e===t?(t[12]=e[0]*v+e[4]*g+e[8]*y+e[12],t[13]=e[1]*v+e[5]*g+e[9]*y+e[13],t[14]=e[2]*v+e[6]*g+e[10]*y+e[14],t[15]=e[3]*v+e[7]*g+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=d,t[11]=p,t[12]=r*v+s*g+f*y+e[12],t[13]=i*v+u*g+h*y+e[13],t[14]=o*v+c*g+d*y+e[14],t[15]=a*v+l*g+p*y+e[15]),t}function a(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},function(t,e,n){"use strict";n.r(e);var r=n(119),i=n(8),o=n.n(i),a=n(4),s=n.n(a),u=n(30);function c(t,e,n){return l.apply(this,arguments)}function l(){return(l=o()(s.a.mark((function t(e,n,r){var i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("number"!=typeof e){t.next=4;break}return t.next=3,u.a._readToArrayBuffer(e,n,r);case 3:return t.abrupt("return",t.sent);case 4:return e instanceof Blob||(e=new Blob([e])),i=e.slice(n,n+r),t.next=8,f(i);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function f(t){return h.apply(this,arguments)}function h(){return(h=o()(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,n){var r=new FileReader;r.onload=function(e){var n;return t(null==e?void 0:null===(n=e.target)||void 0===n?void 0:n.result)},r.onerror=function(t){return n(t)},r.readAsArrayBuffer(e)}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var d=n(116),p=n(93),v=n(109),g=n(122);function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t=Object(d.b)(t),!p.c){var n=u.a.readFileSync(t,e);return"string"!=typeof n?Object(v.d)(n):n}return e.nothrow||Object(g.a)(!1),null}var m=n(117);function b(t,e,n){return A.apply(this,arguments)}function A(){return(A=o()(s.a.mark((function t(e,n,r){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=Object(d.b)(e),p.c){t.next=4;break}return t.next=4,u.a.writeFile(e,Object(m.c)(n),{flag:"w"});case 4:Object(g.a)(!1);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _(t,e,n){t=Object(d.b)(t),p.c||u.a.writeFileSync(t,Object(m.c)(e),{flag:"w"}),Object(g.a)(!1)}var O=n(66),w=n(127),x=n(100),C=n(121),P=n(23),S=n.n(P),B=n(65),k=n(139),E=n(112),T=n(84);function j(t,e,n,r){Object(g.a)(!r||"object"===S()(r)),Array.isArray(e)||Object(B.a)(e)||(r=void 0,n=e,e=void 0),n=n||{};var i=e,o=Object(E.b)(i,r),a=Object(x.b)(t,o,n);if(!a)return null;n=Object(O.d)(n,a,o);var s=Object(T.b)(t).url;return function(t,e,n,r){if(e=Object(k.b)(e,t,n),t.parseTextSync&&"string"==typeof e)return t.parseTextSync(e,n);if(t.parseSync&&e instanceof ArrayBuffer)return t.parseSync(e,n,r);throw new Error("".concat(t.name," loader: 'parseSync' not supported by this loader, use 'parse' instead. ").concat(r.url||""))}(a,t,n,r=Object(E.a)({url:s,parseSync:j,parse:function(){throw new Error("parseSync called parse")},loaders:e},n))}var M=n(22),I=n.n(M),R=n(68),D=n.n(R),L=n(51),F=n.n(L),G=n(60),N=n.n(G),U=n(258),z=n.n(U),H=n(168);function V(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?V(Object(n),!0).forEach((function(e){I()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function W(t,e,n,r){return K.apply(this,arguments)}function K(){return(K=o()(s.a.mark((function t(e,n,r,i){var o,a,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Object(g.a)(!i||"object"===S()(i)),Array.isArray(n)||Object(B.a)(n)||(i=void 0,r=n,n=void 0),t.next=4,e;case 4:return e=t.sent,r=r||{},o=Object(T.b)(e),a=o.url,t.next=9,Object(x.a)(e,n,r);case 9:if(u=t.sent){t.next=12;break}return t.abrupt("return",null);case 12:return r=Object(O.d)(r,u,n,a),i=Object(E.a)({url:a,parseInBatches:W,parse:C.a,loaders:n},r,i),t.next=16,X(u,e,r,i);case 16:return t.abrupt("return",t.sent);case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function X(t,e,n,r){var i,o,a,u;return s.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return u=function(){return(u=D()(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o;case 2:return t.delegateYield(z()(N()(e),F.a),"t0",3);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)},a=function(t){return u.apply(this,arguments)},c.next=4,s.a.awrap(q(t,e,n,r));case 4:if(i=c.sent,n.metadata){c.next=7;break}return c.abrupt("return",i);case 7:return o={batchType:"metadata",metadata:{_loader:t,_context:r},data:[],bytesUsed:0},c.abrupt("return",a(i));case 9:case"end":return c.stop()}}),null,null,null,Promise)}function q(t,e,n,r){return Q.apply(this,arguments)}function Q(){return(Q=o()(s.a.mark((function t(e,n,r,i){var o,a,u,c;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=function(){return(c=D()(s.a.mark((function t(){var n,o,u;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F()(Object(H.a)(a));case 2:return n=t.sent,t.next=5,F()(Object(C.a)(n,e,J(J({},r),{},{mimeType:e.mimeTypes[0]}),i));case 5:return o=t.sent,u={mimeType:e.mimeTypes[0],shape:Array.isArray(o)?"row-table":"unknown",batchType:"data",data:o,length:Array.isArray(o)?o.length:1},t.next=9,u;case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)},u=function(){return c.apply(this,arguments)},t.next=4,Object(k.c)(n,r);case 4:return o=t.sent,t.next=7,Z(o,(null==r?void 0:r.transforms)||[]);case 7:if(a=t.sent,!e.parseInBatches){t.next=10;break}return t.abrupt("return",e.parseInBatches(a,r,i));case 10:return t.abrupt("return",u());case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Z(t){return Y.apply(this,arguments)}function Y(){return(Y=o()(s.a.mark((function t(e){var n,r,i,o,a,u,c,l,f=arguments;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=f.length>1&&void 0!==f[1]?f[1]:[],r=e,i=!1,o=!1,t.prev=4,u=N()(n);case 6:return t.next=8,u.next();case 8:if(!(i=!(c=t.sent).done)){t.next=14;break}l=c.value,r=l(r);case 11:i=!1,t.next=6;break;case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(4),o=!0,a=t.t0;case 20:if(t.prev=20,t.prev=21,!i||null==u.return){t.next=25;break}return t.next=25,u.return();case 25:if(t.prev=25,!o){t.next=28;break}throw a;case 28:return t.finish(25);case 29:return t.finish(20);case 30:return t.abrupt("return",r);case 31:case"end":return t.stop()}}),t,null,[[4,16,20,30],[21,,25,29]])})))).apply(this,arguments)}var $=n(223);function tt(t,e,n,r){Array.isArray(e)||Object(B.a)(e)||(void 0,n=e,e=null);var i=Object(O.a)(n||{});return Array.isArray(t)?t.map((function(t){return et(t,e,n,i)})):et(t,e,n,i)}function et(t,e,n,r){return nt.apply(this,arguments)}function nt(){return(nt=o()(s.a.mark((function t(e,n,r,i){var o,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e){t.next=8;break}return o=e,t.next=4,i(o);case 4:return a=t.sent,t.next=7,W(a,n,r);case 7:return t.abrupt("return",t.sent);case 8:return t.next=10,W(e,n,r);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var rt=n(230),it=n(147),ot=n(199),at=n(190);function st(t,e){return ut.apply(this,arguments)}function ut(){return(ut=o()(s.a.mark((function t(e,n){var r,i,o,a,u,c,l,f,h,d,p,v=arguments;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=v.length>2&&void 0!==v[2]?v[2]:{},i=v.length>3&&void 0!==v[3]?v[3]:{},o=Object(ot.a)(e),a=it.a.getWorkerFarm(r),u=r.source,c={name:o,source:u},u||(c.url=Object(ot.b)(e,r)),l=a.getWorkerPool(c),f=r.jobName||e.name,t.next=11,l.startJob(f,ct.bind(null,i));case 11:return h=t.sent,d=Object(at.b)(r),h.postMessage("process",{input:n,options:d}),t.next=16,h.result;case 16:return p=t.sent,t.abrupt("return",p.result);case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ct(t,e,n,r){return lt.apply(this,arguments)}function lt(){return(lt=o()(s.a.mark((function t(e,n,r,i){var o,a,u,c,l;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r,t.next="done"===t.t0?3:"error"===t.t0?5:"process"===t.t0?7:23;break;case 3:return n.done(i),t.abrupt("break",24);case 5:return n.error(new Error(i.error)),t.abrupt("break",24);case 7:if(o=i.id,a=i.input,u=i.options,t.prev=8,e.process){t.next=12;break}return n.postMessage("error",{id:o,error:"Worker not set up to process on main thread"}),t.abrupt("return");case 12:return t.next=14,e.process(a,u);case 14:c=t.sent,n.postMessage("done",{id:o,result:c}),t.next=22;break;case 18:t.prev=18,t.t1=t.catch(8),l=t.t1 instanceof Error?t.t1.message:"unknown error",n.postMessage("error",{id:o,error:l});case 22:return t.abrupt("break",24);case 23:console.warn("process-on-worker: unknown message ".concat(r));case 24:case"end":return t.stop()}}),t,null,[[8,18]])})))).apply(this,arguments)}function ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(n),!0).forEach((function(e){I()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function dt(t,e,n){return pt.apply(this,arguments)}function pt(){return(pt=o()(s.a.mark((function t(e,n,i){var o,a,u,c,l,f,h,d,g,y,m,A,_;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=Object(O.b)(),i=ht(ht({},o),i),!Object(rt.a)(n,i)){t.next=6;break}return t.next=5,st(n,e,i);case 5:return t.abrupt("return",t.sent);case 6:if(!n.encode){t.next=10;break}return t.next=9,n.encode(e,i);case 9:return t.abrupt("return",t.sent);case 10:if(!n.encodeSync){t.next=12;break}return t.abrupt("return",n.encodeSync(e,i));case 12:if(!n.encodeText){t.next=18;break}return t.t0=new TextEncoder,t.next=16,n.encodeText(e,i);case 16:return t.t1=t.sent,t.abrupt("return",t.t0.encode.call(t.t0,t.t1));case 18:if(!n.encodeInBatches){t.next=50;break}a=mt(e,n,i),u=[],c=!1,l=!1,t.prev=23,h=N()(a);case 25:return t.next=27,h.next();case 27:if(!(c=!(d=t.sent).done)){t.next=33;break}g=d.value,u.push(g);case 30:c=!1,t.next=25;break;case 33:t.next=39;break;case 35:t.prev=35,t.t2=t.catch(23),l=!0,f=t.t2;case 39:if(t.prev=39,t.prev=40,!c||null==h.return){t.next=44;break}return t.next=44,h.return();case 44:if(t.prev=44,!l){t.next=47;break}throw f;case 47:return t.finish(44);case 48:return t.finish(39);case 49:return t.abrupt("return",v.b.apply(void 0,u));case 50:if(p.c||!n.encodeURLtoURL){t.next=62;break}return y=_t("input"),t.next=54,b(y,e);case 54:return m=_t("output"),t.next=57,bt(y,m,n,i);case 57:return A=t.sent,t.next=60,Object(r.a)(A);case 60:return _=t.sent,t.abrupt("return",_.arrayBuffer());case 62:throw new Error("Writer could not encode data");case 63:case"end":return t.stop()}}),t,null,[[23,35,39,49],[40,,44,48]])})))).apply(this,arguments)}function vt(t,e,n){if(e.encodeSync)return e.encodeSync(t,n);throw new Error("Writer could not synchronously encode data")}function gt(t,e,n){return yt.apply(this,arguments)}function yt(){return(yt=o()(s.a.mark((function t(e,n,r){var i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.text||!n.encodeText){t.next=4;break}return t.next=3,n.encodeText(e,r);case 3:return t.abrupt("return",t.sent);case 4:if(!n.text||!n.encode&&!n.encodeInBatches){t.next=9;break}return t.next=7,dt(e,n,r);case 7:return i=t.sent,t.abrupt("return",(new TextDecoder).decode(i));case 9:throw new Error("Writer could not encode data as text");case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mt(t,e,n){if(e.encodeInBatches){var r=function(t){return[{table:t,start:0,end:t.length}]}(t);return e.encodeInBatches(r,n)}throw new Error("Writer could not encode data in batches")}function bt(t,e,n,r){return At.apply(this,arguments)}function At(){return(At=o()(s.a.mark((function t(e,n,r,i){var o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=Object(d.b)(e),n=Object(d.b)(n),!p.c&&r.encodeURLtoURL){t.next=4;break}throw new Error;case 4:return t.next=6,r.encodeURLtoURL(e,n,i);case 6:return o=t.sent,t.abrupt("return",o);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _t(t){return"/tmp/".concat(t)}function Ot(t,e,n,r){return wt.apply(this,arguments)}function wt(){return(wt=o()(s.a.mark((function t(e,n,r,i){var o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,dt(e,r,i);case 2:return o=t.sent,t.next=5,b(n,o);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function xt(t,e,n,r){return _(e,vt(t,n,r))}var Ct=n(231),Pt=n(141);function St(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Bt(t,e){var n=t[Symbol.asyncIterator]?t[Symbol.asyncIterator]():t[Symbol.iterator]();return new ReadableStream({type:"bytes",pull:function(t){return o()(s.a.mark((function e(){var r,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.next();case 3:r=e.sent,i=r.done,o=r.value,i?t.close():t.enqueue(new Uint8Array(o)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},cancel:function(){return o()(s.a.mark((function t(){var e;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null==n?void 0:null===(e=n.return)||void 0===e?void 0:e.call(n);case 2:case"end":return t.stop()}}),t)})))()}},function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?St(Object(n),!0).forEach((function(e){I()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({highWaterMark:Math.pow(2,24)},e))}var kt={name:"Null loader",id:"null",module:"core",version:"3.3.0-alpha.5",worker:!0,mimeTypes:["application/x.empty"],extensions:["null"],tests:[function(){return!1}],options:{null:{}}};function Et(t,e,n){return e.null.echoParameters?{arrayBuffer:t,options:e,context:n=n&&JSON.parse(JSON.stringify(n))}:null}var Tt,jt,Mt={name:"Null loader",id:"null",module:"core",version:"3.3.0-alpha.5",mimeTypes:["application/x.empty"],extensions:["null"],parse:(jt=o()(s.a.mark((function t(e,n,r){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Et(e,n,r));case 1:case"end":return t.stop()}}),t)}))),function(t,e,n){return jt.apply(this,arguments)}),parseSync:Et,parseInBatches:(Tt=D()(s.a.mark((function t(e,n,r){var i,o,a,u,c,l;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=!1,o=!1,t.prev=2,u=N()(e);case 4:return t.next=6,F()(u.next());case 6:if(!(i=!(c=t.sent).done)){t.next=13;break}return l=c.value,t.next=10,Et(l,n,r);case 10:i=!1,t.next=4;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(2),o=!0,a=t.t0;case 19:if(t.prev=19,t.prev=20,!i||null==u.return){t.next=24;break}return t.next=24,F()(u.return());case 24:if(t.prev=24,!o){t.next=27;break}throw a;case 27:return t.finish(24);case 28:return t.finish(19);case 29:case"end":return t.stop()}}),t,null,[[2,15,19,29],[20,,24,28]])}))),function(t,e,n){return Tt.apply(this,arguments)}),tests:[function(){return!1}],options:{null:{echoParameters:!1}}},It=n(232);function Rt(t,e){return Dt.apply(this,arguments)}function Dt(){return(Dt=o()(s.a.mark((function t(e,n){var r,i,a,u,c,l,f=arguments;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=f.length>2&&void 0!==f[2]?f[2]:function(){},i=f.length>3&&void 0!==f[3]?f[3]:function(){},t.next=4,e;case 4:if((e=t.sent).ok){t.next=7;break}return t.abrupt("return",e);case 7:if(a=e.body){t.next=10;break}return t.abrupt("return",e);case 10:if(u=e.headers.get("content-length")||0,c=u&&parseInt(u),u>0){t.next=14;break}return t.abrupt("return",e);case 14:if("undefined"!=typeof ReadableStream&&a.getReader){t.next=16;break}return t.abrupt("return",e);case 16:return l=new ReadableStream({start:function(t){return o()(s.a.mark((function e(){var o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.getReader(),e.next=3,Lt(t,o,0,c,n,r,i);case 3:case"end":return e.stop()}}),e)})))()}}),t.abrupt("return",new Response(l));case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Lt(t,e,n,r,i,o,a){return Ft.apply(this,arguments)}function Ft(){return(Ft=o()(s.a.mark((function t(e,n,r,i,o,a,u){var c,l,f,h;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.read();case 3:if(c=t.sent,l=c.done,f=c.value,!l){t.next=10;break}return a(),e.close(),t.abrupt("return");case 10:return r+=f.byteLength,h=Math.round(r/i*100),o(h,{loadedBytes:r,totalBytes:i}),e.enqueue(f),t.next=16,Lt(e,n,r,i,o,a,u);case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(0),e.error(t.t0),u(t.t0);case 22:case"end":return t.stop()}}),t,null,[[0,18]])})))).apply(this,arguments)}var Gt=n(11),Nt=n.n(Gt),Ut=n(16),zt=n.n(Ut),Ht=n(6),Vt=function(){function t(e,n){Nt()(this,t),Object(Ht.a)(this,"_fetch",void 0),Object(Ht.a)(this,"files",{}),Object(Ht.a)(this,"lowerCaseFiles",{}),Object(Ht.a)(this,"usedFiles",{}),this._fetch=(null==n?void 0:n.fetch)||fetch;for(var r=0;r<e.length;++r){var i=e[r];this.files[i.name]=i,this.lowerCaseFiles[i.name.toLowerCase()]=i,this.usedFiles[i.name]=!1}this.fetch=this.fetch.bind(this)}var e,n,r,i,a,u,c;return zt()(t,[{key:"fetch",value:(c=o()(s.a.mark((function t(e,n){var r,i,o,a,u,c,l,f,h;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.includes("://")){t.next=2;break}return t.abrupt("return",this._fetch(e,n));case 2:if(r=this.files[e]){t.next=5;break}return t.abrupt("return",new Response(e,{status:400,statusText:"NOT FOUND"}));case 5:if(i=new Headers(null==n?void 0:n.headers),o=i.get("Range"),!(a=o&&/bytes=($1)-($2)/.exec(o))){t.next=17;break}return u=parseInt(a[1]),c=parseInt(a[2]),t.next=13,r.slice(u,c).arrayBuffer();case 13:return l=t.sent,f=new Response(l),Object.defineProperty(f,"url",{value:e}),t.abrupt("return",f);case 17:return h=new Response(r),Object.defineProperty(h,"url",{value:e}),t.abrupt("return",h);case 20:case"end":return t.stop()}}),t,this)}))),function(t,e){return c.apply(this,arguments)})},{key:"readdir",value:(u=o()(s.a.mark((function t(e){var n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r in n=[],this.files)n.push(r);return t.abrupt("return",n);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"stat",value:(a=o()(s.a.mark((function t(e,n){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.files[e]){t.next=3;break}throw new Error(e);case 3:return t.abrupt("return",{size:r.size});case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"unlink",value:(i=o()(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:delete this.files[e],delete this.lowerCaseFiles[e],this.usedFiles[e]=!0;case 3:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"open",value:(r=o()(s.a.mark((function t(e,n,r){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.files[e]);case 1:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return r.apply(this,arguments)})},{key:"read",value:(n=o()(s.a.mark((function t(e,n){var r,i,o,a,u=arguments;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u.length>2&&void 0!==u[2]&&u[2],r=u.length>3&&void 0!==u[3]?u[3]:n.byteLength,u.length>4&&void 0!==u[4]&&u[4],i=e,o=0,t.next=7,i.slice(o,o+r).arrayBuffer();case 7:return a=t.sent,t.abrupt("return",{bytesRead:r,buffer:a});case 9:case"end":return t.stop()}}),t)}))),function(t,e){return n.apply(this,arguments)})},{key:"close",value:(e=o()(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"_getFile",value:function(t,e){var n=this.files[t]||this.lowerCaseFiles[t];return n&&e&&(this.usedFiles[t]=!0),n}}]),t}(),Jt=n(148),Wt=n(32);n.d(e,"fetchFile",(function(){return r.a})),n.d(e,"readArrayBuffer",(function(){return c})),n.d(e,"readFileSync",(function(){return y})),n.d(e,"writeFile",(function(){return b})),n.d(e,"writeFileSync",(function(){return _})),n.d(e,"setLoaderOptions",(function(){return O.e})),n.d(e,"getLoaderOptions",(function(){return O.b})),n.d(e,"registerLoaders",(function(){return w.c})),n.d(e,"selectLoader",(function(){return x.a})),n.d(e,"selectLoaderSync",(function(){return x.b})),n.d(e,"parse",(function(){return C.a})),n.d(e,"parseSync",(function(){return j})),n.d(e,"parseInBatches",(function(){return W})),n.d(e,"load",(function(){return $.a})),n.d(e,"loadInBatches",(function(){return tt})),n.d(e,"encode",(function(){return dt})),n.d(e,"encodeSync",(function(){return vt})),n.d(e,"encodeInBatches",(function(){return mt})),n.d(e,"encodeText",(function(){return gt})),n.d(e,"encodeURLtoURL",(function(){return bt})),n.d(e,"save",(function(){return Ot})),n.d(e,"saveSync",(function(){return xt})),n.d(e,"setPathPrefix",(function(){return d.c})),n.d(e,"getPathPrefix",(function(){return d.a})),n.d(e,"resolvePath",(function(){return d.b})),n.d(e,"RequestScheduler",(function(){return Ct.a})),n.d(e,"makeIterator",(function(){return Pt.a})),n.d(e,"makeStream",(function(){return Bt})),n.d(e,"NullWorkerLoader",(function(){return kt})),n.d(e,"NullLoader",(function(){return Mt})),n.d(e,"JSONLoader",(function(){return It.a})),n.d(e,"_fetchProgress",(function(){return Rt})),n.d(e,"_BrowserFileSystem",(function(){return Vt})),n.d(e,"_unregisterLoaders",(function(){return w.a})),n.d(e,"isBrowser",(function(){return p.c})),n.d(e,"isWorker",(function(){return p.d})),n.d(e,"self",(function(){return p.e})),n.d(e,"window",(function(){return p.f})),n.d(e,"global",(function(){return p.b})),n.d(e,"document",(function(){return p.a})),n.d(e,"assert",(function(){return g.a})),n.d(e,"forEach",(function(){return H.b})),n.d(e,"concatenateArrayBuffersAsync",(function(){return H.a})),n.d(e,"makeTextDecoderIterator",(function(){return Jt.c})),n.d(e,"makeTextEncoderIterator",(function(){return Jt.d})),n.d(e,"makeLineIterator",(function(){return Jt.a})),n.d(e,"makeNumberedLineIterator",(function(){return Jt.b})),n.d(e,"isPureObject",(function(){return Wt.h})),n.d(e,"isPromise",(function(){return Wt.g})),n.d(e,"isIterable",(function(){return Wt.d})),n.d(e,"isAsyncIterable",(function(){return Wt.a})),n.d(e,"isIterator",(function(){return Wt.e})),n.d(e,"isResponse",(function(){return Wt.j})),n.d(e,"isReadableStream",(function(){return Wt.i})),n.d(e,"isWritableStream",(function(){return Wt.k}))},function(t,e,n){"use strict";n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return l}));var r=n(23),i={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},o=i.self||i.window||i.global||{},a=i.window||i.self||i.global||{},s=i.global||i.self||i.window||{},u=i.document||{},c=Boolean("object"!==("undefined"==typeof process?"undefined":n.n(r)()(process))||"[object process]"!==String(process)||process.browser),l="function"==typeof importScripts,f="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);f&&parseFloat(f[1])},function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(5),l=n.n(c),f=n(7),h=n.n(f),d=n(2),p=n.n(d),v=n(0),g=n.n(v),y=n(189),m=n(12),b=n(197);function A(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var w=function(t){l()(n,t);var e=O(n);function n(){var t;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o)),g()(u()(t),"_lastRenderIndex",-1),t}return a()(n,[{key:"render",value:function(t){var e=this.gl;return Object(m.n)(e,{framebuffer:t.target}),this._drawLayers(t)}},{key:"_drawLayers",value:function(t){var e=t.target,n=t.moduleParameters,r=t.viewports,i=t.views,o=t.onViewportActive,a=t.clearStack,s=void 0===a||a,u=t.clearCanvas,c=void 0===u||u;t.pass=t.pass||"unknown";var l=this.gl;c&&function(t){var e=t.drawingBufferWidth,n=t.drawingBufferHeight;Object(m.n)(t,{viewport:[0,0,e,n]}),t.clear(16640)}(l),s&&(this._lastRenderIndex=-1);var f,h=[],d=A(r);try{for(d.s();!(f=d.n()).done;){var p=f.value,v=i&&i[p.id];o(p);var g,y=this._getDrawLayerParams(p,t),b=A(p.subViewports||[p]);try{for(b.s();!(g=b.n()).done;){var _=g.value,O=this._drawLayersInViewport(l,{target:e,moduleParameters:n,viewport:_,view:v,pass:t.pass,layers:t.layers},y);h.push(O)}}catch(t){b.e(t)}finally{b.f()}}}catch(t){d.e(t)}finally{d.f()}return h}},{key:"_getDrawLayerParams",value:function(t,e){for(var n=e.layers,r=e.pass,i=e.layerFilter,o=e.cullRect,a=e.effects,s=e.moduleParameters,u=[],c=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},i=function i(o,a){var s,u=o.props._offset,c=o.id,l=o.parent&&o.parent.id;if(!l||l in n||i(o.parent,!1),l in r){var f=r[l]=r[l]||t(n[l],n);s=f(o,a),r[c]=f}else Number.isFinite(u)?(s=u+(n[l]||0),r[c]=null):s=e;return a&&s>=e&&(e=s+1),n[c]=s,s};return i}(this._lastRenderIndex+1),l={layer:n[0],viewport:t,isPicking:r.startsWith("picking"),renderPass:r,cullRect:o},f={},h=0;h<n.length;h++){var d=n[h],p=this._shouldDrawLayer(d,l,i,f),v={shouldDrawLayer:p};p&&(v.layerRenderIndex=c(d,p),v.moduleParameters=this._getModuleParameters(d,a,r,s),v.layerParameters=this.getLayerParameters(d,h,t)),u[h]=v}return u}},{key:"_drawLayersInViewport",value:function(t,e,n){var r=e.layers,i=e.moduleParameters,o=e.pass,a=e.target,s=e.viewport,u=e.view,c=function(t,e){var n=e.moduleParameters,r=e.target,i=e.viewport,o=r&&"default-framebuffer"!==r.id,a=n&&n.devicePixelRatio||Object(m.e)(t),s=o?r.height:t.drawingBufferHeight,u=i;return[u.x*a,s-(u.y+u.height)*a,u.width*a,u.height*a]}(t,{moduleParameters:i,target:a,viewport:s});if(u&&u.props.clear){var l=!0===u.props.clear?{color:!0,depth:!0}:u.props.clear;Object(m.o)(t,{scissorTest:!0,scissor:c},(function(){return Object(b.a)(t,l)}))}var f={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};Object(m.n)(t,{viewport:c});for(var h=0;h<r.length;h++){var d=r[h],p=n[h],v=p.shouldDrawLayer,g=p.layerRenderIndex,y=p.moduleParameters,A=p.layerParameters;if(v&&d.props.pickable&&f.pickableCount++,d.isComposite)f.compositeCount++;else if(v){f.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,g),y.viewport=s;try{d._drawLayer({moduleParameters:y,uniforms:{layerIndex:g},parameters:A})}catch(t){d.raiseError(t,"drawing ".concat(d," to ").concat(o))}}}return f}},{key:"shouldDrawLayer",value:function(t){return!0}},{key:"getModuleParameters",value:function(t,e){return null}},{key:"getLayerParameters",value:function(t,e,n){return t.props.parameters}},{key:"_shouldDrawLayer",value:function(t,e,n,r){if(!(t.props.visible&&this.shouldDrawLayer(t)))return!1;e.layer=t;for(var i=t.parent;i;){if(!i.props.visible||!i.filterSubLayer(e))return!1;e.layer=i,i=i.parent}if(n){var o=e.layer.id;if(o in r||(r[o]=n(e)),!r[o])return!1}return t.activateViewport(e.viewport),!0}},{key:"_getModuleParameters",value:function(t,e,n,r){var i,o=Object.assign(Object.create((null===(i=t.internalState)||void 0===i?void 0:i.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:Object(m.e)(this.gl)});if(e){var a,s=A(e);try{for(s.s();!(a=s.n()).done;){var u,c=a.value;Object.assign(o,null===(u=c.getModuleParameters)||void 0===u?void 0:u.call(c,t))}}catch(t){s.e(t)}finally{s.f()}}return Object.assign(o,this.getModuleParameters(t,e),r)}}]),n}(y.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return M}));var r=n(0),i=n.n(r),o=n(15),a=n.n(o),s=n(1),u=n.n(s),c=n(3),l=n.n(c),f=n(9),h=n.n(f),d=n(10),p=n.n(d),v=n(5),g=n.n(v),y=n(7),m=n.n(y),b=n(2),A=n.n(b),_=n(12),O=n(57),w=n(123),x=n(125),C=n(197),P=n(212),S=n(264),B=n(69),k=n(17);function E(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return T(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=A()(t);if(e){var i=A()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var M=function(t,e){g()(r,t);var n=j(r);function r(t){var e;u()(this,r);var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e=n.call(this,t,i)).width=null,e.height=null,e.attachments={},e.readBuffer=36064,e.drawBuffers=[36064],e.ownResources=[],e.initialize(i),Object.seal(h()(e)),e}return l()(r,[{key:e,get:function(){return"Framebuffer"}},{key:"MAX_COLOR_ATTACHMENTS",get:function(){var t=Object(_.a)(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}},{key:"MAX_DRAW_BUFFERS",get:function(){var t=Object(_.a)(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}},{key:"color",get:function(){return this.attachments[36064]||null}},{key:"texture",get:function(){return this.attachments[36064]||null}},{key:"depth",get:function(){return this.attachments[36096]||this.attachments[33306]||null}},{key:"stencil",get:function(){return this.attachments[36128]||this.attachments[33306]||null}},{key:"initialize",value:function(t){var e=t.width,n=void 0===e?1:e,r=t.height,i=void 0===r?1:r,o=t.attachments,a=void 0===o?null:o,s=t.color,u=void 0===s||s,c=t.depth,l=void 0===c||c,f=t.stencil,h=void 0!==f&&f,d=t.check,p=void 0===d||d,v=t.readBuffer,g=void 0===v?void 0:v,y=t.drawBuffers,m=void 0===y?void 0:y;if(Object(k.a)(n>=0&&i>=0,"Width and height need to be integers"),this.width=n,this.height=i,a)for(var b in a){var A=a[b];(Array.isArray(A)?A[0]:A).resize({width:n,height:i})}else a=this._createDefaultAttachments(u,l,h,n,i);this.update({clearAttachments:!0,attachments:a,readBuffer:g,drawBuffers:m}),a&&p&&this.checkStatus()}},{key:"delete",value:function(){var t,e=E(this.ownResources);try{for(e.s();!(t=e.n()).done;){t.value.delete()}}catch(t){e.e(t)}finally{e.f()}return p()(A()(r.prototype),"delete",this).call(this),this}},{key:"update",value:function(t){var e=t.attachments,n=void 0===e?{}:e,r=t.readBuffer,i=t.drawBuffers,o=t.clearAttachments,a=void 0!==o&&o,s=t.resizeAttachments,u=void 0===s||s;this.attach(n,{clearAttachments:a,resizeAttachments:u});var c=this.gl,l=c.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),c.bindFramebuffer(36160,l||null),this}},{key:"resize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,n=t.height;if(null===this.handle)return Object(k.a)(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;for(var r in void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&_.k.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n))(),this.attachments)this.attachments[r].resize({width:e,height:n});return this.width=e,this.height=n,this}},{key:"attach",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.clearAttachments,i=void 0!==r&&r,o=n.resizeAttachments,s=void 0===o||o,u={};i&&Object.keys(this.attachments).forEach((function(t){u[t]=null})),Object.assign(u,t);var c=this.gl.bindFramebuffer(36160,this.handle);for(var l in u){Object(k.a)(void 0!==l,"Misspelled framebuffer binding point?");var f=Number(l),h=u[f],d=h;if(d)if(d instanceof x.a)this._attachRenderbuffer({attachment:f,renderbuffer:d});else if(Array.isArray(h)){var p=a()(h,3),v=p[0],g=p[1],y=void 0===g?0:g,m=p[2],b=void 0===m?0:m;d=v,this._attachTexture({attachment:f,texture:v,layer:y,level:b})}else this._attachTexture({attachment:f,texture:d,layer:0,level:0});else this._unattach(f);s&&d&&d.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,c||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter((function(t){return!e.attachments[t]})).forEach((function(t){delete e.attachments[t]}))}},{key:"checkStatus",value:function(){this.gl;var t=this.getStatus();if(36053!==t)throw new Error(I(t));return this}},{key:"getStatus",value:function(){var t=this.gl,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}},{key:"clear",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.color,r=e.depth,i=e.stencil,o=e.drawBuffers,a=void 0===o?[]:o,s=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&Object(C.a)(this.gl,{color:n,depth:r,stencil:i}),a.forEach((function(e,n){Object(C.b)(t.gl,{drawBuffer:n,value:e})})),this.gl.bindFramebuffer(36160,s||null),this}},{key:"readPixels",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.k.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}},{key:"readPixelsToBuffer",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.k.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}},{key:"copyToDataUrl",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.k.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}},{key:"copyToImage",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.k.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}},{key:"copyToTexture",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.k.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}},{key:"blit",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _.k.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}},{key:"invalidate",value:function(t){var e=t.attachments,n=void 0===e?[]:e,r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,s=t.width,u=t.height,c=Object(_.a)(this.gl),l=c.bindFramebuffer(36008,this.handle);return 0===i&&0===a&&void 0===s&&void 0===u?c.invalidateFramebuffer(36008,n):c.invalidateFramebuffer(36008,n,i,a,s,u),c.bindFramebuffer(36008,l),this}},{key:"getAttachmentParameter",value:function(t,e,n){var r=this._getAttachmentParameterFallback(e);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=Object(B.a)(this.gl,r)),r}},{key:"getAttachmentParameters",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[],i={},o=E(r);try{for(o.s();!(t=o.n()).done;){var a=t.value,s=n?Object(B.a)(this.gl,a):a;i[s]=this.getAttachmentParameter(e,a,n)}}catch(t){o.e(t)}finally{o.f()}return i}},{key:"getParameters",value:function(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=Object.keys(this.attachments),n={},r=0,i=e;r<i.length;r++){var o=i[r],a=Number(o),s=t?Object(B.a)(this.gl,a):a;n[s]=this.getAttachmentParameters(a,t)}return n}},{key:"show",value:function(){return"undefined"!=typeof window&&window.open(Object(P.a)(this),"luma-debug-texture"),this}},{key:"log",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t>_.k.level||"undefined"==typeof window)return this;e=e||"Framebuffer ".concat(this.id);var n=Object(P.a)(this,{targetMaxHeight:100});return _.k.image({logLevel:t,message:e,image:n},e)(),this}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=void 0===e?36160:e;return this.gl.bindFramebuffer(n,this.handle),this}},{key:"unbind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.target,n=void 0===e?36160:e;return this.gl.bindFramebuffer(n,null),this}},{key:"_createDefaultAttachments",value:function(t,e,n,r,o){var a,s=null;t&&((s=s||{})[36064]=new w.a(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:o,mipmaps:!1,parameters:(a={},i()(a,10241,9729),i()(a,10240,9729),i()(a,10242,33071),i()(a,10243,33071),a)}),this.ownResources.push(s[36064]));return e&&n?((s=s||{})[33306]=new x.a(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(s[33306])):e?((s=s||{})[36096]=new x.a(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:o}),this.ownResources.push(s[36096])):n&&Object(k.a)(!1),s}},{key:"_unattach",value:function(t){var e=this.attachments[t];e&&(e instanceof x.a?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}},{key:"_attachRenderbuffer",value:function(t){var e=t.attachment,n=void 0===e?36064:e,r=t.renderbuffer;this.gl.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}},{key:"_attachTexture",value:function(t){var e=t.attachment,n=void 0===e?36064:e,r=t.texture,i=t.layer,o=t.level,a=this.gl;switch(a.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:Object(_.a)(a).framebufferTextureLayer(36160,n,r.target,o,i);break;case 34067:var s=function(t){return t<34069?t+34069:t}(i);a.framebufferTexture2D(36160,n,s,r.handle,o);break;case 3553:a.framebufferTexture2D(36160,n,3553,r.handle,o);break;default:Object(k.a)(!1,"Illegal texture type")}a.bindTexture(r.target,null),this.attachments[n]=r}},{key:"_setReadBuffer",value:function(t){var e=Object(_.g)(this.gl);e?e.readBuffer(t):Object(k.a)(36064===t||1029===t,"Multiple render targets not supported"),this.readBuffer=t}},{key:"_setDrawBuffers",value:function(t){var e=this.gl,n=Object(_.a)(e);if(n)n.drawBuffers(t);else{var r=e.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(t):Object(k.a)(1===t.length&&(36064===t[0]||1029===t[0]),"Multiple render targets not supported")}this.drawBuffers=t}},{key:"_getAttachmentParameterFallback",value:function(t){var e=Object(S.a)(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}},{key:"_createHandle",value:function(){return this.gl.createFramebuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteFramebuffer(this.handle)}},{key:"_bindHandle",value:function(t){return this.gl.bindFramebuffer(36160,t)}}],[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.colorBufferFloat,r=e.colorBufferHalfFloat,i=!0;return n&&(i=Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),r&&(i=i&&Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),i}},{key:"getDefaultFramebuffer",value:function(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new r(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}}]),r}(O.a,Symbol.toStringTag);function I(t){return(M.STATUS||{})[t]||"Framebuffer error ".concat(t)}M.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303]},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=function(){function t(e){i()(this,t),u()(this,"_inProgress",void 0),u()(this,"_handle",void 0),u()(this,"_timeline",void 0),u()(this,"time",void 0),u()(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}return a()(t,[{key:"inProgress",get:function(){return this._inProgress}},{key:"start",value:function(t){var e,n;this.cancel(),this.settings=t,this._inProgress=!0,null===(e=(n=this.settings).onStart)||void 0===e||e.call(n,this)}},{key:"end",value:function(){var t,e;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(t=(e=this.settings).onEnd)||void 0===t||t.call(e,this))}},{key:"cancel",value:function(){var t,e;this._inProgress&&(null===(t=(e=this.settings).onInterrupt)||void 0===t||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}},{key:"update",value:function(){var t,e;if(!this._inProgress)return!1;if(null===this._handle){var n=this._timeline,r=this.settings;this._handle=n.addChannel({delay:n.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(t=(e=this.settings).onUpdate)||void 0===t||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}},{key:"_onUpdate",value:function(){}}]),t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));var r="vs",i="fs"},function(t,e,n){"use strict";n.d(e,"a",(function(){return P}));var r,i=n(54),o=n.n(i),a=n(55),s=n.n(a),u=n(58),c=n.n(u),l=n(59),f=n.n(l),h=n(43),d=n.n(h),p=n(188),v=n(34),g=n(78),y=n(40),m=n(50),b=n(39),A=n(53);function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(r||(r={}));var O,w,x=45*Math.PI/180,C=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),P=function(t){c()(n,t);var e=_(n);function n(t){var r;return o()(this,n),r=e.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?r.copy(t):r.identity(),r}return s()(n,[{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}},{key:"INDICES",get:function(){return r}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}},{key:"set",value:function(t,e,n,r,i,o,a,s,u,c,l,f,h,d,p,v){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=a,this[7]=s,this[8]=u,this[9]=c,this[10]=l,this[11]=f,this[12]=h,this[13]=d,this[14]=p,this[15]=v,this.check()}},{key:"setRowMajor",value:function(t,e,n,r,i,o,a,s,u,c,l,f,h,d,p,v){return this[0]=t,this[1]=i,this[2]=u,this[3]=h,this[4]=e,this[5]=o,this[6]=c,this[7]=d,this[8]=n,this[9]=a,this[10]=l,this[11]=p,this[12]=r,this[13]=s,this[14]=f,this[15]=v,this.check()}},{key:"toRowMajor",value:function(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}},{key:"identity",value:function(){return this.copy(C)}},{key:"fromObject",value:function(t){return this.check()}},{key:"fromQuaternion",value:function(t){return y.c(this,t),this.check()}},{key:"frustum",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,o=t.near,a=void 0===o?.1:o,s=t.far,u=void 0===s?500:s;return u===1/0?function(t,e,n,r,i,o){var a=2*o/(n-e),s=2*o/(i-r),u=(n+e)/(n-e),c=(i+r)/(i-r),l=-2*o;t[0]=a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=u,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0}(this,e,n,r,i,a):y.d(this,e,n,r,i,a,u),this.check()}},{key:"lookAt",value:function(t){var e=t.eye,n=t.center,r=void 0===n?[0,0,0]:n,i=t.up,o=void 0===i?[0,1,0]:i;return y.g(this,e,r,o),this.check()}},{key:"ortho",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,o=t.near,a=void 0===o?.1:o,s=t.far,u=void 0===s?500:s;return y.i(this,e,n,r,i,a,u),this.check()}},{key:"orthographic",value:function(t){var e=t.fovy,n=void 0===e?x:e,r=t.aspect,i=void 0===r?1:r,o=t.focalDistance,a=void 0===o?1:o,s=t.near,u=void 0===s?.1:s,c=t.far,l=void 0===c?500:c;k(n);var f=n/2,h=a*Math.tan(f),d=h*i;return this.ortho({left:-d,right:d,bottom:-h,top:h,near:u,far:l})}},{key:"perspective",value:function(t){var e=t.fovy,n=void 0===e?45*Math.PI/180:e,r=t.aspect,i=void 0===r?1:r,o=t.near,a=void 0===o?.1:o,s=t.far,u=void 0===s?500:s;return k(n),y.j(this,n,i,a,u),this.check()}},{key:"determinant",value:function(){return y.a(this)}},{key:"getScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}},{key:"getTranslation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}},{key:"getRotation",value:function(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];var n=this.getScale(e),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{key:"getRotationMatrix3",value:function(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];var n=this.getScale(e),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*o,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*o,t}},{key:"transpose",value:function(){return y.q(this,this),this.check()}},{key:"invert",value:function(){return y.f(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return y.h(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return y.h(this,this,t),this.check()}},{key:"rotateX",value:function(t){return y.l(this,this,t),this.check()}},{key:"rotateY",value:function(t){return y.m(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return y.n(this,this,t),this.check()}},{key:"rotateXYZ",value:function(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}},{key:"rotateAxis",value:function(t,e){return y.k(this,this,t,e),this.check()}},{key:"scale",value:function(t){return y.o(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}},{key:"translate",value:function(t){return y.p(this,this,t),this.check()}},{key:"transform",value:function(t,e){return 4===t.length?(e=A.n(e||[-0,-0,-0,-0],t,this),Object(v.b)(e,4),e):this.transformAsPoint(t,e)}},{key:"transformAsPoint",value:function(t,e){var n;switch(t.length){case 2:n=m.j(e||[-0,-0],t,this);break;case 3:n=b.q(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(v.b)(n,t.length),n}},{key:"transformAsVector",value:function(t,e){var n;switch(t.length){case 2:n=Object(g.a)(e||[-0,-0],t,this);break;case 3:n=Object(g.c)(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(v.b)(n,t.length),n}},{key:"transformPoint",value:function(t,e){return this.transformAsPoint(t,e)}},{key:"transformVector",value:function(t,e){return this.transformAsPoint(t,e)}},{key:"transformDirection",value:function(t,e){return this.transformAsVector(t,e)}},{key:"makeRotationX",value:function(t){return this.identity().rotateX(t)}},{key:"makeTranslation",value:function(t,e,n){return this.identity().translate([t,e,n])}}],[{key:"IDENTITY",get:function(){return B()}},{key:"ZERO",get:function(){return S()}}]),n}(p.a);function S(){return O||(O=new P([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(O)),O}function B(){return w||(w=new P,Object.freeze(w)),w}function k(t){if(t>2*Math.PI)throw Error("expected radians")}},,function(t,e,n){"use strict";var r=n(22),i=n.n(r),o=n(23),a=n.n(o),s=n(36),u=n.n(s),c=n(8),l=n.n(c),f=n(4),h=n.n(f),d=n(30),p=n(109),v=n(65),g=n(11),y=n.n(g),m=n(16),b=n.n(m),A=n(6);function _(){return!("object"===("undefined"==typeof process?"undefined":a()(process))&&"[object process]"===String(process)&&!process.browser)||function(t){if("undefined"!=typeof window&&"object"===a()(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"===a()(process.versions)&&Boolean(process.versions.electron))return!0;var e="object"===("undefined"==typeof navigator?"undefined":a()(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}()}_();function O(t){try{var e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(t){return null}}var w,x=function(){function t(e){y()(this,t);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";Object(A.a)(this,"storage",void 0),Object(A.a)(this,"id",void 0),Object(A.a)(this,"config",{}),this.storage=O(r),this.id=e,this.config={},Object.assign(this.config,n),this._loadConfiguration()}return b()(t,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(t){return this.config={},this.updateConfiguration(t)}},{key:"updateConfiguration",value:function(t){if(Object.assign(this.config,t),this.storage){var e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}return this}},{key:"_loadConfiguration",value:function(){var t={};if(this.storage){var e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}]),t}();function C(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));var o=t.width*n,a=t.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),s]}function P(t){return"string"==typeof t?w[t.toUpperCase()]||w.WHITE:t}function S(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return B(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],r=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(r),o=S(i);try{var a=function(){var r=e.value;"function"==typeof t[r]&&(n.find((function(t){return r===t}))||(t[r]=t[r].bind(t)))};for(o.s();!(e=o.n()).done;)a()}catch(t){o.e(t)}finally{o.f()}}function E(t,e){if(!t)throw new Error(e||"Assertion failed")}!function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(w||(w={}));var T={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":a()(process))&&process},j=(globalThis,T.window||T.self||T.global),M=T.process||{};console;function I(){var t,e,n;if(_&&"performance"in j)t=null==j?void 0:null===(e=j.performance)||void 0===e?void 0:null===(n=e.now)||void 0===n?void 0:n.call(e);else if("hrtime"in M){var r,i=null==M?void 0:null===(r=M.hrtime)||void 0===r?void 0:r.call(M);t=1e3*i[0]+i[1]/1e6}else t=Date.now();return t}var R={debug:_&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},D={enabled:!0,level:0};function L(){}var F={},G={once:!0},N=function(){function t(){y()(this,t);var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""},n=e.id;Object(A.a)(this,"id",void 0),Object(A.a)(this,"VERSION","8.8.20"),Object(A.a)(this,"_startTs",I()),Object(A.a)(this,"_deltaTs",I()),Object(A.a)(this,"_storage",void 0),Object(A.a)(this,"userData",{}),Object(A.a)(this,"LOG_THROTTLE_TIMEOUT",0),this.id=n,this._storage=new x("__probe-".concat(this.id,"__"),D),this.userData={},this.timeStamp("".concat(this.id," started")),k(this),Object.seal(this)}return b()(t,[{key:"level",get:function(){return this.getLevel()},set:function(t){this.setLevel(t)}},{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((I()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((I()-this._deltaTs).toPrecision(10))}},{key:"priority",get:function(){return this.level},set:function(t){this.level=t}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:t}),this}},{key:"setLevel",value:function(t){return this._storage.updateConfiguration({level:t}),this}},{key:"get",value:function(t){return this._storage.config[t]}},{key:"set",value:function(t,e){this._storage.updateConfiguration(i()({},t,e))}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"assert",value:function(t,e){E(t,e)}},{key:"warn",value:function(t){return this._getLogFunction(0,t,R.warn,arguments,G)}},{key:"error",value:function(t){return this._getLogFunction(0,t,R.error,arguments)}},{key:"deprecated",value:function(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}},{key:"removed",value:function(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}},{key:"probe",value:function(t,e){return this._getLogFunction(t,e,R.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(t,e){return this._getLogFunction(t,e,R.debug,arguments)}},{key:"info",value:function(t,e){return this._getLogFunction(t,e,console.info,arguments)}},{key:"once",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction(t,e,R.debug||R.info,arguments,G)}},{key:"table",value:function(t,e,n){return e?this._getLogFunction(t,e,console.table||L,n&&[n],{tag:H(e)}):L}},{key:"image",value:function(t){var e=t.logLevel,r=t.priority,i=t.image,o=t.message,a=void 0===o?"":o,s=t.scale,c=void 0===s?1:s;return this._shouldLog(e||r)?_?function(t){var e=t.image,n=t.message,r=void 0===n?"":n,i=t.scale,o=void 0===i?1:i;if("string"==typeof e){var a=new Image;return a.onload=function(){var t,e=C(a,r,o);(t=console).log.apply(t,u()(e))},a.src=e,L}var s=e.nodeName||"";if("img"===s.toLowerCase()){var c;return(c=console).log.apply(c,u()(C(e,r,o))),L}if("canvas"===s.toLowerCase()){var l=new Image;return l.onload=function(){var t;return(t=console).log.apply(t,u()(C(l,r,o)))},l.src=e.toDataURL(),L}return L}({image:i,message:a,scale:c}):function(t){var e=t.image,r=(t.message,t.scale),i=void 0===r?1:r,o=null;try{o=n(301)}catch(t){}if(o)return function(){return o(e,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then((function(t){return console.log(t)}))};return L}({image:i,message:a,scale:c}):L}},{key:"time",value:function(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}},{key:"timeEnd",value:function(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(t,e){return this._getLogFunction(t,e,console.timeStamp||L)}},{key:"group",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1},r=z({logLevel:t,message:e,opts:n}),i=n.collapsed;return r.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}},{key:"groupCollapsed",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}},{key:"groupEnd",value:function(t){return this._getLogFunction(t,"",console.groupEnd||L)}},{key:"withGroup",value:function(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(t){return this.isEnabled()&&this.getLevel()>=U(t)}},{key:"_getLogFunction",value:function(t,e,n,r,i){if(this._shouldLog(t)){var o;i=z({logLevel:t,message:e,args:r,opts:i}),E(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=I();var a=i.tag||i.message;if(i.once){if(F[a])return L;F[a]=I()}return e=function(t,e,n){if("string"==typeof e){var r=n.time?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}((s=n.total)<10?"".concat(s.toFixed(2),"ms"):s<100?"".concat(s.toFixed(1),"ms"):s<1e3?"".concat(s.toFixed(0),"ms"):"".concat((s/1e3).toFixed(2),"s")):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),i=e,o=n.color,a=n.background,_||"string"!=typeof i||(o&&(o=P(o),i="[".concat(o,"m").concat(i,"[39m")),a&&(o=P(a),i="[".concat(a+10,"m").concat(i,"[49m"))),e=i}var i,o,a;var s;return e}(this.id,i.message,i),(o=n).bind.apply(o,[console,e].concat(u()(i.args)))}return L}}]),t}();function U(t){if(!t)return 0;var e;switch(a()(t)){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return E(Number.isFinite(e)&&e>=0),e}function z(t){var e=t.logLevel,n=t.message;t.logLevel=U(e);for(var r=t.args?Array.from(t.args):[];r.length&&r.shift()!==n;);switch(a()(e)){case"string":case"function":void 0!==n&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"==typeof t.message&&(t.message=t.message());var i=a()(t.message);return E("string"===i||"object"===i),Object.assign(t,{args:r},t.opts)}function H(t){for(var e in t)for(var n in t[e])return n||"untitled";return"empty"}Object(A.a)(N,"VERSION","8.8.20");var V=new N({id:"loaders.gl"}),J=n(84),W=n(127),K=n(32);function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Q(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Z(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return $})),n.d(e,"b",(function(){return et}));var Y=/\.([^.]+)$/;function $(t){return tt.apply(this,arguments)}function tt(){return(tt=l()(h.a.mark((function t(e){var n,r,i,o,a=arguments;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:[],r=a.length>2?a[2]:void 0,i=a.length>3?a[3]:void 0,rt(e)){t.next=5;break}return t.abrupt("return",null);case 5:if(!(o=et(e,n,q(q({},r),{},{nothrow:!0}),i))){t.next=8;break}return t.abrupt("return",o);case 8:if(!Object(K.b)(e)){t.next=13;break}return t.next=11,e.slice(0,10).arrayBuffer();case 11:e=t.sent,o=et(e,n,r,i);case 13:if(o||null!=r&&r.nothrow){t.next=15;break}throw new Error(it(e));case 15:return t.abrupt("return",o);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function et(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!rt(t))return null;if(e&&!Array.isArray(e))return Object(v.b)(e);var i,o=[];(e&&(o=o.concat(e)),null!=n&&n.ignoreRegisteredLoaders)||(i=o).push.apply(i,u()(Object(W.b)()));ot(o);var a=nt(t,o,n,r);if(!(a||null!=n&&n.nothrow))throw new Error(it(t));return a}function nt(t,e,n,r){var i,o=Object(J.b)(t),a=o.url,s=o.type,u=a||(null==r?void 0:r.url),c=null,l="";(null!=n&&n.mimeType&&(c=at(e,null==n?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(null==n?void 0:n.mimeType)),c=c||function(t,e){var n=e&&Y.exec(e),r=n&&n[1];return r?function(t,e){e=e.toLowerCase();var n,r=Q(t);try{for(r.s();!(n=r.n()).done;){var i,o=n.value,a=Q(o.extensions);try{for(a.s();!(i=a.n()).done;){if(i.value.toLowerCase()===e)return o}}catch(t){a.e(t)}finally{a.f()}}}catch(t){r.e(t)}finally{r.f()}return null}(t,r):null}(e,u),l=l||(c?"matched url ".concat(u):""),c=c||at(e,s),l=l||(c?"matched MIME type ".concat(s):""),c=c||function(t,e){if(!e)return null;var n,r=Q(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if("string"==typeof e){if(st(e,i))return i}else if(ArrayBuffer.isView(e)){if(ut(e.buffer,e.byteOffset,i))return i}else if(e instanceof ArrayBuffer){if(ut(e,0,i))return i}}}catch(t){r.e(t)}finally{r.f()}return null}(e,t),l=l||(c?"matched initial data ".concat(ct(t)):""),c=c||at(e,null==n?void 0:n.fallbackMimeType),l=l||(c?"matched fallback MIME type ".concat(s):""))&&V.log(1,"selectLoader selected ".concat(null===(i=c)||void 0===i?void 0:i.name,": ").concat(l,"."));return c}function rt(t){return!(t instanceof Response&&204===t.status)}function it(t){var e=Object(J.b)(t),n=e.url,r=e.type,i="No valid loader found (";i+=n?"".concat(d.b.filename(n),", "):"no url provided, ",i+="MIME type: ".concat(r?'"'.concat(r,'"'):"not provided",", ");var o=t?ct(t):"";return i+=o?' first bytes: "'.concat(o,'"'):"first bytes: not available",i+=")"}function ot(t){var e,n=Q(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;Object(v.b)(r)}}catch(t){n.e(t)}finally{n.f()}}function at(t,e){var n,r=Q(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.mimeTypes&&i.mimeTypes.includes(e))return i;if(e==="application/x.".concat(i.id))return i}}catch(t){r.e(t)}finally{r.f()}return null}function st(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some((function(e){return t.startsWith(e)}))}function ut(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((function(r){return function(t,e,n,r){if(r instanceof ArrayBuffer)return Object(p.a)(r,t,r.byteLength);switch(a()(r)){case"function":return r(t,n);case"string":var i=lt(t,e,r.length);return r===i;default:return!1}}(t,e,n,r)}))}function ct(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return lt(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){var n=0;return lt(t,n,e)}return""}function lt(t,e,n){if(t.byteLength<e+n)return"";for(var r=new DataView(t),i="",o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(e+o));return i}},function(t,e,n){"use strict";function r(t,e){if(t===e)return!0;if(Array.isArray(t)){var n=t.length;if(!e||e.length!==n)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function i(t){var e,n={};return function(i){for(var o in i)if(!r(i[o],n[o])){e=t(i),n=i;break}return e}}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return E}));var r=n(15),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(9),l=n.n(c),f=n(10),h=n.n(f),d=n(5),p=n.n(d),v=n(7),g=n.n(v),y=n(2),m=n.n(y),b=n(0),A=n.n(b),_=n(62),O=n(33),w=n(113),x=n(98);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var B=Math.PI/180;function k(t){return 512/4003e4/Math.cos(t*B)}var E=function(t){p()(n,t);var e=S(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a()(this,n);var i,o=r.latitude,s=void 0===o?0:o,u=r.longitude,c=void 0===u?0:u,f=r.zoom,h=void 0===f?0:f,d=r.pitch,p=void 0===d?0:d,v=r.bearing,g=void 0===v?0:v,y=r.nearZMultiplier,m=void 0===y?.1:y,b=r.farZMultiplier,_=void 0===b?100.01:b,w=r.orthographic,C=void 0!==w&&w,S=r.projectionMatrix,B=r.repeat,k=void 0!==B&&B,E=r.worldOffset,T=void 0===E?0:E,j=r.legacyMeterSizes,M=void 0!==j&&j,I=r.width,R=r.height,D=r.altitude,L=void 0===D?1.5:D,F=Math.pow(2,h);I=I||1,R=R||1;var G=null;S?(L=S[5]/2,i=Object(O.b)(L)):(r.fovy?(i=r.fovy,L=Object(O.e)(i)):i=Object(O.b)(L),G=Object(O.j)({width:I,height:R,pitch:p,fovy:i,nearZMultiplier:m,farZMultiplier:_}));var N=Object(O.k)({height:R,pitch:p,bearing:g,scale:F,altitude:L});if(T){var U=(new x.a).translate([512*T,0,0]);N=U.multiplyLeft(N)}return t=e.call(this,P(P(P({},r),{},{width:I,height:R,viewMatrix:N,longitude:c,latitude:s,zoom:h},G),{},{fovy:i,focalDistance:L})),A()(l()(t),"longitude",void 0),A()(l()(t),"latitude",void 0),A()(l()(t),"pitch",void 0),A()(l()(t),"bearing",void 0),A()(l()(t),"altitude",void 0),A()(l()(t),"fovy",void 0),A()(l()(t),"orthographic",void 0),A()(l()(t),"_subViewports",void 0),A()(l()(t),"_pseudoMeters",void 0),t.latitude=s,t.longitude=c,t.zoom=h,t.pitch=p,t.bearing=g,t.altitude=L,t.fovy=i,t.orthographic=C,t._subViewports=k?[]:null,t._pseudoMeters=M,Object.freeze(l()(t)),t}return u()(n,[{key:"subViewports",get:function(){if(this._subViewports&&!this._subViewports.length)for(var t=this.getBounds(),e=Math.floor((t[0]+180)/360),r=Math.ceil((t[2]-180)/360),i=e;i<=r;i++){var o=i?new n(P(P({},this),{},{worldOffset:i})):this;this._subViewports.push(o)}return this._subViewports}},{key:"projectPosition",value:function(t){if(this._pseudoMeters)return h()(m()(n.prototype),"projectPosition",this).call(this,t);var e=this.projectFlat(t),r=i()(e,2);return[r[0],r[1],(t[2]||0)*k(t[1])]}},{key:"unprojectPosition",value:function(t){if(this._pseudoMeters)return h()(m()(n.prototype),"unprojectPosition",this).call(this,t);var e=this.unprojectFlat(t),r=i()(e,2),o=r[0],a=r[1];return[o,a,(t[2]||0)/k(a)]}},{key:"addMetersToLngLat",value:function(t,e){return Object(O.a)(t,e)}},{key:"panByPosition",value:function(t,e){var n=Object(O.n)(e,this.pixelUnprojectionMatrix),r=this.projectFlat(t),o=w.a([],r,w.b([],n)),a=w.a([],this.center,o),s=this.unprojectFlat(a),u=i()(s,2);return{longitude:u[0],latitude:u[1]}}},{key:"getBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object(O.f)(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}},{key:"fitBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,o=Object(O.c)(P({width:r,height:i,bounds:t},e)),a=o.longitude,s=o.latitude,u=o.zoom;return new n({width:r,height:i,longitude:a,latitude:s,zoom:u})}}]),n}(_.a);A()(E,"displayName","WebMercatorViewport")},function(t,e,n){"use strict";n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return h}));var r,i=n(15),o=n.n(i),a=n(0),s=n.n(a),u=n(17),c=(r={},s()(r,5126,[5126,1,"float"]),s()(r,35664,[5126,2,"vec2"]),s()(r,35665,[5126,3,"vec3"]),s()(r,35666,[5126,4,"vec4"]),s()(r,5124,[5124,1,"int"]),s()(r,35667,[5124,2,"ivec2"]),s()(r,35668,[5124,3,"ivec3"]),s()(r,35669,[5124,4,"ivec4"]),s()(r,5125,[5125,1,"uint"]),s()(r,36294,[5125,2,"uvec2"]),s()(r,36295,[5125,3,"uvec3"]),s()(r,36296,[5125,4,"uvec4"]),s()(r,35670,[5126,1,"bool"]),s()(r,35671,[5126,2,"bvec2"]),s()(r,35672,[5126,3,"bvec3"]),s()(r,35673,[5126,4,"bvec4"]),s()(r,35674,[5126,8,"mat2"]),s()(r,35685,[5126,8,"mat2x3"]),s()(r,35686,[5126,8,"mat2x4"]),s()(r,35675,[5126,12,"mat3"]),s()(r,35687,[5126,12,"mat3x2"]),s()(r,35688,[5126,12,"mat3x4"]),s()(r,35676,[5126,16,"mat4"]),s()(r,35689,[5126,16,"mat4x2"]),s()(r,35690,[5126,16,"mat4x3"]),r);function l(t){switch(t){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return Object(u.a)(!1),0}}function f(t){var e=c[t];if(!e)return null;var n=o()(e,2);return{type:n[0],components:n[1]}}function h(t,e){switch(t){case 5120:case 5121:case 5122:case 5123:t=5126}for(var n in c){var r=o()(c[n],3),i=r[0],a=r[1],s=r[2];if(i===t&&a===e)return{glType:n,name:s}}return null}},function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return l})),n.d(e,"c",(function(){return f})),n.d(e,"d",(function(){return h})),n.d(e,"e",(function(){return d}));var r,i,o,a=n(0),s=n.n(a),u=n(12),c=(r={},s()(r,6407,{dataFormat:6407,types:[5121,33635]}),s()(r,6408,{dataFormat:6408,types:[5121,32819,32820]}),s()(r,6406,{dataFormat:6406,types:[5121]}),s()(r,6409,{dataFormat:6409,types:[5121]}),s()(r,6410,{dataFormat:6410,types:[5121]}),s()(r,33326,{dataFormat:6403,types:[5126],gl2:!0}),s()(r,33328,{dataFormat:33319,types:[5126],gl2:!0}),s()(r,34837,{dataFormat:6407,types:[5126],gl2:!0}),s()(r,34836,{dataFormat:6408,types:[5126],gl2:!0}),r),l=(i={},s()(i,6403,1),s()(i,36244,1),s()(i,33319,2),s()(i,33320,2),s()(i,6407,3),s()(i,36248,3),s()(i,6408,4),s()(i,36249,4),s()(i,6402,1),s()(i,34041,1),s()(i,6406,1),s()(i,6409,1),s()(i,6410,2),i),f=(o={},s()(o,5126,4),s()(o,5125,4),s()(o,5124,4),s()(o,5123,2),s()(o,5122,2),s()(o,5131,2),s()(o,5120,1),s()(o,5121,1),o);function h(t,e){var n=c[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;var r=Object(u.j)(t)&&n.gl2||n.gl1;return"string"==typeof r?t.getExtension(r):r}function d(t,e){var n=c[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"d",(function(){return s})),n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return c}));var r=n(25);function i(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}var o,a,s=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},u=function(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)},c=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r};o=new r.a(3),r.a!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),a=o},function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var r=n(54),i=n.n(r),o=n(55),a=n.n(o),s=n(58),u=n.n(s),c=n(59),l=n.n(c),f=n(43),h=n.n(f),d=n(134),p=n(24),v=n(34),g=n(39),y=n(78);function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var b,A=[0,0,0],_=function(t){u()(n,t);var e=m(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return i()(this,n),t=e.call(this,-0,-0,-0),1===arguments.length&&Object(p.f)(r)?t.copy(r):(p.b.debug&&(Object(v.a)(r),Object(v.a)(o),Object(v.a)(a)),t[0]=r,t[1]=o,t[2]=a),t}return a()(n,[{key:"set",value:function(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}},{key:"fromObject",value:function(t){return p.b.debug&&(Object(v.a)(t.x),Object(v.a)(t.y),Object(v.a)(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=Object(v.a)(t)}},{key:"angle",value:function(t){return g.b(this,t)}},{key:"cross",value:function(t){return g.d(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?A:n;return g.m(this,this,r,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?A:n;return g.n(this,this,r,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?A:n;return g.o(this,this,r,e),this.check()}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return g.q(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return Object(y.c)(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return g.p(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){return Object(y.b)(this,this,t),this.check()}},{key:"transformByQuaternion",value:function(t){return g.r(this,this,t),this.check()}}],[{key:"ZERO",get:function(){return b||(b=new n(0,0,0),Object.freeze(b)),b}}]),n}(d.a)},,,function(t,e,n){"use strict";n.d(e,"d",(function(){return u})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return f}));var r=n(23),i=n.n(r),o=n(117);function a(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t){if(Object(o.b)(t))return Object(o.a)(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"==typeof t){var e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"===i()(t)&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function c(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;for(var r=new Uint8Array(t),i=new Uint8Array(e),o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}function l(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,i=e.map((function(t){return t instanceof ArrayBuffer?new Uint8Array(t):t})),o=i.reduce((function(t,e){return t+e.byteLength}),0),s=new Uint8Array(o),u=0,c=a(i);try{for(c.s();!(r=c.n()).done;){var l=r.value;s.set(l,u),u+=l.byteLength}}catch(t){c.e(t)}finally{c.f()}return s.buffer}function f(t,e,n){var r=void 0!==n?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(13);function u(){var t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){var e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}var c=function(){function t(e,n){i()(this,t),Object(s.a)(this,"name",void 0),Object(s.a)(this,"type",void 0),Object(s.a)(this,"sampleSize",1),Object(s.a)(this,"time",void 0),Object(s.a)(this,"count",void 0),Object(s.a)(this,"samples",void 0),Object(s.a)(this,"lastTiming",void 0),Object(s.a)(this,"lastSampleTime",void 0),Object(s.a)(this,"lastSampleCount",void 0),Object(s.a)(this,"_count",0),Object(s.a)(this,"_time",0),Object(s.a)(this,"_samples",0),Object(s.a)(this,"_startTime",0),Object(s.a)(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}return a()(t,[{key:"setSampleSize",value:function(t){return this.sampleSize=t,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(t){return this._count+=t,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(t){return this._count-=t,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=u(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(u()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),t}(),l=function(){function t(e){i()(this,t),Object(s.a)(this,"id",void 0),Object(s.a)(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}return a()(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}},{key:"size",get:function(){return Object.keys(this.stats).length}},{key:"reset",value:function(){for(var t in this.stats)this.stats[t].reset();return this}},{key:"forEach",value:function(t){for(var e in this.stats)t(this.stats[e])}},{key:"getTable",value:function(){var t={};return this.forEach((function(e){t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}},{key:"_initializeStats",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){return t._getOrCreate(e)}))}},{key:"_getOrCreate",value:function(t){if(!t||!t.name)return null;var e=t.name,n=t.type;return this.stats[e]||(this.stats[e]=t instanceof c?t:new c(e,n)),this.stats[e]}}]),t}();n.d(e,"a",(function(){return l}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(25);function i(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function o(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}var a,s;a=new r.a(4),r.a!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0),s=a},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return f}));var r=n(36),i=n.n(r),o=n(22),a=n.n(o),s=n(66);function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){a()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n)return n;var r=c({fetch:Object(s.a)(e,t)},t);return Array.isArray(r.loaders)||(r.loaders=null),r}function f(t,e){if(!e&&t&&!Array.isArray(t))return t;var n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){var r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[].concat(i()(n),i()(r)):r}return n&&n.length?n:null}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(25);function i(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function o(t,e){return t[0]=-e[0],t[1]=-e[1],t}var a,s;a=new r.a(2),r.a!=Float32Array&&(a[0]=0,a[1]=0),s=a},,,function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s}));var r="",i={};function o(t){r=t}function a(){return r}function s(t){for(var e in i)if(t.startsWith(e)){var n=i[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t="".concat(r).concat(t)),t}},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return u}));var r=n(23),i=n.n(r),o=n(206);function a(t){return t&&"object"===i()(t)&&t.isBuffer}function s(t){return o.toBuffer?o.toBuffer(t):t}function u(t){return a(t)?new Uint8Array(t.buffer,t.byteOffset,t.length).slice().buffer:t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=n(106),l=[255,255,255],f=[0,0,-1],h=0,d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t),u()(this,"id",void 0),u()(this,"color",void 0),u()(this,"intensity",void 0),u()(this,"type","directional"),u()(this,"direction",void 0),u()(this,"shadow",void 0);var n=e.color,r=void 0===n?l:n,o=e.intensity,a=void 0===o?1:o,s=e.direction,d=void 0===s?f:s,p=e._shadow,v=void 0!==p&&p;this.id=e.id||"directional-".concat(h++),this.color=r,this.intensity=a,this.type="directional",this.direction=new c.a(d).normalize().toArray(),this.shadow=v}return a()(t,[{key:"getProjectedLight",value:function(t){return this}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(8),i=n.n(r),o=n(4),a=n.n(o),s=n(116),u=n(124);function c(t,e){return l.apply(this,arguments)}function l(){return(l=i()(a.a.mark((function t(e,n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e){t.next=7;break}return e=Object(s.b)(e),r=n,null!=n&&n.fetch&&"function"!=typeof(null==n?void 0:n.fetch)&&(r=n.fetch),t.next=6,fetch(e,r);case 6:return t.abrupt("return",t.sent);case 7:return t.next=9,Object(u.b)(e);case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},function(t,e,n){"use strict";var r={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},i="#define SMOOTH_EDGE_RADIUS 0.5",o={name:"geometry",vs:"\n".concat(i,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(i,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},a=n(20),s=Object.keys(a.a).map((function(t){return"const int COORDINATE_SYSTEM_".concat(t," = ").concat(a.a[t],";")})).join(""),u=Object.keys(a.d).map((function(t){return"const int PROJECTION_MODE_".concat(t," = ").concat(a.d[t],";")})).join(""),c=Object.keys(a.e).map((function(t){return"const int UNIT_".concat(t.toUpperCase()," = ").concat(a.e[t],";")})).join(""),l="".concat(s,"\n").concat(u,"\n").concat(c,'\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0; // meters\nconst float GLOBE_RADIUS = 256.0;\n\n// returns an adjustment factor for uCommonUnitsPerMeter\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n\n    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear\n    // Adjust by 1 / cos(latitude)\n    // If geometry.position (vertex in common space) is populated, use it\n    // Otherwise use geometry.worldPosition (anchor in world space)\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n\n    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)\n    // Taylor series of 1 / cos(latitude)\n    // Max error < 0.003\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\n\n//\n// Scaling offsets - scales meters to "world distance"\n// Note the scalar version of project_size is for scaling the z component only\n//\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\n\n// Get rotation matrix that aligns the z axis with the given up vector\n// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  // Tangent on XY plane\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n\n//\n// Projecting normal - transform deltas from current coordinate system to\n// normals in the worldspace\n//\nvec3 project_normal(vec3 vector) {\n  // Apply model matrix\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n//\n// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]\n//\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n//\n// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)\n//\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        // Too far from the projection center for offset mode to be accurate\n        // Only use high parts\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n\n  // Translation is already added to the high parts\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\n\n//\n// Projects from common space coordinates to clip space.\n// Uses project_uViewProjectionMatrix\n//\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\n\n// Returns a clip space offset that corresponds to a given number of screen pixels\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  // UNIT_PIXELS\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n'),f=n(137),h={};e.a={name:"project",dependencies:[r,o],vs:l,getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h;return"viewport"in t?Object(f.b)(t):{}}}},function(t,e,n){"use strict";var r=n(23),i=n.n(r),o=n(8),a=n.n(o),s=n(4),u=n.n(s),c=n(74),l=n(167);function f(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.a;Object(c.a)(t,"no worker provided");var n=t.version;return!(!e||!n)}var h=n(202),d=n(65),p=n(32),v=n(66),g=n(139),y=n(112),m=n(84),b=n(100);function A(t,e,n,r){return _.apply(this,arguments)}function _(){return(_=a()(u.a.mark((function t(e,n,r,o){var a,s,l,f,h;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Object(c.a)(!o||"object"===i()(o)),!n||Array.isArray(n)||Object(d.a)(n)||(o=void 0,r=n,n=void 0),t.next=4,e;case 4:return e=t.sent,r=r||{},a=Object(m.b)(e),s=a.url,l=n,f=Object(y.b)(l,o),t.next=11,Object(b.a)(e,f,r);case 11:if(h=t.sent){t.next=14;break}return t.abrupt("return",null);case 14:return r=Object(v.d)(r,h,f,s),o=Object(y.a)({url:s,parse:A,loaders:f},r,o),t.next=18,O(h,e,r,o);case 18:return t.abrupt("return",t.sent);case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(t,e,n,r){return w.apply(this,arguments)}function w(){return(w=a()(u.a.mark((function t(e,n,r,i){var o,a,s,l,d,v,y,m;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f(e),Object(p.j)(n)&&(a=(o=n).ok,s=o.redirected,l=o.status,d=o.statusText,v=o.type,y=o.url,m=Object.fromEntries(o.headers.entries()),i.response={headers:m,ok:a,redirected:s,status:l,statusText:d,type:v,url:y}),t.next=4,Object(g.a)(n,e,r);case 4:if(n=t.sent,!e.parseTextSync||"string"!=typeof n){t.next=8;break}return r.dataType="text",t.abrupt("return",e.parseTextSync(n,r,i,e));case 8:if(!Object(h.a)(e,r)){t.next=12;break}return t.next=11,Object(h.b)(e,n,r,i,A);case 11:return t.abrupt("return",t.sent);case 12:if(!e.parseText||"string"!=typeof n){t.next=16;break}return t.next=15,e.parseText(n,r,i,e);case 15:return t.abrupt("return",t.sent);case 16:if(!e.parse){t.next=20;break}return t.next=19,e.parse(n,r,i,e);case 19:return t.abrupt("return",t.sent);case 20:throw Object(c.a)(!e.parseSync),new Error("".concat(e.id," loader - no parser found and worker is disabled"));case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}n.d(e,"a",(function(){return A}))},function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"loader assertion failed.")}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(5),l=n.n(c),f=n(7),h=n.n(f),d=n(2),p=n.n(d),v=n(12),g=n(77),y=n(17),m="";function b(t,e){return Object(y.a)("string"==typeof t),t=m+t,new Promise((function(n,r){try{var i=new Image;i.onload=function(){return n(i)},i.onerror=function(){return r(new Error("Could not load image ".concat(t,".")))},i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(t){r(t)}}))}function A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}n.d(e,"a",(function(){return _}));var _=function(t,e){l()(r,t);var n=A(r);function r(t){var e;i()(this,r);var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(v.b)(t),(o instanceof Promise||"string"==typeof o)&&(o={data:o}),"string"==typeof o.data&&(o=Object.assign({},o,{data:b(o.data)})),(e=n.call(this,t,Object.assign({},o,{target:3553}))).initialize(o),Object.seal(u()(e)),e}return a()(r,[{key:e,get:function(){return"Texture2D"}}],[{key:"isSupported",value:function(t,e){return g.a.isSupported(t,e)}}]),r}(g.a,Symbol.toStringTag)},function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return f}));var r=n(8),i=n.n(r),o=n(4),a=n.n(o),s=n(32),u=n(84);function c(t){return l.apply(this,arguments)}function l(){return(l=i()(a.a.mark((function t(e){var n,r,i,o,c,l,f;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Object(s.j)(e)){t.next=2;break}return t.abrupt("return",e);case 2:return n={},(r=Object(u.a)(e))>=0&&(n["content-length"]=String(r)),i=Object(u.b)(e),o=i.url,(c=i.type)&&(n["content-type"]=c),t.next=9,v(e);case 9:return(l=t.sent)&&(n["x-first-bytes"]=l),"string"==typeof e&&(e=(new TextEncoder).encode(e)),f=new Response(e,{headers:n}),Object.defineProperty(f,"url",{value:o}),t.abrupt("return",f);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function f(t){return h.apply(this,arguments)}function h(){return(h=i()(a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ok){t.next=5;break}return t.next=3,d(e);case 3:throw n=t.sent,new Error(n);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function d(t){return p.apply(this,arguments)}function p(){return(p=i()(a.a.mark((function t(e){var n,r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n="Failed to fetch resource ".concat(e.url," (").concat(e.status,"): "),t.prev=1,r=e.headers.get("Content-Type"),i=e.statusText,!r.includes("application/json")){t.next=11;break}return t.t0=i,t.t1=" ",t.next=9,e.text();case 9:t.t2=t.sent,i=t.t0+=t.t1.concat.call(t.t1,t.t2);case 11:n=(n+=i).length>60?"".concat(n.slice(0,60),"..."):n,t.next=17;break;case 15:t.prev=15,t.t3=t.catch(1);case 17:return t.abrupt("return",n);case 18:case"end":return t.stop()}}),t,null,[[1,15]])})))).apply(this,arguments)}function v(t){return g.apply(this,arguments)}function g(){return(g=i()(a.a.mark((function t(e){var n,r,i,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=5,"string"!=typeof e){t.next=3;break}return t.abrupt("return","data:,".concat(e.slice(0,n)));case 3:if(!(e instanceof Blob)){t.next=8;break}return r=e.slice(0,5),t.next=7,new Promise((function(t){var e=new FileReader;e.onload=function(e){var n;return t(null==e?void 0:null===(n=e.target)||void 0===n?void 0:n.result)},e.readAsDataURL(r)}));case 7:return t.abrupt("return",t.sent);case 8:if(!(e instanceof ArrayBuffer)){t.next=12;break}return i=e.slice(0,n),o=y(i),t.abrupt("return","data:base64,".concat(o));case 12:return t.abrupt("return",null);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function y(t){for(var e="",n=new Uint8Array(t),r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}},function(t,e,n){"use strict";var r,i=n(1),o=n.n(i),a=n(3),s=n.n(a),u=n(9),c=n.n(u),l=n(5),f=n.n(l),h=n(7),d=n.n(h),p=n(2),v=n.n(p),g=n(57),y=n(0),m=n.n(y),b="EXT_color_buffer_float",A=(r={},m()(r,33189,{bpp:2}),m()(r,33190,{gl2:!0,bpp:3}),m()(r,36012,{gl2:!0,bpp:4}),m()(r,36168,{bpp:1}),m()(r,34041,{bpp:4}),m()(r,35056,{gl2:!0,bpp:4}),m()(r,36013,{gl2:!0,bpp:5}),m()(r,32854,{bpp:2}),m()(r,36194,{bpp:2}),m()(r,32855,{bpp:2}),m()(r,33321,{gl2:!0,bpp:1}),m()(r,33330,{gl2:!0,bpp:1}),m()(r,33329,{gl2:!0,bpp:1}),m()(r,33332,{gl2:!0,bpp:2}),m()(r,33331,{gl2:!0,bpp:2}),m()(r,33334,{gl2:!0,bpp:4}),m()(r,33333,{gl2:!0,bpp:4}),m()(r,33323,{gl2:!0,bpp:2}),m()(r,33336,{gl2:!0,bpp:2}),m()(r,33335,{gl2:!0,bpp:2}),m()(r,33338,{gl2:!0,bpp:4}),m()(r,33337,{gl2:!0,bpp:4}),m()(r,33340,{gl2:!0,bpp:8}),m()(r,33339,{gl2:!0,bpp:8}),m()(r,32849,{gl2:!0,bpp:3}),m()(r,32856,{gl2:!0,bpp:4}),m()(r,32857,{gl2:!0,bpp:4}),m()(r,36220,{gl2:!0,bpp:4}),m()(r,36238,{gl2:!0,bpp:4}),m()(r,36975,{gl2:!0,bpp:4}),m()(r,36214,{gl2:!0,bpp:8}),m()(r,36232,{gl2:!0,bpp:8}),m()(r,36226,{gl2:!0,bpp:16}),m()(r,36208,{gl2:!0,bpp:16}),m()(r,33325,{gl2:b,bpp:2}),m()(r,33327,{gl2:b,bpp:4}),m()(r,34842,{gl2:b,bpp:8}),m()(r,33326,{gl2:b,bpp:4}),m()(r,33328,{gl2:b,bpp:8}),m()(r,34836,{gl2:b,bpp:16}),m()(r,35898,{gl2:b,bpp:4}),r),_=n(12),O=n(17);function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v()(t);if(e){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}function x(t,e,n){var r=n[e];if(!r)return!1;var i=Object(_.j)(t)&&r.gl2||r.gl1;return"string"==typeof i?t.getExtension(i):i}n.d(e,"a",(function(){return C}));var C=function(t,e){f()(r,t);var n=w(r);function r(t){var e;o()(this,r);var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e=n.call(this,t,i)).initialize(i),Object.seal(c()(e)),e}return s()(r,[{key:e,get:function(){return"Renderbuffer"}},{key:"initialize",value:function(t){var e=t.format,n=t.width,r=void 0===n?1:n,i=t.height,o=void 0===i?1:i,a=t.samples,s=void 0===a?0:a;return Object(O.a)(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==s&&Object(_.j)(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,e,r,o):this.gl.renderbufferStorage(36161,e,r,o),this.format=e,this.width=r,this.height=o,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*A[this.format].bpp),this}},{key:"resize",value:function(t){var e=t.width,n=t.height;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}},{key:"_createHandle",value:function(){return this.gl.createRenderbuffer()}},{key:"_deleteHandle",value:function(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}},{key:"_bindHandle",value:function(t){this.gl.bindRenderbuffer(36161,t)}},{key:"_syncHandle",value:function(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}},{key:"_getParameter",value:function(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}],[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null},n=e.format;return!n||x(t,n,A)}},{key:"getSamplesForFormat",value:function(t,e){var n=e.format;return t.getInternalformatParameter(36161,n,32937)}}]),r}(g.a,Symbol.toStringTag)},function(t,e,n){var r=n(311),i=n(312),o=n(313),a=n(314);t.exports=function(t){return r(t)||i(t)||o(t)||a()},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){"use strict";n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return l}));var r=n(65),i=n(66);function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s=function(){var t=Object(i.c)();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function u(t){var e,n=s(),i=o(t=Array.isArray(t)?t:[t]);try{var a=function(){var t=e.value,i=Object(r.b)(t);n.find((function(t){return i===t}))||n.unshift(i)};for(i.s();!(e=i.n()).done;)a()}catch(t){i.e(t)}finally{i.f()}}function c(){return s()}function l(){Object(i.c)().loaderRegistry=[]}},function(t,e,n){"use strict";n.d(e,"a",(function(){return B})),n.d(e,"b",(function(){return k}));var r=n(10),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(9),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(24),A=n(80),_=n(138),O=n(33),w=n(44),x=n(71);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var B=function(t){h()(n,t);var e=S(n);function n(t){var r;a()(this,n);var i=t.width,o=t.height,s=t.latitude,u=t.longitude,c=t.zoom,f=t.bearing,h=void 0===f?0:f,d=t.pitch,p=void 0===d?0:d,v=t.altitude,g=void 0===v?1.5:v,y=t.position,b=void 0===y?[0,0,0]:y,A=t.maxZoom,_=void 0===A?20:A,O=t.minZoom,x=void 0===O?0:O,C=t.maxPitch,P=void 0===C?60:C,S=t.minPitch,B=void 0===S?0:S,k=t.startPanLngLat,E=t.startZoomLngLat,T=t.startRotatePos,j=t.startBearing,M=t.startPitch,I=t.startZoom,R=t.normalize,D=void 0===R||R;return Object(w.a)(Number.isFinite(u)),Object(w.a)(Number.isFinite(s)),Object(w.a)(Number.isFinite(c)),r=e.call(this,{width:i,height:o,latitude:s,longitude:u,zoom:c,bearing:h,pitch:p,altitude:g,maxZoom:_,minZoom:x,maxPitch:P,minPitch:B,normalize:D,position:b},{startPanLngLat:k,startZoomLngLat:E,startRotatePos:T,startBearing:j,startPitch:M,startZoom:I}),m()(l()(r),"makeViewport",void 0),r.makeViewport=t.makeViewport,r}return u()(n,[{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedState({startPanLngLat:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;var i=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(i)}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanLngLat:null})}},{key:"rotateStart",value:function(t){var e=t.pos;return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}},{key:"rotate",value:function(t){var e,n=t.pos,r=t.deltaAngleX,i=void 0===r?0:r,o=t.deltaAngleY,a=void 0===o?0:o,s=this.getState(),u=s.startRotatePos,c=s.startBearing,l=s.startPitch;return u&&void 0!==c&&void 0!==l?(e=n?this._getNewRotation(n,u,l,c):{bearing:c+i,pitch:l+a},this._getUpdatedState(e)):this}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale,i=this.getState(),o=i.startZoom,a=i.startZoomLngLat;if(a||(o=this.getViewportProps().zoom,a=this._unproject(n)||this._unproject(e)),!a)return this;var s=this.getViewportProps(),u=s.maxZoom,c=s.minZoom,l=o+Math.log2(r);l=Object(b.a)(l,c,u);var f=this.makeViewport(P(P({},this.getViewportProps()),{},{zoom:l}));return this._getUpdatedState(P({zoom:l},f.panByPosition(a,e)))}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}},{key:"zoomIn",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(t)}},{key:"zoomOut",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._zoomFromCenter(1/t)}},{key:"moveLeft",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([t,0])}},{key:"moveRight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([-t,0])}},{key:"moveUp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,t])}},{key:"moveDown",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return this._panFromCenter([0,-t])}},{key:"rotateLeft",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}},{key:"rotateRight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}},{key:"rotateUp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}},{key:"rotateDown",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}},{key:"shortestPathFrom",value:function(t){var e=t.getViewportProps(),n=P({},this.getViewportProps()),r=n.bearing,i=n.longitude;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}},{key:"applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;t.zoom=Object(b.a)(r,n,e);var i=t.maxPitch,o=t.minPitch,a=t.pitch;t.pitch=Object(b.a)(a,o,i);var s=t.normalize;return(void 0===s||s)&&Object.assign(t,Object(O.m)(t)),t}},{key:"_zoomFromCenter",value:function(t){var e=this.getViewportProps(),n=e.width,r=e.height;return this.zoom({pos:[n/2,r/2],scale:t})}},{key:"_panFromCenter",value:function(t){var e=this.getViewportProps(),n=e.width,r=e.height;return this.pan({startPos:[n/2,r/2],pos:[n/2+t[0],r/2+t[1]]})}},{key:"_getUpdatedState",value:function(t){return new this.constructor(P(P(P({makeViewport:this.makeViewport},this.getViewportProps()),this.getState()),t))}},{key:"_unproject",value:function(t){var e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}},{key:"_getNewRotation",value:function(t,e,n,r){var i=t[0]-e[0],o=t[1]-e[1],a=t[1],s=e[1],u=this.getViewportProps(),c=u.width,l=u.height,f=i/c,h=0;o>0?Math.abs(l-s)>5&&(h=o/(s-l)*1.2):o<0&&s>5&&(h=1-a/s),h=Object(b.a)(h,-1,1);var d=this.getViewportProps(),p=d.minPitch,v=d.maxPitch,g=n;return h>0?g=n+h*(v-n):h<0&&(g=n-h*(p-n)),{pitch:g,bearing:r+180*f}}}]),n}(_.a),k=function(t){h()(n,t);var e=S(n);function n(){var t;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),m()(l()(t),"ControllerState",B),m()(l()(t),"transition",{transitionDuration:300,transitionInterpolator:new x.a({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),m()(l()(t),"dragMode","pan"),t}return u()(n,[{key:"setProps",value:function(t){t.position=t.position||[0,0,0];var e=this.props;i()(g()(n.prototype),"setProps",this).call(this,t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState(P(P({makeViewport:this.makeViewport},t),this.state)))}}]),n}(A.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=n(24),l=n(44);function f(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var d=function(){function t(e){i()(this,t),u()(this,"_propsToCompare",void 0),u()(this,"_propsToExtract",void 0),u()(this,"_requiredProps",void 0);var n=e.compare,r=e.extract,o=e.required;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=o}return a()(t,[{key:"arePropsEqual",value:function(t,e){var n,r=f(this._propsToCompare);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!(i in t&&i in e&&Object(c.d)(t[i],e[i])))return!1}}catch(t){r.e(t)}finally{r.f()}return!0}},{key:"initializeProps",value:function(t,e){var n,r={},i={},o=f(this._propsToExtract);try{for(o.s();!(n=o.n()).done;){var a=n.value;(a in t||a in e)&&(r[a]=t[a],i[a]=e[a])}}catch(t){o.e(t)}finally{o.f()}return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}},{key:"getDuration",value:function(t,e){return e.transitionDuration}},{key:"_checkRequiredProps",value:function(t){this._requiredProps&&this._requiredProps.forEach((function(e){var n=t[e];Object(l.a)(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))}))}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return C})),n.d(e,"b",(function(){return P}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(5),l=n.n(c),f=n(7),h=n.n(f),d=n(2),p=n.n(d),v=n(0),g=n.n(v),y=n(24),m=n(80),b=n(138),A=n(52),_=n(71);function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){g()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var C=function(t){l()(n,t);var e=x(n);function n(t){var r;i()(this,n);var o=t.width,a=t.height,s=t.rotationX,c=void 0===s?0:s,l=t.rotationOrbit,f=void 0===l?0:l,h=t.target,d=void 0===h?[0,0,0]:h,p=t.zoom,v=void 0===p?0:p,y=t.minRotationX,m=void 0===y?-90:y,b=t.maxRotationX,A=void 0===b?90:b,_=t.minZoom,O=void 0===_?-1/0:_,w=t.maxZoom,x=void 0===w?1/0:w,C=t.startPanPosition,P=t.startRotatePos,S=t.startRotationX,B=t.startRotationOrbit,k=t.startZoomPosition,E=t.startZoom;return r=e.call(this,{width:o,height:a,rotationX:c,rotationOrbit:f,target:d,zoom:v,minRotationX:m,maxRotationX:A,minZoom:O,maxZoom:x},{startPanPosition:C,startRotatePos:P,startRotationX:S,startRotationOrbit:B,startZoomPosition:k,startZoom:E}),g()(u()(r),"makeViewport",void 0),r.makeViewport=t.makeViewport,r}return a()(n,[{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedState({startPanPosition:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPosition,r=this.getState().startPanPosition||n;if(!r)return this;var i=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(i)}},{key:"panEnd",value:function(){return this._getUpdatedState({startPanPosition:null})}},{key:"rotateStart",value:function(t){var e=t.pos;return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}},{key:"rotate",value:function(t){var e,n=t.pos,r=t.deltaAngleX,i=void 0===r?0:r,o=t.deltaAngleY,a=void 0===o?0:o,s=this.getState(),u=s.startRotatePos,c=s.startRotationX,l=s.startRotationOrbit,f=this.getViewportProps(),h=f.width,d=f.height;if(!u||void 0===c||void 0===l)return this;if(n){var p=(n[0]-u[0])/h;(c<-90||c>90)&&(p*=-1),e={rotationX:c+180*((n[1]-u[1])/d),rotationOrbit:l+180*p}}else e={rotationX:c+a,rotationOrbit:l+i};return this._getUpdatedState(e)}},{key:"rotateEnd",value:function(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}},{key:"shortestPathFrom",value:function(t){var e=t.getViewportProps(),n=w({},this.getViewportProps()),r=n.rotationOrbit;return Math.abs(r-e.rotationOrbit)>180&&(n.rotationOrbit=r<0?r+360:r-360),n}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale,i=this.getState(),o=i.startZoom,a=i.startZoomPosition;if(a||(o=this.getViewportProps().zoom,a=this._unproject(n)||this._unproject(e)),!a)return this;var s=this._calculateNewZoom({scale:r,startZoom:o}),u=this.makeViewport(w(w({},this.getViewportProps()),{},{zoom:s}));return this._getUpdatedState(w({zoom:s},u.panByPosition(a,e)))}},{key:"zoomEnd",value:function(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}},{key:"zoomIn",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}},{key:"zoomOut",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}},{key:"moveLeft",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([-t,0])}},{key:"moveRight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([t,0])}},{key:"moveUp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([0,-t])}},{key:"moveDown",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this._panFromCenter([0,t])}},{key:"rotateLeft",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-t})}},{key:"rotateRight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+t})}},{key:"rotateUp",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-t})}},{key:"rotateDown",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+t})}},{key:"_unproject",value:function(t){var e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this.getViewportProps(),i=r.maxZoom,o=r.minZoom;void 0===n&&(n=this.getViewportProps().zoom);var a=n+Math.log2(e);return Object(y.a)(a,o,i)}},{key:"_panFromCenter",value:function(t){var e=this.getViewportProps(),n=e.width,r=e.height,i=e.target;return this.pan({startPosition:i,pos:[n/2+t[0],r/2+t[1]]})}},{key:"_getUpdatedState",value:function(t){return new this.constructor(w(w(w({makeViewport:this.makeViewport},this.getViewportProps()),this.getState()),t))}},{key:"applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom,i=t.maxRotationX,o=t.minRotationX,a=t.rotationOrbit;return t.zoom=Array.isArray(r)?[Object(y.a)(r[0],n,e),Object(y.a)(r[1],n,e)]:Object(y.a)(r,n,e),t.rotationX=Object(y.a)(t.rotationX,o,i),(a<-180||a>180)&&(t.rotationOrbit=Object(A.e)(a+180,360)-180),t}}]),n}(b.a),P=function(t){l()(n,t);var e=x(n);function n(){var t;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o)),g()(u()(t),"ControllerState",C),g()(u()(t),"transition",{transitionDuration:300,transitionInterpolator:new _.a({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})}),t}return n}(m.a)},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(10),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(228),A=n(248),_=n(247),O=n(20),w=n(176),x=n(264),C=n(198),P=n(194),S=n(82),B=n(86),k=n(229),E=n(56);function T(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return j(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var D=function(t){h()(n,t);var e=R(n);function n(t){i()(this,n);var r=t.fp64,o=t.IndexType,a=void 0===o?Uint32Array:o;return e.call(this,I(I({},t),{},{attributes:{positions:{size:3,type:r?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:a,size:1}}}))}return a()(n,[{key:"get",value:function(t){var e=this.attributes;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}},{key:"updateGeometry",value:function(t){l()(g()(n.prototype),"updateGeometry",this).call(this,t);var e=this.buffers.indices;if(e)this.vertexCount=(e.value||e).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}},{key:"normalizeGeometry",value:function(t){if(this.normalize){var e=B.d(t,this.positionSize);return this.opts.resolution?Object(E.b)(B.b(e),B.a(e),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?Object(E.c)(B.b(e),B.a(e),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):e}return t}},{key:"getGeometrySize",value:function(t){if(L(t)){var e,n=0,r=T(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n+=this.getGeometrySize(i)}}catch(t){r.e(t)}finally{r.f()}return n}return B.b(t).length/this.positionSize}},{key:"getGeometryFromBuffer",value:function(t){return this.normalize||!this.buffers.indices?l()(g()(n.prototype),"getGeometryFromBuffer",this).call(this,t):null}},{key:"updateGeometryAttributes",value:function(t,e){if(t&&L(t)){var n,r=T(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=this.getGeometrySize(i);e.geometrySize=o,this.updateGeometryAttributes(i,e),e.vertexStart+=o,e.indexStart=this.indexStarts[e.geometryIndex+1]}}catch(t){r.e(t)}finally{r.f()}}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}},{key:"_updateIndices",value:function(t,e){var n=e.geometryIndex,r=e.vertexStart,i=e.indexStart,o=this.attributes,a=this.indexStarts,s=this.typedArrayManager,u=o.indices;if(u&&t){var c=i,l=B.c(t,this.positionSize,this.opts.preproject);u=s.allocate(u,i+l.length,{copy:!0});for(var f=0;f<l.length;f++)u[c++]=l[f]+r;a[n+1]=i+l.length,o.indices=u}}},{key:"_updatePositions",value:function(t,e){var n=e.vertexStart,r=e.geometrySize,i=this.attributes.positions,o=this.positionSize;if(i&&t)for(var a=B.b(t),s=n,u=0;u<r;s++,u++){var c=a[u*o],l=a[u*o+1],f=o>2?a[u*o+2]:0;i[3*s]=c,i[3*s+1]=l,i[3*s+2]=f}}},{key:"_updateVertexValid",value:function(t,e){var n=e.vertexStart,r=e.geometrySize,i=this.positionSize,o=this.attributes.vertexValid,a=t&&B.a(t);if(t&&t.edgeTypes?o.set(t.edgeTypes,n):o.fill(1,n,n+r),a)for(var s=0;s<a.length;s++)o[n+a[s]/i-1]=0;o[n+r-1]=0}}]),n}(k.a);function L(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}var F="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",G="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(F,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),N="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(F,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n");function U(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?U(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function H(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}n.d(e,"a",(function(){return K}));var V=[0,0,0,255],J={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:function(t){return t.polygon}},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:V},getLineColor:{type:"accessor",value:V},material:!0},W={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},K=function(t){h()(n,t);var e=H(n);function n(){var t;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o)),m()(u()(t),"state",void 0),t}return a()(n,[{key:"getShaders",value:function(t){return l()(g()(n.prototype),"getShaders",this).call(this,{vs:"top"===t?G:N,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[b.a,A.a,_.a]})}},{key:"wrapLongitude",get:function(){return!1}},{key:"initializeState",value:function(){var t=this,e=this.context,n=e.gl,r=e.viewport,i=this.props.coordinateSystem;r.isGeospatial&&i===O.a.DEFAULT&&(i=O.a.LNGLAT),this.setState({numInstances:0,polygonTesselator:new D({preproject:i===O.a.LNGLAT&&r.projectFlat.bind(r),fp64:this.use64bitPositions(),IndexType:!n||Object(x.c)(n,C.a.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});var o=this.getAttributeManager();o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:!0},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:W,accessor:"getPolygon",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:!0},elevations:{size:1,transition:W,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:W,accessor:"getFillColor",defaultValue:V,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:W,accessor:"getLineColor",defaultValue:V,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:function(e,n){var r=n.index,i=n.target;return t.encodePickingColor(e&&e.__source?e.__source.index:r,i)},shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}},{key:"getPickingInfo",value:function(t){var e=l()(g()(n.prototype),"getPickingInfo",this).call(this,t),r=e.index,i=this.props.data;return i[0]&&i[0].__source&&(e.object=i.find((function(t){return t.__source.index===r}))),e}},{key:"disablePickingIndex",value:function(t){var e=this.props.data;if(e[0]&&e[0].__source)for(var n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.extruded,i=n.filled,o=n.wireframe,a=n.elevationScale,s=this.state,u=s.topModel,c=s.sideModel,l=s.polygonTesselator,f=z(z({},e),{},{extruded:Boolean(r),elevationScale:a});c&&(c.setInstanceCount(l.instanceCount-1),c.setUniforms(f),o&&(c.setDrawMode(3),c.setUniforms({isWireframe:!0}).draw()),i&&(c.setDrawMode(6),c.setUniforms({isWireframe:!1}).draw())),u&&(u.setVertexCount(l.vertexCount),u.setUniforms(f).draw())}},{key:"updateState",value:function(t){l()(g()(n.prototype),"updateState",this).call(this,t),this.updateGeometry(t);var e,r=t.props,i=t.oldProps,o=t.changeFlags,a=this.getAttributeManager();(o.extensionsChanged||r.filled!==i.filled||r.extruded!==i.extruded)&&(null===(e=this.state.models)||void 0===e||e.forEach((function(t){return t.delete()})),this.setState(this._getModels(this.context.gl)),a.invalidateAll())}},{key:"updateGeometry",value:function(t){var e=t.props,n=(t.oldProps,t.changeFlags);if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){var r=this.state.polygonTesselator,i=e.data.attributes||{};r.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:i.getPolygon,buffers:i,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged}),this.setState({numInstances:r.instanceCount,startIndices:r.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}},{key:"_getModels",value:function(t){var e,n,r=this.props,i=r.id,o=r.filled,a=r.extruded;if(o){var s=this.getShaders("top");s.defines.NON_INSTANCED_MODEL=1,e=new P.a(t,z(z({},s),{},{id:"".concat(i,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0}))}return a&&((n=new P.a(t,z(z({},this.getShaders("side")),{},{id:"".concat(i,"-side"),geometry:new S.a({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}))).userData.excludeAttributes={indices:!0}),{models:[n,e].filter(Boolean),topModel:e,sideModel:n}}},{key:"calculateIndices",value:function(t){var e=this.state.polygonTesselator;t.startIndices=e.indexStarts,t.value=e.get("indices")}},{key:"calculatePositions",value:function(t){var e=this.state.polygonTesselator;t.startIndices=e.vertexStarts,t.value=e.get("positions")}},{key:"calculateVertexValid",value:function(t){t.value=this.state.polygonTesselator.get("vertexValid")}}]),n}(w.a);m()(K,"defaultProps",J),m()(K,"layerName","SolidPolygonLayer")},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(10),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(228),A=n(247),_=n(20),O=n(176),w=n(194),x=n(82),C=n(229),P=n(56);function S(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return B(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var j=function(t){h()(n,t);var e=T(n);function n(t){return i()(this,n),e.call(this,E(E({},t),{},{attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}}))}return a()(n,[{key:"get",value:function(t){return this.attributes[t]}},{key:"getGeometryFromBuffer",value:function(t){return this.normalize?l()(g()(n.prototype),"getGeometryFromBuffer",this).call(this,t):null}},{key:"normalizeGeometry",value:function(t){return this.normalize?function(t,e,n,r){var i;if(Array.isArray(t[0])){var o=t.length*e;i=new Array(o);for(var a=0;a<t.length;a++)for(var s=0;s<e;s++)i[a*e+s]=t[a][s]||0}else i=t;return n?Object(P.d)(i,{size:e,gridResolution:n}):r?Object(P.e)(i,{size:e}):i}(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}},{key:"getGeometrySize",value:function(t){if(M(t)){var e,n=0,r=S(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n+=this.getGeometrySize(i)}}catch(t){r.e(t)}finally{r.f()}return n}var o=this.getPathLength(t);return o<2?0:this.isClosed(t)?o<3?0:o+2:o}},{key:"updateGeometryAttributes",value:function(t,e){if(0!==e.geometrySize)if(t&&M(t)){var n,r=S(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=this.getGeometrySize(i);e.geometrySize=o,this.updateGeometryAttributes(i,e),e.vertexStart+=o}}catch(t){r.e(t)}finally{r.f()}}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}},{key:"_updateSegmentTypes",value:function(t,e){var n=this.attributes.segmentTypes,r=!!t&&this.isClosed(t),i=e.vertexStart,o=e.geometrySize;n.fill(0,i,i+o),r?(n[i]=4,n[i+o-2]=4):(n[i]+=1,n[i+o-2]+=2),n[i+o-1]=4}},{key:"_updatePositions",value:function(t,e){var n=this.attributes.positions;if(n&&t)for(var r=e.vertexStart,i=e.geometrySize,o=new Array(3),a=r,s=0;s<i;a++,s++)this.getPointOnPath(t,s,o),n[3*a]=o[0],n[3*a+1]=o[1],n[3*a+2]=o[2]}},{key:"getPathLength",value:function(t){return t.length/this.positionSize}},{key:"getPointOnPath",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this.positionSize;e*r>=t.length&&(e+=1-t.length/r);var i=e*r;return n[0]=t[i],n[1]=t[i+1],n[2]=3===r&&t[i+2]||0,n}},{key:"isClosed",value:function(t){if(!this.normalize)return Boolean(this.opts.loop);var e=this.positionSize,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}]),n}(C.a);function M(t){return Array.isArray(t[0])}function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function D(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}n.d(e,"a",(function(){return N}));var L=[0,0,0,255],F={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:function(t){return t.path}},getColor:{type:"accessor",value:L},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},G={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},N=function(t){h()(n,t);var e=D(n);function n(){var t;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o)),m()(u()(t),"state",void 0),t}return a()(n,[{key:"getShaders",value:function(){return l()(g()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\n\n// calculate line join positions\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  // side of the segment - -1: left, 0: center, 1: right\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n\n  // tangent of the corner\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  // direction of the corner\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  // direction of the segment\n  vec2 dir = isEnd ? dirA : dirB;\n  // direction of the extrusion\n  vec2 perp = isEnd ? perpA : perpB;\n  // length of the segment\n  float L = isEnd ? lenA : lenB;\n\n  // A = angle of the corner\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n\n  // -1: right, 1: left\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n\n  // relative position to the corner:\n  // -1: inside (smaller side of the angle)\n  // 0: center\n  // 1: outside (bigger side of the angle)\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  // trim if inside corner extends further than the line segment\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n\n  // special treatment for start cap and end cap\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n\n  // extend out a triangle to envelope the round cap\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n\n  // Generate variables for fragment shader\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return currPoint + offset;\n}\n\n// In clipspace extrusion, if a line extends behind the camera, clip it to avoid visual artifacts\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    // Extrude in clipspace\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    // Extrude in commonspace\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec4 pos = vec4(\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\n      1.0);\n    geometry.position = pos;\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\n/*\n * vPathPosition represents the relative coordinates of the current fragment on the path segment.\n * vPathPosition.x - position along the width of the path, between [-1, 1]. 0 is the center line.\n * vPathPosition.y - position along the length of the path, between [0, L / width].\n */\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    // if joint is rounded, test distance from the corner\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    // trim miter\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[b.a,A.a]})}},{key:"wrapLongitude",get:function(){return!1}},{key:"initializeState",value:function(){var t=this;this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:G,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:G,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:G,defaultValue:L},instancePickingColors:{size:3,type:5121,accessor:function(e,n){var r=n.index,i=n.target;return t.encodePickingColor(e&&e.__source?e.__source.index:r,i)}}}),this.setState({pathTesselator:new j({fp64:this.use64bitPositions()})})}},{key:"updateState",value:function(t){l()(g()(n.prototype),"updateState",this).call(this,t);var e=t.props,r=t.changeFlags,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){var o=this.state.pathTesselator,a=e.data.attributes||{};o.updateGeometry({data:e.data,geometryBuffer:a.getPath,buffers:a,normalize:!e._pathType,loop:"loop"===e._pathType,getGeometry:e.getPath,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var s,u=this.context.gl;null===(s=this.state.model)||void 0===s||s.delete(),this.state.model=this._getModel(u),i.invalidateAll()}}},{key:"getPickingInfo",value:function(t){var e=l()(g()(n.prototype),"getPickingInfo",this).call(this,t),r=e.index,i=this.props.data;return i[0]&&i[0].__source&&(e.object=i.find((function(t){return t.__source.index===r}))),e}},{key:"disablePickingIndex",value:function(t){var e=this.props.data;if(e[0]&&e[0].__source)for(var n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.jointRounded,i=n.capRounded,o=n.billboard,a=n.miterLimit,s=n.widthUnits,u=n.widthScale,c=n.widthMinPixels,l=n.widthMaxPixels;this.state.model.setUniforms(e).setUniforms({jointType:Number(r),capType:Number(i),billboard:o,widthUnits:_.e[s],widthScale:u,miterLimit:a,widthMinPixels:c,widthMaxPixels:l}).draw()}},{key:"_getModel",value:function(t){return new w.a(t,R(R({},this.getShaders()),{},{id:this.props.id,geometry:new x.a({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0}))}},{key:"calculatePositions",value:function(t){var e=this.state.pathTesselator;t.startIndices=e.vertexStarts,t.value=e.get("positions")}},{key:"calculateSegmentTypes",value:function(t){var e=this.state.pathTesselator;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}]),n}(O.a);m()(N,"defaultProps",F),m()(N,"layerName","PathLayer")},function(t,e,n){"use strict";var r,i=n(1),o=n.n(i),a=n(3),s=n.n(a),u=n(9),c=n.n(u),l=n(10),f=n.n(l),h=n(5),d=n.n(h),p=n(7),v=n.n(p),g=n(2),y=n.n(g),m=n(0),b=n.n(m),A=n(228),_=n(247),O=n(20),w=n(31),x=n(176),C=n(194),P=n(82),S=n(123),B=n(212),k=n(347),E=n(223),T=n(75);function j(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return M(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach((function(e){b()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D=function(){},L=(r={},b()(r,10241,9987),b()(r,10240,9729),b()(r,10242,33071),b()(r,10243,33071),r);function F(t){return t&&(t.id||t.url)}function G(t,e,n){for(var r=0;r<e.length;r++){var i=e[r],o=i.icon,a=i.xOffset;t[F(o)]=R(R({},o),{},{x:a,y:n})}}var N=function(){function t(e,n){var r=n.onUpdate,i=void 0===r?D:r,a=n.onError,s=void 0===a?D:a;o()(this,t),b()(this,"gl",void 0),b()(this,"onUpdate",void 0),b()(this,"onError",void 0),b()(this,"_loadOptions",null),b()(this,"_texture",null),b()(this,"_externalTexture",null),b()(this,"_mapping",{}),b()(this,"_textureParameters",null),b()(this,"_pendingCount",0),b()(this,"_autoPacking",!1),b()(this,"_xOffset",0),b()(this,"_yOffset",0),b()(this,"_rowHeight",0),b()(this,"_buffer",4),b()(this,"_canvasWidth",1024),b()(this,"_canvasHeight",0),b()(this,"_canvas",null),this.gl=e,this.onUpdate=i,this.onError=s}return s()(t,[{key:"finalize",value:function(){var t;null===(t=this._texture)||void 0===t||t.delete()}},{key:"getTexture",value:function(){return this._texture||this._externalTexture}},{key:"getIconMapping",value:function(t){var e=this._autoPacking?F(t):t;return this._mapping[e]||{}}},{key:"setProps",value:function(t){var e,n=t.loadOptions,r=t.autoPacking,i=t.iconAtlas,o=t.iconMapping,a=t.textureParameters;(n&&(this._loadOptions=n),void 0!==r&&(this._autoPacking=r),o&&(this._mapping=o),i)&&(null===(e=this._texture)||void 0===e||e.delete(),this._texture=null,this._externalTexture=i);a&&(this._textureParameters=a)}},{key:"isLoaded",get:function(){return 0===this._pendingCount}},{key:"packIcons",value:function(t,e){if(this._autoPacking&&"undefined"!=typeof document){var n,r,i,o,a,s,u,c=Object.values(function(t,e,n){if(!t||!e)return null;n=n||{};var r,i={},o=Object(T.a)(t),a=o.iterable,s=o.objectInfo,u=j(a);try{for(u.s();!(r=u.n()).done;){var c=r.value;s.index++;var l=e(c,s),f=F(l);if(!l)throw new Error("Icon is missing.");if(!l.url)throw new Error("Icon url is missing.");i[f]||n[f]&&l.url===n[f].url||(i[f]=R(R({},l),{},{source:c,sourceIndex:s.index}))}}catch(t){u.e(t)}finally{u.f()}return i}(t,e,this._mapping)||{});if(c.length>0){var l=function(t){for(var e,n=t.icons,r=t.buffer,i=t.mapping,o=void 0===i?{}:i,a=t.xOffset,s=void 0===a?0:a,u=t.yOffset,c=void 0===u?0:u,l=t.rowHeight,f=void 0===l?0:l,h=t.canvasWidth,d=[],p=0;p<n.length;p++){var v=n[p];if(!o[F(v)]){var g=v.height,y=v.width;s+y+r>h&&(G(o,d,c),s=0,c=f+c+r,f=0,d=[]),d.push({icon:v,xOffset:s}),s=s+y+r,f=Math.max(f,g)}}return d.length>0&&G(o,d,c),{mapping:o,rowHeight:f,xOffset:s,yOffset:c,canvasWidth:h,canvasHeight:(e=f+c+r,Math.pow(2,Math.ceil(Math.log2(e))))}}({icons:c,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset}),f=l.mapping,h=l.xOffset,d=l.yOffset,p=l.rowHeight,v=l.canvasHeight;this._rowHeight=p,this._mapping=f,this._xOffset=h,this._yOffset=d,this._canvasHeight=v,this._texture||(this._texture=new S.a(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||L})),this._texture.height!==this._canvasHeight&&(this._texture=(n=this._texture,r=this._canvasWidth,i=this._canvasHeight,o=this._textureParameters||L,a=n.width,s=n.height,u=new S.a(n.gl,{width:r,height:i,parameters:o}),Object(B.b)(n,u,{targetY:0,width:a,height:s}),n.delete(),u)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(c)}}}},{key:"_loadIcons",value:function(t){var e,n=this,r=this._canvas.getContext("2d"),i=j(t);try{var o=function(){var t=e.value;n._pendingCount++,Object(E.a)(t.url,k.a,n._loadOptions).then((function(e){var i=F(t),o=n._mapping[i],a=o.x,s=o.y,u=o.width,c=o.height,l=function(t,e,n,r){return n===e.width&&r===e.height?e:(t.canvas.height=r,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,r),t.canvas)}(r,e,u,c);n._texture.setSubImageData({data:l,x:a,y:s,width:u,height:c}),n._texture.generateMipmap(),n.onUpdate()})).catch((function(e){n.onError({url:t.url,source:t.source,sourceIndex:t.sourceIndex,loadOptions:n._loadOptions,error:e})})).finally((function(){n._pendingCount--}))};for(i.s();!(e=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}}}]),t}();function U(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?U(Object(n),!0).forEach((function(e){b()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function H(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}n.d(e,"a",(function(){return W}));var V=[0,0,0,255],J={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:function(t){return t.position}},getIcon:{type:"accessor",value:function(t){return t.icon}},getColor:{type:"accessor",value:V},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}},W=function(t){d()(n,t);var e=H(n);function n(){var t;o()(this,n);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=e.call.apply(e,[this].concat(i)),b()(c()(t),"state",void 0),t}return s()(n,[{key:"getShaders",value:function(){return f()(y()(n.prototype),"getShaders",this).call(this,{vs:'#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  // convert size in meters to pixels, then scaled and clamp\n \n  // project meters to pixels and clamp to limits \n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n\n  // scale icon height to match instanceSize\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n\n  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n',fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n\n  // if colorMode == 0, use pixel color from the texture\n  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  // Take the global opacity and the alpha from vColor into account for the alpha component\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[A.a,_.a]})}},{key:"initializeState",value:function(){this.state={iconManager:new N(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:V},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}},{key:"updateState",value:function(t){f()(y()(n.prototype),"updateState",this).call(this,t);var e=t.props,r=t.oldProps,i=t.changeFlags,o=this.getAttributeManager(),a=e.iconAtlas,s=e.iconMapping,u=e.data,c=e.getIcon,l=e.textureParameters,h=this.state.iconManager,d=a||this.internalState.isAsyncPropLoading("iconAtlas");if(h.setProps({loadOptions:e.loadOptions,autoPacking:!d,iconAtlas:a,iconMapping:d?s:null,textureParameters:l}),d?r.iconMapping!==e.iconMapping&&o.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&h.packIcons(u,c),i.extensionsChanged){var p,v=this.context.gl;null===(p=this.state.model)||void 0===p||p.delete(),this.state.model=this._getModel(v),o.invalidateAll()}}},{key:"isLoaded",get:function(){return f()(y()(n.prototype),"isLoaded",this)&&this.state.iconManager.isLoaded}},{key:"finalizeState",value:function(t){f()(y()(n.prototype),"finalizeState",this).call(this,t),this.state.iconManager.finalize()}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.sizeScale,i=n.sizeMinPixels,o=n.sizeMaxPixels,a=n.sizeUnits,s=n.billboard,u=n.alphaCutoff,c=this.state.iconManager.getTexture();c&&this.state.model.setUniforms(e).setUniforms({iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeUnits:O.e[a],sizeScale:r,sizeMinPixels:i,sizeMaxPixels:o,billboard:s,alphaCutoff:u}).draw()}},{key:"_getModel",value:function(t){return new C.a(t,z(z({},this.getShaders()),{},{id:this.props.id,geometry:new P.a({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0}))}},{key:"_onUpdate",value:function(){this.setNeedsRedraw()}},{key:"_onError",value:function(t){var e,n=null===(e=this.getCurrentLayer())||void 0===e?void 0:e.props.onIconError;n?n(t):w.a.error(t.error.message)()}},{key:"getInstanceOffset",value:function(t){var e=this.state.iconManager.getIconMapping(t),n=e.width,r=e.height,i=e.anchorX,o=void 0===i?n/2:i,a=e.anchorY;return[n/2-o,r/2-(void 0===a?r/2:a)]}},{key:"getInstanceColorMode",value:function(t){return this.state.iconManager.getIconMapping(t).mask?1:0}},{key:"getInstanceIconFrame",value:function(t){var e=this.state.iconManager.getIconMapping(t);return[e.x,e.y,e.width,e.height]}}]),n}(x.a);b()(W,"defaultProps",J),b()(W,"layerName","IconLayer")},function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var r=n(54),i=n.n(r),o=n(55),a=n.n(o),s=n(58),u=n.n(s),c=n(59),l=n.n(c),f=n(43),h=n.n(f),d=n(135),p=n(34),v=n(154);function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var y=function(t){u()(n,t);var e=g(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"x",get:function(){return this[0]},set:function(t){this[0]=Object(p.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=Object(p.a)(t)}},{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n){var r=this[n]-t[n];e+=r*r}return Object(p.a)(e)}},{key:"dot",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Object(p.a)(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0;a<this.ELEMENTS;++a)this[a]*=o[a];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0;a<this.ELEMENTS;++a)this[a]/=o[a];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return Object(v.a)(t>=0&&t<this.ELEMENTS,"index is out of range"),Object(p.a)(this[t])}},{key:"setComponent",value:function(t,e){return Object(v.a)(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}]),n}(d.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n(54),i=n.n(r),o=n(55),a=n.n(o),s=n(58),u=n.n(s),c=n(59),l=n.n(c),f=n(43),h=n.n(f),d=n(24);function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var v=function(t){u()(n,t);var e=p(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}},{key:"from",value:function(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}},{key:"to",value:function(t){return t===this?this:Object(d.f)(t)?this.toArray(t):this.toObject(t)}},{key:"toTarget",value:function(t){return t?this.to(t):this}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(d.b)}},{key:"formatString",value:function(t){for(var e="",n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Object(d.e)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!Object(d.d)(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"lerp",value:function(t,e,n){if(void 0===n)return this.lerp(this,t,e);for(var r=0;r<this.ELEMENTS;++r){var i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0;a<this.ELEMENTS;++a)this[a]+=o[a];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0;a<this.ELEMENTS;++a)this[a]-=o[a];return this.check()}},{key:"scale",value:function(t){if("number"==typeof t)for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(var n=0;n<this.ELEMENTS&&n<t.length;++n)this[n]*=t[n];return this.check()}},{key:"multiplyByScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"check",value:function(){if(d.b.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var t=this.length===this.ELEMENTS,e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"divideScalar",value:function(t){return this.multiplyByScalar(1/t)}},{key:"clampScalar",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}},{key:"elements",get:function(){return this}}]),n}(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array))},function(t,e,n){"use strict";var r=n(27),i=n.n(r),o=n(15),a=n.n(o),s=n(20),u=n(120),c=n(98),l=n(106),f=n(101),h=n(33);function d(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var v=Object(f.a)((function(t){var e=t.viewport,n=t.center;return new c.a(e.viewProjectionMatrix).invert().transform(n)})),g=Object(f.a)((function(t){var e,n=t.viewport,r=t.shadowMatrices,o=[],s=n.pixelUnprojectionMatrix,u=n.isGeospatial?void 0:1,f=[[0,0,u],[n.width,0,u],[0,n.height,u],[n.width,n.height,u],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map((function(t){return function(t,e){var n=a()(t,3),r=n[0],i=n[1],o=n[2],s=Object(h.n)([r,i,o],e);if(Number.isFinite(o))return s;return[s[0],s[1],0]}(t,s)})),p=d(r);try{var v=function(){var t=e.value,r=t.clone().translate(new l.a(n.center).negate()),a=f.map((function(t){return r.transform(t)})),s=(new c.a).ortho({left:Math.min.apply(Math,i()(a.map((function(t){return t[0]})))),right:Math.max.apply(Math,i()(a.map((function(t){return t[0]})))),bottom:Math.min.apply(Math,i()(a.map((function(t){return t[1]})))),top:Math.max.apply(Math,i()(a.map((function(t){return t[1]})))),near:Math.min.apply(Math,i()(a.map((function(t){return-t[2]})))),far:Math.max.apply(Math,i()(a.map((function(t){return-t[2]}))))});o.push(s.multiplyRight(t))};for(p.s();!(e=p.n()).done;)v()}catch(t){p.e(t)}finally{p.f()}return o})),y=[0,0,0,1],m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function b(t,e){var n=t.shadowEnabled;if(!(void 0===n||n)||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};for(var r={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||y,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=v({viewport:t.viewport,center:e.project_uCenter}),o=[],a=g({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice(),u=0;u<t.shadowMatrices.length;u++){var c=a[u],f=c.clone().translate(new l.a(t.viewport.center).negate());e.project_uCoordinateSystem===s.a.LNGLAT&&e.project_uProjectionMode===s.d.WEB_MERCATOR?(a[u]=f,o[u]=i):(a[u]=c.clone().multiplyRight(m),o[u]=f.transform(i))}for(var h=0;h<a.length;h++)r["shadow_uViewProjectionMatrices[".concat(h,"]")]=a[h],r["shadow_uProjectCenters[".concat(h,"]")]=o[h],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(h)]=t.shadowMaps[h]:r["shadow_uShadowMap".concat(h)]=t.dummyShadowMap;return r}e.a={name:"shadow",dependencies:[u.a],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?b(t,e):{}}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return p}));var r=n(91),i=n(111),o=n(20),a=n(101),s=[0,0,0,0],u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l=[0,0,0],f=[0,0,0],h=Object(a.a)((function(t){var e=t.viewport,n=t.devicePixelRatio,a=t.coordinateSystem,f=t.coordinateOrigin,h=function(t,e,n){var o=t.viewMatrixUncentered,a=t.projectionMatrix,c=t.viewMatrix,l=t.viewProjectionMatrix,f=s,h=s,p=t.cameraPosition,v=d(t,e,n),g=v.geospatialOrigin,y=v.shaderCoordinateOrigin;v.offsetMode&&(h=t.projectPosition(g||y),p=[p[0]-h[0],p[1]-h[1],p[2]-h[2]],h[3]=1,f=i.b([],h,l),c=o||c,l=r.b([],a,c),l=r.b([],l,u));return{viewMatrix:c,viewProjectionMatrix:l,projectionCenter:f,originCommon:h,cameraPosCommon:p,shaderCoordinateOrigin:y,geospatialOrigin:g}}(e,a,f),p=h.projectionCenter,v=h.viewProjectionMatrix,g=h.originCommon,y=h.cameraPosCommon,m=h.shaderCoordinateOrigin,b=h.geospatialOrigin,A=e.getDistanceScales(),_=[e.width*n,e.height*n],O=i.b([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,w={project_uCoordinateSystem:a,project_uProjectionMode:e.projectionMode,project_uCoordinateOrigin:m,project_uCommonOrigin:g.slice(0,3),project_uCenter:p,project_uPseudoMeters:Boolean(e._pseudoMeters),project_uViewportSize:_,project_uDevicePixelRatio:n,project_uFocalDistance:O,project_uCommonUnitsPerMeter:A.unitsPerMeter,project_uCommonUnitsPerWorldUnit:A.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:l,project_uScale:e.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:v,project_uModelMatrix:c,project_uCameraPosition:y};if(b){var x=e.getDistanceScales(b);switch(a){case o.a.METER_OFFSETS:w.project_uCommonUnitsPerWorldUnit=x.unitsPerMeter,w.project_uCommonUnitsPerWorldUnit2=x.unitsPerMeter2;break;case o.a.LNGLAT:case o.a.LNGLAT_OFFSETS:e._pseudoMeters||(w.project_uCommonUnitsPerMeter=x.unitsPerMeter),w.project_uCommonUnitsPerWorldUnit=x.unitsPerDegree,w.project_uCommonUnitsPerWorldUnit2=x.unitsPerDegree2;break;case o.a.CARTESIAN:w.project_uCommonUnitsPerWorldUnit=[1,1,x.unitsPerMeter[2]],w.project_uCommonUnitsPerWorldUnit2=[0,0,x.unitsPerMeter2[2]]}}return w}));function d(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f;n.length<3&&(n=[n[0],n[1],0]);var r,i=n,a=!0;switch(r=e===o.a.LNGLAT_OFFSETS||e===o.a.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case o.d.WEB_MERCATOR:e!==o.a.LNGLAT&&e!==o.a.CARTESIAN||(r=[0,0,0],a=!1);break;case o.d.WEB_MERCATOR_AUTO_OFFSET:e===o.a.LNGLAT?i=r:e===o.a.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case o.d.IDENTITY:(i=t.position.map(Math.fround))[2]=i[2]||0;break;case o.d.GLOBE:a=!1,r=null;break;default:a=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:a}}function p(t){var e=t.viewport,n=t.devicePixelRatio,r=void 0===n?1:n,i=t.modelMatrix,a=void 0===i?null:i,s=t.coordinateSystem,u=void 0===s?o.a.DEFAULT:s,l=t.coordinateOrigin,d=void 0===l?f:l,p=t.autoWrapLongitude,v=void 0!==p&&p;u===o.a.DEFAULT&&(u=e.isGeospatial?o.a.LNGLAT:o.a.CARTESIAN);var g=h({viewport:e,devicePixelRatio:r,coordinateSystem:u,coordinateOrigin:d});return g.project_uWrapLongitude=v,g.project_uModelMatrix=a||c,g}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=function(){function t(e,n){i()(this,t),u()(this,"_viewportProps",void 0),u()(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}return a()(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getState",value:function(){return this._state}}]),t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return d})),n.d(e,"c",(function(){return v}));var r=n(8),i=n.n(r),o=n(4),a=n.n(o),s=n(168),u=n(32),c=n(141),l=n(124),f="Cannot convert supplied data type";function h(t,e,n){if(e.text&&"string"==typeof t)return t;if(Object(u.c)(t)&&(t=t.buffer),t instanceof ArrayBuffer){var r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);var i=t.buffer,o=t.byteLength||t.length;return 0===t.byteOffset&&o===i.byteLength||(i=i.slice(t.byteOffset,t.byteOffset+o)),i}throw new Error(f)}function d(t,e,n){return p.apply(this,arguments)}function p(){return(p=i()(a.a.mark((function t(e,n,r){var i,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e instanceof ArrayBuffer||ArrayBuffer.isView(e),"string"!=typeof e&&!i){t.next=3;break}return t.abrupt("return",h(e,n));case 3:if(!Object(u.b)(e)){t.next=7;break}return t.next=6,Object(l.b)(e);case 6:e=t.sent;case 7:if(!Object(u.j)(e)){t.next=21;break}return o=e,t.next=11,Object(l.a)(o);case 11:if(!n.binary){t.next=17;break}return t.next=14,o.arrayBuffer();case 14:t.t0=t.sent,t.next=20;break;case 17:return t.next=19,o.text();case 19:t.t0=t.sent;case 20:return t.abrupt("return",t.t0);case 21:if(Object(u.i)(e)&&(e=Object(c.a)(e,r)),!Object(u.d)(e)&&!Object(u.a)(e)){t.next=24;break}return t.abrupt("return",Object(s.a)(e));case 24:throw new Error(f);case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function v(t,e){return g.apply(this,arguments)}function g(){return(g=i()(a.a.mark((function t(e,n){var r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Object(u.e)(e)){t.next=2;break}return t.abrupt("return",e);case 2:if(!Object(u.j)(e)){t.next=10;break}return r=e,t.next=6,Object(l.a)(r);case 6:return t.next=8,r.body;case 8:return i=t.sent,t.abrupt("return",Object(c.a)(i,n));case 10:if(!Object(u.b)(e)&&!Object(u.i)(e)){t.next=12;break}return t.abrupt("return",Object(c.a)(e,n));case 12:if(!Object(u.a)(e)){t.next=14;break}return t.abrupt("return",e[Symbol.asyncIterator]());case 14:return t.abrupt("return",y(e));case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function y(t){if(ArrayBuffer.isView(t))return a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.buffer;case 2:case"end":return e.stop()}}),e)}))();if(t instanceof ArrayBuffer)return a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:case"end":return e.stop()}}),e)}))();if(Object(u.e)(t))return t;if(Object(u.d)(t))return t[Symbol.iterator]();throw new Error(f)}},function(t,e,n){var r=n(310);t.exports=function(t,e){if(null==t)return{};var n,i,o=r(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}},function(t,e,n){"use strict";var r=n(4),i=n.n(r),o=i.a.mark(a);function a(t,e){var n,r,a,s,u;return i.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=(null==e?void 0:e.chunkSize)||262144,r=0,a=new TextEncoder;case 3:if(!(r<t.length)){i.next=11;break}return s=Math.min(t.length-r,n),u=t.slice(r,r+s),r+=s,i.next=9,a.encode(u);case 9:i.next=3;break;case 11:case"end":return i.stop()}}),o)}var s=i.a.mark(u);function u(t){var e,n,r,o,a,u,c,l=arguments;return i.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:e=l.length>1&&void 0!==l[1]?l[1]:{},n=e.chunkSize,r=void 0===n?262144:n,o=0;case 3:if(!(o<t.byteLength)){i.next=14;break}return a=Math.min(t.byteLength-o,r),u=new ArrayBuffer(a),c=new Uint8Array(t,o,a),new Uint8Array(u).set(c),o+=a,i.next=12,u;case 12:i.next=3;break;case 14:case"end":return i.stop()}}),s)}var c=n(51),l=n.n(c),f=n(68),h=n.n(f);function d(){return(d=h()(i.a.mark((function t(e,n){var r,o,a,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=(null==n?void 0:n.chunkSize)||1048576,o=0;case 2:if(!(o<e.size)){t.next=12;break}return a=o+r,t.next=6,l()(e.slice(o,a).arrayBuffer());case 6:return s=t.sent,o=a,t.next=10,s;case 10:t.next=2;break;case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var p=n(60),v=n.n(p),g=n(93),y=n(109);function m(t,e){return g.c?function(t,e){return b.apply(this,arguments)}(t,e):function(t,e){return A.apply(this,arguments)}(t,e)}function b(){return(b=h()(i.a.mark((function t(e,n){var r,o,a,s,u,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=e.getReader(),t.prev=1;case 2:return a=o||r.read(),null!=n&&n._streamReadAhead&&(o=r.read()),t.next=7,l()(a);case 7:if(s=t.sent,u=s.done,c=s.value,!u){t.next=12;break}return t.abrupt("return");case 12:return t.next=14,Object(y.d)(c);case 14:t.next=2;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(1),r.releaseLock();case 21:case"end":return t.stop()}}),t,null,[[1,18]])})))).apply(this,arguments)}function A(){return(A=h()(i.a.mark((function t(e,n){var r,o,a,s,u,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!1,o=!1,t.prev=2,s=v()(e);case 4:return t.next=6,l()(s.next());case 6:if(!(r=!(u=t.sent).done)){t.next=13;break}return c=u.value,t.next=10,Object(y.d)(c);case 10:r=!1,t.next=4;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(2),o=!0,a=t.t0;case 19:if(t.prev=19,t.prev=20,!r||null==s.return){t.next=24;break}return t.next=24,l()(s.return());case 24:if(t.prev=24,!o){t.next=27;break}throw a;case 27:return t.finish(24);case 28:return t.finish(19);case 29:case"end":return t.stop()}}),t,null,[[2,15,19,29],[20,,24,28]])})))).apply(this,arguments)}var _=n(32);function O(t,e){if("string"==typeof t)return a(t,e);if(t instanceof ArrayBuffer)return u(t,e);if(Object(_.b)(t))return function(t,e){return d.apply(this,arguments)}(t,e);if(Object(_.i)(t))return m(t,e);if(Object(_.j)(t))return m(t.body,e);throw new Error("makeIterator")}n.d(e,"a",(function(){return O}))},function(t,e,n){var r,i,o;
/**
 * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/long.js for details
 */i=[],void 0===(o="function"==typeof(r=function(){"use strict";function t(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function e(t){return!0===(t&&t.__isLong__)}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),t.isLong=e;var n={},r={};function i(t,e){var i,o,s;return e?(s=0<=(t>>>=0)&&t<256)&&(o=r[t])?o:(i=a(t,(0|t)<0?-1:0,!0),s&&(r[t]=i),i):(s=-128<=(t|=0)&&t<128)&&(o=n[t])?o:(i=a(t,t<0?-1:0,!1),s&&(n[t]=i),i)}function o(t,e){if(isNaN(t)||!isFinite(t))return e?v:p;if(e){if(t<0)return v;if(t>=f)return A}else{if(t<=-h)return _;if(t+1>=h)return b}return t<0?o(-t,e).neg():a(t%l|0,t/l|0,e)}function a(e,n,r){return new t(e,n,r)}t.fromInt=i,t.fromNumber=o,t.fromBits=a;var s=Math.pow;function u(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return p;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return u(t.substring(1),e,n).neg();for(var i=o(s(n,8)),a=p,c=0;c<t.length;c+=8){var l=Math.min(8,t.length-c),f=parseInt(t.substring(c,c+l),n);if(l<8){var h=o(s(n,l));a=a.mul(h).add(o(f))}else a=(a=a.mul(i)).add(o(f))}return a.unsigned=e,a}function c(e){return e instanceof t?e:"number"==typeof e?o(e):"string"==typeof e?u(e):a(e.low,e.high,e.unsigned)}t.fromString=u,t.fromValue=c;var l=4294967296,f=l*l,h=f/2,d=i(1<<24),p=i(0);t.ZERO=p;var v=i(0,!0);t.UZERO=v;var g=i(1);t.ONE=g;var y=i(1,!0);t.UONE=y;var m=i(-1);t.NEG_ONE=m;var b=a(-1,2147483647,!1);t.MAX_VALUE=b;var A=a(-1,-1,!0);t.MAX_UNSIGNED_VALUE=A;var _=a(0,-2147483648,!1);t.MIN_VALUE=_;var O=t.prototype;return O.toInt=function(){return this.unsigned?this.low>>>0:this.low},O.toNumber=function(){return this.unsigned?(this.high>>>0)*l+(this.low>>>0):this.high*l+(this.low>>>0)},O.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(_)){var e=o(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=o(s(t,6),this.unsigned),a=this,u="";;){var c=a.div(i),l=(a.sub(c.mul(i)).toInt()>>>0).toString(t);if((a=c).isZero())return l+u;for(;l.length<6;)l="0"+l;u=""+l+u}},O.getHighBits=function(){return this.high},O.getHighBitsUnsigned=function(){return this.high>>>0},O.getLowBits=function(){return this.low},O.getLowBitsUnsigned=function(){return this.low>>>0},O.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},O.isZero=function(){return 0===this.high&&0===this.low},O.isNegative=function(){return!this.unsigned&&this.high<0},O.isPositive=function(){return this.unsigned||this.high>=0},O.isOdd=function(){return 1==(1&this.low)},O.isEven=function(){return 0==(1&this.low)},O.equals=function(t){return e(t)||(t=c(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},O.eq=O.equals,O.notEquals=function(t){return!this.eq(t)},O.neq=O.notEquals,O.lessThan=function(t){return this.comp(t)<0},O.lt=O.lessThan,O.lessThanOrEqual=function(t){return this.comp(t)<=0},O.lte=O.lessThanOrEqual,O.greaterThan=function(t){return this.comp(t)>0},O.gt=O.greaterThan,O.greaterThanOrEqual=function(t){return this.comp(t)>=0},O.gte=O.greaterThanOrEqual,O.compare=function(t){if(e(t)||(t=c(t)),this.eq(t))return 0;var n=this.isNegative(),r=t.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},O.comp=O.compare,O.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(g)},O.neg=O.negate,O.add=function(t){e(t)||(t=c(t));var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=t.high>>>16,u=65535&t.high,l=t.low>>>16,f=0,h=0,d=0,p=0;return d+=(p+=o+(65535&t.low))>>>16,h+=(d+=i+l)>>>16,f+=(h+=r+u)>>>16,f+=n+s,a((d&=65535)<<16|(p&=65535),(f&=65535)<<16|(h&=65535),this.unsigned)},O.subtract=function(t){return e(t)||(t=c(t)),this.add(t.neg())},O.sub=O.subtract,O.multiply=function(t){if(this.isZero())return p;if(e(t)||(t=c(t)),t.isZero())return p;if(this.eq(_))return t.isOdd()?_:p;if(t.eq(_))return this.isOdd()?_:p;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(d)&&t.lt(d))return o(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,s=65535&this.low,u=t.high>>>16,l=65535&t.high,f=t.low>>>16,h=65535&t.low,v=0,g=0,y=0,m=0;return y+=(m+=s*h)>>>16,g+=(y+=i*h)>>>16,y&=65535,g+=(y+=s*f)>>>16,v+=(g+=r*h)>>>16,g&=65535,v+=(g+=i*f)>>>16,g&=65535,v+=(g+=s*l)>>>16,v+=n*h+r*f+i*l+s*u,a((y&=65535)<<16|(m&=65535),(v&=65535)<<16|(g&=65535),this.unsigned)},O.mul=O.multiply,O.divide=function(t){if(e(t)||(t=c(t)),t.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?v:p;var n,r,i;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return v;if(t.gt(this.shru(1)))return y;i=v}else{if(this.eq(_))return t.eq(g)||t.eq(m)?_:t.eq(_)?g:(n=this.shr(1).div(t).shl(1)).eq(p)?t.isNegative()?g:m:(r=this.sub(t.mul(n)),i=n.add(r.div(t)));if(t.eq(_))return this.unsigned?v:p;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=p}for(r=this;r.gte(t);){n=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(n)/Math.LN2),u=a<=48?1:s(2,a-48),l=o(n),f=l.mul(t);f.isNegative()||f.gt(r);)f=(l=o(n-=u,this.unsigned)).mul(t);l.isZero()&&(l=g),i=i.add(l),r=r.sub(f)}return i},O.div=O.divide,O.modulo=function(t){return e(t)||(t=c(t)),this.sub(this.div(t).mul(t))},O.mod=O.modulo,O.not=function(){return a(~this.low,~this.high,this.unsigned)},O.and=function(t){return e(t)||(t=c(t)),a(this.low&t.low,this.high&t.high,this.unsigned)},O.or=function(t){return e(t)||(t=c(t)),a(this.low|t.low,this.high|t.high,this.unsigned)},O.xor=function(t){return e(t)||(t=c(t)),a(this.low^t.low,this.high^t.high,this.unsigned)},O.shiftLeft=function(t){return e(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?a(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):a(0,this.low<<t-32,this.unsigned)},O.shl=O.shiftLeft,O.shiftRight=function(t){return e(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?a(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):a(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},O.shr=O.shiftRight,O.shiftRightUnsigned=function(t){if(e(t)&&(t=t.toInt()),0==(t&=63))return this;var n=this.high;return t<32?a(this.low>>>t|n<<32-t,n>>>t,this.unsigned):a(32===t?n:n>>>t-32,0,this.unsigned)},O.shru=O.shiftRightUnsigned,O.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},O.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},O.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},O.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24&255,255&t,t>>>8&255,t>>>16&255,t>>>24&255]},O.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24&255,t>>>16&255,t>>>8&255,255&t,e>>>24&255,e>>>16&255,e>>>8&255,255&e]},t})?r.apply(e,i):r)||(t.exports=o)},function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return d}));var r=n(75),i=n(20);function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var s=Math.PI/180,u=new Float32Array(16),c=new Float32Array(12);function l(t,e,n){var r=e[0]*s,i=e[1]*s,o=e[2]*s,a=Math.sin(o),u=Math.sin(r),c=Math.sin(i),l=Math.cos(o),f=Math.cos(r),h=Math.cos(i),d=n[0],p=n[1],v=n[2];t[0]=d*h*f,t[1]=d*c*f,t[2]=d*-u,t[3]=p*(-c*l+h*u*a),t[4]=p*(h*l+c*u*a),t[5]=p*f*a,t[6]=v*(c*a+h*u*l),t[7]=v*(-h*a+c*u*l),t[8]=v*f*l}function f(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}var h={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update:function(t,e){var n=e.startRow,i=e.endRow,a=this.props,s=a.data,h=a.getOrientation,d=a.getScale,p=a.getTranslation,v=a.getTransformMatrix,g=Array.isArray(v),y=g&&16===v.length,m=Array.isArray(d),b=Array.isArray(h),A=Array.isArray(p),_=y||!g&&Boolean(v(s[0]));t.constant=_?y:b&&m&&A;var O=t.value;if(t.constant){var w;if(_)u.set(v),w=f(u);else l(w=c,h,d),w.set(p,9);t.value=new Float32Array(w)}else{var x,C=n*t.size,P=Object(r.a)(s,n,i),S=P.iterable,B=P.objectInfo,k=o(S);try{for(k.s();!(x=k.n()).done;){var E=x.value;B.index++;var T=void 0;if(_)u.set(y?v:v(E,B)),T=f(u);else l(T=c,b?h:h(E,B),m?d:d(E,B)),T.set(A?p:p(E,B),9);O[C++]=T[0],O[C++]=T[1],O[C++]=T[2],O[C++]=T[3],O[C++]=T[4],O[C++]=T[5],O[C++]=T[6],O[C++]=T[7],O[C++]=T[8],O[C++]=T[9],O[C++]=T[10],O[C++]=T[11]}}catch(t){k.e(t)}finally{k.f()}}}};function d(t,e){return e===i.a.CARTESIAN||e===i.a.METER_OFFSETS||e===i.a.DEFAULT&&!t.isGeospatial}},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return f}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(12),u=n(110),c=n(152),l=function(){function t(){i()(this,t),this.stats=new Map}return a()(t,[{key:"get",value:function(t){return this.stats.has(t)||this.stats.set(t,new u.a({id:t})),this.stats.get(t)}}]),t}(),f=new l;if(globalThis.luma&&"8.5.16"!==globalThis.luma.VERSION)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat("8.5.16"));globalThis.luma||(Object(c.a)()&&s.k.log(1,"luma.gl ".concat("8.5.16"," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:"8.5.16",version:"8.5.16",log:s.k,stats:f,globals:{modules:{},nodeIO:{}}});globalThis.luma},function(t,e){},function(t,e){},function(t,e,n){"use strict";var r=n(22),i=n.n(r),o=n(11),a=n.n(o),s=n(16),u=n.n(s),c=n(6),l=n(8),f=n.n(l),h=n(4),d=n.n(h),p=n(70),v=function t(){a()(this,t)},g=n(74),y=new Map;function m(t){Object(g.a)(t.source&&!t.url||!t.source&&t.url);var e=y.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return b((e=t,"try {\n  importScripts('".concat(e,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")));var e}(t.url),y.set(t.url,e)),t.source&&(e=b(t.source),y.set(t.source,e))),Object(g.a)(e),e}function b(t){var e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}var A=n(190),_=function(){},O=function(){function t(e){a()(this,t),Object(c.a)(this,"name",void 0),Object(c.a)(this,"source",void 0),Object(c.a)(this,"url",void 0),Object(c.a)(this,"terminated",!1),Object(c.a)(this,"worker",void 0),Object(c.a)(this,"onMessage",void 0),Object(c.a)(this,"onError",void 0),Object(c.a)(this,"_loadableURL","");var n=e.name,r=e.source,i=e.url;Object(g.a)(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=_,this.onError=function(t){return console.log(t)},this.worker=p.b?this._createBrowserWorker():this._createNodeWorker()}return u()(t,[{key:"destroy",value:function(){this.onMessage=_,this.onError=_,this.worker.terminate(),this.terminated=!0}},{key:"isRunning",get:function(){return Boolean(this.onMessage)}},{key:"postMessage",value:function(t,e){e=e||Object(A.a)(t),this.worker.postMessage(t,e)}},{key:"_getErrorFromErrorEvent",value:function(t){var e="Failed to load ";return e+="worker ".concat(this.name," from ").concat(this.url,". "),t.message&&(e+="".concat(t.message," in ")),t.lineno&&(e+=":".concat(t.lineno,":").concat(t.colno)),new Error(e)}},{key:"_createBrowserWorker",value:function(){var t=this;this._loadableURL=m({source:this.source,url:this.url});var e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=function(e){e.data?t.onMessage(e.data):t.onError(new Error("No data received"))},e.onerror=function(e){t.onError(t._getErrorFromErrorEvent(e)),t.terminated=!0},e.onmessageerror=function(t){return console.error(t)},e}},{key:"_createNodeWorker",value:function(){var t,e=this;if(this.url){var n=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);t=new v(n,{eval:!1})}else{if(!this.source)throw new Error("no worker");t=new v(this.source,{eval:!0})}return t.on("message",(function(t){e.onMessage(t)})),t.on("error",(function(t){e.onError(t)})),t.on("exit",(function(t){})),t}}],[{key:"isSupported",value:function(){return"undefined"!=typeof Worker&&p.b||!p.b}}]),t}(),w=function(){function t(e,n){var r=this;a()(this,t),Object(c.a)(this,"name",void 0),Object(c.a)(this,"workerThread",void 0),Object(c.a)(this,"isRunning",!0),Object(c.a)(this,"result",void 0),Object(c.a)(this,"_resolve",(function(){})),Object(c.a)(this,"_reject",(function(){})),this.name=e,this.workerThread=n,this.result=new Promise((function(t,e){r._resolve=t,r._reject=e}))}return u()(t,[{key:"postMessage",value:function(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}},{key:"done",value:function(t){Object(g.a)(this.isRunning),this.isRunning=!1,this._resolve(t)}},{key:"error",value:function(t){Object(g.a)(this.isRunning),this.isRunning=!1,this._reject(t)}}]),t}();function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var P=function(){function t(e){a()(this,t),Object(c.a)(this,"name","unnamed"),Object(c.a)(this,"source",void 0),Object(c.a)(this,"url",void 0),Object(c.a)(this,"maxConcurrency",1),Object(c.a)(this,"maxMobileConcurrency",1),Object(c.a)(this,"onDebug",(function(){})),Object(c.a)(this,"reuseWorkers",!0),Object(c.a)(this,"props",{}),Object(c.a)(this,"jobQueue",[]),Object(c.a)(this,"idleQueue",[]),Object(c.a)(this,"count",0),Object(c.a)(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}var e,n;return u()(t,[{key:"destroy",value:function(){this.idleQueue.forEach((function(t){return t.destroy()})),this.isDestroyed=!0}},{key:"setProps",value:function(t){this.props=C(C({},this.props),t),void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}},{key:"startJob",value:(n=f()(d.a.mark((function t(e){var n,r,i,o=this,a=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:function(t,e,n){return t.done(n)},r=a.length>2&&void 0!==a[2]?a[2]:function(t,e){return t.error(e)},i=new Promise((function(t){return o.jobQueue.push({name:e,onMessage:n,onError:r,onStart:t}),o})),this._startQueuedJob(),t.next=6,i;case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"_startQueuedJob",value:(e=f()(d.a.mark((function t(){var e,n,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.jobQueue.length){t.next=2;break}return t.abrupt("return");case 2:if(e=this._getAvailableWorker()){t.next=5;break}return t.abrupt("return");case 5:if(!(n=this.jobQueue.shift())){t.next=18;break}return this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length}),r=new w(n.name,e),e.onMessage=function(t){return n.onMessage(r,t.type,t.payload)},e.onError=function(t){return n.onError(r,t)},n.onStart(r),t.prev=12,t.next=15,r.result;case 15:return t.prev=15,this.returnWorkerToQueue(e),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[12,,15,18]])}))),function(){return e.apply(this,arguments)})},{key:"returnWorkerToQueue",value:function(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}},{key:"_getAvailableWorker",value:function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;var t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new O({name:t,source:this.source,url:this.url})}return null}},{key:"_getMaxConcurrency",value:function(){return p.c?this.maxMobileConcurrency:this.maxConcurrency}}],[{key:"isSupported",value:function(){return O.isSupported()}}]),t}();function S(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return B(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n.d(e,"a",(function(){return j}));var T={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:function(){}},j=function(){function t(e){a()(this,t),Object(c.a)(this,"props",void 0),Object(c.a)(this,"workerPools",new Map),this.props=E({},T),this.setProps(e),this.workerPools=new Map}return u()(t,[{key:"destroy",value:function(){var t,e=S(this.workerPools.values());try{for(e.s();!(t=e.n()).done;){t.value.destroy()}}catch(t){e.e(t)}finally{e.f()}this.workerPools=new Map}},{key:"setProps",value:function(t){this.props=E(E({},this.props),t);var e,n=S(this.workerPools.values());try{for(n.s();!(e=n.n()).done;){e.value.setProps(this._getWorkerPoolProps())}}catch(t){n.e(t)}finally{n.f()}}},{key:"getWorkerPool",value:function(t){var e=t.name,n=t.source,r=t.url,i=this.workerPools.get(e);return i||((i=new P({name:e,source:n,url:r})).setProps(this._getWorkerPoolProps()),this.workerPools.set(e,i)),i}},{key:"_getWorkerPoolProps",value:function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}],[{key:"isSupported",value:function(){return O.isSupported()}},{key:"getWorkerFarm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t._workerFarm=t._workerFarm||new t({}),t._workerFarm.setProps(e),t._workerFarm}}]),t}();Object(c.a)(j,"_workerFarm",void 0)},function(t,e,n){"use strict";n.d(e,"c",(function(){return f})),n.d(e,"d",(function(){return d})),n.d(e,"a",(function(){return v})),n.d(e,"b",(function(){return y}));var r=n(51),i=n.n(r),o=n(68),a=n.n(o),s=n(60),u=n.n(s),c=n(4),l=n.n(c);function f(t){return h.apply(this,arguments)}function h(){return(h=a()(l.a.mark((function t(e){var n,r,o,a,s,c,f,h,d=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=d.length>1&&void 0!==d[1]?d[1]:{},r=new TextDecoder(void 0,n),o=!1,a=!1,t.prev=4,c=u()(e);case 6:return t.next=8,i()(c.next());case 8:if(!(o=!(f=t.sent).done)){t.next=15;break}return h=f.value,t.next=12,"string"==typeof h?h:r.decode(h,{stream:!0});case 12:o=!1,t.next=6;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(4),a=!0,s=t.t0;case 21:if(t.prev=21,t.prev=22,!o||null==c.return){t.next=26;break}return t.next=26,i()(c.return());case 26:if(t.prev=26,!a){t.next=29;break}throw s;case 29:return t.finish(26);case 30:return t.finish(21);case 31:case"end":return t.stop()}}),t,null,[[4,17,21,31],[22,,26,30]])})))).apply(this,arguments)}function d(t){return p.apply(this,arguments)}function p(){return(p=a()(l.a.mark((function t(e){var n,r,o,a,s,c,f;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new TextEncoder,r=!1,o=!1,t.prev=3,s=u()(e);case 5:return t.next=7,i()(s.next());case 7:if(!(r=!(c=t.sent).done)){t.next=14;break}return f=c.value,t.next=11,"string"==typeof f?n.encode(f):f;case 11:r=!1,t.next=5;break;case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(3),o=!0,a=t.t0;case 20:if(t.prev=20,t.prev=21,!r||null==s.return){t.next=25;break}return t.next=25,i()(s.return());case 25:if(t.prev=25,!o){t.next=28;break}throw a;case 28:return t.finish(25);case 29:return t.finish(20);case 30:case"end":return t.stop()}}),t,null,[[3,16,20,30],[21,,25,29]])})))).apply(this,arguments)}function v(t){return g.apply(this,arguments)}function g(){return(g=a()(l.a.mark((function t(e){var n,r,o,a,s,c,f,h,d;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n="",r=!1,o=!1,t.prev=3,s=u()(e);case 5:return t.next=7,i()(s.next());case 7:if(!(r=!(c=t.sent).done)){t.next=21;break}f=c.value,n+=f,h=void 0;case 11:if(!((h=n.indexOf("\n"))>=0)){t.next=18;break}return d=n.slice(0,h+1),n=n.slice(h+1),t.next=16,d;case 16:t.next=11;break;case 18:r=!1,t.next=5;break;case 21:t.next=27;break;case 23:t.prev=23,t.t0=t.catch(3),o=!0,a=t.t0;case 27:if(t.prev=27,t.prev=28,!r||null==s.return){t.next=32;break}return t.next=32,i()(s.return());case 32:if(t.prev=32,!o){t.next=35;break}throw a;case 35:return t.finish(32);case 36:return t.finish(27);case 37:if(!(n.length>0)){t.next=40;break}return t.next=40,n;case 40:case"end":return t.stop()}}),t,null,[[3,23,27,37],[28,,32,36]])})))).apply(this,arguments)}function y(t){return m.apply(this,arguments)}function m(){return(m=a()(l.a.mark((function t(e){var n,r,o,a,s,c,f;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=1,r=!1,o=!1,t.prev=3,s=u()(e);case 5:return t.next=7,i()(s.next());case 7:if(!(r=!(c=t.sent).done)){t.next=15;break}return f=c.value,t.next=11,{counter:n,line:f};case 11:n++;case 12:r=!1,t.next=5;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(3),o=!0,a=t.t0;case 21:if(t.prev=21,t.prev=22,!r||null==s.return){t.next=26;break}return t.next=26,i()(s.return());case 26:if(t.prev=26,!o){t.next=29;break}throw a;case 29:return t.finish(26);case 30:return t.finish(21);case 31:case"end":return t.stop()}}),t,null,[[3,17,21,31],[22,,26,30]])})))).apply(this,arguments)}},function(t,e,n){"use strict";function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return i(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){var n=0;return i(t,n,e)}return""}function i(t,e,n){if(t.byteLength<=e+n)return"";for(var r=new DataView(t),i="",o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(e+o));return i}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return c}));var r=n(26),i=n.n(r),o=n(37);function a(t){var e=d(t);for(var n in e){var r=e[n],i=r.validate;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function s(t,e){var n=c({newProps:t,oldProps:e,propTypes:d(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(t,e){if(null===e)return"oldProps is null, initial diff";var n=!1,r=t.dataComparator,i=t._dataDiff;r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied");n&&i&&(n=i(t.data,e.data)||n);return n}(t,e),i=!1;return r||(i=function(t,e){if(null===e)return{all:!0};if("all"in t.updateTriggers){if(h(t,e,"all"))return{all:!0}}var n={},r=!1;for(var i in t.updateTriggers){if("all"!==i)h(t,e,i)&&(n[i]=!0,r=!0)}return!!r&&n}(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:f(t,e),transitionsChanged:u(t,e)}}function u(t,e){if(!t.transitions)return!1;var n={},r=d(t),i=!1;for(var o in t.transitions){var a=r[o],s=a&&a.type;("number"===s||"color"===s||"array"===s)&&l(t[o],e[o],a)&&(n[o]=!0,i=!0)}return!!i&&n}function c(t){var e=t.newProps,n=t.oldProps,r=t.ignoreProps,o=void 0===r?{}:r,a=t.propTypes,s=void 0===a?{}:a,u=t.triggerName,c=void 0===u?"props":u;if(n===e)return!1;if("object"!==i()(e)||null===e)return"".concat(c," changed shallowly");if("object"!==i()(n)||null===n)return"".concat(c," changed shallowly");for(var f=0,h=Object.keys(e);f<h.length;f++){var d=h[f];if(!(d in o)){if(!(d in n))return"".concat(c,".").concat(d," added");var p=l(e[d],n[d],s[d]);if(p)return"".concat(c,".").concat(d," ").concat(p)}}for(var v=0,g=Object.keys(n);v<g.length;v++){var y=g[v];if(!(y in o)){if(!(y in e))return"".concat(c,".").concat(y," dropped");if(!Object.hasOwnProperty.call(e,y)){var m=l(e[y],n[y],s[y]);if(m)return"".concat(c,".").concat(y," ").concat(m)}}}return!1}function l(t,e,n){var r=n&&n.equal;return r&&!r(t,e,n)?"changed deeply":r||!(r=t&&e&&t.equals)||r.call(t,e)?r||e===t?null:"changed shallowly":"changed deeply"}function f(t,e){if(null===e)return!0;var n=e.extensions,r=t.extensions;if(r===n)return!1;if(!n||!r)return!0;if(r.length!==n.length)return!0;for(var i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function h(t,e,n){var r=t.updateTriggers[n];r=null==r?{}:r;var i=e.updateTriggers[n];return c({oldProps:i=null==i?{}:i,newProps:r,triggerName:n})}function d(t){var e=t[o.d],n=e&&e.constructor;return n?n._propTypes:{}}},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=n(210),l=n(123),f=n(164),h=n(118),d=n(98),p=n(106),v=n(9),g=n.n(v),y=n(10),m=n.n(y),b=n(5),A=n.n(b),_=n(7),O=n.n(_),w=n(2),x=n.n(w),C=n(94),P=n(125),S=n(95),B=n(12);function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=x()(t);if(e){var i=x()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return O()(this,n)}}var j=function(t){A()(n,t);var e=T(n);function n(t,r){var o,a,s;return i()(this,n),s=e.call(this,t,r),u()(g()(s),"shadowMap",void 0),u()(g()(s),"depthBuffer",void 0),u()(g()(s),"fbo",void 0),s.shadowMap=new l.a(t,{width:1,height:1,parameters:(o={},u()(o,10241,9729),u()(o,10240,9729),u()(o,10242,33071),u()(o,10243,33071),o)}),s.depthBuffer=new P.a(t,{format:33189,width:1,height:1}),s.fbo=new S.a(t,{id:"shadowmap",width:1,height:1,attachments:(a={},u()(a,36064,s.shadowMap),u()(a,36096,s.depthBuffer),a)}),s}return a()(n,[{key:"render",value:function(t){var e=this,r=this.fbo;Object(B.o)(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(function(){var i=t.viewports[0],o=Object(B.e)(e.gl),a=i.width*o,s=i.height*o;a===r.width&&s===r.height||r.resize({width:a,height:s}),m()(x()(n.prototype),"render",e).call(e,E(E({},t),{},{target:r,pass:"shadow"}))}))}},{key:"shouldDrawLayer",value:function(t){return!1!==t.props.shadowEnabled}},{key:"getModuleParameters",value:function(){return{drawToShadowMap:!0}}},{key:"delete",value:function(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}]),n}(C.a),M=n(136);function I(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return R(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return G}));var D={color:[255,255,255],intensity:1},L=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],F=[0,0,0,200/255],G=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var n in i()(this,t),u()(this,"id","lighting-effect"),u()(this,"props",null),u()(this,"shadowColor",F),u()(this,"shadow",void 0),u()(this,"ambientLight",null),u()(this,"directionalLights",[]),u()(this,"pointLights",[]),u()(this,"shadowPasses",[]),u()(this,"shadowMaps",[]),u()(this,"dummyShadowMap",null),u()(this,"programManager",void 0),u()(this,"shadowMatrices",void 0),e){var r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((function(t){return t.shadow}))}return a()(t,[{key:"preRender",value:function(t,e){var n=e.layers,r=e.layerFilter,i=e.viewports,o=e.onViewportActive,a=e.views;if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=c.a.getDefaultProgramManager(t),M.a&&this.programManager.addDefaultModule(M.a)),this.dummyShadowMap||(this.dummyShadowMap=new l.a(t,{width:1,height:1}));for(var s=0;s<this.shadowPasses.length;s++){this.shadowPasses[s].render({layers:n,layerFilter:r,viewports:i,onViewportActive:o,views:a,moduleParameters:{shadowLightId:s,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}}},{key:"getModuleParameters",value:function(t){var e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((function(e){return e.getProjectedLight({layer:t})})),pointLights:this.pointLights.map((function(e){return e.getProjectedLight({layer:t})}))},e}},{key:"cleanup",value:function(){var t,e=I(this.shadowPasses);try{for(e.s();!(t=e.n()).done;){t.value.delete()}}catch(t){e.e(t)}finally{e.f()}this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(M.a),this.programManager=null)}},{key:"_calculateMatrices",value:function(){var t,e=[],n=I(this.directionalLights);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=(new d.a).lookAt({eye:new p.a(r.direction).negate()});e.push(i)}}catch(t){n.e(t)}finally{n.f()}return e}},{key:"_createShadowPasses",value:function(t){for(var e=0;e<this.directionalLights.length;e++){var n=new j(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}},{key:"_applyDefaultLights",value:function(){var t=this.ambientLight,e=this.pointLights,n=this.directionalLights;t||0!==e.length||0!==n.length||(this.ambientLight=new f.a(D),this.directionalLights.push(new h.a(L[0]),new h.a(L[1])))}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(26),i=n.n(r),o=n(185);function a(){return!("object"===("undefined"==typeof process?"undefined":i()(process))&&"[object process]"===String(process)&&!process.browser)||Object(o.a)()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(12);function i(t,e,n){var i=n.removedProps,o=void 0===i?{}:i,a=n.deprecatedProps,s=void 0===a?{}:a,u=n.replacedProps,c=void 0===u?{}:u;for(var l in o)if(l in e){var f=o[l]?"".concat(t,".").concat(o[l]):"N/A";r.k.removed("".concat(t,".").concat(l),f)()}for(var h in s)if(h in e){var d=s[h];r.k.deprecated("".concat(t,".").concat(h),"".concat(t,".").concat(d))()}var p=null;for(var v in c)if(v in e){var g=c[v];r.k.deprecated("".concat(t,".").concat(v),"".concat(t,".").concat(g))(),(p=p||Object.assign({},e))[g]=e[v],delete p[v]}return p||e}},function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return d}));var r=n(15),i=n.n(r),o=n(20),a=n(137),s=n(102),u=n(111),c=n(105),l=n(33);function f(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.projectPosition(t);if(n&&e instanceof s.a){var o=i()(t,3),a=o[0],u=o[1],c=o[2],l=void 0===c?0:c,f=e.getDistanceScales([a,u]);r[2]=l*f.unitsPerMeter[2]}return r}function h(t,e){var n=e.viewport,r=e.modelMatrix,a=e.coordinateSystem,s=e.coordinateOrigin,c=e.offsetMode,h=i()(t,3),d=h[0],p=h[1],v=h[2],g=void 0===v?0:v;if(r){var y=u.b([],[d,p,g,1],r),m=i()(y,3);d=m[0],p=m[1],g=m[2]}switch(a){case o.a.LNGLAT:return f([d,p,g],n,c);case o.a.LNGLAT_OFFSETS:return f([d+s[0],p+s[1],g+(s[2]||0)],n,c);case o.a.METER_OFFSETS:return f(Object(l.a)(s,[d,p,g]),n,c);case o.a.CARTESIAN:default:return n.isGeospatial?[d+s[0],p+s[1],g+s[2]]:n.projectPosition([d,p,g])}}function d(t,e){var n=function(t){var e=t.viewport,n=t.modelMatrix,r=t.coordinateOrigin,i=t.coordinateSystem,a=t.fromCoordinateSystem,s=t.fromCoordinateOrigin;return i===o.a.DEFAULT&&(i=e.isGeospatial?o.a.LNGLAT:o.a.CARTESIAN),void 0===a&&(a=i),void 0===s&&(s=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:a,fromCoordinateOrigin:s}}(e),r=n.viewport,i=n.coordinateSystem,s=n.coordinateOrigin,u=n.modelMatrix,l=n.fromCoordinateSystem,f=n.fromCoordinateOrigin,d=Object(a.a)(r,i,s),p=d.geospatialOrigin,v=d.shaderCoordinateOrigin,g=d.offsetMode,y=h(t,{viewport:r,modelMatrix:u,coordinateSystem:l,coordinateOrigin:f,offsetMode:g});if(g){var m=r.projectPosition(p||v);c.d(y,y,m)}return y}},function(t,e,n){"use strict";var r="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n";function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return c}));var a={lightSources:{}};function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.color,n=void 0===e?[0,0,0]:e,r=t.intensity,i=void 0===r?1:r;return n.map((function(t){return t*i/255}))}function u(t){var e=t.ambientLight,n=t.pointLights,r=void 0===n?[]:n,i=t.directionalLights,o=void 0===i?[]:i,a={};return a["lighting_uAmbientLight.color"]=e?s(e):[0,0,0],r.forEach((function(t,e){a["lighting_uPointLight[".concat(e,"].color")]=s(t),a["lighting_uPointLight[".concat(e,"].position")]=t.position,a["lighting_uPointLight[".concat(e,"].attenuation")]=t.attenuation||[1,0,0]})),a.lighting_uPointLightCount=r.length,o.forEach((function(t,e){a["lighting_uDirectionalLight[".concat(e,"].color")]=s(t),a["lighting_uDirectionalLight[".concat(e,"].direction")]=t.direction})),a.lighting_uDirectionalLightCount=o.length,a}var c={name:"lights",vs:r,fs:r,getUniforms:function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;if("lightSources"in e){var n=e.lightSources||{},r=n.ambientLight,o=n.pointLights,s=n.directionalLights,c=r||o&&o.length>0||s&&s.length>0;return c?Object.assign({},u({ambientLight:r,pointLights:o,directionalLights:s}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){var l,f={pointLights:[],directionalLights:[]},h=i(e.lights||[]);try{for(h.s();!(l=h.n()).done;){var d=l.value;switch(d.type){case"ambient":f.ambientLight=d;break;case"directional":f.directionalLights.push(d);break;case"point":f.pointLights.push(d)}}}catch(t){h.e(t)}finally{h.f()}return t({lightSources:f})}return{}},defines:{MAX_LIGHTS:3}}},function(t,e,n){var r=n(290),i=n(291),o=n(222),a=n(292);t.exports=function(t){return r(t)||i(t)||o(t)||a()},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var r;
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */!function(i,o,a,s){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),f=Math.round,h=Math.abs,d=Date.now;function p(t,e,n){return setTimeout(_(t,n),e)}function v(t,e,n){return!!Array.isArray(t)&&(g(t,n[e],n),!0)}function g(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(void 0!==t.length)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function y(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}u="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var m=y((function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&void 0===t[r[i]])&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),b=y((function(t,e){return m(t,e,!0)}),"merge","Use `assign`.");function A(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&u(r,n)}function _(t,e){return function(){return t.apply(e,arguments)}}function O(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function w(t,e){return void 0===t?e:t}function x(t,e,n){g(B(e),(function(e){t.addEventListener(e,n,!1)}))}function C(t,e,n){g(B(e),(function(e){t.removeEventListener(e,n,!1)}))}function P(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function S(t,e){return t.indexOf(e)>-1}function B(t){return t.trim().split(/\s+/g)}function k(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function E(t){return Array.prototype.slice.call(t,0)}function T(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];k(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function j(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((r=(n=c[o])?n+i:e)in t)return r;o++}}var M=1;function I(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var R="ontouchstart"in i,D=void 0!==j(i,"PointerEvent"),L=R&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),F=["x","y"],G=["clientX","clientY"];function N(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){O(t.options.enable,[t])&&n.handler(e)},this.init()}function U(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&e&&r-i==0,a=12&e&&r-i==0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=z(e));i>1&&!n.firstMultiple?n.firstMultiple=z(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,u=e.center=H(r);e.timeStamp=d(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=K(s,u),e.distance=W(s,u),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y});e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=J(e.deltaX,e.deltaY);var c=V(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=c.x,e.overallVelocityY=c.y,e.overallVelocity=h(c.x)>h(c.y)?c.x:c.y,e.scale=a?(l=a.pointers,f=r,W(f[0],f[1],G)/W(l[0],l[1],G)):1,e.rotation=a?function(t,e){return K(e[1],e[0],G)+K(t[1],t[0],G)}(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,a=t.lastInterval||e,s=e.timeStamp-a.timeStamp;if(8!=e.eventType&&(s>25||void 0===a.velocity)){var u=e.deltaX-a.deltaX,c=e.deltaY-a.deltaY,l=V(s,u,c);r=l.x,i=l.y,n=h(l.x)>h(l.y)?l.x:l.y,o=J(u,c),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var l,f;var p=t.element;P(e.srcEvent.target,p)&&(p=e.srcEvent.target);e.target=p}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function z(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:f(t.pointers[n].clientX),clientY:f(t.pointers[n].clientY)},n++;return{timeStamp:d(),pointers:e,center:H(e),deltaX:t.deltaX,deltaY:t.deltaY}}function H(t){var e=t.length;if(1===e)return{x:f(t[0].clientX),y:f(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:f(n/e),y:f(r/e)}}function V(t,e,n){return{x:e/t||0,y:n/t||0}}function J(t,e){return t===e?1:h(t)>=h(e)?t<0?2:4:e<0?8:16}function W(t,e,n){n||(n=F);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function K(t,e,n){n||(n=F);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}N.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(I(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(I(this.element),this.evWin,this.domHandler)}};var X={mousedown:1,mousemove:2,mouseup:4};function q(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,N.apply(this,arguments)}A(q,N,{handler:function(t){var e=X[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var Q={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Z={2:"touch",3:"pen",4:"mouse",5:"kinect"},Y="pointerdown",$="pointermove pointerup pointercancel";function tt(){this.evEl=Y,this.evWin=$,N.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(Y="MSPointerDown",$="MSPointerMove MSPointerUp MSPointerCancel"),A(tt,N,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=Q[r],o=Z[t.pointerType]||t.pointerType,a="touch"==o,s=k(e,t.pointerId,"pointerId");1&i&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):12&i&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var et={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function nt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,N.apply(this,arguments)}function rt(t,e){var n=E(t.touches),r=E(t.changedTouches);return 12&e&&(n=T(n.concat(r),"identifier",!0)),[n,r]}A(nt,N,{handler:function(t){var e=et[t.type];if(1===e&&(this.started=!0),this.started){var n=rt.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var it={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ot(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},N.apply(this,arguments)}function at(t,e){var n=E(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=E(t.changedTouches),s=[],u=this.target;if(o=n.filter((function(t){return P(t.target,u)})),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),12&e&&delete r[a[i].identifier],i++;return s.length?[T(o.concat(s),"identifier",!0),s]:void 0}A(ot,N,{handler:function(t){var e=it[t.type],n=at.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}});function st(){N.apply(this,arguments);var t=_(this.handler,this);this.touch=new ot(this.manager,t),this.mouse=new q(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function ut(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,ct.call(this,e)):12&t&&ct.call(this,e)}function ct(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),2500)}}function lt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=25&&a<=25)return!0}return!1}A(st,N,{handler:function(t,e,n){var r="touch"==n.pointerType,i="mouse"==n.pointerType;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)ut.call(this,e,n);else if(i&&lt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ft=j(l.style,"touchAction"),ht=void 0!==ft,dt=function(){if(!ht)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}();function pt(t,e){this.manager=t,this.set(e)}pt.prototype={set:function(t){"compute"==t&&(t=this.compute()),ht&&this.manager.element.style&&dt[t]&&(this.manager.element.style[ft]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return g(this.manager.recognizers,(function(e){O(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(S(t,"none"))return"none";var e=S(t,"pan-x"),n=S(t,"pan-y");if(e&&n)return"none";if(e||n)return e?"pan-x":"pan-y";if(S(t,"manipulation"))return"manipulation";return"auto"}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=S(r,"none")&&!dt.none,o=S(r,"pan-y")&&!dt["pan-y"],a=S(r,"pan-x")&&!dt["pan-x"];if(i){var s=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(s&&u&&c)return}if(!a||!o)return i||o&&6&n||a&&24&n?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};function vt(t){this.options=u({},this.defaults,t||{}),this.id=M++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function gt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function yt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function mt(t,e){var n=e.manager;return n?n.get(t):t}function bt(){vt.apply(this,arguments)}function At(){bt.apply(this,arguments),this.pX=null,this.pY=null}function _t(){bt.apply(this,arguments)}function Ot(){vt.apply(this,arguments),this._timer=null,this._input=null}function wt(){bt.apply(this,arguments)}function xt(){bt.apply(this,arguments)}function Ct(){vt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Pt(t,e){return(e=e||{}).recognizers=w(e.recognizers,Pt.defaults.preset),new St(t,e)}vt.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(v(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=mt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return v(t,"dropRecognizeWith",this)?this:(t=mt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(v(t,"requireFailure",this))return this;var e=this.requireFail;return-1===k(e,t=mt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(v(t,"dropRequireFailure",this))return this;t=mt(t,this);var e=k(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+gt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+gt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!O(this.options.enable,[this,e]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},A(bt,vt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:32}}),A(At,bt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push("pan-y"),24&t&&e.push("pan-x"),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?1:a<0?8:16,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return bt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=yt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),A(_t,bt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),A(Ot,vt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),A(wt,bt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),A(xt,bt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return At.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:24&n&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&h(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=yt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),A(Ct,vt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||W(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=p((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Pt.VERSION="2.0.7",Pt.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[wt,{enable:!1}],[_t,{enable:!1},["rotate"]],[xt,{direction:6}],[At,{direction:6},["swipe"]],[Ct],[Ct,{event:"doubletap",taps:2},["tap"]],[Ot]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function St(t,e){var n;this.options=u({},Pt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(D?tt:L?ot:R?st:q))(n,U),this.touchAction=new pt(this,this.options.touchAction),Bt(this,!0),g(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Bt(t,e){var n,r=t.element;r.style&&(g(t.options.cssProps,(function(i,o){n=j(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}St.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof vt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(v(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(v(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=k(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(void 0!==t&&void 0!==e){var n=this.handlers;return g(B(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(void 0!==t){var n=this.handlers;return g(B(t),(function(t){e?n[t]&&n[t].splice(k(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&Bt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(Pt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:St,Input:N,TouchAction:pt,TouchInput:ot,MouseInput:q,PointerEventInput:tt,TouchMouseInput:st,SingleTouchInput:nt,Recognizer:vt,AttrRecognizer:bt,Tap:Ct,Pan:At,Swipe:xt,Pinch:_t,Rotate:wt,Press:Ot,on:x,off:C,each:g,merge:b,extend:m,assign:u,inherit:A,bindFn:_,prefixed:j}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=Pt,void 0===(r=function(){return Pt}.call(e,n,e,t))||(t.exports=r)}(window,document)},,,function(t,e){},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(122);function i(t,e){return Object(r.a)(t>=0),Object(r.a)(e>0),t+(e-1)&~(e-1)}function o(t,e,n){var r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{var o=t.byteOffset,a=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,o,a)}return e.set(r,n),n+i(r.byteLength,4)}},function(t,e,n){"use strict";n.r(e);var r=n(246);n.d(e,"SimpleMeshLayer",(function(){return r.a}));var i=n(239);n.d(e,"ScenegraphLayer",(function(){return i.a}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1),i=n.n(r),o=n(0),a=n.n(o),s=[255,255,255],u=0,c=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t),a()(this,"id",void 0),a()(this,"color",void 0),a()(this,"intensity",void 0),a()(this,"type","ambient");var n=e.color,r=void 0===n?s:n,o=e.intensity,c=void 0===o?1:o;this.id=e.id||"ambient-".concat(u++),this.color=r,this.intensity=c}},function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(5),u=n.n(s),c=n(7),l=n.n(c),f=n(2),h=n.n(f),d=n(0),p=n.n(d),v=n(81),g=n(102),y=n(128);function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var b=function(t){u()(n,t);var e=m(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"ViewportType",get:function(){return g.a}},{key:"ControllerType",get:function(){return y.b}}]),n}(v.a);p()(b,"displayName","MapView")},function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return g}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=n(96);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h=function(){},d={BREAK:1,SNAP_TO_END:2,IGNORE:3},p=function(t){return t},v=d.BREAK,g=function(){function t(e){var n=this;i()(this,t),u()(this,"getControllerState",void 0),u()(this,"props",void 0),u()(this,"propsInTransition",void 0),u()(this,"transition",void 0),u()(this,"onViewStateChange",void 0),u()(this,"onStateChange",void 0),u()(this,"_onTransitionUpdate",(function(t){var e=t.time,r=t.settings,i=r.interpolator,o=r.startProps,a=r.endProps,s=r.duration,u=(0,r.easing)(e/s),c=i.interpolateProps(o,a,u);n.propsInTransition=n.getControllerState(f(f({},n.props),c)).getViewportProps(),n.onViewStateChange({viewState:n.propsInTransition,oldViewState:n.props})})),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new c.a(e.timeline),this.onViewStateChange=e.onViewStateChange||h,this.onStateChange=e.onStateChange||h}return a()(t,[{key:"finalize",value:function(){this.transition.cancel()}},{key:"getViewportInTransition",value:function(){return this.propsInTransition}},{key:"processViewStateChange",value:function(t){var e=!1,n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){var r=n;if(this.transition.inProgress){var i=this.transition.settings,o=i.interruption,a=i.endProps;r=f(f({},n),o===d.SNAP_TO_END?a:this.propsInTransition||n)}this._triggerTransition(r,t),e=!0}else this.transition.cancel();return e}},{key:"updateTransition",value:function(){this.transition.update()}},{key:"_isTransitionEnabled",value:function(t){var e=t.transitionDuration,n=t.transitionInterpolator;return(e>0||"auto"===e)&&Boolean(n)}},{key:"_isUpdateDueToCurrentTransition",value:function(t){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(t,e){return this.transition.inProgress?this.transition.settings.interruption===d.IGNORE||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}},{key:"_triggerTransition",value:function(t,e){var n=this.getControllerState(t),r=this.getControllerState(e).shortestPathFrom(n),i=e.transitionInterpolator,o=i.getDuration?i.getDuration(t,e):e.transitionDuration;if(0!==o){var a=i.initializeProps(t,r);this.propsInTransition={};var s={duration:o,easing:e.transitionEasing||p,interpolator:i,interruption:e.transitionInterruption||v,startProps:a.start,endProps:a.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)};this.transition.start(s),this.onStateChange({inTransition:!0}),this.updateTransition()}}},{key:"_onTransitionEnd",value:function(t){var e=this;return function(n){e.propsInTransition=null,e.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null==t||t(n)}}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r="3.3.0-alpha.5"},function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return h}));var r=n(8),i=n.n(r),o=n(60),a=n.n(o),s=n(4),u=n.n(s),c=n(109);function l(t,e){return f.apply(this,arguments)}function f(){return(f=i()(u.a.mark((function t(e,n){var r,i,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,e.next();case 3:if(r=t.sent,i=r.done,o=r.value,!i){t.next=9;break}return e.return(),t.abrupt("return");case 9:if(!n(o)){t.next=12;break}return t.abrupt("return");case 12:t.next=0;break;case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function h(t){return d.apply(this,arguments)}function d(){return(d=i()(u.a.mark((function t(e){var n,r,i,o,s,l,f;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=!1,i=!1,t.prev=3,s=a()(e);case 5:return t.next=7,s.next();case 7:if(!(r=!(l=t.sent).done)){t.next=13;break}f=l.value,n.push(f);case 10:r=!1,t.next=5;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(3),i=!0,o=t.t0;case 19:if(t.prev=19,t.prev=20,!r||null==s.return){t.next=24;break}return t.next=24,s.return();case 24:if(t.prev=24,!i){t.next=27;break}throw o;case 27:return t.finish(24);case 28:return t.finish(19);case 29:return t.abrupt("return",c.b.apply(void 0,n));case 30:case"end":return t.stop()}}),t,null,[[3,15,19,29],[20,,24,28]])})))).apply(this,arguments)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(210);function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){u=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var a=[n(120).a],s=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function u(t){var e,n=r.a.getDefaultProgramManager(t),o=i(a);try{for(o.s();!(e=o.n()).done;){var u=e.value;n.addDefaultModule(u)}}catch(t){o.e(t)}finally{o.f()}var c,l=i(s);try{for(l.s();!(c=l.n()).done;){var f=c.value;n.addShaderHook(f)}}catch(t){l.e(t)}finally{l.f()}return n}},function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(5),u=n.n(s),c=n(7),l=n.n(c),f=n(2),h=n.n(f),d=n(0),p=n.n(d),v=n(81),g=n(171),y=n(172);function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var b=function(t){u()(n,t);var e=m(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"ViewportType",get:function(){return g.a}},{key:"ControllerType",get:function(){return y.a}}]),n}(v.a);p()(b,"displayName","OrthographicView")},function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var r=n(15),i=n.n(r),o=n(0),a=n.n(o),s=n(1),u=n.n(s),c=n(3),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(62),m=n(98),b=n(24),A=n(33),_=n(113);function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){a()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var C=(new m.a).lookAt({eye:[0,0,1]});function P(t){var e=t.width,n=t.height,r=t.near,i=t.far,o=t.padding,a=-e/2,s=e/2,u=-n/2,c=n/2;if(o){var l=o.left,f=void 0===l?0:l,h=o.right,d=void 0===h?0:h,p=o.top,v=void 0===p?0:p,g=o.bottom,y=void 0===g?0:g,A=Object(b.a)((f+e-d)/2,0,e)-e/2,_=Object(b.a)((v+n-y)/2,0,n)-n/2;a-=A,s-=A,u+=_,c+=_}return(new m.a).ortho({left:a,right:s,bottom:u,top:c,near:r,far:i})}var S=function(t){h()(n,t);var e=x(n);function n(t){u()(this,n);var r,i=t.width,o=t.height,a=t.near,s=void 0===a?.1:a,c=t.far,l=void 0===c?1e3:c,f=t.zoom,h=void 0===f?0:f,d=t.target,p=void 0===d?[0,0,0]:d,v=t.padding,g=void 0===v?null:v,y=t.flipY,m=void 0===y||y,b=Array.isArray(h)?h[0]:h,A=Array.isArray(h)?h[1]:h,_=Math.min(b,A),O=Math.pow(2,_);if(b!==A){var x=Math.pow(2,b),S=Math.pow(2,A);r={unitsPerMeter:[x/O,S/O,1],metersPerUnit:[O/x,O/S,1]}}return e.call(this,w(w({},t),{},{longitude:void 0,position:p,viewMatrix:C.clone().scale([O,O*(m?-1:1),O]),projectionMatrix:P({width:i||1,height:o||1,padding:g,near:s,far:l}),zoom:_,distanceScales:r}))}return l()(n,[{key:"projectFlat",value:function(t){var e=i()(t,2),n=e[0],r=e[1],o=this.distanceScales.unitsPerMeter;return[n*o[0],r*o[1]]}},{key:"unprojectFlat",value:function(t){var e=i()(t,2),n=e[0],r=e[1],o=this.distanceScales.metersPerUnit;return[n*o[0],r*o[1]]}},{key:"panByPosition",value:function(t,e){var n=Object(A.n)(e,this.pixelUnprojectionMatrix),r=this.projectFlat(t),i=_.a([],r,_.b([],n)),o=_.a([],this.center,i);return{target:this.unprojectFlat(o)}}}]),n}(y.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return C}));var r=n(15),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(9),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(24),A=n(80),_=n(130),O=n(71);function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var x=function(t){h()(n,t);var e=w(n);function n(t){var r;return a()(this,n),r=e.call(this,t),m()(l()(r),"zoomAxis",void 0),r.zoomAxis=t.zoomAxis||"all",r}return u()(n,[{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this.getViewportProps(),o=r.maxZoom,a=r.minZoom;void 0===n&&(n=this.getViewportProps().zoom);var s=Math.log2(e);if(Array.isArray(n)){var u=n,c=i()(u,2),l=c[0],f=c[1];switch(this.zoomAxis){case"X":l=Object(b.a)(l+s,a,o);break;case"Y":f=Object(b.a)(f+s,a,o);break;default:var h=Math.min(l+s,f+s);h<a&&(s+=a-h),(h=Math.max(l+s,f+s))>o&&(s+=o-h),l+=s,f+=s}return[l,f]}return Object(b.a)(n+s,a,o)}}]),n}(_.a),C=function(t){h()(n,t);var e=w(n);function n(){var t;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),m()(l()(t),"ControllerState",x),m()(l()(t),"transition",{transitionDuration:300,transitionInterpolator:new O.a(["target","zoom"])}),m()(l()(t),"dragMode","pan"),t}return u()(n,[{key:"_onPanRotate",value:function(){return!1}}]),n}(A.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(26),i=n.n(r);function o(t){if(null===(e=t)||"object"!==i()(e))throw new Error("count(): argument not an object");var e;if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"===i()(t)&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(0),i=n.n(r);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){if(!e)return t;var n=a(a({},t),e);if("defines"in e&&(n.defines=a(a({},t.defines),e.defines)),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some((function(t){return"project64"===t.name})))){var r=n.modules.findIndex((function(t){return"project32"===t.name}));r>=0&&n.modules.splice(r,1)}if("inject"in e)if(t.inject){var i=a({},t.inject);for(var o in e.inject)i[o]=(i[o]||"")+e.inject[o];n.inject=i}else n.inject=e.inject;return n}},function(t,e,n){"use strict";n.d(e,"a",(function(){return E}));var r=n(15),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(9),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(98),A=n(62),_=n(20),O=n(105),w=n(111);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function P(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var S=Math.PI/180,B=180/Math.PI;function k(){var t=Math.PI/180*256;return{unitsPerMeter:[256/6370972,256/6370972,256/6370972],unitsPerMeter2:[0,0,0],metersPerUnit:[24886.609375,24886.609375,24886.609375],unitsPerDegree:[t,t,256/6370972],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/t,1/t,24886.609375]}}var E=function(t){h()(n,t);var e=P(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a()(this,n);var i=r.latitude,o=void 0===i?0:i,s=r.longitude,u=void 0===s?0:s,c=r.zoom,f=void 0===c?0:c,h=r.nearZMultiplier,d=void 0===h?.1:h,p=r.farZMultiplier,v=void 0===p?2:p,g=r.resolution,y=void 0===g?10:g,A=r.height,_=r.altitude,O=void 0===_?1.5:_;A=A||1,O=Math.max(.75,O);var w=(new b.a).lookAt({eye:[0,-O,0],up:[0,0,1]}),x=Math.pow(2,f);w.rotateX(o*S),w.rotateZ(-u*S),w.scale(x/A);var P=Math.atan(.5/O),B=512*x/A;return t=e.call(this,C(C({},r),{},{height:A,viewMatrix:w,longitude:u,latitude:o,zoom:f,distanceScales:k(),fovyRadians:2*P,focalDistance:O,near:d,far:Math.min(2,1/B+1)*O*v})),m()(l()(t),"longitude",void 0),m()(l()(t),"latitude",void 0),m()(l()(t),"resolution",void 0),t.latitude=o,t.longitude=u,t.resolution=y,t}return u()(n,[{key:"projectionMode",get:function(){return _.d.GLOBE}},{key:"getDistanceScales",value:function(){return this.distanceScales}},{key:"getBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={targetZ:t.z||0},n=this.unproject([0,this.height/2],e),r=this.unproject([this.width/2,0],e),i=this.unproject([this.width,this.height/2],e),o=this.unproject([this.width/2,this.height],e);return i[0]<this.longitude&&(i[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],i[0],r[0],o[0]),Math.min(n[1],i[1],r[1],o[1]),Math.max(n[0],i[0],r[0],o[0]),Math.max(n[1],i[1],r[1],o[1])]}},{key:"unproject",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.topLeft,o=void 0===r||r,a=n.targetZ,s=i()(t,3),u=s[0],c=s[1],l=s[2],f=o?c:this.height-c,h=this.pixelUnprojectionMatrix;if(Number.isFinite(l))e=T(h,[u,f,l,1]);else{var d=T(h,[u,f,-1,1]),p=T(h,[u,f,1,1]),v=256*((a||0)/6370972+1),g=O.c(O.d([],d,p)),y=O.c(d),m=O.c(p),b=(4*y*m-Math.pow(g-y-m,2))/16,A=4*b/g,_=Math.sqrt(y-A),w=Math.sqrt(Math.max(0,v*v-A)),x=(_-w)/Math.sqrt(g);e=O.b([],d,p,x)}var C=this.unprojectPosition(e),P=i()(C,3),S=P[0],B=P[1],k=P[2];return Number.isFinite(l)?[S,B,k]:Number.isFinite(a)?[S,B,a]:[S,B]}},{key:"projectPosition",value:function(t){var e=i()(t,3),n=e[0],r=e[1],o=e[2],a=void 0===o?0:o,s=n*S,u=r*S,c=Math.cos(u),l=256*(a/6370972+1);return[Math.sin(s)*c*l,-Math.cos(s)*c*l,Math.sin(u)*l]}},{key:"unprojectPosition",value:function(t){var e=i()(t,3),n=e[0],r=e[1],o=e[2],a=O.a(t),s=Math.asin(o/a);return[Math.atan2(n,-r)*B,s*B,6370972*(a/256-1)]}},{key:"projectFlat",value:function(t){return t}},{key:"unprojectFlat",value:function(t){return t}},{key:"panByPosition",value:function(t,e){var n=this.unproject(e);return{longitude:t[0]-n[0]+this.longitude,latitude:t[1]-n[1]+this.latitude}}}]),n}(A.a);function T(t,e){var n=w.b([],e,t);return w.a(n,n,1/n[3]),n}},function(t,e,n){"use strict";var r=n(15),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(9),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(20),A=n(177),_=n(63),O=n(24),w=n(96);function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var C=function(t){h()(n,t);var e=x(n);function n(){return a()(this,n),e.apply(this,arguments)}return u()(n,[{key:"value",get:function(){return this._value}},{key:"_onUpdate",value:function(){var t=this.time,e=this.settings,n=e.fromValue,r=e.toValue,i=e.duration,o=(0,e.easing)(t/i);this._value=Object(O.g)(n,r,o)}}]),n}(w.a);function P(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}function S(t,e,n,r,i){var o=e-t;return(n-e)*i+-o*r+o+e}function B(t,e){if(Array.isArray(t)){for(var n=0,r=0;r<t.length;r++){var i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}var k=function(t){h()(n,t);var e=P(n);function n(){return a()(this,n),e.apply(this,arguments)}return u()(n,[{key:"value",get:function(){return this._currValue}},{key:"_onUpdate",value:function(){var t=this.settings,e=t.fromValue,n=t.toValue,r=t.damping,i=t.stiffness,o=this._prevValue,a=void 0===o?e:o,s=this._currValue,u=void 0===s?e:s,c=function(t,e,n,r,i){if(Array.isArray(n)){for(var o=[],a=0;a<n.length;a++)o[a]=S(t[a],e[a],n[a],r,i);return o}return S(t,e,n,r,i)}(a,u,n,r,i),l=B(c,n),f=B(c,u);l<1e-5&&f<1e-5&&(c=n,this.end()),this._prevValue=u,this._currValue=c}}]),n}(w.a),E=n(31);function T(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return j(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var R,D={interpolation:C,spring:k},L=function(){function t(e){a()(this,t),this.transitions=new Map,this.timeline=e}return u()(t,[{key:"active",get:function(){return this.transitions.size>0}},{key:"add",value:function(t,e,n,r){var i=this.transitions;if(i.has(t)){var o=i.get(t),a=o.value;e=void 0===a?o.settings.fromValue:a,this.remove(t)}if(r=Object(_.e)(r)){var s=D[r.type];if(s){var u=new s(this.timeline);u.start(I(I({},r),{},{fromValue:e,toValue:n})),i.set(t,u)}else E.a.error("unsupported transition type '".concat(r.type,"'"))()}}},{key:"remove",value:function(t){var e=this.transitions;e.has(t)&&(e.get(t).cancel(),e.delete(t))}},{key:"update",value:function(){var t,e={},n=T(this.transitions);try{for(n.s();!(t=n.n()).done;){var r=i()(t.value,2),o=r[0],a=r[1];a.update(),e[o]=a.value,a.inProgress||this.remove(o)}}catch(t){n.e(t)}finally{n.f()}return e}},{key:"clear",value:function(){var t,e=T(this.transitions.keys());try{for(e.s();!(t=e.n()).done;){var n=t.value;this.remove(n)}}catch(t){e.e(t)}finally{e.f()}}}]),t}(),F=n(150),G=n(37),N=n(173),U=n(47),z=n(12),H=n(44),V=n(101),J=n(174),W=n(155),K=n(90),X=n(75),q=n(26),Q=n.n(q),Z=n(123);function Y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var tt=(R={},m()(R,10241,9987),m()(R,10240,9729),m()(R,10242,33071),m()(R,10243,33071),R),et={};var nt=n(83);function rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function it(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ot={boolean:{validate:function(t,e){return!0},equal:function(t,e,n){return Boolean(t)===Boolean(e)}},number:{validate:function(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate:function(t,e){return e.optional&&!t||ct(t)&&(3===t.length||4===t.length)},equal:function(t,e,n){return at(t,e)}},accessor:{validate:function(t,e){var n=lt(t);return"function"===n||n===lt(e.value)},equal:function(t,e,n){return"function"==typeof e||at(t,e)}},array:{validate:function(t,e){return e.optional&&!t||ct(t)},equal:function(t,e,n){return n.compare?at(t,e):t===e}},object:{equal:function(t,e,n){return n.compare?Object(nt.a)(t,e):t===e}},function:{validate:function(t,e){return e.optional&&!t||"function"==typeof t},equal:function(t,e,n){return!n.compare||t===e}},data:{transform:function(t,e,n){var r=n.props.dataTransform;return r&&t?r(t):t}},image:{transform:function(t,e,n){return function(t,e){var n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof Z.a)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});var r=null;e.compressed&&(r=m()({},10241,e.data.length>1?9985:9729));var i=new Z.a(n,$($({},e),{},{parameters:$($($({},tt),r),t.props.textureParameters)}));return et[i.id]=!0,i}(n,t)},release:function(t){var e;(e=t)&&e instanceof Z.a&&et[e.id]&&(e.delete(),delete et[e.id])}}};function at(t,e){if(t===e)return!0;if(!ct(t)||!ct(e))return!1;var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function st(t,e){switch(lt(e)){case"object":return ut(t,e);case"array":return ut(t,{type:"array",value:e,compare:!1});case"boolean":return ut(t,{type:"boolean",value:e});case"number":return ut(t,{type:"number",value:e});case"function":return ut(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function ut(t,e){return"type"in e?it(it({name:t},ot[e.type]),e):"value"in e?it({name:t,type:lt(e.value)},e):{name:t,type:"object",value:e}}function ct(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function lt(t){return ct(t)?"array":null===t?"null":Q()(t)}function ft(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ht(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ht(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?dt(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function vt(t,e){var n=gt(t.constructor),r=Object.create(n);r[G.d]=t,r[G.b]={},r[G.c]={};for(var i=0;i<e.length;++i){var o=e[i];for(var a in o)r[a]=o[a]}return Object.freeze(r),r}function gt(t){var e=bt(t,"_mergedDefaultProps");return e||(function(t){if(!t.prototype)return;var e=Object.getPrototypeOf(t),n=gt(e),r=function(t){for(var e={},n={},r={},o=0,a=Object.entries(t);o<a.length;o++){var s=i()(a[o],2),u=s[0],c=s[1],l=null==c?void 0:c.deprecatedFor;if(l)r[u]=Array.isArray(l)?l:[l];else{var f=st(u,c);e[u]=f,n[u]=f.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}(bt(t,"defaultProps")||{}),o=function(t,e,n){var r=Object.create(null);Object.assign(r,e,t);var i=function(t){var e=bt(t,"layerName")||bt(t,"componentName");e||E.a.once(0,"".concat(t.name,".componentName not specified"))();return e||t.name}(n);return delete t.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}(r.defaultProps,n,t),a=pt(pt({},e._propTypes),r.propTypes);!function(t,e){var n={},r={};for(var i in e){var o=e[i],a=o.name,s=o.value;o.async&&(n[a]=s,r[a]=yt(a))}t[G.a]=n,t[G.b]={},Object.defineProperties(t,r)}(o,a);var s=pt(pt({},e._deprecatedProps),r.deprecatedProps);(function(t,e){var n=function(n){Object.defineProperty(t,n,{enumerable:!1,set:function(t){var r,i="".concat(this.id,": ").concat(n),o=ft(e[n]);try{for(o.s();!(r=o.n()).done;){var a=r.value;mt(this,a)||(this[a]=t)}}catch(t){o.e(t)}finally{o.f()}E.a.deprecated(i,e[n].join("/"))()}})};for(var r in e)n(r)})(o,s),t._mergedDefaultProps=o,t._propTypes=a,t._deprecatedProps=s}(t),t._mergedDefaultProps)}function yt(t){return{enumerable:!0,set:function(e){"string"==typeof e||e instanceof Promise||Object(X.c)(e)?this[G.b][t]=e:this[G.c][t]=e},get:function(){if(this[G.c]){if(t in this[G.c])return this[G.c][t]||this[G.a][t];if(t in this[G.b]){var e=this[G.d]&&this[G.d].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[G.a][t]}}return this[G.a][t]}}}function mt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function bt(t,e){return mt(t,e)&&t[e]}function At(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?At(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ot=0,wt=function(){function t(){a()(this,t),m()(this,"id",void 0),m()(this,"props",void 0),m()(this,"count",void 0);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.props=vt(this,n),this.id=this.props.id,this.count=Ot++}return u()(t,[{key:"clone",value:function(t){var e=this.props,n={};for(var r in e[G.a])r in e[G.c]?n[r]=e[G.c][r]:r in e[G.b]&&(n[r]=e[G.b][r]);return new this.constructor(_t(_t(_t({},e),n),t))}}]),t}();m()(wt,"componentName","Component"),m()(wt,"defaultProps",{});var xt=n(10),Ct=n.n(xt),Pt=n(19),St=n.n(Pt),Bt=n(256),kt=n.n(Bt),Et=n(14),Tt=n.n(Et),jt=Object.freeze({});function Mt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var It=function(t){h()(n,t);var e=Mt(n);function n(t){var r,i=t.attributeManager,o=t.layer;return a()(this,n),r=e.call(this,o),m()(l()(r),"attributeManager",void 0),m()(l()(r),"needsRedraw",void 0),m()(l()(r),"needsUpdate",void 0),m()(l()(r),"subLayers",void 0),m()(l()(r),"usesPickingColorCache",void 0),m()(l()(r),"changeFlags",void 0),m()(l()(r),"viewport",void 0),m()(l()(r),"uniformTransitions",void 0),m()(l()(r),"propsInTransition",void 0),r.attributeManager=i,r.needsRedraw=!0,r.needsUpdate=!0,r.subLayers=null,r.usesPickingColorCache=!1,r}return u()(n,[{key:"layer",get:function(){return this.component},set:function(t){this.component=t}},{key:"_fetch",value:function(t,e){var r=this.component.props.fetch;return r?r(e,{propName:t,layer:this.layer}):Ct()(g()(n.prototype),"_fetch",this).call(this,t,e)}},{key:"_onResolve",value:function(t,e){var n=this.component.props.onDataLoad;"data"===t&&n&&n(e,{propName:t,layer:this.layer})}},{key:"_onError",value:function(t,e){this.layer.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}]),n}(function(){function t(e){a()(this,t),m()(this,"component",void 0),m()(this,"onAsyncPropUpdated",void 0),m()(this,"asyncProps",void 0),m()(this,"oldProps",void 0),m()(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=function(){},this.oldProps=null,this.oldAsyncProps=null}var e;return u()(t,[{key:"finalize",value:function(){for(var t in this.asyncProps){var e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}}},{key:"getOldProps",value:function(){return this.oldAsyncProps||this.oldProps||jt}},{key:"resetOldProps",value:function(){this.oldAsyncProps=null,this.oldProps=this.component.props}},{key:"hasAsyncProp",value:function(t){return t in this.asyncProps}},{key:"getAsyncProp",value:function(t){var e=this.asyncProps[t];return e&&e.resolvedValue}},{key:"isAsyncPropLoading",value:function(t){if(t){var e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(var n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}},{key:"reloadAsyncProp",value:function(t,e){this._watchPromise(t,Promise.resolve(e))}},{key:"setAsyncProps",value:function(t){var e=t[G.c]||{},n=t[G.b]||t,r=t[G.a]||{};for(var i in e){var o=e[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,o),e[i]=this.getAsyncProp(i)}for(var a in n){var s=n[a];this._createAsyncPropData(a,r[a]),this._updateAsyncProp(a,s)}}},{key:"_fetch",value:function(t,e){return null}},{key:"_onResolve",value:function(t,e){}},{key:"_onError",value:function(t,e){}},{key:"_updateAsyncProp",value:function(t,e){this._didAsyncInputValueChange(t,e)&&("string"==typeof e&&(e=this._fetch(t,e)),e instanceof Promise?this._watchPromise(t,e):Object(X.c)(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e))}},{key:"_freezeAsyncOldProps",value:function(){if(!this.oldAsyncProps&&this.oldProps)for(var t in this.oldAsyncProps=Object.create(this.oldProps),this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}},{key:"_didAsyncInputValueChange",value:function(t,e){var n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}},{key:"_setPropValue",value:function(t,e){this._freezeAsyncOldProps();var n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}},{key:"_setAsyncPropValue",value:function(t,e,n){var r=this.asyncProps[t];r&&n>=r.resolvedLoadCount&&void 0!==e&&(this._freezeAsyncOldProps(),r.resolvedValue=e,r.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}},{key:"_watchPromise",value:function(t,e){var n=this,r=this.asyncProps[t];if(r){r.pendingLoadCount++;var i=r.pendingLoadCount;e.then((function(e){e=n._postProcessValue(r,e),n._setAsyncPropValue(t,e,i),n._onResolve(t,e)})).catch((function(e){n._onError(t,e)}))}}},{key:"_resolveAsyncIterable",value:(e=St()(Tt.a.mark((function t(e,n){var r,i,o,a,s,u,c,l,f,h,d;return Tt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("data"===e){t.next=3;break}return this._setPropValue(e,n),t.abrupt("return");case 3:if(r=this.asyncProps[e]){t.next=6;break}return t.abrupt("return");case 6:r.pendingLoadCount++,i=r.pendingLoadCount,o=[],a=0,s=!1,u=!1,t.prev=12,l=kt()(n);case 14:return t.next=16,l.next();case 16:if(!(s=!(f=t.sent).done)){t.next=26;break}h=f.value,d=this.component.props.dataTransform,o=d?d(h,o):o.concat(h),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:a,endRow:o.length}]}),a=o.length,this._setAsyncPropValue(e,o,i);case 23:s=!1,t.next=14;break;case 26:t.next=32;break;case 28:t.prev=28,t.t0=t.catch(12),u=!0,c=t.t0;case 32:if(t.prev=32,t.prev=33,!s||null==l.return){t.next=37;break}return t.next=37,l.return();case 37:if(t.prev=37,!u){t.next=40;break}throw c;case 40:return t.finish(37);case 41:return t.finish(32);case 42:this._onResolve(e,o);case 43:case"end":return t.stop()}}),t,this,[[12,28,32,42],[33,,37,41]])}))),function(t,n){return e.apply(this,arguments)})},{key:"_postProcessValue",value:function(t,e){var n=t.type;return n&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}},{key:"_createAsyncPropData",value:function(t,e){if(!this.asyncProps[t]){var n=this.component&&this.component.constructor._propTypes;this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}]),t}()),Rt=n(33),Dt=n(223);function Lt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ft(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ft(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Gt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}function Nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ut(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nt(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n.d(e,"a",(function(){return Kt}));var zt=Math.pow(2,24)-1,Ht=Object.freeze([]),Vt=Object(V.a)((function(t){var e=t.oldViewport,n=t.viewport;return e.equals(n)})),Jt=new Uint8ClampedArray(0),Wt={data:{type:"data",value:Ht,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:function(t){return t&&t.__diff},compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:function(t,e){var n,r=e.propName,i=e.layer,o=e.loaders,a=e.loadOptions,s=e.signal,u=i.context.resourceManager;(a=a||i.getLoadOptions(),o=o||i.props.loaders,s)&&(a=Ut(Ut({},a),{},{fetch:Ut(Ut({},null===(n=a)||void 0===n?void 0:n.fetch),{},{signal:s})}));var c=u.contains(t);return c||a||(u.add({resourceId:t,data:Object(Dt.a)(t,o),persistent:!1}),c=!0),c?u.subscribe({resourceId:t,onChange:function(t){var e;return null===(e=i.internalState)||void 0===e?void 0:e.reloadAsyncProp(r,t)},consumerId:i.id,requestId:r}):Object(Dt.a)(t,o,a)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:b.c.DRAW,onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:b.a.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:function(t){return[0,100*-t.layerIndex]},compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}},Kt=function(t){h()(n,t);var e=Gt(n);function n(){var t;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),m()(l()(t),"internalState",null),m()(l()(t),"lifecycle",G.e.NO_STATE),m()(l()(t),"context",void 0),m()(l()(t),"state",void 0),m()(l()(t),"parent",null),t}return u()(n,[{key:"root",get:function(){for(var t=this;t.parent;)t=t.parent;return t}},{key:"toString",value:function(){var t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}},{key:"project",value:function(t){Object(H.a)(this.internalState);var e=this.internalState.viewport||this.context.viewport,n=Object(W.a)(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),r=Object(Rt.p)(n,e.pixelProjectionMatrix),o=i()(r,3),a=o[0],s=o[1],u=o[2];return 2===t.length?[a,s]:[a,s,u]}},{key:"unproject",value:function(t){return Object(H.a)(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}},{key:"projectPosition",value:function(t,e){Object(H.a)(this.internalState);var n=this.internalState.viewport||this.context.viewport;return Object(W.b)(t,Ut({viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem},e))}},{key:"isComposite",get:function(){return!1}},{key:"setState",value:function(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}},{key:"setNeedsRedraw",value:function(){this.internalState&&(this.internalState.needsRedraw=!0)}},{key:"setNeedsUpdate",value:function(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}},{key:"isLoaded",get:function(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}},{key:"wrapLongitude",get:function(){return this.props.wrapLongitude}},{key:"isPickable",value:function(){return this.props.pickable&&this.props.visible}},{key:"getModels",value:function(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}},{key:"setModuleParameters",value:function(t){var e,n=Lt(this.getModels());try{for(n.s();!(e=n.n()).done;){e.value.updateModuleSettings(t)}}catch(t){n.e(t)}finally{n.f()}}},{key:"getAttributeManager",value:function(){return this.internalState&&this.internalState.attributeManager}},{key:"getCurrentLayer",value:function(){return this.internalState&&this.internalState.layer}},{key:"getLoadOptions",value:function(){return this.props.loadOptions}},{key:"use64bitPositions",value:function(){var t=this.props.coordinateSystem;return t===b.a.DEFAULT||t===b.a.LNGLAT||t===b.a.CARTESIAN}},{key:"onHover",value:function(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}},{key:"onClick",value:function(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}},{key:"nullPickingColor",value:function(){return[0,0,0]}},{key:"encodePickingColor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}},{key:"decodePickingColor",value:function(t){Object(H.a)(t instanceof Uint8Array);var e=i()(t,3);return e[0]+256*e[1]+65536*e[2]-1}},{key:"getNumInstances",value:function(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:Object(N.a)(this.props.data)}},{key:"getStartIndices",value:function(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}},{key:"getBounds",value:function(){var t,e=this.getAttributeManager();if(!e)return null;var n=e.attributes,r=n.positions,i=n.instancePositions;return null===(t=r||i)||void 0===t?void 0:t.getBounds()}},{key:"getShaders",value:function(t){var e,n=Lt(this.props.extensions);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=Object(J.a)(t,r.getShaders.call(this,r))}}catch(t){n.e(t)}finally{n.f()}return t}},{key:"shouldUpdateState",value:function(t){return t.changeFlags.propsOrDataChanged}},{key:"updateState",value:function(t){var e=this.getAttributeManager(),n=t.changeFlags.dataChanged;if(n&&e)if(Array.isArray(n)){var r,i=Lt(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;e.invalidateAll(o)}}catch(t){i.e(t)}finally{i.f()}}else e.invalidateAll();var a=t.props,s=t.oldProps,u=Number.isInteger(s.highlightedObjectIndex)||s.pickable,c=Number.isInteger(a.highlightedObjectIndex)||a.pickable;if(u!==c&&e){var l=e.attributes,f=l.pickingColors,h=l.instancePickingColors,d=f||h;d&&(c&&d.constant&&(d.constant=!1,e.invalidate(d.id)),d.value||c||(d.constant=!0,d.value=[0,0,0]))}}},{key:"finalizeState",value:function(t){var e,n=Lt(this.getModels());try{for(n.s();!(e=n.n()).done;){e.value.delete()}}catch(t){n.e(t)}finally{n.f()}var r=this.getAttributeManager();r&&r.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}},{key:"draw",value:function(t){var e,n=Lt(this.getModels());try{for(n.s();!(e=n.n()).done;){e.value.draw(t)}}catch(t){n.e(t)}finally{n.f()}}},{key:"getPickingInfo",value:function(t){var e=t.info,n=(t.mode,t.sourceLayer,e.index);return n>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[n]),e}},{key:"raiseError",value:function(t,e){var n,r,i,o;(e&&(t.message="".concat(e,": ").concat(t.message)),null!==(n=(r=this.props).onError)&&void 0!==n&&n.call(r,t))||(null===(i=this.context)||void 0===i||null===(o=i.onError)||void 0===o||o.call(i,t,this))}},{key:"getNeedsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};return this._getNeedsRedraw(t)}},{key:"needsUpdate",value:function(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}},{key:"hasUniformTransition",value:function(){var t;return(null===(t=this.internalState)||void 0===t?void 0:t.uniformTransitions.active)||!1}},{key:"activateViewport",value:function(t){if(this.internalState){var e=this.internalState.viewport;this.internalState.viewport=t,e&&Vt({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}}},{key:"invalidateAttribute",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",e=this.getAttributeManager();e&&("all"===t?e.invalidateAll():e.invalidate(t))}},{key:"updateAttributes",value:function(t){var e,n=Lt(this.getModels());try{for(n.s();!(e=n.n()).done;){var r=e.value;this._setModelAttributes(r,t)}}catch(t){n.e(t)}finally{n.f()}}},{key:"_updateAttributes",value:function(){var t=this.getAttributeManager();if(t){var e=this.props,n=this.getNumInstances(),r=this.getStartIndices();t.update({data:e.data,numInstances:n,startIndices:r,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});var i=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}}},{key:"_updateAttributeTransition",value:function(){var t=this.getAttributeManager();t&&t.updateTransition()}},{key:"_updateUniformTransition",value:function(){var t=this.internalState.uniformTransitions;if(t.active){var e=t.update(),n=Object.create(this.props);for(var r in e)Object.defineProperty(n,r,{value:e[r]});return n}return this.props}},{key:"calculateInstancePickingColors",value:function(t,e){var n=e.numInstances;if(!t.constant){var r=Math.floor(Jt.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>zt&&E.a.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Jt=K.a.allocate(Jt,n,{size:3,copy:!0,maxCount:Math.max(n,zt)});for(var i=Math.floor(Jt.length/3),o=[],a=r;a<i;a++)this.encodePickingColor(a,o),Jt[3*a+0]=o[0],Jt[3*a+1]=o[1],Jt[3*a+2]=o[2]}t.value=Jt.subarray(0,3*n)}}},{key:"_setModelAttributes",value:function(t,e){var n=this.getAttributeManager(),r=t.userData.excludeAttributes||{},i=n.getShaderAttributes(e,r);t.setAttributes(i)}},{key:"disablePickingIndex",value:function(t){this._disablePickingIndex(t)}},{key:"_disablePickingIndex",value:function(t){var e=this.getAttributeManager().attributes,n=e.pickingColors,r=e.instancePickingColors,i=n||r;if(i){var o=i.getVertexOffset(t),a=i.getVertexOffset(t+1);i.buffer.subData({data:new Uint8Array(a-o),offset:o})}}},{key:"restorePickingColors",value:function(){var t=this.getAttributeManager().attributes,e=t.pickingColors,n=t.instancePickingColors,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Jt.buffer&&(r.value=Jt.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}},{key:"_initialize",value:function(){Object(H.a)(!this.internalState),Object(H.a)(Number.isFinite(this.props.coordinateSystem)),Object(U.a)("layer.initialize",this);var t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new It({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:function(){return E.a.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t}}),this.internalState.layer=this,this.internalState.uniformTransitions=new L(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);var e,n=Lt(this.props.extensions);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.initializeState.call(this,this.context,r)}}catch(t){n.e(t)}finally{n.f()}this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}},{key:"_transferState",value:function(t){Object(U.a)("layer.matched",this,this===t);var e=t.state,n=t.internalState;this!==t&&(this.internalState=n,this.internalState.layer=this,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}},{key:"_update",value:function(){var t=this.needsUpdate();if(Object(U.a)("layer.update",this,t),t){var e=this.props,n=this.context,r=this.internalState,i=n.viewport,o=this._updateUniformTransition();r.propsInTransition=o,n.viewport=r.viewport||i,this.props=o;try{var a=this._getUpdateParams(),s=this.getModels();if(n.gl)this.updateState(a);else try{this.updateState(a)}catch(t){}var u,c=Lt(this.props.extensions);try{for(c.s();!(u=c.n()).done;){var l=u.value;l.updateState.call(this,a,l)}}catch(t){c.e(t)}finally{c.f()}var f=this.getModels()[0]!==s[0];this._postUpdate(a,f)}finally{n.viewport=i,this.props=e,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}}},{key:"_finalize",value:function(){Object(U.a)("layer.finalize",this),this.finalizeState(this.context);var t,e=Lt(this.props.extensions);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.finalizeState.call(this,n)}}catch(t){e.e(t)}finally{e.f()}}},{key:"_drawLayer",value:function(t){var e=this,n=t.moduleParameters,r=void 0===n?null:n,i=t.uniforms,o=void 0===i?{}:i,a=t.parameters,s=void 0===a?{}:a;this._updateAttributeTransition();var u=this.props,c=this.context;this.props=this.internalState.propsInTransition||u;var l=this.props.opacity;o.opacity=Math.pow(l,1/2.2);try{r&&this.setModuleParameters(r);var f=this.props.getPolygonOffset,h=f&&f(o)||[0,0];Object(z.n)(c.gl,{polygonOffset:h}),Object(z.o)(c.gl,s,(function(){var t,n={moduleParameters:r,uniforms:o,parameters:s,context:c},i=Lt(e.props.extensions);try{for(i.s();!(t=i.n()).done;){var a=t.value;a.draw.call(e,n,a)}}catch(t){i.e(t)}finally{i.f()}e.draw(n)}))}finally{this.props=u}}},{key:"getChangeFlags",value:function(){var t;return null===(t=this.internalState)||void 0===t?void 0:t.changeFlags}},{key:"setChangeFlags",value:function(t){if(this.internalState){var e=this.internalState.changeFlags;for(var n in t)if(t[n]){var r=!1;switch(n){case"dataChanged":var i=t[n],o=e[n];i&&Array.isArray(o)&&(e.dataChanged=Array.isArray(i)?o.concat(i):i,r=!0);default:e[n]||(e[n]=t[n],r=!0)}r&&Object(U.a)("layer.changeFlag",this,n,t)}var a=Boolean(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=a,e.somethingChanged=a||e.viewportChanged||e.stateChanged}}},{key:"_clearChangeFlags",value:function(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}},{key:"_diffProps",value:function(t,e){var n=Object(F.b)(t,e);if(n.updateTriggersChanged)for(var r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(n.transitionsChanged)for(var i in n.transitionsChanged){var o;this.internalState.uniformTransitions.add(i,e[i],t[i],null===(o=t.transitions)||void 0===o?void 0:o[i])}return this.setChangeFlags(n)}},{key:"validateProps",value:function(){Object(F.c)(this.props)}},{key:"updateAutoHighlight",value:function(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}},{key:"_updateAutoHighlight",value:function(t){var e={pickingSelectedColor:t.picked?t.color:null},n=this.props.highlightColor;t.picked&&"function"==typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}},{key:"_getAttributeManager",value:function(){var t=this.context;return new A.a(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}},{key:"_postUpdate",value:function(t,e){var n=t.props,r=t.oldProps;this.setNeedsRedraw(),this._updateAttributes();var i=this.state.model;null==i||i.setInstanceCount(this.getNumInstances());var o=n.autoHighlight,a=n.highlightedObjectIndex,s=n.highlightColor;if(e||r.autoHighlight!==o||r.highlightedObjectIndex!==a||r.highlightColor!==s){var u={};o||(u.pickingSelectedColor=null),Array.isArray(s)&&(u.pickingHighlightColor=s),Number.isInteger(a)&&(u.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(u)}}},{key:"_getUpdateParams",value:function(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}},{key:"_getNeedsRedraw",value:function(t){if(!this.internalState)return!1;var e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;var n=this.getAttributeManager(),r=!!n&&n.getNeedsRedraw(t);return e=e||r}},{key:"_onAsyncPropUpdated",value:function(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}]),n}(wt);m()(Kt,"defaultProps",Wt),m()(Kt,"layerName","Layer")},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=n(15),l=n.n(c),f=n(9),h=n.n(f),d=n(10),p=n.n(d),v=n(5),g=n.n(v),y=n(7),m=n.n(y),b=n(2),A=n.n(b),_=n(264),O=n(198),w=n(49);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var P=function(){function t(e,n){i()(this,t),u()(this,"opts",void 0),u()(this,"source",void 0),this.opts=n,this.source=e}return a()(t,[{key:"value",get:function(){return this.source.value}},{key:"getValue",value:function(){var t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];var n=this.source.value,r=e.size,i=n;if(n&&n.length!==r){i=new Float32Array(r);for(var o=e.elementOffset||0,a=0;a<r;++a)i[a]=n[o+a]}return i}},{key:"getAccessor",value:function(){return C(C({},this.source.getAccessor()),this.opts)}}]),t}();var S=n(90),B=n(52),k=n(31);function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function j(t){return t.stride||t.size*t.bytesPerElement}function M(t,e){e.offset&&k.a.removed("shaderAttribute.offset","vertexOffset, elementOffset")();var n=j(t),r=(void 0!==e.vertexOffset?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return T(T({},e),{},{offset:r,stride:n})}var I=function(){function t(e,n,r){i()(this,t),u()(this,"gl",void 0),u()(this,"id",void 0),u()(this,"size",void 0),u()(this,"settings",void 0),u()(this,"value",void 0),u()(this,"doublePrecision",void 0),u()(this,"_buffer",void 0),u()(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;var o,a=n.logicalType||n.type,s=5130===a,c=n.defaultValue;c=Number.isFinite(c)?[c]:c||new Array(this.size).fill(0),o=s?5126:!a&&n.isIndexed?e&&Object(_.b)(e,O.a.ELEMENT_INDEX_UINT32)?5125:5123:a||5126;var l=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(a||o||5126);this.doublePrecision=s,s&&!1===n.fp64&&(l=Float32Array),this.value=null,this.settings=T(T({},n),{},{defaultType:l,defaultValue:c,logicalType:a,type:o,size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT}),this.state=T(T({},r),{},{externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}),this._buffer=null}return a()(t,[{key:"isConstant",get:function(){return this.state.constant}},{key:"buffer",get:function(){if(!this._buffer){var t=this.settings,e=t.isIndexed,n=t.type;this._buffer=new w.a(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}},{key:"byteOffset",get:function(){var t=this.getAccessor();return t.vertexOffset?t.vertexOffset*j(t):0}},{key:"numInstances",get:function(){return this.state.numInstances},set:function(t){this.state.numInstances=t}},{key:"delete",value:function(){this._buffer&&(this._buffer.delete(),this._buffer=null),S.a.release(this.state.allocatedValue)}},{key:"getShaderAttributes",value:function(t,e){if(this.doublePrecision){var n={},r=this.value instanceof Float64Array,i=(o=this.getAccessor(),{high:a=M(o,e||{}),low:T(T({},a),{},{offset:a.offset+4*o.size})});return n[t]=new P(this,i.high),n["".concat(t,"64Low")]=r?new P(this,i.low):new Float32Array(this.size),n}var o,a;if(e){var s=M(this.getAccessor(),e);return u()({},t,new P(this,s))}return u()({},t,this)}},{key:"getBuffer",value:function(){return this.state.constant?null:this.state.externalBuffer||this._buffer}},{key:"getValue",value:function(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}},{key:"getAccessor",value:function(){return this.state.bufferAccessor}},{key:"getBounds",value:function(){if(this.state.bounds)return this.state.bounds;var t=null;if(this.state.constant&&this.value){var e=Array.from(this.value);t=[e,e]}else{var n=this.value,r=this.numInstances,i=this.size,o=r*i;if(n&&o&&n.length>=o){for(var a=new Array(i).fill(1/0),s=new Array(i).fill(-1/0),u=0;u<o;)for(var c=0;c<i;c++){var l=n[u++];l<a[c]&&(a[c]=l),l>s[c]&&(s[c]=l)}t=[a,s]}}return this.state.bounds=t,t}},{key:"setData",value:function(t){var e,n=this.state;e=ArrayBuffer.isView(t)?{value:t}:t instanceof w.a?{buffer:t}:t;var r=T(T({},this.settings),e);if(n.bufferAccessor=r,n.bounds=null,e.constant){var i=e.value;if(i=this._normalizeValue(i,[],0),this.settings.normalized&&(i=this.normalizeConstant(i)),!(!n.constant||!this._areValuesEqual(i,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=i}else if(e.buffer){var o=e.buffer;n.externalBuffer=o,n.constant=!1,this.value=e.value||null;var a=e.value instanceof Float64Array;r.type=e.type||o.accessor.type,r.bytesPerElement=o.accessor.BYTES_PER_ELEMENT*(a?2:1),r.stride=j(r)}else if(e.value){this._checkExternalBuffer(e);var s=e.value;n.externalBuffer=null,n.constant=!1,this.value=s,r.bytesPerElement=s.BYTES_PER_ELEMENT,r.stride=j(r);var u=this.buffer,c=this.byteOffset;this.doublePrecision&&s instanceof Float64Array&&(s=Object(B.f)(s,r));var l=s.byteLength+c+2*r.stride;u.byteLength<l&&u.reallocate(l),u.setAccessor(null),u.subData({data:s,offset:c}),r.type=e.type||u.accessor.type}return!0}},{key:"updateSubBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.state.bounds=null;var e=this.value,n=t.startOffset,r=void 0===n?0:n,i=t.endOffset;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?Object(B.f)(e,{size:this.size,startIndex:r,endIndex:i}):e.subarray(r,i),offset:r*e.BYTES_PER_ELEMENT+this.byteOffset})}},{key:"allocate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.state,r=n.allocatedValue,i=S.a.allocate(r,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=i;var o=this.buffer,a=this.byteOffset;return o.byteLength<i.byteLength+a&&(o.reallocate(i.byteLength+a),e&&r&&o.subData({data:r instanceof Float64Array?Object(B.f)(r,this):r,offset:a})),n.allocatedValue=i,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}},{key:"_checkExternalBuffer",value:function(t){var e=t.value;if(!ArrayBuffer.isView(e))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));var n=this.settings.defaultType,r=!1;if(this.doublePrecision&&(r=e.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||k.a.warn("Attribute ".concat(this.id," is normalized"))()}},{key:"normalizeConstant",value:function(t){switch(this.settings.type){case 5120:return new Float32Array(t).map((function(t){return(t+128)/255*2-1}));case 5122:return new Float32Array(t).map((function(t){return(t+32768)/65535*2-1}));case 5121:return new Float32Array(t).map((function(t){return t/255}));case 5123:return new Float32Array(t).map((function(t){return t/65535}));default:return t}}},{key:"_normalizeValue",value:function(t,e,n){var r=this.settings,i=r.defaultValue,o=r.size;if(Number.isFinite(t))return e[n]=t,e;if(!t)return e[n]=i[0],e;switch(o){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:for(var a=o;--a>=0;)e[n+a]=Number.isFinite(t[a])?t[a]:i[a]}return e}},{key:"_areValuesEqual",value:function(t,e){if(!t||!e)return!1;for(var n=this.size,r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}}]),t}(),R=n(44),D=n(75),L=n(89),F=[],G=[[0,1/0]];function N(t,e){if(t===G)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;for(var n=[],r=t.length,i=0,o=0;o<r;o++){var a=t[o];a[1]<e[0]?(n.push(a),i=o+1):a[0]>e[1]?n.push(a):e=[Math.min(a[0],e[0]),Math.max(a[1],e[1])]}return n.splice(i,0,e),n}var U=n(63);function z(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return H(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function V(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=A()(t);if(e){var i=A()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m()(this,n)}}var J=function(t){g()(n,t);var e=V(n);function n(t,r){var o;return i()(this,n),o=e.call(this,t,r,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:G}),u()(h()(o),"constant",!1),o.settings.update=r.update||(r.accessor?o._autoUpdater:void 0),Object.seal(o.settings),Object.seal(o.state),o._validateAttributeUpdaters(),o}return a()(n,[{key:"startIndices",get:function(){return this.state.startIndices},set:function(t){this.state.startIndices=t}},{key:"needsUpdate",value:function(){return this.state.needsUpdate}},{key:"needsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.clearChangedFlags,n=void 0!==e&&e,r=this.state.needsRedraw;return this.state.needsRedraw=r&&!n,r}},{key:"getUpdateTriggers",value:function(){var t=this.settings.accessor;return[this.id].concat("function"!=typeof t&&t||[])}},{key:"supportsTransition",value:function(){return Boolean(this.settings.transition)}},{key:"getTransitionSetting",value:function(t){if(!t||!this.supportsTransition())return null;var e=this.settings.accessor,n=this.settings.transition,r=Array.isArray(e)?t[e.find((function(e){return t[e]}))]:t[e];return Object(U.e)(r,n)}},{key:"setNeedsUpdate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id,e=arguments.length>1?arguments[1]:void 0;if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){var n=e.startRow,r=void 0===n?0:n,i=e.endRow,o=void 0===i?1/0:i;this.state.updateRanges=N(this.state.updateRanges,[r,o])}else this.state.updateRanges=G}},{key:"clearNeedsUpdate",value:function(){this.state.needsUpdate=!1,this.state.updateRanges=F}},{key:"setNeedsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.id;this.state.needsRedraw=this.state.needsRedraw||t}},{key:"allocate",value:function(t){var e=this.state,r=this.settings;return!r.noAlloc&&(!!r.update&&(p()(A()(n.prototype),"allocate",this).call(this,t,e.updateRanges!==G),!0))}},{key:"updateBuffer",value:function(t){var e=t.numInstances,r=t.data,i=t.props,o=t.context;if(!this.needsUpdate())return!1;var a=this.state.updateRanges,s=this.settings,u=s.update,c=s.noAlloc,f=!0;if(u){var h,d=z(a);try{for(d.s();!(h=d.n()).done;){var v=l()(h.value,2),g=v[0],y=v[1];u.call(o,this,{data:r,startRow:g,endRow:y,props:i,numInstances:e})}}catch(t){d.e(t)}finally{d.f()}if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else{var m,b=z(a);try{for(b.s();!(m=b.n()).done;){var _=l()(m.value,2),O=_[0],w=_[1],x=Number.isFinite(O)?this.getVertexOffset(O):0,C=Number.isFinite(w)?this.getVertexOffset(w):c||!Number.isFinite(e)?this.value.length:e*this.size;p()(A()(n.prototype),"updateSubBuffer",this).call(this,{startOffset:x,endOffset:C})}}catch(t){b.e(t)}finally{b.f()}}else;this._checkAttributeArray()}else f=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),f}},{key:"setConstantValue",value:function(t){return void 0!==t&&"function"!=typeof t&&(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}},{key:"setExternalBuffer",value:function(t){var e=this.state;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t),!0)):(e.lastExternalBuffer=null,!1)}},{key:"setBinaryValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.state,r=this.settings;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;n.binaryValue=t,this.setNeedsRedraw();var i=r.transform||e!==this.startIndices;if(i){ArrayBuffer.isView(t)&&(t={value:t});var o=t;Object(R.a)(ArrayBuffer.isView(o.value),"invalid ".concat(r.accessor));var a=Boolean(o.size)&&o.size!==this.size;return n.binaryAccessor=Object(D.b)(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:e,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}},{key:"getVertexOffset",value:function(t){var e=this.startIndices;return(e?e[t]:t)*this.size}},{key:"getShaderAttributes",value:function(){var t=this.settings.shaderAttributes||u()({},this.id,null),e={};for(var r in t)Object.assign(e,p()(A()(n.prototype),"getShaderAttributes",this).call(this,r,t[r]));return e}},{key:"_autoUpdater",value:function(t,e){var n=e.data,r=e.startRow,i=e.endRow,o=e.props,a=e.numInstances;if(!t.constant){var s=t.settings,u=t.state,c=t.value,l=t.size,f=t.startIndices,h=s.accessor,d=s.transform,p=u.binaryAccessor||("function"==typeof h?h:o[h]);Object(R.a)("function"==typeof p,'accessor "'.concat(h,'" is not a function'));var v,g=t.getVertexOffset(r),y=Object(D.a)(n,r,i),m=y.iterable,b=y.objectInfo,A=z(m);try{for(A.s();!(v=A.n()).done;){var _=v.value;b.index++;var O=p(_,b);if(d&&(O=d.call(this,O)),f){var w=(b.index<f.length-1?f[b.index+1]:a)-f[b.index];if(O&&Array.isArray(O[0])){var x,C=g,P=z(O);try{for(P.s();!(x=P.n()).done;){var S=x.value;t._normalizeValue(S,c,C),C+=l}}catch(t){P.e(t)}finally{P.f()}}else O&&O.length>l?c.set(O,g):(t._normalizeValue(O,b.target,0),Object(L.a)({target:c,source:b.target,start:g,count:w}));g+=w*l}else t._normalizeValue(O,c,g),g+=l}}catch(t){A.e(t)}finally{A.f()}}}},{key:"_validateAttributeUpdaters",value:function(){var t=this.settings;if(!(t.noAlloc||"function"==typeof t.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}},{key:"_checkAttributeArray",value:function(){var t=this.value,e=Math.min(4,this.size);if(t&&t.length>=e){var n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}]),n}(I),W=n(47),K=n(349),X=n(96);function q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?q(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Z(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Y(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var $=function(){function t(e){var n=e.gl,r=e.attribute,o=e.timeline;i()(this,t),u()(this,"gl",void 0),u()(this,"type","interpolation"),u()(this,"attributeInTransition",void 0),u()(this,"settings",void 0),u()(this,"attribute",void 0),u()(this,"transition",void 0),u()(this,"currentStartIndices",void 0),u()(this,"currentLength",void 0),u()(this,"transform",void 0),u()(this,"buffers",void 0),this.gl=n,this.transition=new X.a(o),this.attribute=r,this.attributeInTransition=new J(n,r.settings),this.currentStartIndices=r.startIndices,this.currentLength=0,this.transform=function(t,e){var n=Object(U.c)(e.size);return new K.a(t,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(n,r);var a={byteLength:0,usage:35050};this.buffers=[new w.a(n,a),new w.a(n,a)]}return a()(t,[{key:"inProgress",get:function(){return this.transition.inProgress}},{key:"start",value:function(t,e){if(t.duration<=0)this.transition.cancel();else{this.settings=t;var n=this.gl,r=this.buffers,i=this.attribute;Object(U.a)(r);var o,a={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter},s=Z(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;Object(U.f)(Q({buffer:u},a))}}catch(t){s.e(t)}finally{s.f()}this.currentStartIndices=i.startIndices,this.currentLength=Object(U.b)(i,e),this.attributeInTransition.setData({buffer:r[1],value:i.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aFrom:r[0],aTo:Object(U.d)(n,i)},feedbackBuffers:{vCurrent:r[1]}})}}},{key:"update",value:function(){var t=this.transition.update();if(t){var e=this.settings,n=e.duration,r=e.easing,i=this.transition.time/n;r&&(i=r(i)),this.transform.run({uniforms:{time:i}})}return t}},{key:"cancel",value:function(){this.transition.cancel(),this.transform.delete();var t,e=Z(this.buffers);try{for(e.s();!(t=e.n()).done;){t.value.delete()}}catch(t){e.e(t)}finally{e.f()}this.buffers.length=0}}]),t}();var tt=n(212),et=n(123),nt=n(95);function rt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return it(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function at(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var st={interpolation:$,spring:function(){function t(e){var n=e.gl,r=e.attribute,o=e.timeline;i()(this,t),u()(this,"gl",void 0),u()(this,"type","spring"),u()(this,"attributeInTransition",void 0),u()(this,"settings",void 0),u()(this,"attribute",void 0),u()(this,"transition",void 0),u()(this,"currentStartIndices",void 0),u()(this,"currentLength",void 0),u()(this,"texture",void 0),u()(this,"framebuffer",void 0),u()(this,"transform",void 0),u()(this,"buffers",void 0),this.gl=n,this.type="spring",this.transition=new X.a(o),this.attribute=r,this.attributeInTransition=new J(n,at(at({},r.settings),{},{normalized:!1})),this.currentStartIndices=r.startIndices,this.currentLength=0,this.texture=function(t){return new et.a(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(n),this.framebuffer=function(t,e){return new nt.a(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:u()({},36064,e)})}(n,this.texture),this.transform=function(t,e,n){var r=Object(U.c)(e.size);return new K.a(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}(n,r,this.framebuffer);var a={byteLength:0,usage:35050};this.buffers=[new w.a(n,a),new w.a(n,a),new w.a(n,a)]}return a()(t,[{key:"inProgress",get:function(){return this.transition.inProgress}},{key:"start",value:function(t,e){var n,r=this.gl,i=this.buffers,o=this.attribute,a={numInstances:e,attribute:o,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter},s=rt(i);try{for(s.s();!(n=s.n()).done;){var u=n.value;Object(U.f)(at({buffer:u},a))}}catch(t){s.e(t)}finally{s.f()}this.settings=t,this.currentStartIndices=o.startIndices,this.currentLength=Object(U.b)(o,e),this.attributeInTransition.setData({buffer:i[1],value:o.value}),this.transition.start(at(at({},t),{},{duration:1/0})),this.transform.update({elementCount:Math.floor(this.currentLength/o.size),sourceBuffers:{aTo:Object(U.d)(r,o)}})}},{key:"update",value:function(){var t=this.buffers,e=this.transform,n=this.framebuffer,r=this.transition;if(!r.update())return!1;var i=this.settings;return e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:i.stiffness,damping:i.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Object(U.a)(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value}),Object(tt.c)(n)[0]>0||r.end(),!0}},{key:"cancel",value:function(){this.transition.cancel(),this.transform.delete();var t,e=rt(this.buffers);try{for(e.s();!(t=e.n()).done;){t.value.delete()}}catch(t){e.e(t)}finally{e.f()}this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}]),t}()},ut=function(){function t(e,n){var r=n.id,o=n.timeline;i()(this,t),u()(this,"id",void 0),u()(this,"isSupported",void 0),u()(this,"gl",void 0),u()(this,"timeline",void 0),u()(this,"transitions",void 0),u()(this,"needsRedraw",void 0),u()(this,"numInstances",void 0),this.id=r,this.gl=e,this.timeline=o,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=K.a.isSupported(e)}return a()(t,[{key:"finalize",value:function(){for(var t in this.transitions)this._removeTransition(t)}},{key:"update",value:function(t){var e=t.attributes,n=t.transitions,r=t.numInstances;for(var i in this.numInstances=r||1,e){var o=e[i],a=o.getTransitionSetting(n);a&&this._updateAttribute(i,o,a)}for(var s in this.transitions){var u=e[s];u&&u.getTransitionSetting(n)||this._removeTransition(s)}}},{key:"hasAttribute",value:function(t){var e=this.transitions[t];return e&&e.inProgress}},{key:"getAttributes",value:function(){var t={};for(var e in this.transitions){var n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}},{key:"run",value:function(){if(!this.isSupported||0===this.numInstances)return!1;for(var t in this.transitions){this.transitions[t].update()&&(this.needsRedraw=!0)}var e=this.needsRedraw;return this.needsRedraw=!1,e}},{key:"_removeTransition",value:function(t){this.transitions[t].cancel(),delete this.transitions[t]}},{key:"_updateAttribute",value:function(t,e,n){var r=this.transitions[t],i=!r||r.type!==n.type;if(i){if(!this.isSupported)return void k.a.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();r&&this._removeTransition(t);var o=st[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):(k.a.error("unsupported transition type '".concat(n.type,"'"))(),i=!1)}(i||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}]),t}();function ct(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function lt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ct(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ft(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ht(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ht(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return dt}));var dt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.id,o=void 0===r?"attribute-manager":r,a=n.stats,s=n.timeline;i()(this,t),u()(this,"id",void 0),u()(this,"gl",void 0),u()(this,"attributes",void 0),u()(this,"updateTriggers",void 0),u()(this,"needsRedraw",void 0),u()(this,"userData",void 0),u()(this,"stats",void 0),u()(this,"attributeTransitionManager",void 0),this.id=o,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=a,this.attributeTransitionManager=new ut(e,{id:"".concat(o,"-transitions"),timeline:s}),Object.seal(this)}return a()(t,[{key:"finalize",value:function(){for(var t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}},{key:"getNeedsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}},{key:"setNeedsRedraw",value:function(){this.needsRedraw=!0}},{key:"add",value:function(t){this._add(t)}},{key:"addInstanced",value:function(t){this._add(t,{instanced:1})}},{key:"remove",value:function(t){var e,n=ft(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;void 0!==this.attributes[r]&&(this.attributes[r].delete(),delete this.attributes[r])}}catch(t){n.e(t)}finally{n.f()}}},{key:"invalidate",value:function(t,e){var n=this._invalidateTrigger(t,e);Object(W.a)("attributeManager.invalidate",this,t,n)}},{key:"invalidateAll",value:function(t){for(var e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);Object(W.a)("attributeManager.invalidate",this,"all")}},{key:"update",value:function(t){var e=t.data,n=t.numInstances,r=t.startIndices,i=void 0===r?null:r,o=t.transitions,a=t.props,s=void 0===a?{}:a,u=t.buffers,c=void 0===u?{}:u,l=t.context,f=void 0===l?{}:l,h=!1;for(var d in Object(W.a)("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart(),this.attributes){var p=this.attributes[d],v=p.settings.accessor;p.startIndices=i,p.numInstances=n,s[d]&&k.a.removed("props.".concat(d),"data.attributes.".concat(d))(),p.setExternalBuffer(c[d])||p.setBinaryValue("string"==typeof v?c[v]:void 0,e.startIndices)||"string"==typeof v&&!c[v]&&p.setConstantValue(s[v])||p.needsUpdate()&&(h=!0,this._updateAttribute({attribute:p,numInstances:n,data:e,props:s,context:f})),this.needsRedraw=this.needsRedraw||p.needsRedraw()}h&&Object(W.a)("attributeManager.updateEnd",this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:o})}},{key:"updateTransition",value:function(){var t=this.attributeTransitionManager.run();return this.needsRedraw=this.needsRedraw||t,t}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getChangedAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearChangedFlags:!1},e=this.attributes,n=this.attributeTransitionManager,r=lt({},n.getAttributes());for(var i in e){var o=e[i];o.needsRedraw(t)&&!n.hasAttribute(i)&&(r[i]=o)}return r}},{key:"getShaderAttributes",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t||(t=this.getAttributes());var n={};for(var r in t)e[r]||Object.assign(n,t[r].getShaderAttributes());return n}},{key:"_add",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(var n in t){var r=t[n];this.attributes[n]=this._createAttribute(n,r,e)}this._mapUpdateTriggersToAttributes()}},{key:"_createAttribute",value:function(t,e,n){var r=lt(lt({},e),{},{id:t,size:(e.isIndexed?1:e.size)||1,divisor:n.instanced?1:e.divisor||0});return new J(this.gl,r)}},{key:"_mapUpdateTriggersToAttributes",value:function(){var t=this,e={},n=function(n){t.attributes[n].getUpdateTriggers().forEach((function(t){e[t]||(e[t]=[]),e[t].push(n)}))};for(var r in this.attributes)n(r);this.updateTriggers=e}},{key:"_invalidateTrigger",value:function(t,e){var n=this.attributes,r=this.updateTriggers[t];return r&&r.forEach((function(t){var r=n[t];r&&r.setNeedsUpdate(r.id,e)})),r}},{key:"_updateAttribute",value:function(t){var e=t.attribute,n=t.numInstances;(Object(W.a)("attribute.updateStart",e),e.constant)?e.setConstantValue(e.value):(e.allocate(n)&&Object(W.a)("attribute.allocate",e,n),e.updateBuffer(t)&&(this.needsRedraw=!0,Object(W.a)("attribute.updateEnd",e,n)))}}]),t}()},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(10),u=n.n(s),c=n(5),l=n.n(c),f=n(7),h=n.n(f),d=n(2),p=n.n(d),v=n(0),g=n.n(v),y=n(228),m=n(248),b=n(247),A=n(20),_=n(176),O=n(12),w=n(264),x=n(198),C=n(194),P=n(31),S=n(67),B=n(82),k=n(56);function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){g()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var M=function(t){l()(n,t);var e=j(n);function n(t){i()(this,n);var r=t.id,o=void 0===r?Object(S.c)("column-geometry"):r,a=function(t){var e=t.radius,n=t.height,r=void 0===n?1:n,i=t.nradial,o=void 0===i?10:i,a=t.vertices;a&&(P.a.assert(a.length>=o),a=a.flatMap((function(t){return[t[0],t[1]]})),Object(k.h)(a,k.a.COUNTER_CLOCKWISE));var s=r>0,u=o+1,c=s?3*u+1:o,l=2*Math.PI/o,f=new Uint16Array(s?3*o*2:0),h=new Float32Array(3*c),d=new Float32Array(3*c),p=0;if(s){for(var v=0;v<u;v++)for(var g=v*l,y=v%o,m=Math.sin(g),b=Math.cos(g),A=0;A<2;A++)h[p+0]=a?a[2*y]:b*e,h[p+1]=a?a[2*y+1]:m*e,h[p+2]=(.5-A)*r,d[p+0]=a?a[2*y]:b,d[p+1]=a?a[2*y+1]:m,p+=3;h[p+0]=h[p-3],h[p+1]=h[p-2],h[p+2]=h[p-1],p+=3}for(var _=s?0:1;_<u;_++){var O=Math.floor(_/2)*Math.sign(.5-_%2),w=O*l,x=(O+o)%o,C=Math.sin(w),S=Math.cos(w);h[p+0]=a?a[2*x]:S*e,h[p+1]=a?a[2*x+1]:C*e,h[p+2]=r/2,d[p+2]=1,p+=3}if(s)for(var B=0,E=0;E<o;E++)f[B++]=2*E+0,f[B++]=2*E+2,f[B++]=2*E+0,f[B++]=2*E+1,f[B++]=2*E+1,f[B++]=2*E+3;return{indices:f,attributes:{POSITION:{size:3,value:h},NORMAL:{size:3,value:d}}}}(t),s=a.indices,u=a.attributes;return e.call(this,T(T({},t),{},{id:o,indices:s,attributes:u}))}return n}(B.a);function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach((function(e){g()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function D(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}n.d(e,"a",(function(){return G}));var L=[0,0,0,255],F={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:function(t){return t.position}},getFillColor:{type:"accessor",value:L},getLineColor:{type:"accessor",value:L},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}},G=function(t){l()(n,t);var e=D(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){var t=this.context.gl,e=!Object(O.j)(t),r={},i=this.props.flatShading&&Object(w.b)(t,x.a.GLSL_DERIVATIVES);return i&&(r.FLAT_SHADING=1),u()(p()(n.prototype),"getShaders",this).call(this,{vs:"#version 300 es\n\n#define SHADER_NAME column-layer-vertex-shader\n\nin vec3 positions;\nin vec3 normals;\n\nin vec3 instancePositions;\nin float instanceElevations;\nin vec3 instancePositions64Low;\nin vec4 instanceFillColors;\nin vec4 instanceLineColors;\nin float instanceStrokeWidths;\n\nin vec3 instancePickingColors;\n\n// Custom uniforms\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool stroked;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int radiusUnits;\nuniform int widthUnits;\n\n// Result\nout vec4 vColor;\n#ifdef FLAT_SHADING\nout vec4 position_commonspace;\n#endif\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  // rotate primitive position and normal\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n\n  // calculate elevation, if 3d not enabled set to 0\n  // cylindar gemoetry height are between -1.0 to 1.0, transform it to between 0, 1\n  float elevation = 0.0;\n  // calculate stroke offset\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (stroked) {\n    float widthPixels = clamp(\n      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n    if (isStroke) {\n      strokeOffsetRatio -= sign(positions.z) * halfOffset;\n    } else {\n      strokeOffsetRatio -= halfOffset;\n    }\n  }\n\n  // if alpha == 0.0 or z < 0.0, do not render element\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n\n  geometry.pickingColor = instancePickingColors;\n\n  // project center of column\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec3 centroidPosition64Low = instancePositions64Low;\n  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;\n  if (radiusUnits == UNIT_METERS) {\n    offset = project_size(offset);\n  }\n  vec3 pos = vec3(offset, 0.);\n  DECKGL_FILTER_SIZE(pos, geometry);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Light calculations\n  if (extruded && !isStroke) {\n#ifdef FLAT_SHADING\n    position_commonspace = geometry.position;\n    vColor = vec4(color.rgb, color.a * opacity);\n#else\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n    vColor = vec4(lightColor, color.a * opacity);\n#endif\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nuniform vec3 project_uCameraPosition;\nuniform bool extruded;\nuniform bool isStroke;\n\nout vec4 fragColor;\n\nin vec4 vColor;\n#ifdef FLAT_SHADING\nin vec4 position_commonspace;\n#endif\n\nvoid main(void) {\n  fragColor = vColor;\n#ifdef FLAT_SHADING\n  if (extruded && !isStroke && !picking_uActive) {\n    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);\n  }\n#endif\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",defines:r,transpileToGLSL100:e,modules:[y.a,i?m.b:m.a,b.a]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:L},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:L},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}},{key:"updateState",value:function(t){u()(p()(n.prototype),"updateState",this).call(this,t);var e=t.props,r=t.oldProps,i=t.changeFlags.extensionsChanged||e.flatShading!==r.flatShading;if(i){var o,a=this.context.gl;null===(o=this.state.model)||void 0===o||o.delete(),this.state.model=this._getModel(a),this.getAttributeManager().invalidateAll()}(i||e.diskResolution!==r.diskResolution||e.vertices!==r.vertices||(e.extruded||e.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(e)}},{key:"getGeometry",value:function(t,e,n){var r=new M({radius:1,height:n?2:0,vertices:e,nradial:t}),i=0;if(e)for(var o=0;o<t;o++){var a=e[o];i+=Math.sqrt(a[0]*a[0]+a[1]*a[1])/t}else i=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*i}),r}},{key:"_getModel",value:function(t){return new C.a(t,R(R({},this.getShaders()),{},{id:this.props.id,isInstanced:!0}))}},{key:"_updateGeometry",value:function(t){var e=t.diskResolution,n=t.vertices,r=t.extruded,i=t.stroked,o=this.getGeometry(e,n,r||i);this.setState({fillVertexCount:o.attributes.POSITION.value.length/3,wireframeVertexCount:o.indices.value.length}),this.state.model.setProps({geometry:o})}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.lineWidthUnits,i=n.lineWidthScale,o=n.lineWidthMinPixels,a=n.lineWidthMaxPixels,s=n.radiusUnits,u=n.elevationScale,c=n.extruded,l=n.filled,f=n.stroked,h=n.wireframe,d=n.offset,p=n.coverage,v=n.radius,g=n.angle,y=this.state,m=y.model,b=y.fillVertexCount,_=y.wireframeVertexCount,O=y.edgeDistance;m.setUniforms(e).setUniforms({radius:v,angle:g/180*Math.PI,offset:d,extruded:c,stroked:f,coverage:p,elevationScale:u,edgeDistance:O,radiusUnits:A.e[s],widthUnits:A.e[r],widthScale:i,widthMinPixels:o,widthMaxPixels:a}),c&&h&&(m.setProps({isIndexed:!0}),m.setVertexCount(_).setDrawMode(1).setUniforms({isStroke:!0}).draw()),l&&(m.setProps({isIndexed:!1}),m.setVertexCount(b).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!c&&f&&(m.setProps({isIndexed:!1}),m.setVertexCount(2*b/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}]),n}(_.a);g()(G,"layerName","ColumnLayer"),g()(G,"defaultProps",F)},function(t,e,n){"use strict";var r=n(15),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(9),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(75),A=n(203),_=n(183),O=n(260),w=n.n(O),x=n(31);function C(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return P(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function P(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var S=[];function B(t,e,n,r){for(var i=0,o=e;o<n;o++){var a;i+=(null===(a=r[t[o]])||void 0===a?void 0:a.width)||0}return i}function k(t,e,n,r,i,o){for(var a=e,s=0,u=e;u<n;u++){var c=B(t,u,u+1,i);s+c>r&&(a<u&&o.push(u),a=u,s=0),s+=c}return s}function E(t,e,n,r,i,o){for(var a=e,s=e,u=e,c=0,l=e;l<n;l++)if(" "===t[l]?u=l+1:" "!==t[l+1]&&l+1!==n||(u=l+1),u>s){var f=B(t,s,u,i);c+f>r&&(a<s&&(o.push(s),a=s,c=0),f>r&&(f=k(t,s,u,r,i,o),a=o[o.length-1])),s=u,c+=f}return c}function T(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5?arguments[5]:void 0;void 0===o&&(o=t.length);var a=[];return"break-all"===e?k(t,i,o,n,r,a):E(t,i,o,n,r,a),a}function j(t,e,n,r,i,o){for(var a=0,s=0,u=e;u<n;u++){var c=t[u],l=r[c];l?(s||(s=l.height),i[u]=a+l.width/2,a+=l.width):(x.a.warn("Missing character: ".concat(c," (").concat(c.codePointAt(0),")"))(),i[u]=a,a+=32)}o[0]=a,o[1]=s}function M(t,e,n,r,i){for(var o=Array.from(t),a=o.length,s=new Array(a),u=new Array(a),c=new Array(a),l=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,f=[0,0],h=[0,0],d=0,p=0,v=0,g=0;g<=a;g++){var y=o[g];if("\n"!==y&&g!==a||(v=g),v>p){for(var m=l?T(o,n,r,i,p,v):S,b=0;b<=m.length;b++){var A=0===b?p:m[b-1],_=b<m.length?m[b]:v;j(o,A,_,i,s,h);for(var O=A;O<_;O++)u[O]=d+h[1]/2,c[O]=h[0];d+=h[1]*e,f[0]=Math.max(f[0],h[0])}p=v}"\n"===y&&(s[p]=0,u[p]=0,c[p]=0,p++)}return f[1]=d,{x:s,y:u,rowWidth:c,size:f}}var I=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;a()(this,t),m()(this,"limit",void 0),m()(this,"_cache",{}),m()(this,"_order",[]),this.limit=e}return u()(t,[{key:"get",value:function(t){var e=this._cache[t];return e&&(this._deleteOrder(t),this._appendOrder(t)),e}},{key:"set",value:function(t,e){this._cache[t]?(this.delete(t),this._cache[t]=e,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=e,this._appendOrder(t))}},{key:"delete",value:function(t){this._cache[t]&&(delete this._cache[t],this._deleteOrder(t))}},{key:"_deleteOrder",value:function(t){var e=this._order.indexOf(t);e>=0&&this._order.splice(e,1)}},{key:"_appendOrder",value:function(t){this._order.push(t)}}]),t}();function R(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return D(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function F(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var G={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){for(var t=[],e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},N=new I(3);function U(t,e){var n;n="string"==typeof e?new Set(Array.from(e)):new Set(e);var r=N.get(t);if(!r)return n;for(var i in r.mapping)n.has(i)&&n.delete(i);return n}function z(t,e){for(var n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function H(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}var V=function(){function t(){a()(this,t),m()(this,"props",F({},G)),m()(this,"_key",void 0),m()(this,"_atlas",void 0)}return u()(t,[{key:"texture",get:function(){return this._atlas}},{key:"mapping",get:function(){return this._atlas&&this._atlas.mapping}},{key:"scale",get:function(){return 1.2}},{key:"setProps",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this.props,t);var e=this._key;this._key=this._getKey();var n=U(this._key,this.props.characterSet),r=N.get(this._key);if(r&&0===n.size)this._key!==e&&(this._atlas=r);else{var i=this._generateFontAtlas(this._key,n,r);this._atlas=i,N.set(this._key,i)}}},{key:"_generateFontAtlas",value:function(t,e,n){var r=this.props,i=r.fontFamily,o=r.fontWeight,a=r.fontSize,s=r.buffer,u=r.sdf,c=r.radius,l=r.cutoff,f=n&&n.data;f||((f=document.createElement("canvas")).width=1024);var h=f.getContext("2d");H(h,i,a,o);var d=function(t){var e,n=t.characterSet,r=t.getFontWidth,i=t.fontHeight,o=t.buffer,a=t.maxCanvasWidth,s=t.mapping,u=void 0===s?{}:s,c=t.xOffset,l=void 0===c?0:c,f=t.yOffset,h=void 0===f?0:f,d=0,p=l,v=C(n);try{for(v.s();!(e=v.n()).done;){var g=e.value;if(!u[g]){var y=r(g);p+y+2*o>a&&(p=0,d++),u[g]={x:p+o,y:h+d*(i+2*o)+o,width:y,height:i},p+=y+2*o}}}catch(t){v.e(t)}finally{v.f()}var m,b=i+2*o;return{mapping:u,xOffset:p,yOffset:h+d*b,canvasHeight:(m=h+(d+1)*b,Math.pow(2,Math.ceil(Math.log2(m))))}}(F({getFontWidth:function(t){return h.measureText(t).width},fontHeight:1.2*a,buffer:s,characterSet:e,maxCanvasWidth:1024},n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset})),p=d.mapping,v=d.canvasHeight,g=d.xOffset,y=d.yOffset;if(f.height!==v){var m=h.getImageData(0,0,f.width,f.height);f.height=v,h.putImageData(m,0,0)}if(H(h,i,a,o),u){var b,A=new w.a(a,s,c,l,i,o),_=h.getImageData(0,0,A.size,A.size),O=R(e);try{for(O.s();!(b=O.n()).done;){var x=b.value;z(A.draw(x),_),h.putImageData(_,p[x].x-s,p[x].y+s)}}catch(t){O.e(t)}finally{O.f()}}else{var P,S=R(e);try{for(S.s();!(P=S.n()).done;){var B=P.value;h.fillText(B,p[B].x,p[B].y+.9*a)}}catch(t){S.e(t)}finally{S.f()}}return{xOffset:g,yOffset:y,mapping:p,data:f,width:f.width,height:f.height}}},{key:"_getKey",value:function(){var t=this.props,e=t.fontFamily,n=t.fontWeight,r=t.fontSize,i=t.buffer,o=t.sdf,a=t.radius,s=t.cutoff;return o?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(a," ").concat(s):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}]),t}(),J=n(181);function W(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return K(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}n.d(e,"a",(function(){return et}));var Z={start:1,middle:0,end:-1},Y={top:1,center:0,bottom:-1},$=[0,0,0,255],tt={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:$},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:G.characterSet},fontFamily:G.fontFamily,fontWeight:G.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:$},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:function(t){return t.text}},getPosition:{type:"accessor",value:function(t){return t.position}},getColor:{type:"accessor",value:$},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}},et=function(t){h()(n,t);var e=Q(n);function n(){var t;a()(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o)),m()(l()(t),"state",void 0),m()(l()(t),"getBoundingRect",(function(e,n){var r=t.state.fontAtlasManager.mapping,o=t.state.getText,a=t.props,s=a.wordBreak,u=a.maxWidth,c=a.lineHeight,l=a.getTextAnchor,f=a.getAlignmentBaseline,h=M(o(e,n)||"",c,s,u,r),d=i()(h.size,2),p=d[0],v=d[1];return[(Z["function"==typeof l?l(e,n):l]-1)*p/2,(Y["function"==typeof f?f(e,n):f]-1)*v/2,p,v]})),m()(l()(t),"getIconOffsets",(function(e,n){for(var r=t.state.fontAtlasManager.mapping,o=t.state.getText,a=t.props,s=a.wordBreak,u=a.maxWidth,c=a.lineHeight,l=a.getTextAnchor,f=a.getAlignmentBaseline,h=M(o(e,n)||"",c,s,u,r),d=h.x,p=h.y,v=h.rowWidth,g=i()(h.size,2),y=g[0],m=g[1],b=Z["function"==typeof l?l(e,n):l],A=Y["function"==typeof f?f(e,n):f],_=d.length,O=new Array(2*_),w=0,x=0;x<_;x++){var C=(1-b)*(y-v[x])/2;O[w++]=(b-1)*y/2+C+d[x],O[w++]=(A-1)*m/2+p[x]}return O})),t}return u()(n,[{key:"initializeState",value:function(){this.state={styleVersion:0,fontAtlasManager:new V}}},{key:"updateState",value:function(t){var e=t.props,n=t.oldProps,r=t.changeFlags;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||e.lineHeight!==n.lineHeight||e.wordBreak!==n.wordBreak||e.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}},{key:"getPickingInfo",value:function(t){var e=t.info;return e.object=e.index>=0?this.props.data[e.index]:null,e}},{key:"_updateFontAtlas",value:function(){var t=this.props,e=t.fontSettings,n=t.fontFamily,r=t.fontWeight,i=this.state,o=i.fontAtlasManager,a=i.characterSet,s=q(q({},e),{},{characterSet:a,fontFamily:n,fontWeight:r});if(!o.mapping)return o.setProps(s),!0;for(var u in s)if(s[u]!==o.props[u])return o.setProps(s),!0;return!1}},{key:"_updateText",value:function(){var t,e,n=this.props,r=n.data,i=n.characterSet,o=null===(t=r.attributes)||void 0===t?void 0:t.getText,a=this.props.getText,s=r.startIndices,u="auto"===i&&new Set;if(o&&s){var c=function(t){var e=t.value,n=t.length,r=t.stride,i=t.offset,o=t.startIndices,a=t.characterSet,s=e.BYTES_PER_ELEMENT,u=r?r/s:1,c=i?i/s:0,l=o[n]||Math.ceil((e.length-c)/u),f=a&&new Set,h=new Array(n),d=e;if(u>1||c>0){d=new(0,e.constructor)(l);for(var p=0;p<l;p++)d[p]=e[p*u+c]}for(var v=0;v<n;v++){var g=o[v],y=o[v+1]||l,m=d.subarray(g,y);h[v]=String.fromCodePoint.apply(null,m),f&&m.forEach(f.add,f)}if(f){var b,A=C(f);try{for(A.s();!(b=A.n()).done;){var _=b.value;a.add(String.fromCodePoint(_))}}catch(t){A.e(t)}finally{A.f()}}return{texts:h,characterCount:l}}(q(q({},ArrayBuffer.isView(o)?{value:o}:o),{},{length:r.length,startIndices:s,characterSet:u})),l=c.texts;e=c.characterCount,a=function(t,e){var n=e.index;return l[n]}}else{var f=Object(b.a)(r),h=f.iterable,d=f.objectInfo;s=[0],e=0;var p,v=W(h);try{for(v.s();!(p=v.n()).done;){var g=p.value;d.index++;var y=Array.from(a(g,d)||"");u&&y.forEach(u.add,u),e+=y.length,s.push(e)}}catch(t){v.e(t)}finally{v.f()}}this.setState({getText:a,startIndices:s,numInstances:e,characterSet:u||i})}},{key:"renderLayers",value:function(){var t=this.state,e=t.startIndices,n=t.numInstances,r=t.getText,i=t.fontAtlasManager,o=i.scale,a=i.texture,s=i.mapping,u=t.styleVersion,c=this.props,l=c.data,f=c._dataDiff,h=c.getPosition,d=c.getColor,p=c.getSize,v=c.getAngle,g=c.getPixelOffset,y=c.getBackgroundColor,m=c.getBorderColor,b=c.getBorderWidth,A=c.backgroundPadding,O=c.background,w=c.billboard,x=c.fontSettings,C=c.outlineWidth,P=c.outlineColor,S=c.sizeScale,B=c.sizeUnits,k=c.sizeMinPixels,E=c.sizeMaxPixels,T=c.transitions,j=c.updateTriggers,M=this.getSubLayerClass("characters",_.a),I=this.getSubLayerClass("background",J.a);return[O&&new I({getFillColor:y,getLineColor:m,getLineWidth:b,padding:A,getPosition:h,getSize:p,getAngle:v,getPixelOffset:g,billboard:w,sizeScale:S/this.state.fontAtlasManager.props.fontSize,sizeUnits:B,sizeMinPixels:k,sizeMaxPixels:E,transitions:T&&{getPosition:T.getPosition,getAngle:T.getAngle,getSize:T.getSize,getFillColor:T.getBackgroundColor,getLineColor:T.getBorderColor,getLineWidth:T.getBorderWidth,getPixelOffset:T.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:j.getPosition,getAngle:j.getAngle,getSize:j.getSize,getFillColor:j.getBackgroundColor,getLineColor:j.getBorderColor,getLineWidth:j.getBorderWidth,getPixelOffset:j.getPixelOffset,getBoundingRect:{getText:j.getText,getTextAnchor:j.getTextAnchor,getAlignmentBaseline:j.getAlignmentBaseline,styleVersion:u}}}),{data:l.attributes&&l.attributes.background?{length:l.length,attributes:l.attributes.background}:l,_dataDiff:f,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new M({sdf:x.sdf,smoothing:Number.isFinite(x.smoothing)?x.smoothing:G.smoothing,outlineWidth:C,outlineColor:P,iconAtlas:a,iconMapping:s,getPosition:h,getColor:d,getSize:p,getAngle:v,getPixelOffset:g,billboard:w,sizeScale:S*o,sizeUnits:B,sizeMinPixels:k*o,sizeMaxPixels:E*o,transitions:T&&{getPosition:T.getPosition,getAngle:T.getAngle,getColor:T.getColor,getSize:T.getSize,getPixelOffset:T.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:j.getText,getPosition:j.getPosition,getAngle:j.getAngle,getColor:j.getColor,getSize:j.getSize,getPixelOffset:j.getPixelOffset,getIconOffsets:{getText:j.getText,getTextAnchor:j.getTextAnchor,getAlignmentBaseline:j.getAlignmentBaseline,styleVersion:u}}}),{data:l,_dataDiff:f,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}}],[{key:"fontAtlasCacheLimit",set:function(t){!function(t){x.a.assert(Number.isFinite(t)&&t>=3,"Invalid cache limit"),N=new I(t)}(t)}}]),n}(A.a);m()(et,"defaultProps",tt),m()(et,"layerName","TextLayer")},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(10),u=n.n(s),c=n(5),l=n.n(c),f=n(7),h=n.n(f),d=n(2),p=n.n(d),v=n(0),g=n.n(v),y=n(228),m=n(247),b=n(20),A=n(176),_=n(194),O=n(82);function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){g()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}n.d(e,"a",(function(){return B}));var P=[0,0,0,255],S={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:function(t){return t.position}},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:P},getLineColor:{type:"accessor",value:P},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}},B=function(t){l()(n,t);var e=C(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return u()(p()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  // Multiply out radius and clamp to limits\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  \n  // Multiply out line width and clamp to limits\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n\n  // outer radius needs to offset by half stroke width\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n\n  // Expand geometry to accomodate edge smoothing\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n\n  // position on the containing square in [-1, 1] space\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  }\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[y.a,m.a]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}},{key:"updateState",value:function(t){if(u()(p()(n.prototype),"updateState",this).call(this,t),t.changeFlags.extensionsChanged){var e,r=this.context.gl;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.radiusUnits,i=n.radiusScale,o=n.radiusMinPixels,a=n.radiusMaxPixels,s=n.stroked,u=n.filled,c=n.billboard,l=n.antialiasing,f=n.lineWidthUnits,h=n.lineWidthScale,d=n.lineWidthMinPixels,p=n.lineWidthMaxPixels;this.state.model.setUniforms(e).setUniforms({stroked:s?1:0,filled:u,billboard:c,antialiasing:l,radiusUnits:b.e[r],radiusScale:i,radiusMinPixels:o,radiusMaxPixels:a,lineWidthUnits:b.e[f],lineWidthScale:h,lineWidthMinPixels:d,lineWidthMaxPixels:p}).draw()}},{key:"_getModel",value:function(t){return new _.a(t,x(x({},this.getShaders()),{},{id:this.props.id,geometry:new O.a({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0}))}}]),n}(A.a);g()(B,"defaultProps",S),g()(B,"layerName","ScatterplotLayer")},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(10),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(228),A=n(247),_=n(20),O=n(176),w=n(194),x=n(82);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}n.d(e,"a",(function(){return k}));var B={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:function(t){return t.position}},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}},k=function(t){h()(n,t);var e=S(n);function n(){var t;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o)),m()(u()(t),"state",void 0),t}return a()(n,[{key:"getShaders",value:function(){return l()(g()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n\n  // convert size in meters to pixels, then scaled and clamp\n\n  // project meters to pixels and clamp to limits\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[b.a,A.a]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}},{key:"updateState",value:function(t){if(l()(g()(n.prototype),"updateState",this).call(this,t),t.changeFlags.extensionsChanged){var e,r=this.context.gl;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.billboard,i=n.sizeScale,o=n.sizeUnits,a=n.sizeMinPixels,s=n.sizeMaxPixels,u=n.getLineWidth,c=this.props.padding;c.length<4&&(c=[c[0],c[1],c[0],c[1]]),this.state.model.setUniforms(e).setUniforms({billboard:r,stroked:Boolean(u),padding:c,sizeUnits:_.e[o],sizeScale:i,sizeMinPixels:a,sizeMaxPixels:s}).draw()}},{key:"_getModel",value:function(t){return new w.a(t,P(P({},this.getShaders()),{},{id:this.props.id,geometry:new x.a({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0}))}}]),n}(O.a);m()(k,"defaultProps",B),m()(k,"layerName","TextBackgroundLayer")},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=n(344),l=n(37),f=n(31),h=n(47),d=n(89),p=n(110),v=n(223);function g(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var m=function(){function t(e,n,r){i()(this,t),u()(this,"id",void 0),u()(this,"context",void 0),u()(this,"isLoaded",void 0),u()(this,"persistent",void 0),u()(this,"_loadCount",0),u()(this,"_subscribers",new Set),u()(this,"_data",void 0),u()(this,"_loader",void 0),u()(this,"_error",void 0),u()(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}return a()(t,[{key:"subscribe",value:function(t){this._subscribers.add(t)}},{key:"unsubscribe",value:function(t){this._subscribers.delete(t)}},{key:"inUse",value:function(){return this._subscribers.size>0}},{key:"delete",value:function(){}},{key:"getData",value:function(){var t=this;return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((function(){return t.getData()}))}},{key:"setData",value:function(t,e){var n=this;if(t!==this._data||e){this._data=t;var r=++this._loadCount,i=t;"string"==typeof t&&(i=Object(v.a)(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then((function(t){n._loadCount===r&&(n.isLoaded=!0,n._error=void 0,n._content=t)})).catch((function(t){n._loadCount===r&&(n.isLoaded=!0,n._error=t||!0)}))):(this.isLoaded=!0,this._error=void 0,this._content=t);var o,a=g(this._subscribers);try{for(a.s();!(o=a.n()).done;){o.value.onChange(this.getData())}}catch(t){a.e(t)}finally{a.f()}}}}]),t}(),b=function(){function t(e){var n=e.gl,r=e.protocol;i()(this,t),u()(this,"protocol",void 0),u()(this,"_context",void 0),u()(this,"_resources",void 0),u()(this,"_consumers",void 0),u()(this,"_pruneRequest",void 0),this.protocol=r||"resource://",this._context={gl:n,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}return a()(t,[{key:"contains",value:function(t){return!!t.startsWith(this.protocol)||t in this._resources}},{key:"add",value:function(t){var e=t.resourceId,n=t.data,r=t.forceUpdate,i=void 0!==r&&r,o=t.persistent,a=void 0===o||o,s=this._resources[e];s?s.setData(n,i):(s=new m(e,n,this._context),this._resources[e]=s),s.persistent=a}},{key:"remove",value:function(t){var e=this._resources[t];e&&(e.delete(),delete this._resources[t])}},{key:"unsubscribe",value:function(t){var e=t.consumerId,n=this._consumers[e];if(n){for(var r in n){var i=n[r],o=this._resources[i.resourceId];o&&o.unsubscribe(i)}delete this._consumers[e],this.prune()}}},{key:"subscribe",value:function(t){var e=t.resourceId,n=t.onChange,r=t.consumerId,i=t.requestId,o=void 0===i?"default":i,a=this._resources,s=this.protocol;e.startsWith(s)&&(a[e=e.replace(s,"")]||this.add({resourceId:e,data:null,persistent:!1}));var u=a[e];if(this._track(r,o,u,n),u)return u.getData()}},{key:"prune",value:function(){var t=this;this._pruneRequest||(this._pruneRequest=setTimeout((function(){return t._prune()}),0))}},{key:"finalize",value:function(){for(var t in this._resources)this._resources[t].delete()}},{key:"_track",value:function(t,e,n,r){var i=this._consumers,o=i[t]=i[t]||{},a=o[e]||{},s=a.resourceId&&this._resources[a.resourceId];s&&(s.unsubscribe(a),this.prune()),n&&(o[e]=a,a.onChange=r,a.resourceId=n.id,n.subscribe(a))}},{key:"_prune",value:function(){this._pruneRequest=null;for(var t=0,e=Object.keys(this._resources);t<e.length;t++){var n=e[t],r=this._resources[n];r.persistent||r.inUse()||(r.delete(),delete this._resources[n])}}}]),t}(),A=n(62),_=n(169);function O(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return x}));var x=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.deck,a=r.stats,s=r.viewport,l=r.timeline;i()(this,t),u()(this,"layers",void 0),u()(this,"context",void 0),u()(this,"resourceManager",void 0),u()(this,"_lastRenderedLayers",[]),u()(this,"_needsRedraw",!1),u()(this,"_needsUpdate",!1),u()(this,"_nextLayers",null),u()(this,"_debug",!1),u()(this,"activateViewport",(function(t){Object(h.a)("layerManager.activateViewport",n,t),t&&(n.context.viewport=t)})),this.layers=[],this.resourceManager=new b({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:o,programManager:e&&Object(_.a)(e),stats:a||new p.a({id:"deck.gl"}),viewport:s||new A.a({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:l||new c.a,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}return a()(t,[{key:"finalize",value:function(){this.resourceManager.finalize();var t,e=O(this.layers);try{for(e.s();!(t=e.n()).done;){var n=t.value;this._finalizeLayer(n)}}catch(t){e.e(t)}finally{e.f()}}},{key:"needsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);var n,r=O(this.layers);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i.getNeedsRedraw(t);e=e||o}}catch(t){r.e(t)}finally{r.f()}return e}},{key:"needsUpdate",value:function(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}},{key:"setNeedsRedraw",value:function(t){this._needsRedraw=this._needsRedraw||t}},{key:"setNeedsUpdate",value:function(t){this._needsUpdate=this._needsUpdate||t}},{key:"getLayers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.layerIds;return e?this.layers.filter((function(t){return e.find((function(e){return 0===t.id.indexOf(e)}))})):this.layers}},{key:"setProps",value:function(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}},{key:"setLayers",value:function(t,e){Object(h.a)("layerManager.setLayers",this,e,t),this._lastRenderedLayers=t;var n,r=Object(d.b)(t,Boolean),i=O(r);try{for(i.s();!(n=i.n()).done;){n.value.context=this.context}}catch(t){i.e(t)}finally{i.f()}this._updateLayers(this.layers,r)}},{key:"updateLayers",value:function(){var t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}},{key:"_handleError",value:function(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}},{key:"_updateLayers",value:function(t,e){var n,r={},i=O(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;r[o.id]?f.a.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o}}catch(t){i.e(t)}finally{i.f()}var a=[];this._updateSublayersRecursively(e,r,a),this._finalizeOldLayers(r);for(var s=!1,u=0,c=a;u<c.length;u++){var l=c[u];if(l.hasUniformTransition()){s="Uniform transition in ".concat(l);break}}this._needsUpdate=s,this.layers=a}},{key:"_updateSublayersRecursively",value:function(t,e,n){var r,i=O(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.context=this.context;var a=e[o.id];null===a&&f.a.warn("Multiple new layers with same id ".concat(o.id))(),e[o.id]=null;var s=null;try{this._debug&&a!==o&&o.validateProps(),a?(this._transferLayerState(a,o),this._updateLayer(o)):this._initializeLayer(o),n.push(o),s=o.isComposite?o.getSubLayers():null}catch(t){this._handleError("matching",t,o)}s&&this._updateSublayersRecursively(s,e,n)}}catch(t){i.e(t)}finally{i.f()}}},{key:"_finalizeOldLayers",value:function(t){for(var e in t){var n=t[e];n&&this._finalizeLayer(n)}}},{key:"_initializeLayer",value:function(t){try{t._initialize(),t.lifecycle=l.e.INITIALIZED}catch(e){this._handleError("initialization",e,t)}}},{key:"_transferLayerState",value:function(t,e){e._transferState(t),e.lifecycle=l.e.MATCHED,e!==t&&(t.lifecycle=l.e.AWAITING_GC)}},{key:"_updateLayer",value:function(t){try{t._update()}catch(e){this._handleError("update",e,t)}}},{key:"_finalizeLayer",value:function(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=l.e.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=l.e.FINALIZED}catch(e){this._handleError("finalization",e,t)}}}]),t}()},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(10),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(31),A=n(133);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}n.d(e,"a",(function(){return C}));var x=[],C=function(t){h()(n,t);var e=w(n);function n(){var t;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o)),m()(u()(t),"state",void 0),t}return a()(n,[{key:"getShaders",value:function(){return O(O({},l()(g()(n.prototype),"getShaders",this).call(this)),{},{fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n\n    // if enable sdf (signed distance fields)\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n\n    // Take the global opacity and the alpha from color into account for the alpha component\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"})}},{key:"initializeState",value:function(){var t=this;l()(g()(n.prototype),"initializeState",this).call(this),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:function(e,n){var r=n.index,i=n.target;return t.encodePickingColor(r,i)}}})}},{key:"updateState",value:function(t){l()(g()(n.prototype),"updateState",this).call(this,t);var e=t.props,r=t.oldProps,i=e.outlineColor;i!==r.outlineColor&&((i=i.map((function(t){return t/255})))[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!e.sdf&&e.outlineWidth&&b.a.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}},{key:"draw",value:function(t){var e=this.props,r=e.sdf,i=e.smoothing,o=e.outlineWidth,a=this.state.outlineColor;t.uniforms=O(O({},t.uniforms),{},{buffer:.75,outlineBuffer:o?Math.max(i,.75*(1-o)):-1,gamma:i,sdf:Boolean(r),outlineColor:a}),l()(g()(n.prototype),"draw",this).call(this,t)}},{key:"getInstanceOffset",value:function(t){var e=this;return t?Array.from(t).flatMap((function(t){return l()(g()(n.prototype),"getInstanceOffset",e).call(e,t)})):x}},{key:"getInstanceColorMode",value:function(t){return 1}},{key:"getInstanceIconFrame",value:function(t){var e=this;return t?Array.from(t).flatMap((function(t){return l()(g()(n.prototype),"getInstanceIconFrame",e).call(e,t)})):x}}]),n}(A.a);m()(C,"defaultProps",{getIconOffsets:{type:"accessor",value:function(t){return t.offsets}},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),m()(C,"layerName","MultiIconLayer")},function(t,e,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(47),l=n(5),f=n.n(l),h=n(7),d=n.n(h),p=n(2),v=n.n(p),g=n(20);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v()(t);if(e){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var m=function(t){f()(n,t);var e=y(n);function n(){return a()(this,n),e.apply(this,arguments)}return u()(n,[{key:"shouldDrawLayer",value:function(t){return t.props.operation===g.c.DRAW}}]),n}(n(94).a),b=n(191),A=n(95);function _(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n.d(e,"a",(function(){return C}));var C=function(){function t(e){a()(this,t),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new m(e),this.pickLayersPass=new b.a(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}return u()(t,[{key:"setProps",value:function(t){"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in t&&this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}},{key:"renderLayers",value:function(t){var e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;t.layerFilter=t.layerFilter||this.layerFilter,t.effects=t.effects||[],t.target=t.target||A.a.getDefaultFramebuffer(this.gl),this._preRender(t.effects,t);var n=this.lastPostProcessEffect?this.renderBuffers[0]:t.target,r=e.render(x(x({},t),{},{target:n}));this._postRender(t.effects,t),this.renderCount++,Object(c.a)("deckRenderer.renderLayers",this,r,t)}},{key:"needsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}},{key:"finalize",value:function(){var t,e=this.renderBuffers,n=_(e);try{for(n.s();!(t=n.n()).done;){t.value.delete()}}catch(t){n.e(t)}finally{n.f()}e.length=0}},{key:"_preRender",value:function(t,e){var n,r=null,i=_(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.preRender(this.gl,e),o.postRender&&(r=o)}}catch(t){i.e(t)}finally{i.f()}r&&this._resizeRenderBuffers(),this.lastPostProcessEffect=r}},{key:"_resizeRenderBuffers",value:function(){var t=this.renderBuffers;0===t.length&&t.push(new A.a(this.gl),new A.a(this.gl));var e,n=_(t);try{for(n.s();!(e=n.n()).done;){e.value.resize()}}catch(t){n.e(t)}finally{n.f()}}},{key:"_postRender",value:function(t,e){var n,r=this.renderBuffers,i={inputBuffer:r[0],swapBuffer:r[1],target:null},o=_(t);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(a.postRender){if(a===this.lastPostProcessEffect){i.target=e.target,a.postRender(this.gl,i);break}var s=a.postRender(this.gl,i);i.inputBuffer=s,i.swapBuffer=s===r[0]?r[1]:r[0]}}}catch(t){o.e(t)}finally{o.f()}}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(26),i=n.n(r);function o(t){if("undefined"!=typeof window&&"object"===i()(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"===i()(process.versions)&&Boolean(process.versions.electron))return!0;var e="object"===("undefined"==typeof navigator?"undefined":i()(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(12);function i(t,e,n,i){var o="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),a=Object.getPrototypeOf(t);i.forEach((function(t){a.methodName||(a[t]=function(){throw r.k.removed("Calling removed method ".concat(e,".").concat(t,": "),o)(),new Error(t)})}))}},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=n=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),n(e)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var r=n(54),i=n.n(r),o=n(55),a=n.n(o),s=n(58),u=n.n(s),c=n(59),l=n.n(c),f=n(43),h=n.n(f),d=n(135),p=n(34),v=n(24);function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var y=function(t){u()(n,t);var e=g(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"toString",value:function(){var t="[";if(v.b.printRowMajor){t+="row-major:";for(var e=0;e<this.RANK;++e)for(var n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(var r=0;r<this.ELEMENTS;++r)t+=" ".concat(this[r])}return t+="]"}},{key:"getElementIndex",value:function(t,e){return e*this.RANK+t}},{key:"getElement",value:function(t,e){return this[e*this.RANK+t]}},{key:"setElement",value:function(t,e,n){return this[e*this.RANK+t]=Object(p.a)(n),this}},{key:"getColumn",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0),n=t*this.RANK,r=0;r<this.RANK;++r)e[r]=this[n+r];return e}},{key:"setColumn",value:function(t,e){for(var n=t*this.RANK,r=0;r<this.RANK;++r)this[n+r]=e[r];return this}}]),n}(d.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{id:"pass"};i()(this,t),u()(this,"id",void 0),u()(this,"gl",void 0),u()(this,"props",void 0);var r=n.id;this.id=r,this.gl=e,this.props=l({},n)}return a()(t,[{key:"setProps",value:function(t){Object.assign(this.props,t)}},{key:"render",value:function(t){}},{key:"cleanup",value:function(){}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s}));var r=n(23),i=n.n(r);function o(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=n||new Set;if(t){if(a(t))r.add(t);else if(a(t.buffer))r.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"===i()(t))for(var s in t)o(t[s],e,r)}else;return void 0===n?Array.from(r):[]}function a(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}function s(t){if(null===t)return{};var e=Object.assign({},t);return Object.keys(e).forEach((function(n){"object"!==i()(t[n])||ArrayBuffer.isView(t[n])||t[n]instanceof Array?"function"==typeof e[n]||e[n]instanceof RegExp?e[n]={}:e[n]=t[n]:e[n]=s(t[n])})),e}},function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(10),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(94),A=n(12),_=n(20),O=n(31);function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var P={blendFunc:[1,0,32771,0],blendEquation:32774},S=function(t){h()(n,t);var e=C(n);function n(){var t;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o)),m()(u()(t),"pickZ",void 0),m()(u()(t),"_colors",null),t}return a()(n,[{key:"render",value:function(t){return t.pickingFBO?this._drawPickingBuffer(t):l()(g()(n.prototype),"render",this).call(this,t)}},{key:"_drawPickingBuffer",value:function(t){var e=this,r=t.layers,i=t.layerFilter,o=t.views,a=t.viewports,s=t.onViewportActive,u=t.pickingFBO,c=t.deviceRect,f=c.x,h=c.y,d=c.width,p=c.height,v=t.cullRect,y=t.effects,m=t.pass,b=void 0===m?"picking":m,_=t.pickZ,O=this.gl;this.pickZ=_;var w=_?null:{byLayer:new Map,byAlpha:[]};this._colors=w;var C=Object(A.o)(O,x(x({scissorTest:!0,scissor:[f,h,d,p],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0]},P),{},{blend:!_}),(function(){return l()(g()(n.prototype),"render",e).call(e,{target:u,layers:r,layerFilter:i,views:o,viewports:a,onViewportActive:s,cullRect:v,effects:null==y?void 0:y.filter((function(t){return t.useInPicking})),pass:b})}));return this._colors=null,{decodePickingColor:w&&B.bind(null,w),stats:C}}},{key:"shouldDrawLayer",value:function(t){return t.props.pickable&&t.props.operation===_.c.DRAW}},{key:"getModuleParameters",value:function(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}},{key:"getLayerParameters",value:function(t,e,n){var r=x({},t.props.parameters);return this._colors?(Object.assign(r,P),r.blend=!0,r.blendColor=function(t,e,n){var r,i=t.byLayer,o=t.byAlpha,a=i.get(e);a?(a.viewports.push(n),r=a.a):(r=i.size+1)<=255?(a={a:r,layer:e,viewports:[n]},i.set(e,a),o[r]=a):(O.a.warn("Too many pickable layers, only picking the first 255")(),r=0);return[0,0,0,r/255]}(this._colors,t,n)):r.blend=!1,r}}]),n}(b.a);function B(t,e){var n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));function r(t){var e=i(t);return function(t){var e=i(t);if(!(e.byteLength>=24&&2303741511===e.getUint32(0,!1)))return null;return{mimeType:"image/png",width:e.getUint32(16,!1),height:e.getUint32(20,!1)}}(e)||function(t){var e=i(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,!1)&&255===e.getUint8(2)))return null;var n=function(){for(var t=new Set([65499,65476,65484,65501,65534]),e=65504;e<65520;++e)t.add(e);var n=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:n}}(),r=n.tableMarkers,o=n.sofMarkers,a=2;for(;a+9<e.byteLength;){var s=e.getUint16(a,!1);if(o.has(s))return{mimeType:"image/jpeg",height:e.getUint16(a+5,!1),width:e.getUint16(a+7,!1)};if(!r.has(s))return null;a+=2,a+=e.getUint16(a,!1)}return null}(e)||function(t){var e=i(t);if(!(e.byteLength>=10&&1195984440===e.getUint32(0,!1)))return null;return{mimeType:"image/gif",width:e.getUint16(6,!0),height:e.getUint16(8,!0)}}(e)||function(t){var e=i(t);if(!(e.byteLength>=14&&16973===e.getUint16(0,!1)&&e.getUint32(2,!0)===e.byteLength))return null;return{mimeType:"image/bmp",width:e.getUint32(18,!0),height:e.getUint32(22,!0)}}(e)}function i(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}},function(t,e,n){"use strict";function r(t){for(var e=t.data,n=t.getIndex,r=t.dataRange,i=t.replace,o=r.startRow,a=void 0===o?0:o,s=r.endRow,u=void 0===s?1/0:s,c=e.length,l=c,f=c,h=0;h<c;h++){var d=n(e[h]);if(l>h&&d>=a&&(l=h),d>=u){f=h;break}}for(var p=l,v=f-l!==i.length?e.slice(f):void 0,g=0;g<i.length;g++)e[p++]=i[g];if(v){for(var y=0;y<v.length;y++)e[p++]=v[y];e.length=p}return{startRow:l,endRow:l+i.length}}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";var r=n(0),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(12),l=n(210),f=n(67),h=n(17),d=n(197),p=n(348),v=n(85),g=n(49),y=n(9),m=n.n(y),b=n(10),A=n.n(b),_=n(5),O=n.n(_),w=n(7),x=n.n(w),C=n(2),P=n.n(C),S=n(57),B=null;function k(t,e){var n;return new t((n=t.BYTES_PER_ELEMENT*e,(!B||B.byteLength<n)&&(B=new ArrayBuffer(n)),B),0,e)}var E=n(342);function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=P()(t);if(e){var i=P()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return x()(this,n)}}var j="elements must be GL.ELEMENT_ARRAY_BUFFER",M=function(t,e){O()(r,t);var n=T(r);function r(t){var e;a()(this,r);var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.id||i.program&&i.program.id;return(e=n.call(this,t,Object.assign({},i,{id:o}))).buffer=null,e.bufferValue=null,e.isDefaultArray=i.isDefaultArray||!1,e.gl2=t,e.initialize(i),Object.seal(m()(e)),e}return u()(r,[{key:e,get:function(){return"VertexArrayObject"}},{key:"delete",value:function(){return A()(P()(r.prototype),"delete",this).call(this),this.buffer&&this.buffer.delete(),this}},{key:"MAX_ATTRIBUTES",get:function(){return r.getMaxAttributes(this.gl)}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.setProps(t)}},{key:"setProps",value:function(t){return this}},{key:"setElementBuffer",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(h.a)(!e||34963===e.target,j),this.bind((function(){t.gl.bindBuffer(34963,e?e.handle:null)})),this}},{key:"setBuffer",value:function(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);var r=n.size,i=n.type,o=n.stride,a=n.offset,s=n.normalized,u=n.integer,l=n.divisor,f=this.gl,d=this.gl2;return t=Number(t),this.bind((function(){f.bindBuffer(34962,e.handle),u?(Object(h.a)(Object(c.j)(f)),d.vertexAttribIPointer(t,r,i,o,a)):f.vertexAttribPointer(t,r,i,s,o,a),f.enableVertexAttribArray(t),d.vertexAttribDivisor(t,l||0)})),this}},{key:"enable",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!n&&0===t&&!r.isSupported(this.gl,{constantAttributeZero:!0});return i||(t=Number(t),this.bind((function(){return n?e.gl.enableVertexAttribArray(t):e.gl.disableVertexAttribArray(t)}))),this}},{key:"getConstantBuffer",value:function(t,e){var n=this._normalizeConstantArrayValue(e),r=n.byteLength*t,i=n.length*t,o=!this.buffer;if(this.buffer=this.buffer||new g.a(this.gl,r),o=(o=o||this.buffer.reallocate(r))||!this._compareConstantArrayValues(n,this.bufferValue)){var a=k(e.constructor,i);!function(t){for(var e=t.target,n=t.source,r=t.start,i=void 0===r?0:r,o=t.count,a=void 0===o?1:o,s=n.length,u=a*s,c=0,l=i;c<s;c++)e[l++]=n[c];for(;c<u;)c<u-c?(e.copyWithin(i+c,i,i+c),c*=2):(e.copyWithin(i+c,i,i+u-c),c=u)}({target:a,source:n,start:0,count:i}),this.buffer.subData(a),this.bufferValue=e}return this.buffer}},{key:"_normalizeConstantArrayValue",value:function(t){return Array.isArray(t)?new Float32Array(t):t}},{key:"_compareConstantArrayValues",value:function(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}},{key:"_createHandle",value:function(){return this.gl.createVertexArray()}},{key:"_deleteHandle",value:function(t){return this.gl2.deleteVertexArray(t),[this.elements]}},{key:"_bindHandle",value:function(t){this.gl2.bindVertexArray(t)}},{key:"_getParameter",value:function(t,e){var n=this,r=e.location;return Object(h.a)(Number.isFinite(r)),this.bind((function(){switch(t){case 34373:return n.gl.getVertexAttribOffset(r,t);default:return n.gl.getVertexAttrib(r,t)}}))}}],[{key:"isSupported",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return!e.constantAttributeZero||(Object(c.j)(t)||"Chrome"===Object(E.a)())}},{key:"getDefaultArray",value:function(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new r(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}},{key:"getMaxAttributes",value:function(t){return r.MAX_ATTRIBUTES=r.MAX_ATTRIBUTES||t.getParameter(34921),r.MAX_ATTRIBUTES}},{key:"setConstant",value:function(t,e,n){switch(n.constructor){case Float32Array:r._setConstantFloatArray(t,e,n);break;case Int32Array:r._setConstantIntArray(t,e,n);break;case Uint32Array:r._setConstantUintArray(t,e,n);break;default:Object(h.a)(!1)}}},{key:"_setConstantFloatArray",value:function(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:Object(h.a)(!1)}}},{key:"_setConstantIntArray",value:function(t,e,n){switch(Object(h.a)(Object(c.j)(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:Object(h.a)(!1)}}},{key:"_setConstantUintArray",value:function(t,e,n){switch(Object(h.a)(Object(c.j)(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:Object(h.a)(!1)}}}]),r}(S.a,Symbol.toStringTag),I=n(186),R=/^(.+)__LOCATION_([0-9]+)$/,D=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"],L=function(){function t(e){a()(this,t);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new M(e),Object(I.a)(this,"VertexArray","v6.0",D),this.initialize(n),Object.seal(this)}return u()(t,[{key:"delete",value:function(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}},{key:"reset",value:function(){this.elements=null,this.elementsAccessor=null;var t=this.vertexArrayObject.MAX_ATTRIBUTES;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}},{key:"setProps",value:function(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}},{key:"clearDrawParams",value:function(){this.drawParams=null}},{key:"getDrawParams",value:function(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}},{key:"setAttributes",value:function(t){var e=this;return Object.assign(this.attributes,t),this.vertexArrayObject.bind((function(){for(var n in t){var r=t[n];e._setAttribute(n,r)}e.gl.bindBuffer(34962,null)})),this}},{key:"setElementBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}},{key:"setBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===e.target)return this.setElementBuffer(e,n);var r=this._resolveLocationAndAccessor(t,e,e.accessor,n),i=r.location,o=r.accessor;return i>=0&&(this.values[i]=e,this.accessors[i]=o,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,e,o)),this}},{key:"setConstant",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n)),i=r.location,o=r.accessor;return i>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[i]=e,this.accessors[i]=o,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}},{key:"unbindBuffers",value:function(){var t=this;return this.vertexArrayObject.bind((function(){t.elements&&t.vertexArrayObject.setElementBuffer(null),t.buffer=t.buffer||new g.a(t.gl,{accessor:{size:4}});for(var e=0;e<t.vertexArrayObject.MAX_ATTRIBUTES;e++)t.values[e]instanceof g.a&&(t.gl.disableVertexAttribArray(e),t.gl.bindBuffer(34962,t.buffer.handle),t.gl.vertexAttribPointer(e,1,5126,!1,0,0))})),this}},{key:"bindBuffers",value:function(){var t=this;return this.vertexArrayObject.bind((function(){t.elements&&t.setElementBuffer(t.elements);for(var e=0;e<t.vertexArrayObject.MAX_ATTRIBUTES;e++){var n=t.values[e];n instanceof g.a&&t.setBuffer(e,n)}})),this}},{key:"bindForDraw",value:function(t,e,n){var r,i=this;return this.vertexArrayObject.bind((function(){i._setConstantAttributes(t,e),r=n()})),r}},{key:"_resolveLocationAndAccessor",value:function(t,e,n,r){var i=this,o={location:-1,accessor:null},a=this._getAttributeIndex(t),s=a.location,u=a.name;if(!Number.isFinite(s)||s<0)return this.unused[t]=e,c.k.once(3,(function(){return"unused value ".concat(t," in ").concat(i.id)}))(),o;var l=this._getAttributeInfo(u||s);if(!l)return o;var f=this.accessors[s]||{},d=v.a.resolve(l.accessor,f,n,r),p=d.size,g=d.type;return Object(h.a)(Number.isFinite(p)&&Number.isFinite(g)),{location:s,accessor:d}}},{key:"_getAttributeInfo",value:function(t){return this.configuration&&this.configuration.getAttributeInfo(t)}},{key:"_getAttributeIndex",value:function(t){var e=Number(t);if(Number.isFinite(e))return{location:e};var n=R.exec(t),r=n?n[1]:t,i=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+i,name:r}:{location:-1}}},{key:"_setAttribute",value:function(t,e){if(e instanceof g.a)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof g.a){var n=e[0],r=e[1];this.setBuffer(t,n,r)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){var i=e;this.setConstant(t,i)}else{if(!(e.buffer instanceof g.a))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");var o=e;this.setBuffer(t,o.buffer,o)}}},{key:"_setConstantAttributes",value:function(t,e){var n=Math.max(0|t,0|e),r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(var i=1;i<this.vertexArrayObject.MAX_ATTRIBUTES;i++)r=this.values[i],ArrayBuffer.isView(r)&&this._setConstantAttribute(i,r)}},{key:"_setConstantAttributeZero",value:function(t,e){if(M.isSupported(this.gl,{constantAttributeZero:!0}))this._setConstantAttribute(0,t);else{var n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}}},{key:"_setConstantAttribute",value:function(t,e){M.setConstant(this.gl,t,e)}},{key:"_updateDrawParams",value:function(){for(var t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0},e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}},{key:"_updateDrawParamsForLocation",value:function(t,e){var n=this.values[e],r=this.accessors[e];if(n){var i=r.divisor>0;if(t.isInstanced=t.isInstanced||i,n instanceof g.a){var o=n;if(i){var a=o.getVertexCount(r);t.instanceCount=Math.min(t.instanceCount,a)}else{var s=o.getVertexCount(r);t.vertexCount=Math.min(t.vertexCount,s)}}}}},{key:"setElements",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c.k.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}]),t}(),F=n(343),G=n(69),N=n(103);function U(t,e){for(var n=e.maxElts,r=void 0===n?16:n,i=e.size,o=void 0===i?1:i,a="[",s=0;s<t.length&&s<r;++s)s>0&&(a+=",".concat(s%o==0?" ":"")),a+=z(t[s],e);var u=t.length>r?"...":"]";return"".concat(a).concat(u)}function z(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=1e-16,r=e.isInteger,i=void 0!==r&&r;if(Array.isArray(t)||ArrayBuffer.isView(t))return U(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return i?"0":"0.";if(i)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);var o=t.toPrecision(2),a=o.indexOf(".0");return a===o.length-2?o.slice(0,-1):o}function H(t,e,n,r){var o,a,s=t.gl;if(!e)return a={},i()(a,r,"null"),i()(a,"Format ","N/A"),a;var u,c,l,f="NOT PROVIDED",h=1,d=0,p=0;if(n&&(f=n.type,h=n.size,u=-1!==(f=String(f).replace("Array","")).indexOf("nt")),e instanceof g.a){var v,y,m=e,b=m.getDebugData(),A=b.data;if(c=b.changed?"*":"",l=A,d=(p=m.byteLength)/A.BYTES_PER_ELEMENT/h,n){var _=n.divisor>0;y="".concat(_?"I ":"P "," ").concat(d," (x").concat(h,"=").concat(p," bytes ").concat(Object(G.a)(s,f),")")}else u=!0,y="".concat(p," bytes");return v={},i()(v,r,"".concat(c).concat(z(l,{size:h,isInteger:u}))),i()(v,"Format ",y),v}return l=e,h=e.length,u=-1!==(f=String(e.constructor.name).replace("Array","")).indexOf("nt"),o={},i()(o,r,"".concat(z(l,{size:h,isInteger:u})," (constant)")),i()(o,"Format ","".concat(h,"x").concat(f," (constant)")),o}function V(t,e){var n=e.type,r=e.size,i=Object(N.b)(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function J(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return W(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return W(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function K(t){var e=t.header,n=void 0===e?"Uniforms":e,r=t.program,o=t.uniforms,a=t.undefinedOnly,s=void 0!==a&&a;Object(h.a)(r);var u,c=r._uniformSetters,l={},f=Object.keys(c).sort(),d=0,p=J(f);try{for(p.s();!(u=p.n()).done;){var v=u.value;v.match(".*_.*")||v.match(".*Matrix")||X({table:l,header:n,uniforms:o,uniformName:v,undefinedOnly:s})&&d++}}catch(t){p.e(t)}finally{p.f()}var g,y=J(f);try{for(y.s();!(g=y.n()).done;){var m=g.value;m.match(".*Matrix")&&X({table:l,header:n,uniforms:o,uniformName:m,undefinedOnly:s})&&d++}}catch(t){y.e(t)}finally{y.f()}var b,A=J(f);try{for(A.s();!(b=A.n()).done;){var _=b.value;l[_]||X({table:l,header:n,uniforms:o,uniformName:_,undefinedOnly:s})&&d++}}catch(t){A.e(t)}finally{A.f()}var O=0,w={};if(!s)for(var x in o){var C=o[x];l[x]||(O++,w[x]=i()({Type:"NOT USED: ".concat(C)},n,z(C)))}return{table:l,count:d,unusedTable:w,unusedCount:O}}function X(t){var e,n=t.table,r=t.header,o=t.uniforms,a=t.uniformName,s=t.undefinedOnly,u=o[a],c=function(t){return null!=t}(u);return(!s||!c)&&(n[a]=(e={},i()(e,r,c?z(u):"N/A"),i()(e,"Uniform Type",c?u:"NOT PROVIDED"),e),!0)}function q(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Z(t){var e=t.accessor,n=e.type,r=e.size,i=Object(N.b)(n,r);return i?"".concat(i.name," ").concat(t.name):t.name}function Y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var tt={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function et(t,e){var n=(e||{}).attributeMap,r=void 0===n?tt:n;return r&&r[t]||t}function nt(t,e){var n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}Object(h.a)(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}n.d(e,"a",(function(){return ot}));var rt=function(){},it={},ot=function(){function t(e){a()(this,t);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.id,i=void 0===r?Object(f.c)("model"):r;Object(h.a)(Object(c.i)(e)),this.id=i,this.gl=e,this.id=n.id||Object(f.c)("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}return u()(t,[{key:"initialize",value:function(t){this.props={},this.programManager=t.programManager||l.a.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;var e=t.program,n=void 0===e?null:e,r=t.vs,i=t.fs,o=t.modules,a=t.defines,s=t.inject,u=t.varyings,c=t.bufferMode,f=t.transpileToGLSL100;this.programProps={program:n,vs:r,fs:i,modules:o,defines:a,inject:s,varyings:u,bufferMode:c,transpileToGLSL100:f},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},Object(h.a)(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}},{key:"setProps",value:function(t){this._setModelProps(t)}},{key:"delete",value:function(){for(var t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}},{key:"getDrawMode",value:function(){return this.drawMode}},{key:"getVertexCount",value:function(){return this.vertexCount}},{key:"getInstanceCount",value:function(){return this.instanceCount}},{key:"getAttributes",value:function(){return this.attributes}},{key:"getProgram",value:function(){return this.program}},{key:"setProgram",value:function(t){var e=t.program,n=t.vs,r=t.fs,i=t.modules,o=t.defines,a=t.inject,s=t.varyings,u=t.bufferMode,c=t.transpileToGLSL100;this.programProps={program:e,vs:n,fs:r,modules:i,defines:o,inject:a,varyings:s,bufferMode:u,transpileToGLSL100:c},this._programDirty=!0}},{key:"getUniforms",value:function(){return this.uniforms}},{key:"setDrawMode",value:function(t){return this.drawMode=t,this}},{key:"setVertexCount",value:function(t){return Object(h.a)(Number.isFinite(t)),this.vertexCount=t,this}},{key:"setInstanceCount",value:function(t){return Object(h.a)(Number.isFinite(t)),this.instanceCount=t,this}},{key:"setGeometry",value:function(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(t,e,n){var r={},i=e.indices;for(var o in e.attributes){var a=e.attributes[o],s=et(o,n);if("indices"===o)i=a;else if(a.constant)r[s]=a.value;else{var u=a.value,c=$({},a);delete c.value,r[s]=[new g.a(t,u),c],nt(o,c)}}if(i){var l=i.value||i;Object(h.a)(l instanceof Uint16Array||l instanceof Uint32Array,'attribute array for "indices" must be of integer type');var f={size:1,isIndexed:void 0===i.isIndexed||i.isIndexed};r.indices=[new g.a(t,{data:l,target:34963}),f]}return r}(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}},{key:"setAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(f.a)(t))return this;var e={};for(var n in t){var r=t[n];e[n]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(e),this}},{key:"setUniforms",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.uniforms,t),this}},{key:"getModuleUniforms",value:function(t){this._checkProgram();var e=this.programManager.getUniforms(this.program);return e?e(t):{}}},{key:"updateModuleSettings",value:function(t){var e=this.getModuleUniforms(t||{});return this.setUniforms(e)}},{key:"clear",value:function(t){return Object(d.a)(this.program.gl,t),this}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();var e,n=t.moduleSettings,r=void 0===n?null:n,i=t.framebuffer,o=t.uniforms,a=void 0===o?{}:o,s=t.attributes,u=void 0===s?{}:s,l=t.transformFeedback,f=void 0===l?this.transformFeedback:l,h=t.parameters,d=void 0===h?{}:h,p=t.vertexArray,v=void 0===p?this.vertexArray:p;this.setAttributes(u),this.updateModuleSettings(r),this.setUniforms(a),c.k.priority>=2&&(e=this._logDrawCallStart(2));var g=this.vertexArray.getDrawParams(),y=this.props,m=y.isIndexed,b=void 0===m?g.isIndexed:m,A=y.indexType,_=void 0===A?g.indexType:A,O=y.indexOffset,w=void 0===O?g.indexOffset:O,x=y.vertexArrayInstanced,C=void 0===x?g.isInstanced:x;C&&!this.isInstanced&&c.k.warn("Found instanced attributes on non-instanced model",this.id)();var P=this.isInstanced,S=this.instanceCount,B=this.props,k=B.onBeforeRender,E=void 0===k?rt:k,T=B.onAfterRender,j=void 0===T?rt:T;E(),this.program.setUniforms(this.uniforms);var M=this.program.draw(Object.assign(it,t,{logPriority:e,uniforms:null,framebuffer:i,parameters:d,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:v,transformFeedback:f,isIndexed:b,indexType:_,isInstanced:P,instanceCount:S,offset:b?w:0}));return j(),c.k.priority>=2&&this._logDrawCallEnd(e,v,i),M}},{key:"transform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.discard,n=void 0===e||e,r=t.feedbackBuffers,o=t.unbindModels,a=void 0===o?[]:o,s=t.parameters;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,i()({},35977,n))),a.forEach((function(t){return t.vertexArray.unbindBuffers()}));try{this.draw(Object.assign({},t,{parameters:s}))}finally{a.forEach((function(t){return t.vertexArray.bindBuffers()}))}return this}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c.k.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}},{key:"_setModelProps",value:function(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}},{key:"_checkProgram",value:function(){if(this._programDirty||this.programManager.stateHash!==this._programManagerState){var t=this.programProps.program;if(t)this._managedProgram=!1;else{var e=this.programProps,n=e.vs,r=e.fs,i=e.modules,o=e.inject,a=e.defines,s=e.varyings,u=e.bufferMode,c=e.transpileToGLSL100;t=this.programManager.get({vs:n,fs:r,modules:i,inject:o,defines:a,varyings:s,bufferMode:u,transpileToGLSL100:c}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Object(h.a)(t instanceof p.a,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new L(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}}},{key:"_deleteGeometryBuffers",value:function(){for(var t in this.geometryBuffers){var e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof g.a&&e.delete()}}},{key:"_setAnimationProps",value:function(t){this.animated&&Object(h.a)(t,"Model.draw(): animated uniforms but no animationProps")}},{key:"_setFeedbackBuffers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Object(f.a)(t))return this;var e=this.program.gl;return this.transformFeedback=this.transformFeedback||new F.a(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}},{key:"_logDrawCallStart",value:function(t){var e=t>3?0:1e4;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),c.k.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:c.k.level<=2})(),t}},{key:"_logDrawCallEnd",value:function(t,e,n,r){if(void 0!==t){var o=function(t){var e=t.vertexArray,n=t.header,r=void 0===n?"Attributes":n;if(!e.configuration)return{};var i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=H(e,e.elements,null,r));var o=e.values;for(var a in o){var s=e._getAttributeInfo(a);if(s){var u="".concat(a,": ").concat(s.name),c=e.accessors[s.location];c&&(u="".concat(a,": ").concat(V(s.name,c))),i[u]=H(e,o[a],c,r)}}return i}({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),a=K({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),s=a.table,u=a.unusedTable,l=a.unusedCount,f=K({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0}),h=f.table;f.count>0&&c.k.log("MISSING UNIFORMS",Object.keys(h))(),l>0&&c.k.log("UNUSED UNIFORMS",Object.keys(u))();var d=function(t){var e,n={},r="Accessors for ".concat(t.id),o=q(t.attributeInfos);try{for(o.s();!(e=o.n()).done;){var a=e.value;if(a){var s=Z(a);n["in ".concat(s)]=i()({},r,JSON.stringify(a.accessor))}}}catch(t){o.e(t)}finally{o.f()}var u,c=q(t.varyingInfos);try{for(c.s();!(u=c.n()).done;){var l=u.value;if(l){var f=Z(l);n["out ".concat(f)]=i()({},r,JSON.stringify(l.accessor))}}}catch(t){c.e(t)}finally{c.f()}return n}(this.vertexArray.configuration);c.k.table(t,o)(),c.k.table(t,s)(),c.k.table(t+1,d)(),r&&r.log({logLevel:2,message:"Rendered to ".concat(r.id)}),c.k.groupEnd(2)()}}}]),t}()},function(t,e,n){"use strict";var r=n(11),i=n.n(r),o=n(16),a=n.n(o),s=n(6);function u(){var t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){var e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}var c=function(){function t(e,n){i()(this,t),Object(s.a)(this,"name",void 0),Object(s.a)(this,"type",void 0),Object(s.a)(this,"sampleSize",1),Object(s.a)(this,"time",void 0),Object(s.a)(this,"count",void 0),Object(s.a)(this,"samples",void 0),Object(s.a)(this,"lastTiming",void 0),Object(s.a)(this,"lastSampleTime",void 0),Object(s.a)(this,"lastSampleCount",void 0),Object(s.a)(this,"_count",0),Object(s.a)(this,"_time",0),Object(s.a)(this,"_samples",0),Object(s.a)(this,"_startTime",0),Object(s.a)(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}return a()(t,[{key:"setSampleSize",value:function(t){return this.sampleSize=t,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(t){return this._count+=t,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(t){return this._count-=t,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=u(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(u()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),t}(),l=function(){function t(e){i()(this,t),Object(s.a)(this,"id",void 0),Object(s.a)(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}return a()(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}},{key:"size",get:function(){return Object.keys(this.stats).length}},{key:"reset",value:function(){for(var t in this.stats)this.stats[t].reset();return this}},{key:"forEach",value:function(t){for(var e in this.stats)t(this.stats[e])}},{key:"getTable",value:function(){var t={};return this.forEach((function(e){t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}},{key:"_initializeStats",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){return t._getOrCreate(e)}))}},{key:"_getOrCreate",value:function(t){if(!t||!t.name)return null;var e=t.name,n=t.type;return this.stats[e]||(this.stats[e]=t instanceof c?t:new c(e,n)),this.stats[e]}}]),t}();n.d(e,"a",(function(){return l}))},function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u}));var r=n(15),i=n.n(r),o=n(12),a=n(17);function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.framebuffer,r=void 0===n?null:n,i=e.color,s=void 0===i?null:i,u=e.depth,c=void 0===u?null:u,l=e.stencil,f=void 0===l?null:l,h={};r&&(h.framebuffer=r);var d=0;s&&(d|=16384,!0!==s&&(h.clearColor=s)),c&&(d|=256,!0!==c&&(h.clearDepth=c)),f&&(d|=1024,!0!==c&&(h.clearStencil=c)),Object(a.a)(0!==d,"clear: bad arguments"),Object(o.o)(t,h,(function(){t.clear(d)}))}function u(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.framebuffer,r=void 0===n?null:n,s=e.buffer,u=void 0===s?6144:s,c=e.drawBuffer,l=void 0===c?0:c,f=e.value,h=void 0===f?[0,0,0,0]:f;Object(o.a)(t),Object(o.o)(t,{framebuffer:r},(function(){switch(u){case 6144:switch(h.constructor){case Int32Array:t.clearBufferiv(u,l,h);break;case Uint32Array:t.clearBufferuiv(u,l,h);break;case Float32Array:default:t.clearBufferfv(u,l,h)}break;case 6145:t.clearBufferfv(6145,0,[h]);break;case 6146:t.clearBufferiv(6146,0,[h]);break;case 34041:var e=i()(h,2),n=e[0],r=e[1];t.clearBufferfi(34041,0,n,r);break;default:Object(a.a)(!1,"clear: bad arguments")}}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r,i=n(0),o=n.n(i),a=n(95),s=n(123),u={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};e.b=(r={},o()(r,u.WEBGL2,[!1,!0]),o()(r,u.VERTEX_ARRAY_OBJECT,["OES_vertex_array_object",!0]),o()(r,u.TIMER_QUERY,["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"]),o()(r,u.INSTANCED_RENDERING,["ANGLE_instanced_arrays",!0]),o()(r,u.MULTIPLE_RENDER_TARGETS,["WEBGL_draw_buffers",!0]),o()(r,u.ELEMENT_INDEX_UINT32,["OES_element_index_uint",!0]),o()(r,u.BLEND_EQUATION_MINMAX,["EXT_blend_minmax",!0]),o()(r,u.FLOAT_BLEND,["EXT_float_blend"]),o()(r,u.COLOR_ENCODING_SRGB,["EXT_sRGB",!0]),o()(r,u.TEXTURE_DEPTH,["WEBGL_depth_texture",!0]),o()(r,u.TEXTURE_FLOAT,["OES_texture_float",!0]),o()(r,u.TEXTURE_HALF_FLOAT,["OES_texture_half_float",!0]),o()(r,u.TEXTURE_FILTER_LINEAR_FLOAT,["OES_texture_float_linear"]),o()(r,u.TEXTURE_FILTER_LINEAR_HALF_FLOAT,["OES_texture_half_float_linear"]),o()(r,u.TEXTURE_FILTER_ANISOTROPIC,["EXT_texture_filter_anisotropic"]),o()(r,u.COLOR_ATTACHMENT_RGBA32F,[function(t){var e=new s.a(t,{format:6408,type:5126,dataFormat:6408}),n=new a.a(t,{id:"test-framebuffer",check:!1,attachments:o()({},36064,e)}),r=n.getStatus();return e.delete(),n.delete(),36053===r},"EXT_color_buffer_float"]),o()(r,u.COLOR_ATTACHMENT_FLOAT,[!1,"EXT_color_buffer_float"]),o()(r,u.COLOR_ATTACHMENT_HALF_FLOAT,["EXT_color_buffer_half_float"]),o()(r,u.GLSL_FRAG_DATA,["WEBGL_draw_buffers",!0]),o()(r,u.GLSL_FRAG_DEPTH,["EXT_frag_depth",!0]),o()(r,u.GLSL_DERIVATIVES,["OES_standard_derivatives",!0]),o()(r,u.GLSL_TEXTURE_LOD,["EXT_shader_texture_lod",!0]),r)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(74);function i(t){var e="3.3.0-alpha.5"!==t.version?" (worker-utils@".concat("3.3.0-alpha.5",")"):"";return"".concat(t.name,"@").concat(t.version).concat(e)}function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e[t.id]||{},i="".concat(t.id,"-worker.js"),o=n.workerUrl;if(o||"compression"!==t.id||(o=e.workerUrl),"test"===e._workerType&&(o="modules/".concat(t.module,"/dist/").concat(i)),!o){var a=t.version;"latest"===a&&(a="beta");var s=a?"@".concat(a):"";o="https://unpkg.com/@loaders.gl/".concat(t.module).concat(s,"/dist/").concat(i)}return Object(r.a)(o),o}},function(t,e,n){"use strict";var r,i=n(0),o=n.n(i),a=n(97),s=n(196);n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return d})),n.d(e,"b",(function(){return p}));var u=(r={},o()(r,a.b,"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n"),o()(r,a.a,"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"),r),c="__LUMA_INJECT_DECLARATIONS__",l=/void\s+main\s*\([^)]*\)\s*\{\n?/,f=/}\n?[^{}]*$/,h=[];function d(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e===a.b,o=function(e){var r=n[e];r.sort((function(t,e){return t.order-e.order})),h.length=r.length;for(var o=0,a=r.length;o<a;++o)h[o]=r[o].injection;var s="".concat(h.join("\n"),"\n");switch(e){case"vs:#decl":i&&(t=t.replace(c,s));break;case"vs:#main-start":i&&(t=t.replace(l,(function(t){return t+s})));break;case"vs:#main-end":i&&(t=t.replace(f,(function(t){return s+t})));break;case"fs:#decl":i||(t=t.replace(c,s));break;case"fs:#main-start":i||(t=t.replace(l,(function(t){return t+s})));break;case"fs:#main-end":i||(t=t.replace(f,(function(t){return s+t})));break;default:t=t.replace(e,(function(t){return t+s}))}};for(var s in n)o(s);return t=t.replace(c,""),r&&(t=t.replace(/\}\s*$/,(function(t){return t+u[e]}))),t}function p(t){var e={};return Object(s.a)(Array.isArray(t)&&t.length>1),t.forEach((function(t){for(var n in t)e[n]=e[n]?"".concat(e[n],"\n").concat(t[n]):t[n]})),e}},,function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return f}));var r=n(8),i=n.n(r),o=n(4),a=n.n(o),s=n(70),u=n(147),c=n(199);function l(t,e){return!!u.a.isSupported()&&(!!(s.b||null!=e&&e._nodeWorkers)&&(t.worker&&(null==e?void 0:e.worker)))}function f(t,e,n,r,i){return h.apply(this,arguments)}function h(){return(h=i()(a.a.mark((function t(e,n,r,i,o){var s,l,f,h,p,v;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.id,l=Object(c.b)(e,r),f=u.a.getWorkerFarm(r),h=f.getWorkerPool({name:s,url:l}),r=JSON.parse(JSON.stringify(r)),i=JSON.parse(JSON.stringify(i||{})),t.next=8,h.startJob("process-on-worker",d.bind(null,o));case 8:return(p=t.sent).postMessage("process",{input:n,options:r,context:i}),t.next=12,p.result;case 12:return v=t.sent,t.next=15,v.result;case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function d(t,e,n,r){return p.apply(this,arguments)}function p(){return(p=i()(a.a.mark((function t(e,n,r,i){var o,s,u,c,l;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r,t.next="done"===t.t0?3:"error"===t.t0?5:"process"===t.t0?7:20;break;case 3:return n.done(i),t.abrupt("break",21);case 5:return n.error(new Error(i.error)),t.abrupt("break",21);case 7:return o=i.id,s=i.input,u=i.options,t.prev=8,t.next=11,e(s,u);case 11:c=t.sent,n.postMessage("done",{id:o,result:c}),t.next=19;break;case 15:t.prev=15,t.t1=t.catch(8),l=t.t1 instanceof Error?t.t1.message:"unknown error",n.postMessage("error",{id:o,error:l});case 19:return t.abrupt("break",21);case 20:console.warn("parse-with-worker unknown message ".concat(r));case 21:case"end":return t.stop()}}),t,null,[[8,15]])})))).apply(this,arguments)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return C}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(10),u=n.n(s),c=n(5),l=n.n(c),f=n(7),h=n.n(f),d=n(2),p=n.n(d),v=n(0),g=n.n(v),y=n(176),m=n(47),b=n(89);function A(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){g()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var C=function(t){l()(n,t);var e=x(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"isComposite",get:function(){return!0}},{key:"isLoaded",get:function(){return u()(p()(n.prototype),"isLoaded",this)&&this.getSubLayers().every((function(t){return t.isLoaded}))}},{key:"getSubLayers",value:function(){return this.internalState&&this.internalState.subLayers||[]}},{key:"initializeState",value:function(t){}},{key:"setState",value:function(t){u()(p()(n.prototype),"setState",this).call(this,t),this.setNeedsUpdate()}},{key:"getPickingInfo",value:function(t){var e=t.info,n=e.object;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id?(e.object=n.__source.object,e.index=n.__source.index,e):e}},{key:"filterSubLayer",value:function(t){return!0}},{key:"shouldRenderSubLayer",value:function(t,e){return e&&e.length}},{key:"getSubLayerClass",value:function(t,e){var n=this.props._subLayerProps;return n&&n[t]&&n[t].type||e}},{key:"getSubLayerRow",value:function(t,e,n){return t.__source={parent:this,object:e,index:n},t}},{key:"getSubLayerAccessor",value:function(t){if("function"==typeof t){var e={index:-1,data:this.props.data,target:[]};return function(n,r){return n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,r)}}return t}},{key:"getSubLayerProps",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.props,r=n.opacity,i=n.pickable,o=n.visible,a=n.parameters,s=n.getPolygonOffset,u=n.highlightedObjectIndex,c=n.autoHighlight,l=n.highlightColor,f=n.coordinateSystem,h=n.coordinateOrigin,d=n.wrapLongitude,p=n.positionFormat,v=n.modelMatrix,g=n.extensions,y=n.fetch,m=n.operation,b=n._subLayerProps,_={id:"",updateTriggers:{},opacity:r,pickable:i,visible:o,parameters:a,getPolygonOffset:s,highlightedObjectIndex:u,autoHighlight:c,highlightColor:l,coordinateSystem:f,coordinateOrigin:h,wrapLongitude:d,positionFormat:p,modelMatrix:v,extensions:g,fetch:y,operation:m},O=b&&e.id&&b[e.id],x=O&&O.updateTriggers,C=e.id||"sublayer";if(O){var P=this.constructor._propTypes,S=e.type?e.type._propTypes:{};for(var B in O){var k=S[B]||P[B];k&&"accessor"===k.type&&(O[B]=this.getSubLayerAccessor(O[B]))}}Object.assign(_,e,O),_.id="".concat(this.props.id,"-").concat(C),_.updateTriggers=w(w({all:null===(t=this.props.updateTriggers)||void 0===t?void 0:t.all},e.updateTriggers),x);var E,T=A(g);try{for(T.s();!(E=T.n()).done;){var j=E.value,M=j.getSubLayerProps.call(this,j);M&&Object.assign(_,M,{updateTriggers:Object.assign(_.updateTriggers,M.updateTriggers)})}}catch(t){T.e(t)}finally{T.f()}return _}},{key:"_updateAutoHighlight",value:function(t){var e,n=A(this.getSubLayers());try{for(n.s();!(e=n.n()).done;){e.value.updateAutoHighlight(t)}}catch(t){n.e(t)}finally{n.f()}}},{key:"_getAttributeManager",value:function(){return null}},{key:"_postUpdate",value:function(t,e){var n=this.internalState.subLayers,r=!n||this.needsUpdate();if(r){var i=this.renderLayers();n=Object(b.b)(i,Boolean),this.internalState.subLayers=n}Object(m.a)("compositeLayer.renderLayers",this,r,n);var o,a=A(n);try{for(a.s();!(o=a.n()).done;){o.value.parent=this}}catch(t){a.e(t)}finally{a.f()}}}]),n}(y.a);g()(C,"layerName","CompositeLayer")},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=n(83),l=function(){function t(e){i()(this,t),u()(this,"opts",void 0),e&&(this.opts=e)}return a()(t,[{key:"equals",value:function(t){return this===t||this.constructor===t.constructor&&Object(c.a)(this.opts,t.opts)}},{key:"getShaders",value:function(t){return null}},{key:"getSubLayerProps",value:function(t){var e=t.constructor.defaultProps,n={updateTriggers:{}};for(var r in e)if(r in this.props){var i=e[r],o=this.props[r];n[r]=o,i&&"accessor"===i.type&&(n.updateTriggers[r]=this.props.updateTriggers[r],"function"==typeof o&&(n[r]=this.getSubLayerAccessor(o)))}return n}},{key:"initializeState",value:function(t,e){}},{key:"updateState",value:function(t,e){}},{key:"draw",value:function(t,e){}},{key:"finalizeState",value:function(t,e){}}]),t}();u()(l,"defaultProps",{})},function(t,e,n){"use strict";var r=n(0),i=n.n(r),o=n(127),a=n(347),s=n(31),u=n(47);var c={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){var e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse};function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h=globalThis.deck&&globalThis.deck.VERSION;if(h&&"8.8.20"!==h)throw new Error("deck.gl - multiple versions detected: ".concat(h," vs ").concat("8.8.20"));h||(s.a.log(1,"deck.gl ".concat("8.8.20"))(),globalThis.deck=f(f({},globalThis.deck),{},{VERSION:"8.8.20",version:"8.8.20",log:s.a,_registerLoggers:u.b}),Object(o.c)([c,[a.a,{imagebitmap:{premultiplyAlpha:"none"}}]]));e.a=globalThis.deck},function(t,e){},function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"loader assertion failed.")}n.d(e,"a",(function(){return r}))},function(t,e){},function(t,e,n){"use strict";t.exports=i;var r=n(320);function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function a(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function s(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function u(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function c(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function l(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function h(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function v(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function g(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function y(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function m(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function b(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function A(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=m(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=A(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=m(this.buf,this.pos)+4294967296*m(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=m(this.buf,this.pos)+4294967296*A(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(i=o[n.pos++],r=(112&i)>>4,i<128)return s(t,r,e);if(i=o[n.pos++],r|=(127&i)<<3,i<128)return s(t,r,e);if(i=o[n.pos++],r|=(127&i)<<10,i<128)return s(t,r,e);if(i=o[n.pos++],r|=(127&i)<<17,i<128)return s(t,r,e);if(i=o[n.pos++],r|=(127&i)<<24,i<128)return s(t,r,e);if(i=o[n.pos++],r|=(1&i)<<31,i<128)return s(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&o?function(t,e,n){return o.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){var r="",i=e;for(;i<n;){var o,a,s,u=t[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>n)break;1===l?u<128&&(c=u):2===l?128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),i+=l}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==i.Bytes)return t.push(this.readVarint(e));var n=a(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==i.Bytes)return t.push(this.readSVarint());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==i.Bytes)return t.push(this.readBoolean());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==i.Bytes)return t.push(this.readFloat());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==i.Bytes)return t.push(this.readDouble());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed32());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed32());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed64());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed64());var e=a(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),b(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),b(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),b(this.buf,-1&t,this.pos),b(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),b(this.buf,-1&t,this.pos),b(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;if(e.buf[e.pos++]|=n|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&u(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),r.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),r.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&u(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,i.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,c,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,l,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,v,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,y,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(15),u=n.n(s),c=n(0),l=n.n(c),f=n(97),h=n(211),d=n(196);function p(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function g(t){return y(function t(e,n){return e.map((function(e){return e instanceof h.a?e:(Object(d.a)("string"!=typeof e,"Shader module use by name is deprecated. Import shader module '".concat(e,"' and use it directly.")),Object(d.a)(e.name,"shader module has no name"),(e=new h.a(e)).dependencies=t(e.dependencies),e)}))}(t))}function y(t){var e={},n={};return m({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((function(t,e){return n[e]-n[t]})).map((function(t){return e[t]}))}function m(t){var e=t.modules,n=t.level,r=t.moduleMap,i=t.moduleDepth;if(n>=5)throw new Error("Possible loop in shader dependency graph");var o,a=p(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;r[s.name]=s,(void 0===i[s.name]||i[s.name]<n)&&(i[s.name]=n)}}catch(t){a.e(t)}finally{a.f()}var u,c=p(e);try{for(c.s();!(u=c.n()).done;){var l=u.value;l.dependencies&&m({modules:l.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}}catch(t){c.e(t)}finally{c.f()}}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e="undefined"!=typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}var A={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},_={};Object.keys(A).forEach((function(t){_[t]=t}));var O={};function w(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=A[e];if(Object(d.a)(r,e),!b(n))return!0;if(e in O)return O[e];var i=r[0],o=n.behavior||"enable",a="#extension GL_".concat(i," : ").concat(o,"\nvoid main(void) {}"),s=t.createShader(35633);t.shaderSource(s,a),t.compileShader(s);var u=t.getShaderParameter(s,35713);return t.deleteShader(s),O[e]=u,u}function x(t,e){var n=A[e];Object(d.a)(n,e);var r=function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}(t)&&n[1]||n[0],i="string"==typeof r?Boolean(t.getExtension(r)):r;return Object(d.a)(!1===i||!0===i),i}function C(t,e){return(e=Array.isArray(e)?e:[e]).every((function(e){return x(t,e)}))}var P=n(200);function S(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return B(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}var E,T=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],j=[].concat(T,[[k("attribute"),"in $1"],[k("varying"),"out $1"]]),M=[].concat(T,[[k("varying"),"in $1"]]),I=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],R=[].concat(I,[[k("in"),"attribute $1"],[k("out"),"varying $1"]]),D=[].concat(I,[[k("in"),"varying $1"]]),L=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,F=/void\s+main\s*\([^)]*\)\s*\{\n?/;function G(t,e,n){switch(e){case 300:return n?N(t,j):function(t){var e=(t=N(t,M)).match(L);if(e){var n=e[1];t=t.replace(new RegExp("\\b".concat("gl_FragColor","\\b"),"g"),n)}else{t=t.replace(F,(function(t){return"out vec4 ".concat("fragmentColor",";\n").concat(t)})).replace(new RegExp("\\b".concat("gl_FragColor","\\b"),"g"),"fragmentColor")}return t}(t);case 100:return n?N(t,R):function(t){var e=(t=N(t,D)).match(L);if(e){var n=e[1];t=t.replace(L,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),"gl_FragColor")}return t}(t);default:throw new Error("unknown GLSL version ".concat(e))}}function N(t,e){var n,r=S(e);try{for(r.s();!(n=r.n()).done;){var i=u()(n.value,2),o=i[0],a=i[1];t=t.replace(o,a)}}catch(t){r.e(t)}finally{r.f()}return t}function U(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return z(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var H="\n\n".concat(P.a,"\n\n"),V=(E={},l()(E,f.b,"vertex"),l()(E,f.a,"fragment"),E);function J(t,e){var n=e.vs,r=e.fs,i=g(e.modules||[]);return{gl:t,vs:W(t,Object.assign({},e,{source:n,type:f.b,modules:i})),fs:W(t,Object.assign({},e,{source:r,type:f.a,modules:i})),getUniforms:K(i)}}function W(t,e){var n=e.id,r=e.source,i=e.type,o=e.modules,a=e.defines,s=void 0===a?{}:a,c=e.hookFunctions,l=void 0===c?[]:c,h=e.inject,p=void 0===h?{}:h,v=e.transpileToGLSL100,g=void 0!==v&&v,y=e.prologue,m=void 0===y||y,b=e.log;Object(d.a)("string"==typeof r,"shader source must be a string");var A=i===f.b,O=r.split("\n"),x=100,S="",B=r;0===O[0].indexOf("#version ")?(x=300,S=O[0],B=O.slice(1).join("\n")):S="#version ".concat(x);var k={};o.forEach((function(t){Object.assign(k,t.getDefines())})),Object.assign(k,s);var E=m?"".concat(S,"\n").concat(function(t){var e=t.id,n=t.source,r=t.type;return e&&"string"==typeof e&&-1===n.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat(V[r],"\n\n"):""}({id:n,source:r,type:i}),"\n").concat(function(t){var e=t.type;return"\n#define SHADER_TYPE_".concat(V[e].toUpperCase(),"\n")}({type:i}),"\n").concat(function(t){switch(function(t){var e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:function(t,e){if(t.match(/NVIDIA/i)||e.match(/NVIDIA/i))return"NVIDIA";if(t.match(/INTEL/i)||e.match(/INTEL/i))return"INTEL";if(t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i))return"AMD";return"UNKNOWN GPU"}(n,r),vendor:n,renderer:r,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(t),"\n").concat(function(t,e,n){var r="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return C(t,_.GLSL_FRAG_DEPTH)&&(r+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),C(t,_.GLSL_DERIVATIVES)&&w(t,_.GLSL_DERIVATIVES)&&(r+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),C(t,_.GLSL_FRAG_DATA)&&w(t,_.GLSL_FRAG_DATA,{behavior:"require"})&&(r+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),C(t,_.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),r}(t),"\n").concat(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,n="";for(var r in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;var i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],"\n"))}0===e&&(n+="\n");return n}(k),"\n").concat(A?"":"precision highp float;\n\n","\n"):"".concat(S,"\n"),T=function(t){var e={vs:{},fs:{}};return t.forEach((function(t){var n;"string"!=typeof t?t=(n=t).hook:n={};var r=(t=t.trim()).split(":"),i=u()(r,2),o=i[0],a=i[1],s=t.replace(/\(.+/,"");e[o][s]=Object.assign(n,{signature:a})})),e}(l),j={},M={},I={};for(var R in p){var D="string"==typeof p[R]?{injection:p[R],order:0}:p[R],L=R.match(/^(v|f)s:(#)?([\w-]+)$/);if(L){var F=L[2],N=L[3];F?"decl"===N?M[R]=[D]:I[R]=[D]:j[R]=[D]}else I[R]=[D]}var z,J=U(o);try{for(J.s();!(z=J.n()).done;){var W=z.value;b&&W.checkDeprecations(B,b),E+=W.getModuleSource(i,x);var K=W.injections[i];for(var X in K){var q=X.match(/^(v|f)s:#([\w-]+)$/);if(q){var Q="decl"===q[2]?M:I;Q[X]=Q[X]||[],Q[X].push(K[X])}else j[X]=j[X]||[],j[X].push(K[X])}}}catch(t){J.e(t)}finally{J.f()}return E+=H,E=Object(P.c)(E,i,M),E+=function(t,e){var n="";for(var r in t){var i=t[r];if(n+="void ".concat(i.signature," {\n"),i.header&&(n+="  ".concat(i.header)),e[r]){var o=e[r];o.sort((function(t,e){return t.order-e.order}));var a,s=U(o);try{for(s.s();!(a=s.n()).done;){var u=a.value;n+="  ".concat(u.injection,"\n")}}catch(t){s.e(t)}finally{s.f()}}i.footer&&(n+="  ".concat(i.footer)),n+="}\n"}return n}(T[i],j),E+=B,E=G(E=Object(P.c)(E,i,I),g?100:x,A)}function K(t){return function(e){var n,r={},i=U(t);try{for(i.s();!(n=i.n()).done;){var o=n.value.getUniforms(e,r);Object.assign(r,o)}}catch(t){i.e(t)}finally{i.f()}return r}}var X=n(348);function q(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return Z}));var Z=function(){function t(e){i()(this,t),this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}return a()(t,[{key:"addDefaultModule",value:function(t){this._defaultModules.find((function(e){return e.name===t.name}))||this._defaultModules.push(t),this.stateHash++}},{key:"removeDefaultModule",value:function(t){var e="string"==typeof t?t:t.name;this._defaultModules=this._defaultModules.filter((function(t){return t.name!==e})),this.stateHash++}},{key:"addShaderHook",value:function(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}},{key:"get",value:function(){var t,e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.vs,i=void 0===r?"":r,o=n.fs,a=void 0===o?"":o,s=n.defines,u=void 0===s?{}:s,c=n.inject,l=void 0===c?{}:c,f=n.varyings,h=void 0===f?[]:f,d=n.bufferMode,p=void 0===d?35981:d,v=n.transpileToGLSL100,g=void 0!==v&&v,y=this._getModuleList(n.modules),m=this._getHash(i),b=this._getHash(a),A=y.map((function(t){return e._getHash(t.name)})).sort(),_=h.map((function(t){return e._getHash(t)})),O=Object.keys(u).sort(),w=Object.keys(l).sort(),x=[],C=[],P=q(O);try{for(P.s();!(t=P.n()).done;){var S=t.value;x.push(this._getHash(S)),x.push(this._getHash(u[S]))}}catch(t){P.e(t)}finally{P.f()}var B,k=q(w);try{for(k.s();!(B=k.n()).done;){var E=B.value;C.push(this._getHash(E)),C.push(this._getHash(l[E]))}}catch(t){k.e(t)}finally{k.f()}var T="".concat(m,"/").concat(b,"D").concat(x.join("/"),"M").concat(A.join("/"),"I").concat(C.join("/"),"V").concat(_.join("/"),"H").concat(this.stateHash,"B").concat(p).concat(g?"T":"");if(!this._programCache[T]){var j=J(this.gl,{vs:i,fs:a,modules:y,inject:l,defines:u,hookFunctions:this._hookFunctions,transpileToGLSL100:g});this._programCache[T]=new X.a(this.gl,{hash:T,vs:j.vs,fs:j.fs,varyings:h,bufferMode:p}),this._getUniforms[T]=j.getUniforms||function(t){},this._useCounts[T]=0}return this._useCounts[T]++,this._programCache[T]}},{key:"getUniforms",value:function(t){return this._getUniforms[t.hash]||null}},{key:"release",value:function(t){var e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}},{key:"_getHash",value:function(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}},{key:"_getModuleList",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=new Array(this._defaultModules.length+t.length),n={},r=0,i=0,o=this._defaultModules.length;i<o;++i){var a=this._defaultModules[i],s=a.name;e[r++]=a,n[s]=!0}for(var u=0,c=t.length;u<c;++u){var l=t[u],f=l.name;n[f]||(e[r++]=l,n[f]=!0)}return e.length=r,e}}],[{key:"getDefaultProgramManager",value:function(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new t(e),e.luma.defaultProgramManager}}]),t}()},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(196),u=n(26),c=n.n(u),l={number:{validate:function(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate:function(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function f(t){var e=h(t);return"object"===e?t?"type"in t?Object.assign({},t,l[t.type]):"value"in t?(e=h(t.value),Object.assign({type:e},t,l[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},l[e])}function h(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":c()(t)}n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return p}));var d=function(){function t(e){i()(this,t);var n=e.name,r=e.vs,o=e.fs,a=e.dependencies,u=void 0===a?[]:a,c=e.uniforms,l=e.getUniforms,h=e.deprecations,d=void 0===h?[]:h,p=e.defines,v=void 0===p?{}:p,g=e.inject,y=void 0===g?{}:g,m=e.vertexShader,b=e.fragmentShader;Object(s.a)("string"==typeof n),this.name=n,this.vs=r||m,this.fs=o||b,this.getModuleUniforms=l,this.dependencies=u,this.deprecations=this._parseDeprecationDefinitions(d),this.defines=v,this.injections=function(t){var e={vs:{},fs:{}};for(var n in t){var r=t[n],i=n.slice(0,2);"string"==typeof r&&(r={order:0,injection:r}),e[i][n]=r}return e}(y),c&&(this.uniforms=function(t){var e={};for(var n in t){var r=f(t[n]);e[n]=r}return e}(c))}return a()(t,[{key:"getModuleSource",value:function(t){var e;switch(t){case"vs":e=this.vs||"";break;case"fs":e=this.fs||"";break;default:Object(s.a)(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(e,"// END MODULE_").concat(this.name,"\n\n")}},{key:"getUniforms",value:function(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}},{key:"getDefines",value:function(){return this.defines}},{key:"checkDeprecations",value:function(t,e){this.deprecations.forEach((function(n){n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())}))}},{key:"_parseDeprecationDefinitions",value:function(t){return t.forEach((function(t){switch(t.type){case"function":t.regex=new RegExp("\\b".concat(t.old,"\\("));break;default:t.regex=new RegExp("".concat(t.type," ").concat(t.old,";"))}})),t}},{key:"_defaultGetUniforms",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},n=this.uniforms;for(var r in n){var i=n[r];r in t&&!i.private?(i.validate&&Object(s.a)(i.validate(t[r],i),"".concat(this.name,": invalid ").concat(r)),e[r]=t[r]):e[r]=i.value}return e}}]),t}();function p(t){if(!t.normalized&&(t.normalized=!0,t.uniforms&&!t.getUniforms)){var e=new d(t);t.getUniforms=e.getUniforms.bind(e)}return t}},function(t,e,n){"use strict";var r=n(49),i=n(95),o=n(77),a=n(12),s=n(76),u=n(17);function c(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Object(u.a)(!1),0}}var l=n(250);function f(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.sourceX,r=void 0===n?0:n,i=e.sourceY,o=void 0===i?0:i,a=e.sourceFormat,c=void 0===a?6408:a,l=e.sourceAttachment,f=void 0===l?36064:l,h=e.target,d=void 0===h?null:h,p=e.sourceWidth,y=e.sourceHeight,m=e.sourceType,b=v(t),A=b.framebuffer,_=b.deleteFramebuffer;Object(u.a)(A);var O=A.gl,w=A.handle,x=A.attachments;p=p||A.width,y=y||A.height,36064===f&&null===w&&(f=1028),Object(u.a)(x[f]),d=g(d,m=m||x[f].type,c,p,y),m=m||Object(s.b)(d);var C=O.bindFramebuffer(36160,w);return O.readPixels(r,o,p,y,c,m,d),O.bindFramebuffer(36160,C||null),_&&A.delete(),d}function h(t,e){var n=e.sourceX,i=void 0===n?0:n,o=e.sourceY,s=void 0===o?0:o,l=e.sourceFormat,f=void 0===l?6408:l,h=e.target,d=void 0===h?null:h,p=e.targetByteOffset,g=void 0===p?0:p,y=e.sourceWidth,m=e.sourceHeight,b=e.sourceType,A=v(t),_=A.framebuffer,O=A.deleteFramebuffer;Object(u.a)(_),y=y||_.width,m=m||_.height;var w=Object(a.a)(_.gl);if(b=b||(d?d.type:5121),!d){var x=c(f),C=function(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return Object(u.a)(!1),0}}(b),P=g+y*m*x*C;d=new r.a(w,{byteLength:P,accessor:{type:b,size:x}})}return d.bind({target:35051}),Object(a.o)(w,{framebuffer:_},(function(){w.readPixels(i,s,y,m,f,b,g)})),d.unbind({target:35051}),O&&_.delete(),d}function d(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.sourceAttachment,r=void 0===n?36064:n,i=e.targetMaxHeight,o=void 0===i?Number.MAX_SAFE_INTEGER:i,a=f(t,{sourceAttachment:r}),u=t.width,c=t.height;c>o;){var l=Object(s.d)({data:a,width:u,height:c});a=l.data,u=l.width,c=l.height}Object(s.a)({data:a,width:u,height:c});var h=document.createElement("canvas");h.width=u,h.height=c;var d=h.getContext("2d"),p=d.createImageData(u,c);return p.data.set(a),d.putImageData(p,0,0),h.toDataURL()}function p(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.sourceX,i=void 0===r?0:r,s=n.sourceY,c=void 0===s?0:s,l=n.targetMipmaplevel,f=void 0===l?0:l,h=n.targetInternalFormat,d=void 0===h?6408:h,p=n.targetX,g=n.targetY,y=n.targetZ,m=n.width,b=n.height,A=v(t),_=A.framebuffer,O=A.deleteFramebuffer;Object(u.a)(_);var w=_.gl,x=_.handle,C=void 0!==p||void 0!==g||void 0!==y;p=p||0,g=g||0,y=y||0;var P=w.bindFramebuffer(36160,x);Object(u.a)(e);var S=null;if(e instanceof o.a&&(S=e,m=Number.isFinite(m)?m:S.width,b=Number.isFinite(b)?b:S.height,S.bind(0),e=S.target),C)switch(e){case 3553:case 34067:w.copyTexSubImage2D(e,f,p,g,i,c,m,b);break;case 35866:case 32879:var B=Object(a.a)(w);B.copyTexSubImage3D(e,f,p,g,y,i,c,m,b)}else w.copyTexImage2D(e,f,d,i,c,m,b,0);return S&&S.unbind(),w.bindFramebuffer(36160,P||null),O&&_.delete(),S}function v(t){return t instanceof i.a?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:Object(l.b)(t),deleteFramebuffer:!0}}function g(t,e,n,r,i){return t||(e=e||5121,new(Object(s.c)(e,{clamped:!1}))(r*i*c(n)))}n.d(e,"c",(function(){return f})),n.d(e,"d",(function(){return h})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return p}))},,,,,,,,function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var r=n(221);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(8),i=n.n(r),o=n(4),a=n.n(o),s=n(32),u=n(65),c=n(66),l=n(121);function f(t,e,n,r){return h.apply(this,arguments)}function h(){return(h=i()(a.a.mark((function t(e,n,r,i){var o,f;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Array.isArray(n)||Object(u.a)(n)||(void 0,r=n,n=void 0),o=Object(c.a)(r),f=e,"string"!=typeof e){t.next=7;break}return t.next=6,o(e);case 6:f=t.sent;case 7:if(!Object(s.b)(e)){t.next=11;break}return t.next=10,o(e);case 10:f=t.sent;case 11:return t.next=13,Object(l.a)(f,n,r);case 13:return t.abrupt("return",t.sent);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},function(t,e,n){var r=n(224);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},function(t,e){},function(t,e){t.exports=function(t){this.wrapped=t}},function(t,e,n){"use strict";var r=n(120);e.a={name:"project32",dependencies:[r.a],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"}},function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=n(75),l=n(90),f=n(44),h=n(49);function d(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var v=function(){function t(e){i()(this,t),u()(this,"opts",void 0),u()(this,"typedArrayManager",void 0),u()(this,"indexStarts",[0]),u()(this,"vertexStarts",[0]),u()(this,"vertexCount",0),u()(this,"instanceCount",0),u()(this,"attributes",void 0),u()(this,"_attributeDefs",void 0),u()(this,"data",void 0),u()(this,"getGeometry",void 0),u()(this,"geometryBuffer",void 0),u()(this,"buffers",void 0),u()(this,"positionSize",void 0),u()(this,"normalize",void 0);var n=e.attributes,r=void 0===n?{}:n;this.typedArrayManager=l.a,this.attributes={},this._attributeDefs=r,this.opts=e,this.updateGeometry(e)}return a()(t,[{key:"updateGeometry",value:function(t){Object.assign(this.opts,t);var e=this.opts,n=e.data,r=e.buffers,i=void 0===r?{}:r,o=e.getGeometry,a=e.geometryBuffer,s=e.positionFormat,u=e.dataChanged,c=e.normalize,l=void 0===c||c;if(this.data=n,this.getGeometry=o,this.positionSize=a&&a.size||("XY"===s?2:3),this.buffers=i,this.normalize=l,a&&(Object(f.a)(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(a),l||(i.positions=a)),this.geometryBuffer=i.positions,Array.isArray(u)){var h,p=d(u);try{for(p.s();!(h=p.n()).done;){var v=h.value;this._rebuildGeometry(v)}}catch(t){p.e(t)}finally{p.f()}}else this._rebuildGeometry()}},{key:"updatePartialGeometry",value:function(t){var e=t.startRow,n=t.endRow;this._rebuildGeometry({startRow:e,endRow:n})}},{key:"getGeometryFromBuffer",value:function(t){var e=t.value||t;return ArrayBuffer.isView(e)?Object(c.b)(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}},{key:"_allocate",value:function(t,e){var n=this.attributes,r=this.buffers,i=this._attributeDefs,o=this.typedArrayManager;for(var a in i)if(a in r)o.release(n[a]),n[a]=null;else{var s=i[a];s.copy=e,n[a]=o.allocate(n[a],t,s)}}},{key:"_forEachGeometry",value:function(t,e,n){var r,i=this.data,o=this.getGeometry,a=Object(c.a)(i,e,n),s=a.iterable,u=a.objectInfo,l=d(s);try{for(l.s();!(r=l.n()).done;){var f=r.value;u.index++,t(o?o(f,u):null,u.index)}}catch(t){l.e(t)}finally{l.f()}}},{key:"_rebuildGeometry",value:function(t){var e=this;if(this.data){var n=this.indexStarts,r=this.vertexStarts,i=this.instanceCount,o=this.data,a=this.geometryBuffer,s=t||{},u=s.startRow,c=void 0===u?0:u,l=s.endRow,f=void 0===l?1/0:l,d={};if(t||(n=[0],r=[0]),this.normalize||!a)this._forEachGeometry((function(t,n){var i=t&&e.normalizeGeometry(t);d[n]=i,r[n+1]=r[n]+(i?e.getGeometrySize(i):0)}),c,f),i=r[r.length-1];else if(r=o.startIndices,i=r[o.length]||0,ArrayBuffer.isView(a))i=i||a.length/this.positionSize;else if(a instanceof h.a){var p=a.accessor.stride||4*this.positionSize;i=i||a.byteLength/p}else if(a.buffer){var v=a.stride||4*this.positionSize;i=i||a.buffer.byteLength/v}else if(a.value){var g=a.value,y=a.stride/g.BYTES_PER_ELEMENT||this.positionSize;i=i||g.length/y}this._allocate(i,Boolean(t)),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;var m={};this._forEachGeometry((function(t,o){var a=d[o]||t;m.vertexStart=r[o],m.indexStart=n[o];var s=o<r.length-1?r[o+1]:i;m.geometrySize=s-r[o],m.geometryIndex=o,e.updateGeometryAttributes(a,m)}),c,f),this.vertexCount=n[n.length-1]}}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(147),i=n(93);function o(t,e){return!!r.a.isSupported()&&(!!(i.c||null!=e&&e._nodeWorkers)&&(t.worker&&(null==e?void 0:e.worker)))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n(22),i=n.n(r),o=n(11),a=n.n(o),s=n(16),u=n.n(s),c=n(6),l=n(195);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d={id:"request-scheduler",throttleRequests:!0,maxRequests:6},p=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a()(this,t),Object(c.a)(this,"props",void 0),Object(c.a)(this,"stats",void 0),Object(c.a)(this,"activeRequestCount",0),Object(c.a)(this,"requestQueue",[]),Object(c.a)(this,"requestMap",new Map),Object(c.a)(this,"deferredUpdate",null),this.props=h(h({},d),e),this.stats=new l.a({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}return u()(t,[{key:"scheduleRequest",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 0};if(!this.props.throttleRequests)return Promise.resolve({done:function(){}});if(this.requestMap.has(t))return this.requestMap.get(t);var n={handle:t,priority:0,getPriority:e},r=new Promise((function(t){return n.resolve=t,n}));return this.requestQueue.push(n),this.requestMap.set(t,r),this._issueNewRequests(),r}},{key:"_issueRequest",value:function(t){var e=this,n=t.handle,r=t.resolve,i=!1,o=function(){i||(i=!0,e.requestMap.delete(n),e.activeRequestCount--,e._issueNewRequests())};return this.activeRequestCount++,r?r({done:o}):Promise.resolve({done:o})}},{key:"_issueNewRequests",value:function(){var t=this;this.deferredUpdate||(this.deferredUpdate=setTimeout((function(){return t._issueNewRequestsAsync()}),0))}},{key:"_issueNewRequestsAsync",value:function(){this.deferredUpdate=null;var t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(var e=0;e<t;++e){var n=this.requestQueue.shift();n&&this._issueRequest(n)}}}},{key:"_updateAllRequests",value:function(){for(var t=this.requestQueue,e=0;e<t.length;++e){var n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort((function(t,e){return t.priority-e.priority}))}},{key:"_updateRequest",value:function(t){return t.priority=t.getPriority(t.handle),!(t.priority<0)||(t.resolve(null),!1)}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r,i=n(8),o=n.n(i),a=n(4),s=n.n(a),u={name:"JSON",id:"json",module:"json",version:"3.3.0-alpha.5",extensions:["json","geojson"],mimeTypes:["application/json"],category:"json",text:!0,parseTextSync:c,parse:(r=o()(s.a.mark((function t(e){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",c((new TextDecoder).decode(e)));case 1:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)}),options:{}};function c(t){return JSON.parse(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(5),u=n.n(s),c=n(7),l=n.n(c),f=n(2),h=n.n(f),d=n(0),p=n.n(d),v=n(327),g=n(20);function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var m=function(t){u()(n,t);var e=y(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getGeometry",value:function(t){return new v.a}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.elevationScale,i=n.extruded,o=n.offset,a=n.coverage,s=n.cellSize,u=n.angle,c=n.radiusUnits;this.state.model.setUniforms(e).setUniforms({radius:s/2,radiusUnits:g.e[c],angle:u,offset:o,extruded:i,coverage:a,elevationScale:r,edgeDistance:1,isWireframe:!1}).draw()}}]),n}(n(178).a);p()(m,"layerName","GridCellLayer"),p()(m,"defaultProps",{cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(5),u=n.n(s),c=n(7),l=n.n(c),f=n(2),h=n.n(f),d=n(0),p=n.n(d),v=n(31),g=n(75),y=n(203),m=n(131),b=n(132),A=n(86),_=n(193);function O(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var C=[0,0,0,255],P={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:function(t){return t.polygon}},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:C},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0},S=function(t){u()(n,t);var e=x(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"initializeState",value:function(){this.state={paths:[]},this.props.getLineDashArray&&v.a.removed("getLineDashArray","PathStyleExtension")()}},{key:"updateState",value:function(t){var e=this,n=t.changeFlags,r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon);if(r&&Array.isArray(n.dataChanged)){var i=this.state.paths.slice(),o=n.dataChanged.map((function(t){return Object(_.a)({data:i,getIndex:function(t){return t.__source.index},dataRange:t,replace:e._getPaths(t)})}));this.setState({paths:i,pathsDiff:o})}else r&&this.setState({paths:this._getPaths(),pathsDiff:null})}},{key:"_getPaths",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.props,r=n.data,i=n.getPolygon,o=n.positionFormat,a=n._normalize,s=[],u="XY"===o?2:3,c=e.startRow,l=e.endRow,f=Object(g.a)(r,c,l),h=f.iterable,d=f.objectInfo,p=O(h);try{for(p.s();!(t=p.n()).done;){var v=t.value;d.index++;var y=i(v,d);a&&(y=A.d(y,u));var m=y,b=m.holeIndices,_=y.positions||y;if(b)for(var w=0;w<=b.length;w++){var x=_.slice(b[w-1]||0,b[w]||_.length);s.push(this.getSubLayerRow({path:x},v,d.index))}else s.push(this.getSubLayerRow({path:_},v,d.index))}}catch(t){p.e(t)}finally{p.f()}return s}},{key:"renderLayers",value:function(){var t=this.props,e=t.data,n=t._dataDiff,r=t.stroked,i=t.filled,o=t.extruded,a=t.wireframe,s=t._normalize,u=t._windingOrder,c=t.elevationScale,l=t.transitions,f=t.positionFormat,h=this.props,d=h.lineWidthUnits,p=h.lineWidthScale,v=h.lineWidthMinPixels,g=h.lineWidthMaxPixels,y=h.lineJointRounded,A=h.lineMiterLimit,_=h.lineDashJustified,O=this.props,w=O.getFillColor,x=O.getLineColor,P=O.getLineWidth,S=O.getLineDashArray,B=O.getElevation,k=O.getPolygon,E=O.updateTriggers,T=O.material,j=this.state,M=j.paths,I=j.pathsDiff,R=this.getSubLayerClass("fill",m.a),D=this.getSubLayerClass("stroke",b.a),L=this.shouldRenderSubLayer("fill",M)&&new R({_dataDiff:n,extruded:o,elevationScale:c,filled:i,wireframe:a,_normalize:s,_windingOrder:u,getElevation:B,getFillColor:w,getLineColor:o&&a?x:C,material:T,transitions:l},this.getSubLayerProps({id:"fill",updateTriggers:E&&{getPolygon:E.getPolygon,getElevation:E.getElevation,getFillColor:E.getFillColor,lineColors:o&&a,getLineColor:E.getLineColor}}),{data:e,positionFormat:f,getPolygon:k});return[!o&&L,!o&&r&&this.shouldRenderSubLayer("stroke",M)&&new D({_dataDiff:I&&function(){return I},widthUnits:d,widthScale:p,widthMinPixels:v,widthMaxPixels:g,jointRounded:y,miterLimit:A,dashJustified:_,_pathType:"loop",transitions:l&&{getWidth:l.getLineWidth,getColor:l.getLineColor,getPath:l.getPolygon},getColor:this.getSubLayerAccessor(x),getWidth:this.getSubLayerAccessor(P),getDashArray:this.getSubLayerAccessor(S)},this.getSubLayerProps({id:"stroke",updateTriggers:E&&{getWidth:E.getLineWidth,getColor:E.getLineColor,getDashArray:E.getLineDashArray}}),{data:M,positionFormat:f,getPath:function(t){return t.path}}),o&&L]}}]),n}(y.a);p()(S,"layerName","PolygonLayer"),p()(S,"defaultProps",P)},function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(5),u=n.n(s),c=n(7),l=n.n(c),f=n(2),h=n.n(f),d=n(0),p=n.n(d),v=n(204);function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var y={clipBounds:[0,0,1,1]},m="\nuniform vec4 clip_bounds;\n\nbool clip_isInBounds(vec2 position) {\n  return position.x >= clip_bounds[0] && position.y >= clip_bounds[1] && position.x < clip_bounds[2] && position.y < clip_bounds[3];\n}\n",b={name:"clip-vs",vs:m},A={"vs:#decl":"\nvarying float clip_isVisible;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));\n","fs:#decl":"\nvarying float clip_isVisible;\n","fs:DECKGL_FILTER_COLOR":"\n  if (clip_isVisible < 0.5) discard;\n"},_={name:"clip-fs",fs:m},O={"vs:#decl":"\nvarying vec2 clip_commonPosition;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_commonPosition = geometry.position.xy;\n","fs:#decl":"\nvarying vec2 clip_commonPosition;\n","fs:DECKGL_FILTER_COLOR":"\n  if (!clip_isInBounds(clip_commonPosition)) discard;\n"},w=function(t){u()(n,t);var e=g(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){var t="instancePositions"in this.getAttributeManager().attributes;return"clipByInstance"in this.props&&(t=this.props.clipByInstance),this.state.clipByInstance=t,t?{modules:[b],inject:A}:{modules:[_],inject:O}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props.clipBounds,r=void 0===n?y.clipBounds:n;if(this.state.clipByInstance)e.clip_bounds=r;else{var i=this.projectPosition([r[0],r[1],0]),o=this.projectPosition([r[2],r[3],0]);e.clip_bounds=[Math.min(i[0],o[0]),Math.min(i[1],o[1]),Math.max(i[0],o[0]),Math.max(i[1],o[1])]}}}]),n}(v.a);p()(w,"defaultProps",y),p()(w,"extensionName","ClipExtension")},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(149);function i(t){try{return JSON.parse(t)}catch(e){throw new Error('Failed to parse JSON from data starting with "'.concat(Object(r.a)(t),'"'))}}},function(t,e,n){"use strict";var r={};n.r(r),n.d(r,"name",(function(){return cn})),n.d(r,"decode",(function(){return ln}));var i={};n.r(i),n.d(i,"name",(function(){return An})),n.d(i,"preprocess",(function(){return _n}));var o={};n.r(o),n.d(o,"name",(function(){return xn})),n.d(o,"preprocess",(function(){return Cn}));var a={};n.r(a),n.d(a,"name",(function(){return Tr})),n.d(a,"preprocess",(function(){return jr})),n.d(a,"decode",(function(){return Mr})),n.d(a,"encode",(function(){return Rr}));var s={};n.r(s),n.d(s,"name",(function(){return Hr})),n.d(s,"decode",(function(){return Vr})),n.d(s,"encode",(function(){return Wr}));var u={};n.r(u),n.d(u,"name",(function(){return Qr})),n.d(u,"decode",(function(){return Zr})),n.d(u,"encode",(function(){return $r}));var c={};n.r(c),n.d(c,"name",(function(){return ni})),n.d(c,"decode",(function(){return ri})),n.d(c,"encode",(function(){return oi}));var l=n(1),f=n.n(l),h=n(3),d=n.n(h),p=n(9),v=n.n(p),g=n(10),y=n.n(g),m=n(5),b=n.n(m),A=n(7),_=n.n(A),O=n(2),w=n.n(O),x=n(0),C=n.n(x),P=n(26),S=n.n(P),B=n(228),k=n(247),E=n(31),T=n(176),j=n(12),M=n(352),I=n(106),R=n(98),D=n(67),L=n(17),F=function(){function t(){f()(this,t);var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.id;this.id=n||Object(D.c)(this.constructor.name),this.display=!0,this.position=new I.a,this.rotation=new I.a,this.scale=new I.a(1,1,1),this.matrix=new R.a,this.userData={},this.props={},this._setScenegraphNodeProps(e)}return d()(t,[{key:"delete",value:function(){}},{key:"setProps",value:function(t){return this._setScenegraphNodeProps(t),this}},{key:"toString",value:function(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}},{key:"setPosition",value:function(t){return Object(L.a)(3===t.length,"setPosition requires vector argument"),this.position=t,this}},{key:"setRotation",value:function(t){return Object(L.a)(3===t.length,"setRotation requires vector argument"),this.rotation=t,this}},{key:"setScale",value:function(t){return Object(L.a)(3===t.length,"setScale requires vector argument"),this.scale=t,this}},{key:"setMatrix",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e?this.matrix.copy(t):this.matrix=t}},{key:"setMatrixComponents",value:function(t){var e=t.position,n=t.rotation,r=t.scale,i=t.update,o=void 0===i||i;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),o&&this.updateMatrix(),this}},{key:"updateMatrix",value:function(){var t=this.position,e=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(e),this.matrix.scale(n),this}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.position,n=t.rotation,r=t.scale;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}},{key:"getCoordinateUniforms",value:function(t,e){Object(L.a)(t),e=e||this.matrix;var n=new R.a(t).multiplyRight(e),r=n.invert(),i=r.transpose();return{viewMatrix:t,modelMatrix:e,objectMatrix:e,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}},{key:"_setScenegraphNodeProps",value:function(t){"display"in t&&(this.display=t.display),"position"in t&&this.setPosition(t.position),"rotation"in t&&this.setRotation(t.rotation),"scale"in t&&this.setScale(t.scale),"matrix"in t&&this.setMatrix(t.matrix),Object.assign(this.props,t)}}]),t}(),G=n(49),N=n(85),U=n(27),z=n.n(U);function H(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return V(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function J(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=w()(t);if(e){var i=w()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _()(this,n)}}var W=function(t){b()(n,t);var e=J(n);function n(){var t;f()(this,n);var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r=Array.isArray(r)?{children:r}:r,o=i.children,a=void 0===o?[]:o;return j.k.assert(a.every((function(t){return t instanceof F})),"every child must an instance of ScenegraphNode"),(t=e.call(this,r)).children=a,t}return d()(n,[{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];Array.isArray(o)?this.add.apply(this,z()(o)):this.children.push(o)}return this}},{key:"remove",value:function(t){var e=this.children,n=e.indexOf(t);return n>-1&&e.splice(n,1),this}},{key:"removeAll",value:function(){return this.children=[],this}},{key:"delete",value:function(){this.children.forEach((function(t){return t.delete()})),this.removeAll(),y()(w()(n.prototype),"delete",this).call(this)}},{key:"traverse",value:function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.worldMatrix,o=void 0===i?new R.a:i,a=new R.a(o).multiplyRight(this.matrix),s=H(this.children);try{for(s.s();!(e=s.n()).done;){var u=e.value;u instanceof n?u.traverse(t,{worldMatrix:a}):t(u,{worldMatrix:a})}}catch(t){s.e(t)}finally{s.f()}}}]),n}(F),K=n(351),X={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},q={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Q(t){if(!t._animation){var e=q[t.componentType],n=X[t.type],r=n*t.count,i=t.bufferView.data,o=new e(i.buffer,i.byteOffset+(t.byteOffset||0),r);if(1===n)t._animation=Array.from(o);else{for(var a=[],s=0;s<o.length;s+=n)a.push(Array.from(o.slice(s,s+n)));t._animation=a}}return t._animation}var Z=new R.a;var Y=new K.a;function $(t,e,n,r){var i=e.input,o=e.interpolation,a=e.output,s=t%i[i.length-1],u=i.findIndex((function(t){return t>=s})),c=Math.max(0,u-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:j.k.warn("Bad animation path ".concat(r))()}Object(L.a)(n[r].length===a[c].length);var l=i[c],f=i[u];switch(o){case"STEP":!function(t,e,n){for(var r=0;r<n.length;r++)t[e][r]=n[r]}(n,r,a[c]);break;case"LINEAR":if(f>l){var h=(s-l)/(f-l);!function(t,e,n,r,i){if("rotation"===e){Y.slerp({start:n,target:r,ratio:i});for(var o=0;o<Y.length;o++)t[e][o]=Y[o]}else for(var a=0;a<n.length;a++)t[e][a]=i*r[a]+(1-i)*n[a]}(n,r,a[c],a[u],h)}break;case"CUBICSPLINE":if(f>l){var d=(s-l)/(f-l),p=f-l;!function(t,e,n){for(var r=n.p0,i=n.outTangent0,o=n.inTangent1,a=n.p1,s=n.tDiff,u=n.ratio,c=0;c<t[e].length;c++){var l=i[c]*s,f=o[c]*s;t[e][c]=(2*Math.pow(u,3)-3*Math.pow(u,2)+1)*r[c]+(Math.pow(u,3)-2*Math.pow(u,2)+u)*l+(-2*Math.pow(u,3)+3*Math.pow(u,2))*a[c]+(Math.pow(u,3)-Math.pow(u,2))*f}}(n,r,{p0:a[3*c+1],outTangent0:a[3*c+2],inTangent1:a[3*u+0],p1:a[3*u+1],tDiff:p,ratio:d})}break;default:j.k.warn("Interpolation ".concat(o," not supported"))()}}var tt=function(){function t(e){f()(this,t),this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}return d()(t,[{key:"animate",value:function(t){if(this.playing){var e=(t/1e3-this.startTime)*this.speed;this.channels.forEach((function(t){var n=t.sampler,r=t.target,i=t.path;$(e,n,r,i),function(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){var n=Z.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}(r,r._node)}))}}}]),t}(),et=function(){function t(e){f()(this,t),this.animations=e.animations.map((function(t,n){var r=t.name||"Animation-".concat(n),i=t.samplers.map((function(t){var n=t.input,r=t.interpolation,i=void 0===r?"LINEAR":r,o=t.output;return{input:Q(e.accessors[n]),interpolation:i,output:Q(e.accessors[o])}})),o=t.channels.map((function(t){var n=t.sampler,r=t.target;return{sampler:i[n],target:e.nodes[r.node],path:r.path}}));return new tt({name:r,channels:o})}))}return d()(t,[{key:"animate",value:function(t){this.setTime(t)}},{key:"setTime",value:function(t){this.animations.forEach((function(e){return e.animate(t)}))}},{key:"getAnimations",value:function(){return this.animations}}]),t}(),nt=n(194);function rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=w()(t);if(e){var i=w()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _()(this,n)}}var it=function(t){b()(n,t);var e=rt(n);function n(t){var r;f()(this,n);var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(r=e.call(this,i)).onBeforeRender=null,r.AfterRender=null,t instanceof nt.a?(r.model=t,r._setModelNodeProps(i)):r.model=new nt.a(t,i),r.managedResources=i.managedResources||[],r}return d()(n,[{key:"setProps",value:function(t){return y()(w()(n.prototype),"setProps",this).call(this,t),this._setModelNodeProps(t),this}},{key:"delete",value:function(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach((function(t){return t.delete()})),this.managedResources=[]}},{key:"draw",value:function(){var t;return(t=this.model).draw.apply(t,arguments)}},{key:"setUniforms",value:function(){var t;return(t=this.model).setUniforms.apply(t,arguments),this}},{key:"setAttributes",value:function(){var t;return(t=this.model).setAttributes.apply(t,arguments),this}},{key:"updateModuleSettings",value:function(){var t;return(t=this.model).updateModuleSettings.apply(t,arguments),this}},{key:"_setModelNodeProps",value:function(t){this.model.setProps(t)}}]),n}(F),ot=n(263);function at(t,e){return Object(j.j)(t)?"#version 300 es\n".concat(e):e}var st={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ut={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1},ct=function(){function t(e){f()(this,t);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.options=Object.assign({},ut,n)}return d()(t,[{key:"instantiate",value:function(t){var e=this;return this.gltf=t,(t.scenes||[]).map((function(t){return e.createScene(t)}))}},{key:"createAnimator",value:function(){return Array.isArray(this.gltf.animations)?new et(this.gltf):null}},{key:"createScene",value:function(t){var e=this,n=(t.nodes||[]).map((function(t){return e.createNode(t)}));return new W({id:t.name||t.id,children:n})}},{key:"createNode",value:function(t){var e=this;if(!t._node){var n=(t.children||[]).map((function(t){return e.createNode(t)}));t.mesh&&n.push(this.createMesh(t.mesh));var r=new W({id:t.name||t.id,children:n});if(t.matrix)r.setMatrix(t.matrix);else{if(r.matrix.identity(),t.translation&&r.matrix.translate(t.translation),t.rotation){var i=(new R.a).fromQuaternion(t.rotation);r.matrix.multiplyRight(i)}t.scale&&r.matrix.scale(t.scale)}t._node=r}return t._node}},{key:"createMesh",value:function(t){var e=this;if(!t._mesh){var n=(t.primitives||[]).map((function(n,r){return e.createPrimitive(n,r,t)})),r=new W({id:t.name||t.id,children:n});t._mesh=r}return t._mesh}},{key:"getVertexCount",value:function(t){j.k.warn("getVertexCount() not found")()}},{key:"createPrimitive",value:function(t,e,n){return function(t,e){var n=e.id,r=e.drawMode,i=e.vertexCount,o=e.attributes,a=e.modelOptions,s=new ot.a(t,e);j.k.info(4,"createGLTFModel defines: ",s.defines)();var u=[];u.push.apply(u,z()(s.generatedTextures)),u.push.apply(u,z()(Object.values(o).map((function(t){return t.buffer}))));var c=new it(t,Object.assign({id:n,drawMode:r,vertexCount:i,modules:[M.a],defines:s.defines,parameters:s.parameters,vs:at(t,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:at(t,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:u},a));return c.setProps({attributes:o}),c.setUniforms(s.uniforms),c}(this.gl,Object.assign({id:t.name||"".concat(n.name||n.id,"-primitive-").concat(e),drawMode:t.mode||4,vertexCount:t.indices?t.indices.count:this.getVertexCount(t.attributes),attributes:this.createAttributes(t.attributes,t.indices),material:t.material},this.options))}},{key:"createAttributes",value:function(t,e){var n=this,r={};return Object.keys(t).forEach((function(e){r[e]=n.createAccessor(t[e],n.createBuffer(t[e],n.gl.ARRAY_BUFFER))})),e&&(r.indices=this.createAccessor(e,this.createBuffer(e,this.gl.ELEMENT_ARRAY_BUFFER))),j.k.info(4,"glTF Attributes",{attributes:t,indices:e,generated:r})(),r}},{key:"createBuffer",value:function(t,e){t.bufferView||(t.bufferView={});var n=t.bufferView;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[e]||(n.lumaBuffers[e]=new G.a(this.gl,{id:"from-".concat(n.id),data:n.data||t.value,target:e})),n.lumaBuffers[e]}},{key:"createAccessor",value:function(t,e){return new N.a({buffer:e,offset:t.byteOffset||0,stride:t.bufferView.byteStride||0,type:t.componentType,size:st[t.type]})}},{key:"createSampler",value:function(t){return t}},{key:"needsPOT",value:function(){return!1}}]),t}();var lt=n(19),ft=n.n(lt),ht=n(14),dt=n.n(ht),pt=n(15),vt=n.n(pt),gt={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document},yt=gt.global||gt.self||gt.window||{},mt="object"!==("undefined"==typeof process?"undefined":S()(process))||"[object process]"!==String(process)||process.browser,bt="function"==typeof importScripts,At=("undefined"!=typeof window&&window.orientation,"undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version)),_t=(At&&parseFloat(At[1]),n(146));var Ot={};function wt(t){return xt.apply(this,arguments)}function xt(){return(xt=ft()(dt.a.mark((function t(e){var n,r,i=arguments;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:null,r=i.length>2&&void 0!==i[2]?i[2]:{},n&&(e=Ct(e,n,r)),Ot[e]=Ot[e]||Pt(e),t.next=6,Ot[e];case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ct(t,e,n){if(t.startsWith("http"))return t;var r=n.modules||{};return r[t]?r[t]:mt?n.CDN?(function(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(e,"@").concat("3.2.10","/dist/libs/").concat(t)):bt?"../src/libs/".concat(t):"modules/".concat(e,"/src/libs/").concat(t):"modules/".concat(e,"/dist/libs/").concat(t)}function Pt(t){return St.apply(this,arguments)}function St(){return(St=ft()(dt.a.mark((function t(e){var n,r,i;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.endsWith("wasm")){t.next=7;break}return t.next=3,fetch(e);case 3:return n=t.sent,t.next=6,n.arrayBuffer();case 6:return t.abrupt("return",t.sent);case 7:if(mt){t.next=20;break}if(t.prev=8,t.t0=_t&&_t.requireFromFile,!t.t0){t.next=14;break}return t.next=13,_t.requireFromFile(e);case 13:t.t0=t.sent;case 14:return t.abrupt("return",t.t0);case 17:return t.prev=17,t.t1=t.catch(8),t.abrupt("return",null);case 20:if(!bt){t.next=22;break}return t.abrupt("return",importScripts(e));case 22:return t.next=24,fetch(e);case 24:return r=t.sent,t.next=27,r.text();case 27:return i=t.sent,t.abrupt("return",Bt(i,e));case 29:case"end":return t.stop()}}),t,null,[[8,17]])})))).apply(this,arguments)}function Bt(t,e){if(!mt)return _t.requireFromString&&_t.requireFromString(t,e);if(bt)return eval.call(yt,t),null;var n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch(e){n.text=t}return document.body.appendChild(n),null}var kt,Et,Tt="https://unpkg.com/@loaders.gl/textures@".concat("3.2.10","/dist/libs/basis_encoder.wasm"),jt="https://unpkg.com/@loaders.gl/textures@".concat("3.2.10","/dist/libs/basis_encoder.js");function Mt(t){return It.apply(this,arguments)}function It(){return(It=ft()(dt.a.mark((function t(e){var n;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.modules||{}).basis){t.next=3;break}return t.abrupt("return",n.basis);case 3:return kt=kt||Rt(e),t.next=6,kt;case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Rt(t){return Dt.apply(this,arguments)}function Dt(){return(Dt=ft()(dt.a.mark((function t(e){var n,r,i,o;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=null,r=null,t.t0=Promise,t.next=5,wt("basis_transcoder.js","textures",e);case 5:return t.t1=t.sent,t.next=8,wt("basis_transcoder.wasm","textures",e);case 8:return t.t2=t.sent,t.t3=[t.t1,t.t2],t.next=12,t.t0.all.call(t.t0,t.t3);case 12:return i=t.sent,o=vt()(i,2),n=o[0],r=o[1],n=n||globalThis.BASIS,t.next=19,Lt(n,r);case 19:return t.abrupt("return",t.sent);case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Lt(t,e){var n={};return e&&(n.wasmBinary=e),new Promise((function(e){t(n).then((function(t){var n=t.BasisFile;(0,t.initializeBasis)(),e({BasisFile:n})}))}))}function Ft(t){return Gt.apply(this,arguments)}function Gt(){return(Gt=ft()(dt.a.mark((function t(e){var n;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.modules||{}).basisEncoder){t.next=3;break}return t.abrupt("return",n.basisEncoder);case 3:return Et=Et||Nt(e),t.next=6,Et;case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Nt(t){return Ut.apply(this,arguments)}function Ut(){return(Ut=ft()(dt.a.mark((function t(e){var n,r,i,o;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=null,r=null,t.t0=Promise,t.next=5,wt(jt,"textures",e);case 5:return t.t1=t.sent,t.next=8,wt(Tt,"textures",e);case 8:return t.t2=t.sent,t.t3=[t.t1,t.t2],t.next=12,t.t0.all.call(t.t0,t.t3);case 12:return i=t.sent,o=vt()(i,2),n=o[0],r=o[1],n=n||globalThis.BASIS,t.next=19,zt(n,r);case 19:return t.abrupt("return",t.sent);case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function zt(t,e){var n={};return e&&(n.wasmBinary=e),new Promise((function(e){t(n).then((function(t){var n=t.BasisFile,r=t.KTX2File,i=t.initializeBasis,o=t.BasisEncoder;i(),e({BasisFile:n,KTX2File:r,BasisEncoder:o})}))}))}var Ht={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919};function Vt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Jt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Wt=["","WEBKIT_","MOZ_"],Kt={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"},Xt=null;function qt(t){if(!Xt){t=t||function(){try{return document.createElement("canvas").getContext("webgl")}catch(t){return null}}()||void 0,Xt=new Set;var e,n=Vt(Wt);try{for(n.s();!(e=n.n()).done;){var r=e.value;for(var i in Kt)if(t&&t.getExtension("".concat(r).concat(i))){var o=Kt[i];Xt.add(o)}}}catch(t){n.e(t)}finally{n.f()}}return Xt}new Uint8Array([0]);var Qt,Zt,Yt,$t,te,ee,ne,re;!function(t){t[t.NONE=0]="NONE",t[t.BASISLZ=1]="BASISLZ",t[t.ZSTD=2]="ZSTD",t[t.ZLIB=3]="ZLIB"}(Qt||(Qt={})),function(t){t[t.BASICFORMAT=0]="BASICFORMAT"}(Zt||(Zt={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ETC1S=163]="ETC1S",t[t.UASTC=166]="UASTC"}(Yt||(Yt={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SRGB=1]="SRGB"}($t||($t={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LINEAR=1]="LINEAR",t[t.SRGB=2]="SRGB",t[t.ITU=3]="ITU",t[t.NTSC=4]="NTSC",t[t.SLOG=5]="SLOG",t[t.SLOG2=6]="SLOG2"}(te||(te={})),function(t){t[t.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",t[t.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(ee||(ee={})),function(t){t[t.RGB=0]="RGB",t[t.RRR=3]="RRR",t[t.GGG=4]="GGG",t[t.AAA=15]="AAA"}(ne||(ne={})),function(t){t[t.RGB=0]="RGB",t[t.RGBA=3]="RGBA",t[t.RRR=4]="RRR",t[t.RRRG=5]="RRRG"}(re||(re={}));var ie=[171,75,84,88,32,50,48,187,13,10,26,10];function oe(t){var e=new Uint8Array(t);return!(e.byteLength<ie.length||e[0]!==ie[0]||e[1]!==ie[1]||e[2]!==ie[2]||e[3]!==ie[3]||e[4]!==ie[4]||e[5]!==ie[5]||e[6]!==ie[6]||e[7]!==ie[7]||e[8]!==ie[8]||e[9]!==ie[9]||e[10]!==ie[10]||e[11]!==ie[11])}var ae={etc1:{basisFormat:0,compressed:!0,format:Ht.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:Ht.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:Ht.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:Ht.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:Ht.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:Ht.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};function se(){return(se=ft()(dt.a.mark((function t(e,n){var r,i,o,a,s,u;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("auto"!==n.basis.containerFormat){t.next=11;break}if(!oe(e)){t.next=6;break}return t.next=4,Ft(n);case 4:return r=t.sent,t.abrupt("return",le(r.KTX2File,e,n));case 6:return t.next=8,Mt(n);case 8:return i=t.sent,o=i.BasisFile,t.abrupt("return",ue(o,e,n));case 11:t.t0=n.basis.module,t.next="encoder"===t.t0?14:(t.t0,22);break;case 14:return t.next=16,Ft(n);case 16:a=t.sent,t.t1=n.basis.containerFormat,t.next="ktx2"===t.t1?20:(t.t1,21);break;case 20:return t.abrupt("return",le(a.KTX2File,e,n));case 21:return t.abrupt("return",ue(a.BasisFile,e,n));case 22:return t.next=24,Mt(n);case 24:return s=t.sent,u=s.BasisFile,t.abrupt("return",ue(u,e,n));case 27:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ue(t,e,n){var r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");for(var i=r.getNumImages(),o=[],a=0;a<i;a++){for(var s=r.getNumLevels(a),u=[],c=0;c<s;c++)u.push(ce(r,a,c,n));o.push(u)}return o}finally{r.close(),r.delete()}}function ce(t,e,n,r){var i=t.getImageWidth(e,n),o=t.getImageHeight(e,n),a=t.getHasAlpha(),s=he(r,a),u=s.compressed,c=s.format,l=s.basisFormat,f=t.getImageTranscodedSizeInBytes(e,n,l),h=new Uint8Array(f);if(!t.transcodeImage(h,e,n,l,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:o,data:h,compressed:u,format:c,hasAlpha:a}}function le(t,e,n){var r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");for(var i=r.getLevels(),o=[],a=0;a<i;a++){o.push(fe(r,a,n));break}return[o]}finally{r.close(),r.delete()}}function fe(t,e,n){var r=t.getImageLevelInfo(e,0,0),i=r.alphaFlag,o=r.height,a=r.width,s=he(n,i),u=s.compressed,c=s.format,l=s.basisFormat,f=t.getImageTranscodedSizeInBytes(e,0,0,l),h=new Uint8Array(f);if(!t.transcodeImage(h,e,0,0,l,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:a,height:o,data:h,compressed:u,hasAlpha:i,format:c}}function he(t,e){var n=t&&t.basis&&t.basis.format;return"auto"===n&&(n=de()),"object"===S()(n)&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),ae[n]}function de(){var t=qt();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}function pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ve(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pe(Object(n),!0).forEach((function(e){C()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ge={name:"Basis",id:"basis",module:"textures",version:"3.2.10",worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},ye=ve(ve({},ge),{},{parse:function(t,e){return se.apply(this,arguments)}}),me=n(347);function be(t,e,n){if(t.byteLength<=e+n)return"";for(var r=new DataView(t),i="",o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(e+o));return i}function Ae(t){try{return JSON.parse(t)}catch(e){throw new Error('Failed to parse JSON from data starting with "'.concat(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if("string"==typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return be(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){var n=0;return be(t,n,e)}return""}(t),'"'))}}n(208);function _e(t,e,n){var r=void 0!==n?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}function Oe(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function we(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;var n=e.baseUri||e.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(t));return n.substr(0,n.lastIndexOf("/")+1)+t}function xe(t,e,n){var r=t.bufferViews[n];Oe(r);var i=e[r.buffer];Oe(i);var o=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,o,r.byteLength)}var Ce=n(13),Pe=n(192),Se=n(207);function Be(t,e){return Object(Se.a)(t>=0),Object(Se.a)(e>0),t+(e-1)&~(e-1)}function ke(t,e,n){var r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{var i=t.byteOffset,o=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,i,o)}return e.set(r,n),n+Be(r.byteLength,4)}var Ee=["SCALAR","VEC2","VEC3","VEC4"],Te=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],je=new Map(Te),Me={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ie={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Re={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function De(t){return Ee[t-1]||Ee[0]}function Le(t){var e=je.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function Fe(t,e){var n=Re[t.componentType],r=Me[t.type],i=Ie[t.componentType],o=t.count*r,a=t.count*r*i;return Oe(a>=0&&a<=e.byteLength),{ArrayType:n,length:o,byteLength:a}}function Ge(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ne(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ne(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ue(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ze(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ue(Object(n),!0).forEach((function(e){C()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var He,Ve={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]},Je=function(){function t(e){f()(this,t),Object(Ce.a)(this,"gltf",void 0),Object(Ce.a)(this,"sourceBuffers",void 0),Object(Ce.a)(this,"byteLength",void 0),this.gltf=e||{json:ze({},Ve),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}return d()(t,[{key:"json",get:function(){return this.gltf.json}},{key:"getApplicationData",value:function(t){return this.json[t]}},{key:"getExtraData",value:function(t){return(this.json.extras||{})[t]}},{key:"getExtension",value:function(t){var e=this.getUsedExtensions().find((function(e){return e===t})),n=this.json.extensions||{};return e?n[t]||!0:null}},{key:"getRequiredExtension",value:function(t){return this.getRequiredExtensions().find((function(e){return e===t}))?this.getExtension(t):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getObjectExtension",value:function(t,e){return(t.extensions||{})[e]}},{key:"getScene",value:function(t){return this.getObject("scenes",t)}},{key:"getNode",value:function(t){return this.getObject("nodes",t)}},{key:"getSkin",value:function(t){return this.getObject("skins",t)}},{key:"getMesh",value:function(t){return this.getObject("meshes",t)}},{key:"getMaterial",value:function(t){return this.getObject("materials",t)}},{key:"getAccessor",value:function(t){return this.getObject("accessors",t)}},{key:"getTexture",value:function(t){return this.getObject("textures",t)}},{key:"getSampler",value:function(t){return this.getObject("samplers",t)}},{key:"getImage",value:function(t){return this.getObject("images",t)}},{key:"getBufferView",value:function(t){return this.getObject("bufferViews",t)}},{key:"getBuffer",value:function(t){return this.getObject("buffers",t)}},{key:"getObject",value:function(t,e){if("object"===S()(e))return e;var n=this.json[t]&&this.json[t][e];if(!n)throw new Error("glTF file error: Could not find ".concat(t,"[").concat(e,"]"));return n}},{key:"getTypedArrayForBufferView",value:function(t){var e=(t=this.getBufferView(t)).buffer,n=this.gltf.buffers[e];Oe(n);var r=(t.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,t.byteLength)}},{key:"getTypedArrayForAccessor",value:function(t){t=this.getAccessor(t);var e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,r=Fe(t,e),i=r.ArrayType,o=r.length;return new i(n,e.byteOffset+t.byteOffset,o)}},{key:"getTypedArrayForImageData",value:function(t){t=this.getAccessor(t);var e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,r=e.byteOffset||0;return new Uint8Array(n,r,e.byteLength)}},{key:"addApplicationData",value:function(t,e){return this.json[t]=e,this}},{key:"addExtraData",value:function(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}},{key:"addObjectExtension",value:function(t,e,n){return t.extensions=t.extensions||{},t.extensions[e]=n,this.registerUsedExtension(e),this}},{key:"setObjectExtension",value:function(t,e,n){(t.extensions||{})[e]=n}},{key:"removeObjectExtension",value:function(t,e){var n=t.extensions||{},r=n[e];return delete n[e],r}},{key:"addExtension",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Oe(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}},{key:"addRequiredExtension",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Oe(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}},{key:"registerUsedExtension",value:function(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((function(e){return e===t}))||this.json.extensionsUsed.push(t)}},{key:"registerRequiredExtension",value:function(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((function(e){return e===t}))||this.json.extensionsRequired.push(t)}},{key:"removeExtension",value:function(t){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t]}},{key:"setDefaultScene",value:function(t){this.json.scene=t}},{key:"addScene",value:function(t){var e=t.nodeIndices;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:e}),this.json.scenes.length-1}},{key:"addNode",value:function(t){var e=t.meshIndex,n=t.matrix;this.json.nodes=this.json.nodes||[];var r={mesh:e};return n&&(r.matrix=n),this.json.nodes.push(r),this.json.nodes.length-1}},{key:"addMesh",value:function(t){var e=t.attributes,n=t.indices,r=t.material,i=t.mode,o=void 0===i?4:i,a={primitives:[{attributes:this._addAttributes(e),mode:o}]};if(n){var s=this._addIndices(n);a.primitives[0].indices=s}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}},{key:"addPointCloud",value:function(t){var e={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(e),this.json.meshes.length-1}},{key:"addImage",value:function(t,e){var n=Object(Pe.a)(t),r=e||(null==n?void 0:n.mimeType),i={bufferView:this.addBufferView(t),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1}},{key:"addBufferView",value:function(t){var e=t.byteLength;Oe(Number.isFinite(e)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);var n={buffer:0,byteOffset:this.byteLength,byteLength:e};return this.byteLength+=Be(e,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}},{key:"addAccessor",value:function(t,e){var n={bufferView:t,type:De(e.size),componentType:e.componentType,count:e.count,max:e.max,min:e.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}},{key:"addBinaryBuffer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:3},n=this.addBufferView(t),r={min:e.min,max:e.max};r.min&&r.max||(r=this._getAccessorMinMax(t,e.size));var i={size:e.size,componentType:Le(t),count:Math.round(t.length/e.size),min:r.min,max:r.max};return this.addAccessor(n,Object.assign(i,e))}},{key:"addTexture",value:function(t){var e={source:t.imageIndex};return this.json.textures=this.json.textures||[],this.json.textures.push(e),this.json.textures.length-1}},{key:"addMaterial",value:function(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}},{key:"createBinaryChunk",value:function(){var t,e;this.gltf.buffers=[];var n,r=this.byteLength,i=new ArrayBuffer(r),o=new Uint8Array(i),a=0,s=Ge(this.sourceBuffers||[]);try{for(s.s();!(n=s.n()).done;){a=ke(n.value,o,a)}}catch(t){s.e(t)}finally{s.f()}null!==(t=this.json)&&void 0!==t&&null!==(e=t.buffers)&&void 0!==e&&e[0]?this.json.buffers[0].byteLength=r:this.json.buffers=[{byteLength:r}],this.gltf.binary=i,this.sourceBuffers=[i]}},{key:"_removeStringFromArray",value:function(t,e){for(var n=!0;n;){var r=t.indexOf(e);r>-1?t.splice(r,1):n=!1}}},{key:"_addAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={};for(var n in t){var r=t[n],i=this._getGltfAttributeName(n),o=this.addBinaryBuffer(r.value,r);e[i]=o}return e}},{key:"_addIndices",value:function(t){return this.addBinaryBuffer(t,{size:1})}},{key:"_getGltfAttributeName",value:function(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}},{key:"_getAccessorMinMax",value:function(t,e){var n={min:null,max:null};if(t.length<e)return n;n.min=[],n.max=[];var r,i=Ge(t.subarray(0,e));try{for(i.s();!(r=i.n()).done;){var o=r.value;n.min.push(o),n.max.push(o)}}catch(t){i.e(t)}finally{i.f()}for(var a=e;a<t.length;a+=e)for(var s=0;s<e;s++)n.min[0+s]=Math.min(n.min[0+s],t[a+s]),n.max[0+s]=Math.max(n.max[0+s],t[a+s]);return n}}]),t}(),We=("undefined"==typeof WebAssembly||S()(WebAssembly),"B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB"),Ke="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",Xe=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),qe=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),Qe={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Ze={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};function Ye(t,e,n,r,i){return $e.apply(this,arguments)}function $e(){return($e=ft()(dt.a.mark((function t(e,n,r,i,o){var a,s,u=arguments;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=u.length>5&&void 0!==u[5]?u[5]:"NONE",t.next=3,tn();case 3:an(s=t.sent,s.exports[Ze[o]],e,n,r,i,s.exports[Qe[a||"NONE"]]);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function tn(){return en.apply(this,arguments)}function en(){return(en=ft()(dt.a.mark((function t(){return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return He||(He=nn()),t.abrupt("return",He);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function nn(){return rn.apply(this,arguments)}function rn(){return(rn=ft()(dt.a.mark((function t(){var e,n;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=We,WebAssembly.validate(Xe)&&(e=Ke,console.log("Warning: meshopt_decoder is using experimental SIMD support")),t.next=4,WebAssembly.instantiate(on(e),{});case 4:return n=t.sent,t.next=7,n.instance.exports.__wasm_call_ctors();case 7:return t.abrupt("return",n.instance);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function on(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;++n){var r=t.charCodeAt(n);e[n]=r>96?r-71:r>64?r-65:r>47?r+4:r>46?63:62}for(var i=0,o=0;o<t.length;++o)e[i++]=e[o]<60?qe[e[o]]:64*(e[o]-60)+e[++o];return e.buffer.slice(0,i)}function an(t,e,n,r,i,o,a){var s=t.exports.sbrk,u=r+3&-4,c=s(u*i),l=s(o.length),f=new Uint8Array(t.exports.memory.buffer);f.set(o,l);var h=e(c,r,i,l,o.length);if(0===h&&a&&a(c,u,i),n.set(f.subarray(c,c+r*i)),s(c-s(0)),0!==h)throw new Error("Malformed buffer data: ".concat(h))}function sn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return un(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return un(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function un(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var cn="EXT_meshopt_compression";function ln(t,e){return fn.apply(this,arguments)}function fn(){return(fn=ft()(dt.a.mark((function t(e,n){var r,i,o,a,s,u;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=new Je(e),null!=n&&null!==(r=n.gltf)&&void 0!==r&&r.decompressMeshes){t.next=3;break}return t.abrupt("return");case 3:o=[],a=sn(e.json.bufferViews||[]);try{for(a.s();!(s=a.n()).done;)u=s.value,o.push(hn(i,u))}catch(t){a.e(t)}finally{a.f()}return t.next=8,Promise.all(o);case 8:i.removeExtension("EXT_meshopt_compression");case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function hn(t,e){return dn.apply(this,arguments)}function dn(){return(dn=ft()(dt.a.mark((function t(e,n){var r,i,o,a,s,u,c,l,f,h,d,p,v,g;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=e.getObjectExtension(n,"EXT_meshopt_compression"))){t.next=9;break}return i=r.byteOffset,o=void 0===i?0:i,a=r.byteLength,s=void 0===a?0:a,u=r.byteStride,c=r.count,l=r.mode,f=r.filter,h=void 0===f?"NONE":f,d=r.buffer,p=e.gltf.buffers[d],v=new Uint8Array(p.arrayBuffer,p.byteOffset+o,s),g=new Uint8Array(e.gltf.buffers[n.buffer].arrayBuffer,n.byteOffset,n.byteLength),t.next=8,Ye(g,c,u,v,l,h);case 8:return t.abrupt("return",g);case 9:return t.abrupt("return",null);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var pn=n(345),vn=["image/png","image/jpeg","image/gif"],gn={};function yn(t){return void 0===gn[t]&&(gn[t]=function(t){switch(t){case"image/webp":return function(){if(!pn.a)return!1;try{return 0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch(t){return!1}}();case"image/svg":return pn.a;default:if(!pn.a){var e=globalThis._parseImageNode;return Boolean(e)&&vn.includes(t)}return!0}}(t)),gn[t]}function mn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return bn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bn(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function bn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var An="EXT_texture_webp";function _n(t,e){var n=new Je(t);if(yn("image/webp")){var r,i=mn(n.json.textures||[]);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=n.getObjectExtension(o,"EXT_texture_webp");a&&(o.source=a.source),n.removeObjectExtension(o,"EXT_texture_webp")}}catch(t){i.e(t)}finally{i.f()}n.removeExtension("EXT_texture_webp")}else if(n.getRequiredExtensions().includes("EXT_texture_webp"))throw new Error("gltf: Required extension ".concat("EXT_texture_webp"," not supported by browser"))}function On(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return wn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wn(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function wn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var xn="KHR_texture_basisu";function Cn(t,e){var n,r=new Je(t),i=On(r.json.textures||[]);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=r.getObjectExtension(o,"KHR_texture_basisu");a&&(o.source=a.source),r.removeObjectExtension(o,"KHR_texture_basisu")}}catch(t){i.e(t)}finally{i.f()}r.removeExtension("KHR_texture_basisu")}var Pn={name:"Draco",id:"draco",module:"draco",shapes:["mesh"],version:"3.2.10",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"===("undefined"==typeof WebAssembly?"undefined":S()(WebAssembly))?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};function Sn(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=t.POSITION?t.POSITION.value:[],u=s&&s.length,c=0;c<u;c+=3){var l=s[c],f=s[c+1],h=s[c+2];e=l<e?l:e,n=f<n?f:n,r=h<r?h:r,i=l>i?l:i,o=f>o?f:o,a=h>a?h:a}return[[e,n,r],[i,o,a]]}function Bn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return kn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kn(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function kn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var En=function(){function t(e,n){f()(this,t),Object(Ce.a)(this,"fields",void 0),Object(Ce.a)(this,"metadata",void 0),function(t,e){if(!t)throw new Error(e||"loader assertion failed.")}(Array.isArray(e)),function(t){var e,n={},r=Bn(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n[i.name]&&console.warn("Schema: duplicated field name",i.name,i),n[i.name]=!0}}catch(t){r.e(t)}finally{r.f()}}(e),this.fields=e,this.metadata=n||new Map}return d()(t,[{key:"compareTo",value:function(t){if(this.metadata!==t.metadata)return!1;if(this.fields.length!==t.fields.length)return!1;for(var e=0;e<this.fields.length;++e)if(!this.fields[e].compareTo(t.fields[e]))return!1;return!0}},{key:"select",value:function(){for(var e=Object.create(null),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var o=0,a=r;o<a.length;o++){var s=a[o];e[s]=!0}var u=this.fields.filter((function(t){return e[t.name]}));return new t(u,this.metadata)}},{key:"selectAt",value:function(){for(var e=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=r.map((function(t){return e.fields[t]})).filter(Boolean);return new t(o,this.metadata)}},{key:"assign",value:function(e){var n,r=this.metadata;if(e instanceof t){var i=e;n=i.fields,r=Tn(Tn(new Map,this.metadata),i.metadata)}else n=e;var o,a=Object.create(null),s=Bn(this.fields);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u.name]=u}}catch(t){s.e(t)}finally{s.f()}var c,l=Bn(n);try{for(l.s();!(c=l.n()).done;){var f=c.value;a[f.name]=f}}catch(t){l.e(t)}finally{l.f()}return new t(Object.values(a),r)}}]),t}();function Tn(t,e){return new Map([].concat(z()(t||new Map),z()(e||new Map)))}var jn,Mn=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map;f()(this,t),Object(Ce.a)(this,"name",void 0),Object(Ce.a)(this,"type",void 0),Object(Ce.a)(this,"nullable",void 0),Object(Ce.a)(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=i}return d()(t,[{key:"typeId",get:function(){return this.type&&this.type.typeId}},{key:"clone",value:function(){return new t(this.name,this.type,this.nullable,this.metadata)}},{key:"compareTo",value:function(t){return this.name===t.name&&this.type===t.type&&this.nullable===t.nullable&&this.metadata===t.metadata}},{key:"toString",value:function(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}]),t}();function In(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=w()(t);if(e){var i=w()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _()(this,n)}}!function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"}(jn||(jn={}));var Rn=function(){function t(){f()(this,t)}return d()(t,[{key:"typeId",get:function(){return jn.NONE}},{key:"compareTo",value:function(t){return this===t}}],[{key:"isNull",value:function(t){return t&&t.typeId===jn.Null}},{key:"isInt",value:function(t){return t&&t.typeId===jn.Int}},{key:"isFloat",value:function(t){return t&&t.typeId===jn.Float}},{key:"isBinary",value:function(t){return t&&t.typeId===jn.Binary}},{key:"isUtf8",value:function(t){return t&&t.typeId===jn.Utf8}},{key:"isBool",value:function(t){return t&&t.typeId===jn.Bool}},{key:"isDecimal",value:function(t){return t&&t.typeId===jn.Decimal}},{key:"isDate",value:function(t){return t&&t.typeId===jn.Date}},{key:"isTime",value:function(t){return t&&t.typeId===jn.Time}},{key:"isTimestamp",value:function(t){return t&&t.typeId===jn.Timestamp}},{key:"isInterval",value:function(t){return t&&t.typeId===jn.Interval}},{key:"isList",value:function(t){return t&&t.typeId===jn.List}},{key:"isStruct",value:function(t){return t&&t.typeId===jn.Struct}},{key:"isUnion",value:function(t){return t&&t.typeId===jn.Union}},{key:"isFixedSizeBinary",value:function(t){return t&&t.typeId===jn.FixedSizeBinary}},{key:"isFixedSizeList",value:function(t){return t&&t.typeId===jn.FixedSizeList}},{key:"isMap",value:function(t){return t&&t.typeId===jn.Map}},{key:"isDictionary",value:function(t){return t&&t.typeId===jn.Dictionary}}]),t}(),Dn=(Symbol.toStringTag,Symbol.toStringTag,function(t,e){b()(r,t);var n=In(r);function r(t,e){var i;return f()(this,r),i=n.call(this),Object(Ce.a)(v()(i),"isSigned",void 0),Object(Ce.a)(v()(i),"bitWidth",void 0),i.isSigned=t,i.bitWidth=e,i}return d()(r,[{key:"typeId",get:function(){return jn.Int}},{key:e,get:function(){return"Int"}},{key:"toString",value:function(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}]),r}(Rn,Symbol.toStringTag)),Ln=function(t){b()(n,t);var e=In(n);function n(){return f()(this,n),e.call(this,!0,8)}return n}(Dn),Fn=function(t){b()(n,t);var e=In(n);function n(){return f()(this,n),e.call(this,!0,16)}return n}(Dn),Gn=function(t){b()(n,t);var e=In(n);function n(){return f()(this,n),e.call(this,!0,32)}return n}(Dn),Nn=function(t){b()(n,t);var e=In(n);function n(){return f()(this,n),e.call(this,!1,8)}return n}(Dn),Un=function(t){b()(n,t);var e=In(n);function n(){return f()(this,n),e.call(this,!1,16)}return n}(Dn),zn=function(t){b()(n,t);var e=In(n);function n(){return f()(this,n),e.call(this,!1,32)}return n}(Dn),Hn=32,Vn=64,Jn=function(t,e){b()(r,t);var n=In(r);function r(t){var e;return f()(this,r),e=n.call(this),Object(Ce.a)(v()(e),"precision",void 0),e.precision=t,e}return d()(r,[{key:"typeId",get:function(){return jn.Float}},{key:e,get:function(){return"Float"}},{key:"toString",value:function(){return"Float".concat(this.precision)}}]),r}(Rn,Symbol.toStringTag),Wn=function(t){b()(n,t);var e=In(n);function n(){return f()(this,n),e.call(this,Hn)}return n}(Jn),Kn=function(t){b()(n,t);var e=In(n);function n(){return f()(this,n),e.call(this,Vn)}return n}(Jn),Xn=(Symbol.toStringTag,Symbol.toStringTag,{DAY:0,MILLISECOND:1}),qn=(Symbol.toStringTag,{SECOND:1,MILLISECOND:1e3,MICROSECOND:1e6,NANOSECOND:1e9}),Qn=(Symbol.toStringTag,Symbol.toStringTag,{DAY_TIME:0,YEAR_MONTH:1}),Zn=(Symbol.toStringTag,function(t,e){b()(r,t);var n=In(r);function r(t,e){var i;return f()(this,r),i=n.call(this),Object(Ce.a)(v()(i),"listSize",void 0),Object(Ce.a)(v()(i),"children",void 0),i.listSize=t,i.children=[e],i}return d()(r,[{key:"typeId",get:function(){return jn.FixedSizeList}},{key:"valueType",get:function(){return this.children[0].type}},{key:"valueField",get:function(){return this.children[0]}},{key:e,get:function(){return"FixedSizeList"}},{key:"toString",value:function(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}]),r}(Rn,Symbol.toStringTag));Symbol.toStringTag;function Yn(t,e,n){var r=function(t){switch(t.constructor){case Int8Array:return new Ln;case Uint8Array:return new Nn;case Int16Array:return new Fn;case Uint16Array:return new Un;case Int32Array:return new Gn;case Uint32Array:return new zn;case Float32Array:return new Wn;case Float64Array:return new Kn;default:throw new Error("array type not supported")}}(e.value),i=n||function(t){var e=new Map;"byteOffset"in t&&e.set("byteOffset",t.byteOffset.toString(10));"byteStride"in t&&e.set("byteStride",t.byteStride.toString(10));"normalized"in t&&e.set("normalized",t.normalized.toString());return e}(e);return new Mn(t,new Zn(e.size,new Mn("value",r)),!1,i)}function $n(t,e,n){var r=er(e.metadata),i=[],o=function(t){var e={};for(var n in t){var r=t[n];e[r.name||"undefined"]=r}return e}(e.attributes);for(var a in t){var s=tr(a,t[a],o[a]);i.push(s)}if(n){var u=tr("indices",n);i.push(u)}return new En(i,r)}function tr(t,e,n){return Yn(t,e,n?er(n.metadata):void 0)}function er(t){var e=new Map;for(var n in t)e.set("".concat(n,".string"),JSON.stringify(t[n]));return e}function nr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return rr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rr(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function rr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ir(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function or(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ir(Object(n),!0).forEach((function(e){C()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ir(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ar={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},sr={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},ur=function(){function t(e){f()(this,t),Object(Ce.a)(this,"draco",void 0),Object(Ce.a)(this,"decoder",void 0),Object(Ce.a)(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}return d()(t,[{key:"destroy",value:function(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}},{key:"parseSync",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new this.draco.DecoderBuffer;n.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(e);var r=this.decoder.GetEncodedGeometryType(n),i=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{var o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(n,i);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(n,i);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!i.ptr){var a="DRACO decompression failed: ".concat(o.error_msg());throw new Error(a)}var s=this._getDracoLoaderData(i,r,e),u=this._getMeshData(i,s,e),c=Sn(u.attributes),l=$n(u.attributes,s,u.indices),f=or(or({loader:"draco",loaderData:s,header:{vertexCount:i.num_points(),boundingBox:c}},u),{},{schema:l});return f}finally{this.draco.destroy(n),i&&this.draco.destroy(i)}}},{key:"_getDracoLoaderData",value:function(t,e,n){var r=this._getTopLevelMetadata(t),i=this._getDracoAttributes(t,n);return{geometry_type:e,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:r,attributes:i}}},{key:"_getDracoAttributes",value:function(t,e){for(var n={},r=0;r<t.num_attributes();r++){var i=this.decoder.GetAttribute(t,r),o=this._getAttributeMetadata(t,r);n[i.unique_id()]={unique_id:i.unique_id(),attribute_type:i.attribute_type(),data_type:i.data_type(),num_components:i.num_components(),byte_offset:i.byte_offset(),byte_stride:i.byte_stride(),normalized:i.normalized(),attribute_index:r,metadata:o};var a=this._getQuantizationTransform(i,e);a&&(n[i.unique_id()].quantization_transform=a);var s=this._getOctahedronTransform(i,e);s&&(n[i.unique_id()].octahedron_transform=s)}return n}},{key:"_getMeshData",value:function(t,e,n){var r=this._getMeshAttributes(e,t,n);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(t instanceof this.draco.Mesh)switch(n.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(t),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(t),size:1}}}return{topology:"point-list",mode:0,attributes:r}}},{key:"_getMeshAttributes",value:function(t,e,n){for(var r={},i=0,o=Object.values(t.attributes);i<o.length;i++){var a=o[i],s=this._deduceAttributeName(a,n);a.name=s;var u=this._getAttributeValues(e,a),c=u.value,l=u.size;r[s]={value:c,size:l,byteOffset:a.byte_offset,byteStride:a.byte_stride,normalized:a.normalized}}return r}},{key:"_getTriangleListIndices",value:function(t){var e=3*t.num_faces(),n=4*e,r=this.draco._malloc(n);try{return this.decoder.GetTrianglesUInt32Array(t,n,r),new Uint32Array(this.draco.HEAPF32.buffer,r,e).slice()}finally{this.draco._free(r)}}},{key:"_getTriangleStripIndices",value:function(t){var e=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,e),function(t){for(var e=t.size(),n=new Int32Array(e),r=0;r<e;r++)n[r]=t.GetValue(r);return n}(e)}finally{this.draco.destroy(e)}}},{key:"_getAttributeValues",value:function(t,e){var n,r=sr[e.data_type],i=e.num_components,o=t.num_points()*i,a=o*r.BYTES_PER_ELEMENT,s=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}(this.draco,r),u=this.draco._malloc(a);try{var c=this.decoder.GetAttribute(t,e.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,c,s,a,u),n=new r(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:n,size:i}}},{key:"_deduceAttributeName",value:function(t,e){for(var n=t.unique_id,r=0,i=Object.entries(e.extraAttributes||{});r<i.length;r++){var o=vt()(i[r],2),a=o[0];if(o[1]===n)return a}var s=t.attribute_type;for(var u in ar){if(this.draco[u]===s)return ar[u]}var c=e.attributeNameEntry||"name";return t.metadata[c]?t.metadata[c].string:"CUSTOM_ATTRIBUTE_".concat(n)}},{key:"_getTopLevelMetadata",value:function(t){var e=this.decoder.GetMetadata(t);return this._getDracoMetadata(e)}},{key:"_getAttributeMetadata",value:function(t,e){var n=this.decoder.GetAttributeMetadata(t,e);return this._getDracoMetadata(n)}},{key:"_getDracoMetadata",value:function(t){if(!t||!t.ptr)return{};for(var e={},n=this.metadataQuerier.NumEntries(t),r=0;r<n;r++){var i=this.metadataQuerier.GetEntryName(t,r);e[i]=this._getDracoMetadataField(t,i)}return e}},{key:"_getDracoMetadataField",value:function(t,e){var n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,e,n);var r=function(t){for(var e=t.size(),n=new Int32Array(e),r=0;r<e;r++)n[r]=t.GetValue(r);return n}(n);return{int:this.metadataQuerier.GetIntEntry(t,e),string:this.metadataQuerier.GetStringEntry(t,e),double:this.metadataQuerier.GetDoubleEntry(t,e),intArray:r}}finally{this.draco.destroy(n)}}},{key:"_disableAttributeTransforms",value:function(t){var e,n=t.quantizedAttributes,r=void 0===n?[]:n,i=t.octahedronAttributes,o=void 0===i?[]:i,a=nr([].concat(z()(r),z()(o)));try{for(a.s();!(e=a.n()).done;){var s=e.value;this.decoder.SkipAttributeTransform(this.draco[s])}}catch(t){a.e(t)}finally{a.f()}}},{key:"_getQuantizationTransform",value:function(t,e){var n=this,r=e.quantizedAttributes,i=void 0===r?[]:r,o=t.attribute_type();if(i.map((function(t){return n.decoder[t]})).includes(o)){var a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(t))return{quantization_bits:a.quantization_bits(),range:a.range(),min_values:new Float32Array([1,2,3]).map((function(t){return a.min_value(t)}))}}finally{this.draco.destroy(a)}}return null}},{key:"_getOctahedronTransform",value:function(t,e){var n=this,r=e.octahedronAttributes,i=void 0===r?[]:r,o=t.attribute_type();if(i.map((function(t){return n.decoder[t]})).includes(o)){var a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(t))return{quantization_bits:a.quantization_bits()}}finally{this.draco.destroy(a)}}return null}}]),t}();function cr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function lr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?cr(Object(n),!0).forEach((function(e){C()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var fr,hr="https://www.gstatic.com/draco/versioned/decoders/".concat("1.4.1","/draco_decoder.js"),dr="https://www.gstatic.com/draco/versioned/decoders/".concat("1.4.1","/draco_wasm_wrapper.js"),pr="https://www.gstatic.com/draco/versioned/decoders/".concat("1.4.1","/draco_decoder.wasm");"https://raw.githubusercontent.com/google/draco/".concat("1.4.1","/javascript/draco_encoder.js");function vr(t){return gr.apply(this,arguments)}function gr(){return(gr=ft()(dt.a.mark((function t(e){var n;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.modules||{},fr=n.draco3d?fr||n.draco3d.createDecoderModule({}).then((function(t){return{draco:t}})):fr||yr(e),t.next=4,fr;case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function yr(t){return mr.apply(this,arguments)}function mr(){return(mr=ft()(dt.a.mark((function t(e){var n,r,i,o;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.draco&&e.draco.decoderType,t.next="js"===t.t0?3:(t.t0,7);break;case 3:return t.next=5,wt(hr,"draco",e);case 5:return n=t.sent,t.abrupt("break",21);case 7:return t.t1=Promise,t.next=10,wt(dr,"draco",e);case 10:return t.t2=t.sent,t.next=13,wt(pr,"draco",e);case 13:return t.t3=t.sent,t.t4=[t.t2,t.t3],t.next=17,t.t1.all.call(t.t1,t.t4);case 17:i=t.sent,o=vt()(i,2),n=o[0],r=o[1];case 21:return n=n||globalThis.DracoDecoderModule,t.next=24,br(n,r);case 24:return t.abrupt("return",t.sent);case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function br(t,e){var n={};return e&&(n.wasmBinary=e),new Promise((function(e){t(lr(lr({},n),{},{onModuleLoaded:function(t){return e({draco:t})}}))}))}function Ar(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ar(Object(n),!0).forEach((function(e){C()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ar(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Or=_r(_r({},Pn),{},{parse:function(t,e){return wr.apply(this,arguments)}});function wr(){return(wr=ft()(dt.a.mark((function t(e,n){var r,i,o;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,vr(n);case 2:return r=t.sent,i=r.draco,o=new ur(i),t.prev=5,t.abrupt("return",o.parseSync(e,null==n?void 0:n.draco));case 7:return t.prev=7,o.destroy(),t.finish(7);case 10:case"end":return t.stop()}}),t,null,[[5,,7,10]])})))).apply(this,arguments)}function xr(t){var e={};for(var n in t){var r=t[n];if("indices"!==n){var i=Cr(r);e[n]=i}}return e}function Cr(t){var e=function(t){var e=t,n=1,r=0;t&&t.value&&(e=t.value,n=t.size||1);e&&(ArrayBuffer.isView(e)||(e=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return null;if(Array.isArray(t))return new e(t);if(n&&!(t instanceof e))return new e(t);return t}(e,Float32Array)),r=e.length/n);return{buffer:e,size:n,count:r}}(t),n=e.buffer,r=e.size;return{value:n,size:r,byteOffset:0,count:e.count,type:De(r),componentType:Le(n)}}function Pr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Sr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pr(Object(n),!0).forEach((function(e){C()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Br=dt.a.mark(Nr);function kr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Er(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Er(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Er(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Tr="KHR_draco_mesh_compression";function jr(t,e,n){var r,i=new Je(t),o=kr(Nr(i));try{for(o.s();!(r=o.n()).done;){var a=r.value;i.getObjectExtension(a,"KHR_draco_mesh_compression")}}catch(t){o.e(t)}finally{o.f()}}function Mr(t,e,n){return Ir.apply(this,arguments)}function Ir(){return(Ir=ft()(dt.a.mark((function t(e,n,r){var i,o,a,s,u,c;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n&&null!==(i=n.gltf)&&void 0!==i&&i.decompressMeshes){t.next=2;break}return t.abrupt("return");case 2:o=new Je(e),a=[],s=kr(Nr(o));try{for(s.s();!(u=s.n()).done;)c=u.value,o.getObjectExtension(c,"KHR_draco_mesh_compression")&&a.push(Dr(o,c,n,r))}catch(t){s.e(t)}finally{s.f()}return t.next=8,Promise.all(a);case 8:o.removeExtension("KHR_draco_mesh_compression");case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Rr(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new Je(t),i=kr(r.json.meshes||[]);try{for(i.s();!(e=i.n()).done;){var o=e.value;Fr(o,n),r.addRequiredExtension("KHR_draco_mesh_compression")}}catch(t){i.e(t)}finally{i.f()}}function Dr(t,e,n,r){return Lr.apply(this,arguments)}function Lr(){return(Lr=ft()(dt.a.mark((function t(e,n,r,i){var o,a,s,u,c,l,f,h,d,p,v,g,y,m;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.getObjectExtension(n,"KHR_draco_mesh_compression")){t.next=3;break}return t.abrupt("return");case 3:return a=e.getTypedArrayForBufferView(o.bufferView),s=_e(a.buffer,a.byteOffset),u=i.parse,delete(c=Sr({},r))["3d-tiles"],t.next=10,u(s,Or,c,i);case 10:for(l=t.sent,f=xr(l.attributes),h=0,d=Object.entries(f);h<d.length;h++)p=vt()(d[h],2),v=p[0],g=p[1],v in n.attributes&&(y=n.attributes[v],null!=(m=e.getAccessor(y))&&m.min&&null!=m&&m.max&&(g.min=m.min,g.max=m.max));n.attributes=f,l.indices&&(n.indices=Cr(l.indices)),Gr(n);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Fr(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");var a=i.DracoWriter.encodeSync({attributes:t}),s=null==o?void 0:null===(n=o.parseSync)||void 0===n?void 0:n.call(o,{attributes:t}),u=i._addFauxAttributes(s.attributes),c=i.addBufferView(a),l={primitives:[{attributes:u,mode:r,extensions:C()({},"KHR_draco_mesh_compression",{bufferView:c,attributes:u})}]};return l}function Gr(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function Nr(t){var e,n,r,i,o,a;return dt.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e=kr(t.json.meshes||[]),s.prev=1,e.s();case 3:if((n=e.n()).done){s.next=24;break}r=n.value,i=kr(r.primitives),s.prev=6,i.s();case 8:if((o=i.n()).done){s.next=14;break}return a=o.value,s.next=12,a;case 12:s.next=8;break;case 14:s.next=19;break;case 16:s.prev=16,s.t0=s.catch(6),i.e(s.t0);case 19:return s.prev=19,i.f(),s.finish(19);case 22:s.next=3;break;case 24:s.next=29;break;case 26:s.prev=26,s.t1=s.catch(1),e.e(s.t1);case 29:return s.prev=29,e.f(),s.finish(29);case 32:case"end":return s.stop()}}),Br,null,[[1,26,29,32],[6,16,19,22]])}function Ur(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return zr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zr(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function zr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Hr="KHR_lights_punctual";function Vr(t){return Jr.apply(this,arguments)}function Jr(){return(Jr=ft()(dt.a.mark((function t(e){var n,r,i,o,a,s,u;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new Je(e),r=n.json,(i=n.getExtension("KHR_lights_punctual"))&&(n.json.lights=i.lights,n.removeExtension("KHR_lights_punctual")),o=Ur(r.nodes||[]);try{for(o.s();!(a=o.n()).done;)s=a.value,(u=n.getObjectExtension(s,"KHR_lights_punctual"))&&(s.light=u.light),n.removeObjectExtension(s,"KHR_lights_punctual")}catch(t){o.e(t)}finally{o.f()}case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Wr(t){return Kr.apply(this,arguments)}function Kr(){return(Kr=ft()(dt.a.mark((function t(e){var n,r,i,o,a,s,u;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=new Je(e),(r=n.json).lights&&(Oe(!(i=n.addExtension("KHR_lights_punctual")).lights),i.lights=r.lights,delete r.lights),n.json.lights){o=Ur(n.json.lights);try{for(o.s();!(a=o.n()).done;)s=a.value,u=s.node,n.addObjectExtension(u,"KHR_lights_punctual",s)}catch(t){o.e(t)}finally{o.f()}delete n.json.lights}case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Xr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return qr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qr(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function qr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Qr="KHR_materials_unlit";function Zr(t){return Yr.apply(this,arguments)}function Yr(){return(Yr=ft()(dt.a.mark((function t(e){var n,r,i,o,a;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new Je(e),r=n.json,n.removeExtension("KHR_materials_unlit"),i=Xr(r.materials||[]);try{for(i.s();!(o=i.n()).done;)a=o.value,a.extensions&&a.extensions.KHR_materials_unlit&&(a.unlit=!0),n.removeObjectExtension(a,"KHR_materials_unlit")}catch(t){i.e(t)}finally{i.f()}case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $r(t){var e=new Je(t),n=e.json;if(e.materials){var r,i=Xr(n.materials||[]);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.unlit&&(delete o.unlit,e.addObjectExtension(o,"KHR_materials_unlit",{}),e.addExtension("KHR_materials_unlit"))}}catch(t){i.e(t)}finally{i.f()}}}function ti(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ei(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ei(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ei(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var ni="KHR_techniques_webgl";function ri(t){return ii.apply(this,arguments)}function ii(){return(ii=ft()(dt.a.mark((function t(e){var n,r,i,o,a,s,u,c;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=new Je(e),r=n.json,i=n.getExtension("KHR_techniques_webgl")){o=si(i,n),a=ti(r.materials||[]);try{for(a.s();!(s=a.n()).done;)u=s.value,(c=n.getObjectExtension(u,"KHR_techniques_webgl"))&&(u.technique=Object.assign({},c,o[c.technique]),u.technique.values=ui(u.technique,n)),n.removeObjectExtension(u,"KHR_techniques_webgl")}catch(t){a.e(t)}finally{a.f()}n.removeExtension("KHR_techniques_webgl")}case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function oi(t,e){return ai.apply(this,arguments)}function ai(){return(ai=ft()(dt.a.mark((function t(e,n){return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function si(t,e){var n=t.programs,r=void 0===n?[]:n,i=t.shaders,o=void 0===i?[]:i,a=t.techniques,s=void 0===a?[]:a,u=new TextDecoder;return o.forEach((function(t){if(!Number.isFinite(t.bufferView))throw new Error("KHR_techniques_webgl: no shader code");t.code=u.decode(e.getTypedArrayForBufferView(t.bufferView))})),r.forEach((function(t){t.fragmentShader=o[t.fragmentShader],t.vertexShader=o[t.vertexShader]})),s.forEach((function(t){t.program=r[t.program]})),s}function ui(t,e){var n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach((function(e){!t.uniforms[e].value||e in n||(n[e]=t.uniforms[e].value)})),Object.keys(n).forEach((function(t){"object"===S()(n[t])&&void 0!==n[t].index&&(n[t].texture=e.getTexture(n[t].index))})),n}function ci(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return li(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return li(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function li(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var fi=[r,i,o,a,s,u,c];function hi(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=fi.filter((function(t){return vi(t.name,n)})),o=ci(i);try{for(o.s();!(e=o.n()).done;){var a,s=e.value;null===(a=s.preprocess)||void 0===a||a.call(s,t,n,r)}}catch(t){o.e(t)}finally{o.f()}}function di(t){return pi.apply(this,arguments)}function pi(){return(pi=ft()(dt.a.mark((function t(e){var n,r,i,o,a,s,u,c=arguments;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=c.length>1&&void 0!==c[1]?c[1]:{},r=c.length>2?c[2]:void 0,i=fi.filter((function(t){return vi(t.name,n)})),o=ci(i),t.prev=4,o.s();case 6:if((a=o.n()).done){t.next=12;break}return s=a.value,t.next=10,null===(u=s.decode)||void 0===u?void 0:u.call(s,e,n,r);case 10:t.next=6;break;case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(4),o.e(t.t0);case 17:return t.prev=17,o.f(),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[4,14,17,20]])})))).apply(this,arguments)}function vi(t,e){var n,r=(null==e?void 0:null===(n=e.gltf)||void 0===n?void 0:n.excludeExtensions)||{};return!(t in r&&!r[t])}function gi(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return yi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yi(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function yi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function mi(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return bi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bi(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function bi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ai,_i={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},Oi={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},wi=function(){function t(){f()(this,t),Object(Ce.a)(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),Object(Ce.a)(this,"json",void 0)}return d()(t,[{key:"normalize",value:function(t,e){this.json=t.json;var n=t.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version ".concat(n.asset.version))}if(!e.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(t){var e,n=new Je(t),r=n.json,i=gi(r.images||[]);try{for(i.s();!(e=i.n()).done;){var o=e.value,a=n.getObjectExtension(o,"KHR_binary_glTF");a&&Object.assign(o,a),n.removeObjectExtension(o,"KHR_binary_glTF")}}catch(t){i.e(t)}finally{i.f()}r.buffers&&r.buffers[0]&&delete r.buffers[0].uri,n.removeExtension("KHR_binary_glTF")}(t),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}},{key:"_addAsset",value:function(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}},{key:"_convertTopLevelObjectsToArrays",value:function(t){for(var e in _i)this._convertTopLevelObjectToArray(t,e)}},{key:"_convertTopLevelObjectToArray",value:function(t,e){var n=t[e];if(n&&!Array.isArray(n))for(var r in t[e]=[],n){var i=n[r];i.id=i.id||r;var o=t[e].length;t[e].push(i),this.idToIndexMap[e][r]=o}}},{key:"_convertObjectIdsToArrayIndices",value:function(t){for(var e in _i)this._convertIdsToIndices(t,e);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));var n,r=mi(t.textures);try{for(r.s();!(n=r.n()).done;){var i=n.value;this._convertTextureIds(i)}}catch(t){r.e(t)}finally{r.f()}var o,a=mi(t.meshes);try{for(a.s();!(o=a.n()).done;){var s=o.value;this._convertMeshIds(s)}}catch(t){a.e(t)}finally{a.f()}var u,c=mi(t.nodes);try{for(c.s();!(u=c.n()).done;){var l=u.value;this._convertNodeIds(l)}}catch(t){c.e(t)}finally{c.f()}var f,h=mi(t.scenes);try{for(h.s();!(f=h.n()).done;){var d=f.value;this._convertSceneIds(d)}}catch(t){h.e(t)}finally{h.f()}}},{key:"_convertTextureIds",value:function(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}},{key:"_convertMeshIds",value:function(t){var e,n=mi(t.primitives);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=r.attributes,o=r.indices,a=r.material;for(var s in i)i[s]=this._convertIdToIndex(i[s],"accessor");o&&(r.indices=this._convertIdToIndex(o,"accessor")),a&&(r.material=this._convertIdToIndex(a,"material"))}}catch(t){n.e(t)}finally{n.f()}}},{key:"_convertNodeIds",value:function(t){var e=this;t.children&&(t.children=t.children.map((function(t){return e._convertIdToIndex(t,"node")}))),t.meshes&&(t.meshes=t.meshes.map((function(t){return e._convertIdToIndex(t,"mesh")})))}},{key:"_convertSceneIds",value:function(t){var e=this;t.nodes&&(t.nodes=t.nodes.map((function(t){return e._convertIdToIndex(t,"node")})))}},{key:"_convertIdsToIndices",value:function(t,e){t[e]||(console.warn("gltf v1: json doesn't contain attribute ".concat(e)),t[e]=[]);var n,r=mi(t[e]);try{for(r.s();!(n=r.n()).done;){var i=n.value;for(var o in i){var a=i[o],s=this._convertIdToIndex(a,o);i[o]=s}}}catch(t){r.e(t)}finally{r.f()}}},{key:"_convertIdToIndex",value:function(t,e){var n=Oi[e];if(n in this.idToIndexMap){var r=this.idToIndexMap[n][t];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve ".concat(e," with id ").concat(t));return r}return t}},{key:"_updateObjects",value:function(t){var e,n=mi(this.json.buffers);try{for(n.s();!(e=n.n()).done;){delete e.value.type}}catch(t){n.e(t)}finally{n.f()}}},{key:"_updateMaterial",value:function(t){var e,n=mi(t.materials);try{var r=function(){var n=e.value;n.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};var r=(null===(i=n.values)||void 0===i?void 0:i.tex)||(null===(o=n.values)||void 0===o?void 0:o.texture2d_0)||(null===(a=n.values)||void 0===a?void 0:a.diffuseTex),s=t.textures.findIndex((function(t){return t.id===r}));-1!==s&&(n.pbrMetallicRoughness.baseColorTexture={index:s})};for(n.s();!(e=n.n()).done;){var i,o,a;r()}}catch(t){n.e(t)}finally{n.f()}}}]),t}();function xi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new wi).normalize(t,e)}function Ci(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Pi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ci(Object(n),!0).forEach((function(e){C()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ci(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Si={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Bi={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},ki=10240,Ei=10241,Ti=10242,ji=10243,Mi=10497,Ii=9729,Ri=9986,Di={magFilter:ki,minFilter:Ei,wrapS:Ti,wrapT:ji},Li=(Ai={},C()(Ai,ki,Ii),C()(Ai,Ei,Ri),C()(Ai,Ti,Mi),C()(Ai,ji,Mi),Ai);var Fi=function(){function t(){f()(this,t),Object(Ce.a)(this,"baseUri",""),Object(Ce.a)(this,"json",{}),Object(Ce.a)(this,"buffers",[]),Object(Ce.a)(this,"images",[])}return d()(t,[{key:"postProcess",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.json,r=t.buffers,i=void 0===r?[]:r,o=t.images,a=void 0===o?[]:o,s=t.baseUri,u=void 0===s?"":s;return Oe(n),this.baseUri=u,this.json=n,this.buffers=i,this.images=a,this._resolveTree(this.json,e),this.json}},{key:"_resolveTree",value:function(t){var e=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.bufferViews&&(t.bufferViews=t.bufferViews.map((function(t,n){return e._resolveBufferView(t,n)}))),t.images&&(t.images=t.images.map((function(t,n){return e._resolveImage(t,n)}))),t.samplers&&(t.samplers=t.samplers.map((function(t,n){return e._resolveSampler(t,n)}))),t.textures&&(t.textures=t.textures.map((function(t,n){return e._resolveTexture(t,n)}))),t.accessors&&(t.accessors=t.accessors.map((function(t,n){return e._resolveAccessor(t,n)}))),t.materials&&(t.materials=t.materials.map((function(t,n){return e._resolveMaterial(t,n)}))),t.meshes&&(t.meshes=t.meshes.map((function(t,n){return e._resolveMesh(t,n)}))),t.nodes&&(t.nodes=t.nodes.map((function(t,n){return e._resolveNode(t,n)}))),t.skins&&(t.skins=t.skins.map((function(t,n){return e._resolveSkin(t,n)}))),t.scenes&&(t.scenes=t.scenes.map((function(t,n){return e._resolveScene(t,n)}))),void 0!==t.scene&&(t.scene=t.scenes[this.json.scene])}},{key:"getScene",value:function(t){return this._get("scenes",t)}},{key:"getNode",value:function(t){return this._get("nodes",t)}},{key:"getSkin",value:function(t){return this._get("skins",t)}},{key:"getMesh",value:function(t){return this._get("meshes",t)}},{key:"getMaterial",value:function(t){return this._get("materials",t)}},{key:"getAccessor",value:function(t){return this._get("accessors",t)}},{key:"getCamera",value:function(t){return null}},{key:"getTexture",value:function(t){return this._get("textures",t)}},{key:"getSampler",value:function(t){return this._get("samplers",t)}},{key:"getImage",value:function(t){return this._get("images",t)}},{key:"getBufferView",value:function(t){return this._get("bufferViews",t)}},{key:"getBuffer",value:function(t){return this._get("buffers",t)}},{key:"_get",value:function(t,e){if("object"===S()(e))return e;var n=this.json[t]&&this.json[t][e];return n||console.warn("glTF file error: Could not find ".concat(t,"[").concat(e,"]")),n}},{key:"_resolveScene",value:function(t,e){var n=this;return t.id=t.id||"scene-".concat(e),t.nodes=(t.nodes||[]).map((function(t){return n.getNode(t)})),t}},{key:"_resolveNode",value:function(t,e){var n=this;return t.id=t.id||"node-".concat(e),t.children&&(t.children=t.children.map((function(t){return n.getNode(t)}))),void 0!==t.mesh?t.mesh=this.getMesh(t.mesh):void 0!==t.meshes&&t.meshes.length&&(t.mesh=t.meshes.reduce((function(t,e){var r=n.getMesh(e);return t.id=r.id,t.primitives=t.primitives.concat(r.primitives),t}),{primitives:[]})),void 0!==t.camera&&(t.camera=this.getCamera(t.camera)),void 0!==t.skin&&(t.skin=this.getSkin(t.skin)),t}},{key:"_resolveSkin",value:function(t,e){return t.id=t.id||"skin-".concat(e),t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}},{key:"_resolveMesh",value:function(t,e){var n=this;return t.id=t.id||"mesh-".concat(e),t.primitives&&(t.primitives=t.primitives.map((function(t){var e=(t=Pi({},t)).attributes;for(var r in t.attributes={},e)t.attributes[r]=n.getAccessor(e[r]);return void 0!==t.indices&&(t.indices=n.getAccessor(t.indices)),void 0!==t.material&&(t.material=n.getMaterial(t.material)),t}))),t}},{key:"_resolveMaterial",value:function(t,e){if(t.id=t.id||"material-".concat(e),t.normalTexture&&(t.normalTexture=Pi({},t.normalTexture),t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture=Pi({},t.occlustionTexture),t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture=Pi({},t.emmisiveTexture),t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.emissiveFactor||(t.emissiveFactor=t.emmisiveTexture?[1,1,1]:[0,0,0]),t.pbrMetallicRoughness){t.pbrMetallicRoughness=Pi({},t.pbrMetallicRoughness);var n=t.pbrMetallicRoughness;n.baseColorTexture&&(n.baseColorTexture=Pi({},n.baseColorTexture),n.baseColorTexture.texture=this.getTexture(n.baseColorTexture.index)),n.metallicRoughnessTexture&&(n.metallicRoughnessTexture=Pi({},n.metallicRoughnessTexture),n.metallicRoughnessTexture.texture=this.getTexture(n.metallicRoughnessTexture.index))}return t}},{key:"_resolveAccessor",value:function(t,e){var n,r;if(t.id=t.id||"accessor-".concat(e),void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=(n=t.componentType,Bi[n]),t.components=(r=t.type,Si[r]),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){var i=t.bufferView.buffer,o=Fe(t,t.bufferView),a=o.ArrayType,s=o.byteLength,u=(t.bufferView.byteOffset||0)+(t.byteOffset||0)+i.byteOffset,c=i.arrayBuffer.slice(u,u+s);t.bufferView.byteStride&&(c=this._getValueFromInterleavedBuffer(i,u,t.bufferView.byteStride,t.bytesPerElement,t.count)),t.value=new a(c)}return t}},{key:"_getValueFromInterleavedBuffer",value:function(t,e,n,r,i){for(var o=new Uint8Array(i*r),a=0;a<i;a++){var s=e+a*n;o.set(new Uint8Array(t.arrayBuffer.slice(s,s+r)),a*r)}return o.buffer}},{key:"_resolveTexture",value:function(t,e){return t.id=t.id||"texture-".concat(e),t.sampler="sampler"in t?this.getSampler(t.sampler):Li,t.source=this.getImage(t.source),t}},{key:"_resolveSampler",value:function(t,e){for(var n in t.id=t.id||"sampler-".concat(e),t.parameters={},t){var r=this._enumSamplerParameter(n);void 0!==r&&(t.parameters[r]=t[n])}return t}},{key:"_enumSamplerParameter",value:function(t){return Di[t]}},{key:"_resolveImage",value:function(t,e){t.id=t.id||"image-".concat(e),void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView));var n=this.images[e];return n&&(t.image=n),t}},{key:"_resolveBufferView",value:function(t,e){var n=t.buffer,r=Pi(Pi({id:"bufferView-".concat(e)},t),{},{buffer:this.buffers[n]}),i=this.buffers[n].arrayBuffer,o=this.buffers[n].byteOffset||0;return"byteOffset"in t&&(o+=t.byteOffset),r.data=new Uint8Array(i,o,t.byteLength),r}},{key:"_resolveCamera",value:function(t,e){return t.id=t.id||"camera-".concat(e),t.perspective,t.orthographic,t}}]),t}();function Gi(t,e){return(new Fi).postProcess(t,e)}function Ni(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(String.fromCharCode(t.getUint8(e+0))).concat(String.fromCharCode(t.getUint8(e+1))).concat(String.fromCharCode(t.getUint8(e+2))).concat(String.fromCharCode(t.getUint8(e+3)))}function Ui(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new DataView(t),i=n.magic,o=void 0===i?1735152710:i,a=r.getUint32(e,!1);return a===o||1735152710===a}function zi(t,e,n){Object(Se.a)(t.header.byteLength>20);var r=e.getUint32(n+0,!0),i=e.getUint32(n+4,!0);return n+=8,Object(Se.a)(0===i),Vi(t,e,n,r),n+=r,n+=Ji(t,e,n,t.header.byteLength)}function Hi(t,e,n,r){return Object(Se.a)(t.header.byteLength>20),function(t,e,n,r){for(;n+8<=t.header.byteLength;){var i=e.getUint32(n+0,!0),o=e.getUint32(n+4,!0);switch(n+=8,o){case 1313821514:Vi(t,e,n,i);break;case 5130562:Ji(t,e,n,i);break;case 0:r.strict||Vi(t,e,n,i);break;case 1:r.strict||Ji(t,e,n,i)}n+=Be(i,4)}}(t,e,n,r),n+t.header.byteLength}function Vi(t,e,n,r){var i=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(i);return t.json=JSON.parse(o),Be(r,4)}function Ji(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),Be(r,4)}function Wi(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ki(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ki(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ki(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Xi(t,e){return qi.apply(this,arguments)}function qi(){return(qi=ft()(dt.a.mark((function t(e,n){var r,i,o,a,s,u,c,l,f,h,d=arguments;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=d.length>2&&void 0!==d[2]?d[2]:0,i=d.length>3?d[3]:void 0,o=d.length>4?d[4]:void 0,Qi(e,n,r,i),xi(e,{normalize:null==i?void 0:null===(a=i.gltf)||void 0===a?void 0:a.normalize}),hi(e,i,o),l=[],null==i||null===(s=i.gltf)||void 0===s||!s.loadBuffers||!e.json.buffers){t.next=10;break}return t.next=10,Zi(e,i,o);case 10:return null!=i&&null!==(u=i.gltf)&&void 0!==u&&u.loadImages&&(f=$i(e,i,o),l.push(f)),h=di(e,i,o),l.push(h),t.next=15,Promise.all(l);case 15:return t.abrupt("return",null!=i&&null!==(c=i.gltf)&&void 0!==c&&c.postProcess?Gi(e,i):e);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Qi(t,e,n,r){(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!Ui(e,n,r))&&(e=(new TextDecoder).decode(e));if("string"==typeof e)t.json=Ae(e);else if(e instanceof ArrayBuffer){var i={};n=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],new DataView(e)),i=Ni(r,n+0),o=r.getUint32(n+4,!0),a=r.getUint32(n+8,!0);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:i,version:o,json:{},binChunks:[]}),n+=12,t.version){case 1:return zi(t,r,n);case 2:return Hi(t,r,n,{});default:throw new Error("Invalid GLB version ".concat(t.version,". Only supports v1 and v2."))}}(i,e,n,r.glb),Oe("glTF"===i.type,"Invalid GLB magic string ".concat(i.type)),t._glb=i,t.json=i.json}else Oe(!1,"GLTF: must be ArrayBuffer or string");var o=t.json.buffers||[];if(t.buffers=new Array(o.length).fill(null),t._glb&&t._glb.header.hasBinChunk){var a=t._glb.binChunks;t.buffers[0]={arrayBuffer:a[0].arrayBuffer,byteOffset:a[0].byteOffset,byteLength:a[0].byteLength}}var s=t.json.images||[];t.images=new Array(s.length).fill({})}function Zi(t,e,n){return Yi.apply(this,arguments)}function Yi(){return(Yi=ft()(dt.a.mark((function t(e,n,r){var i,o,a,s,u,c,l,f;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.json.buffers||[],o=0;case 2:if(!(o<i.length)){t.next=22;break}if(!(a=i[o]).uri){t.next=18;break}return Oe(r.fetch),c=we(a.uri,n),t.next=10,null==r?void 0:null===(s=r.fetch)||void 0===s?void 0:s.call(r,c);case 10:return l=t.sent,t.next=13,null==l?void 0:null===(u=l.arrayBuffer)||void 0===u?void 0:u.call(l);case 13:f=t.sent,e.buffers[o]={arrayBuffer:f,byteOffset:0,byteLength:f.byteLength},delete a.uri,t.next=19;break;case 18:null===e.buffers[o]&&(e.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength});case 19:++o,t.next=2;break;case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $i(t,e,n){return to.apply(this,arguments)}function to(){return(to=ft()(dt.a.mark((function t(e,n,r){var i,o,a,s,u,c;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=eo(e),o=e.json.images||[],a=[],s=Wi(i);try{for(s.s();!(u=s.n()).done;)c=u.value,a.push(no(e,o[c],c,n,r))}catch(t){s.e(t)}finally{s.f()}return t.next=7,Promise.all(a);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function eo(t){var e,n=new Set,r=Wi(t.json.textures||[]);try{for(r.s();!(e=r.n()).done;){var i=e.value;void 0!==i.source&&n.add(i.source)}}catch(t){r.e(t)}finally{r.f()}return Array.from(n).sort()}function no(t,e,n,r,i){return ro.apply(this,arguments)}function ro(){return(ro=ft()(dt.a.mark((function t(e,n,r,i,o){var a,s,u,c,l,f,h;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=o.fetch,s=o.parse,!n.uri||n.hasOwnProperty("bufferView")){t.next=9;break}return c=we(n.uri,i),t.next=5,a(c);case 5:return l=t.sent,t.next=8,l.arrayBuffer();case 8:u=t.sent;case 9:return Number.isFinite(n.bufferView)&&(f=xe(e.json,e.buffers,n.bufferView),u=_e(f.buffer,f.byteOffset,f.byteLength)),Oe(u,"glTF image has no data"),t.next=13,s(u,[me.a,ye],{mimeType:n.mimeType,basis:i.basis||{format:de()}},o);case 13:(h=t.sent)&&h[0]&&(h={compressed:!0,mipmaps:!1,width:h[0].width,height:h[0].height,data:h[0]}),e.images=e.images||[],e.images[r]=h;case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function io(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function oo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?io(Object(n),!0).forEach((function(e){C()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):io(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ao={name:"glTF",id:"gltf",module:"gltf",version:"3.2.10",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(t){return so.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function so(){return(so=ft()(dt.a.mark((function t(e){var n,r,i,o,a,s=arguments;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=s.length>2?s[2]:void 0,(n=oo(oo({},ao.options),n)).gltf=oo(oo({},ao.options.gltf),n.gltf),i=n.byteOffset,o=void 0===i?0:i,a={},t.next=8,Xi(a,e,o,n,r);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function uo(){return(uo=ft()(dt.a.mark((function t(e){var n;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],e.scenes.forEach((function(t){t.traverse((function(t){Object.values(t.model.getUniforms()).forEach((function(t){!1===t.loaded&&n.push(t)}))}))})),t.next=4,co((function(){return n.some((function(t){return!t.loaded}))}));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function co(t){return lo.apply(this,arguments)}function lo(){return(lo=ft()(dt.a.mark((function t(e){return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e()){t.next=5;break}return t.next=3,new Promise((function(t){return requestAnimationFrame(t)}));case 3:t.next=0;break;case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var fo=n(143);function ho(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function po(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ho(Object(n),!0).forEach((function(e){C()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ho(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function vo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=w()(t);if(e){var i=w()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _()(this,n)}}n.d(e,"a",(function(){return mo}));var go=[255,255,255,255],yo={scenegraph:{type:"object",value:null,async:!0},getScene:function(t){return t&&t.scenes?"object"===S()(t.scene)?t.scene:t.scenes[t.scene||0]:t},getAnimator:function(t){return t&&t.animator},_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:function(t){return t.position}},getColor:{type:"accessor",value:go},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[ao]},mo=function(t){b()(n,t);var e=vo(n);function n(){var t;f()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),C()(v()(t),"state",void 0),t}return d()(n,[{key:"getShaders",value:function(){var t=[B.a,k.a];return"pbr"===this.props._lighting&&t.push(M.a),{vs:"#version 300 es\n\n// Instance attributes\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\n\n// Uniforms\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\n\n// Attributes\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\n\n// Varying\nout vec4 vColor;\n\n// MODULE_PBR contains all the varying definitions needed\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\n\n// Main\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  vec3 normal = vec3(0.0, 0.0, 1.0);\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;\n    #endif\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    // using instancePositions as world coordinates\n    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth\n    // call project_normal before setting position to avoid rotation\n    geometry.normal = project_normal(normal);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n    geometry.normal = project_normal(normal);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    // set PBR data\n    pbr_vPosition = geometry.position.xyz;\n    #ifdef HAS_NORMALS\n      pbr_vNormal = geometry.normal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n\n// Uniforms\nuniform float opacity;\n\n// Varying\nin vec4 vColor;\n\nout vec4 fragmentColor;\n\n// MODULE_PBR contains all the varying definitions needed\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:go,transition:!0},instanceModelMatrix:fo.a})}},{key:"updateState",value:function(t){y()(w()(n.prototype),"updateState",this).call(this,t);var e=t.props,r=t.oldProps;e.scenegraph!==r.scenegraph?this._updateScenegraph():e._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,e._animations)}},{key:"finalizeState",value:function(t){y()(w()(n.prototype),"finalizeState",this).call(this,t),this._deleteScenegraph()}},{key:"_updateScenegraph",value:function(){var t=this,e=this.props,n=this.context.gl,r=null;if(e.scenegraph instanceof F)r={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){var i=e.scenegraph,o=function(t,e,n){var r=new ct(t,n);return{scenes:r.instantiate(e),animator:r.createAnimator()}}(n,i,this._getModelOptions());r=po({gltf:i},o),function(t){return uo.apply(this,arguments)}(o).then((function(){return t.setNeedsRedraw()}))}else e.scenegraph&&(E.a.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=e.scenegraph);var a={layer:this,gl:n},s=e.getScene(r,a),u=e.getAnimator(r,a);s instanceof F?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,u,e._animations),this.setState({scenegraph:s,animator:u})):null!==s&&E.a.warn("invalid scenegraph:",s)()}},{key:"_applyAllAttributes",value:function(t){var e=this;if(this.state.attributesAvailable){var n=this.getAttributeManager().getAttributes();t.traverse((function(t){e._setModelAttributes(t.model,n)}))}}},{key:"_applyAnimationsProp",value:function(t,e,n){if(t&&e&&n){var r=e.getAnimations();Object.keys(n).sort().forEach((function(t){var e=n[t];if("*"===t)r.forEach((function(t){Object.assign(t,e)}));else if(Number.isFinite(Number(t))){var i=Number(t);i>=0&&i<r.length?Object.assign(r[i],e):E.a.warn("animation ".concat(t," not found"))()}else{var o=r.find((function(e){return e.name===t}));o?Object.assign(o,e):E.a.warn("animation ".concat(t," not found"))()}}))}}},{key:"_deleteScenegraph",value:function(){var t=this.state.scenegraph;t instanceof F&&t.delete()}},{key:"_getModelOptions",value:function(){var t=this.props._imageBasedLightingEnvironment,e=null;return t&&(e="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:e,modelOptions:po({isInstanced:!0,transpileToGLSL100:!Object(j.j)(this.context.gl)},this.getShaders()),useTangents:!1}}},{key:"updateAttributes",value:function(t){var e=this;this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse((function(n){e._setModelAttributes(n.model,t)}))}},{key:"draw",value:function(t){var e=t.moduleParameters,n=void 0===e?null:e,r=t.parameters,i=void 0===r?{}:r,o=t.context;if(this.state.scenegraph){this.props._animations&&this.state.animator&&(this.state.animator.animate(o.timeline.getTime()),this.setNeedsRedraw());var a=this.context.viewport,s=this.props,u=s.sizeScale,c=s.sizeMinPixels,l=s.sizeMaxPixels,f=s.opacity,h=s.coordinateSystem,d=this.getNumInstances();this.state.scenegraph.traverse((function(t,e){var r=e.worldMatrix;t.model.setInstanceCount(d),t.updateModuleSettings(n),t.draw({parameters:i,uniforms:{sizeScale:u,opacity:f,sizeMinPixels:c,sizeMaxPixels:l,composeModelMatrix:Object(fo.b)(a,h),sceneModelMatrix:r,u_Camera:t.model.getUniforms().project_uCameraPosition}})}))}}}]),n}(T.a);C()(mo,"defaultProps",yo),C()(mo,"layerName","ScenegraphLayer")},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=n(182),l=n(83),f=n(31),h=n(89);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v=function(){function t(e){i()(this,t),u()(this,"width",void 0),u()(this,"height",void 0),u()(this,"views",void 0),u()(this,"viewState",void 0),u()(this,"controllers",void 0),u()(this,"timeline",void 0),u()(this,"_viewports",void 0),u()(this,"_viewportMap",void 0),u()(this,"_isUpdating",void 0),u()(this,"_needsRedraw",void 0),u()(this,"_needsUpdate",void 0),u()(this,"_eventManager",void 0),u()(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}return a()(t,[{key:"finalize",value:function(){for(var t in this.controllers){var e=this.controllers[t];e&&e.finalize()}this.controllers={}}},{key:"needsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}},{key:"setNeedsUpdate",value:function(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}},{key:"updateViewStates",value:function(){for(var t in this.controllers){var e=this.controllers[t];e&&e.updateTransition()}}},{key:"getViewports",value:function(t){return t?this._viewports.filter((function(e){return e.containsPixel(t)})):this._viewports}},{key:"getViews",value:function(){var t={};return this.views.forEach((function(e){t[e.id]=e})),t}},{key:"getView",value:function(t){return this.views.find((function(e){return e.id===t}))}},{key:"getViewState",value:function(t){var e="string"==typeof t?this.getView(t):t,n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}},{key:"getViewport",value:function(t){return this._viewportMap[t]}},{key:"unproject",value:function(t,e){for(var n=this.getViewports(),r={x:t[0],y:t[1]},i=n.length-1;i>=0;--i){var o=n[i];if(o.containsPixel(r)){var a=t.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,e)}}return null}},{key:"setProps",value:function(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}},{key:"_update",value:function(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}},{key:"_setSize",value:function(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}},{key:"_setViews",value:function(t){t=Object(h.b)(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}},{key:"_setViewState",value:function(t){t?(!Object(l.a)(t,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):f.a.warn("missing `viewState` or `initialViewState`")()}},{key:"_onViewStateChange",value:function(t,e){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(p(p({},e),{},{viewId:t}))}},{key:"_createController",value:function(t,e){var n=this;return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:function(e){var r;return null===(r=n.getView(t.id))||void 0===r?void 0:r.makeViewport({viewState:e,width:n.width,height:n.height})}})}},{key:"_updateController",value:function(t,e,n,r){var i=t.controller;if(i){var o=p(p(p({},e),i),{},{id:t.id,x:n.x,y:n.y,width:n.width,height:n.height});return r||(r=this._createController(t,o)),r&&r.setProps(o),r}return null}},{key:"_rebuildViewports",value:function(){var t=this.views,e=this.controllers;this._viewports=[],this.controllers={};for(var n=!1,r=t.length;r--;){var i=t[r],o=this.getViewState(i),a=i.makeViewport({viewState:o,width:this.width,height:this.height}),s=e[i.id],u=Boolean(i.controller);u&&!s&&(n=!0),!n&&u||!s||(s.finalize(),s=null),this.controllers[i.id]=this._updateController(i,o,a,s),this._viewports.unshift(a)}for(var c in e){var l=e[c];l&&!this.controllers[c]&&l.finalize()}this._buildViewportMap()}},{key:"_buildViewportMap",value:function(){var t=this;this._viewportMap={},this._viewports.forEach((function(e){e.id&&(t._viewportMap[e.id]=t._viewportMap[e.id]||e)}))}},{key:"_diffViews",value:function(t,e){return t.length!==e.length||t.some((function(n,r){return!t[r].equals(e[r])}))}}]),t}(),g=n(165),y=n(151),m=n(123),b=n(24),A=n(9),_=n.n(A),O=n(10),w=n.n(O),x=n(5),C=n.n(x),P=n(7),S=n.n(P),B=n(2),k=n.n(B),E=n(95),T=n(12),j=n(20);function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function I(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k()(t);if(e){var i=k()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var D=function(t){C()(n,t);var e=R(n);function n(t,r){var o,a;i()(this,n),a=e.call(this,t,r),u()(_()(a),"maskMap",void 0),u()(_()(a),"fbo",void 0);var s=r.mapSize,c=void 0===s?2048:s;return a.maskMap=new m.a(t,{width:c,height:c,parameters:(o={},u()(o,10241,9729),u()(o,10240,9729),u()(o,10242,33071),u()(o,10243,33071),o)}),a.fbo=new E.a(t,{id:"maskmap",width:c,height:c,attachments:u()({},36064,a.maskMap)}),a}return a()(n,[{key:"render",value:function(t){var e=this,r=this.gl,i=[!1,!1,!1,!1];return i[t.channel]=!0,Object(T.o)(r,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:i,depthTest:!1},(function(){return w()(k()(n.prototype),"render",e).call(e,I(I({},t),{},{target:e.fbo,pass:"mask"}))}))}},{key:"shouldDrawLayer",value:function(t){return t.props.operation===j.c.MASK}},{key:"delete",value:function(){this.fbo.delete(),this.maskMap.delete()}}]),n}(n(94).a),L=n(170),F=n(102),G=n(33);function N(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return U(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function z(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return H(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var V=function(){function t(){i()(this,t),u()(this,"id","mask-effect"),u()(this,"props",null),u()(this,"useInPicking",!0),u()(this,"dummyMaskMap",void 0),u()(this,"channels",[]),u()(this,"masks",null),u()(this,"maskPass",void 0),u()(this,"maskMap",void 0),u()(this,"lastViewport",void 0)}return a()(t,[{key:"preRender",value:function(t,e){var n=e.layers,r=e.layerFilter,i=e.viewports,o=e.onViewportActive,a=e.views;this.dummyMaskMap||(this.dummyMaskMap=new m.a(t,{width:1,height:1}));var s=n.filter((function(t){return t.props.visible&&t.props.operation===j.c.MASK}));if(0===s.length)return this.masks=null,void(this.channels.length=0);this.masks={},this.maskPass||(this.maskPass=new D(t,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);var u=this._sortMaskChannels(s),c=i[0],l=!this.lastViewport||!this.lastViewport.equals(c);for(var f in u)this._renderChannel(u[f],{layerFilter:r,onViewportActive:o,views:a,viewport:c,viewportChanged:l})}},{key:"_renderChannel",value:function(t,e){var n=e.layerFilter,r=e.onViewportActive,i=e.views,o=e.viewport,a=e.viewportChanged,s=this.channels[t.index];if(s){var u=t===s||s.layers.length!==t.layers.length||t.layerBounds.some((function(t,e){return t!==s.layerBounds[e]}));if(t.bounds=s.bounds,t.maskBounds=s.maskBounds,this.channels[t.index]=t,(u||a)&&(this.lastViewport=o,t.bounds=function(t){var e,n=t.layers,r=t.viewport,i=null,o=N(n);try{for(o.s();!(e=o.n()).done;){var a=e.value.getBounds();a&&(i?(i[0]=Math.min(i[0],a[0][0]),i[1]=Math.min(i[1],a[0][1]),i[2]=Math.max(i[2],a[1][0]),i[3]=Math.max(i[3],a[1][1])):i=[a[0][0],a[0][1],a[1][0],a[1][1]])}}catch(t){o.e(t)}finally{o.f()}var s=r.getBounds();if(!i)return s;var u=function(t){var e={x:t[2]-t[0],y:t[3]-t[1]},n={x:t[0]+.5*e.x,y:t[1]+.5*e.y};return[n.x-e.x,n.y-e.y,n.x+e.x,n.y+e.y]}(s);return i[2]-i[0]<u[2]-u[0]||i[3]-i[1]<u[3]-u[1]?i:(i[0]=Math.max(i[0],u[0]),i[1]=Math.max(i[1],u[1]),i[2]=Math.min(i[2],u[2]),i[3]=Math.min(i[3],u[3]),i)}({layers:t.layers,viewport:o}),u||!Object(b.d)(t.bounds,s.bounds))){var c=this.maskPass,l=this.maskMap,f=function(t){var e=t.bounds,n=t.viewport,r=t.width,i=t.height;if(e[2]<=e[0]||e[3]<=e[1])return null;if(r-=2,i-=2,n instanceof F.a){var o=Object(G.c)({width:r,height:i,bounds:[[e[0],e[1]],[e[2],e[3]]],maxZoom:20}),a=o.longitude,s=o.latitude,u=o.zoom;return new F.a({longitude:a,latitude:s,zoom:u,x:1,y:1,width:r,height:i})}var c=[(e[0]+e[2])/2,(e[1]+e[3])/2,0],l=Math.min(20,r/(e[2]-e[0]),i/(e[3]-e[1]));return new L.a({x:1,y:1}).makeViewport({width:r,height:i,viewState:{target:c,zoom:Math.log2(l)}})}({bounds:t.bounds,viewport:o,width:l.width,height:l.height});t.maskBounds=f?f.getBounds():[0,0,1,1],c.render({pass:"mask",channel:t.index,layers:t.layers,layerFilter:n,viewports:f?[f]:[],onViewportActive:r,views:i,moduleParameters:{devicePixelRatio:1}})}this.masks[t.id]={index:t.index,bounds:t.maskBounds,coordinateOrigin:t.coordinateOrigin,coordinateSystem:t.coordinateSystem}}}},{key:"_sortMaskChannels",value:function(t){var e,n=this,r={},i=0,o=z(t);try{var a=function(){var t=e.value,o=t.root.id,a=r[o];if(!a){if(++i>4)return f.a.warn("Too many mask layers. The max supported is 4")(),"continue";a={id:o,index:n.channels.findIndex((function(t){return(null==t?void 0:t.id)===o})),layers:[],layerBounds:[],coordinateOrigin:t.root.props.coordinateOrigin,coordinateSystem:t.root.props.coordinateSystem},r[o]=a}a.layers.push(t),a.layerBounds.push(t.getBounds())};for(o.s();!(e=o.n()).done;)a()}catch(t){o.e(t)}finally{o.f()}for(var s=0;s<4;s++){var u=this.channels[s];u&&u.id in r||(this.channels[s]=null)}for(var c in r){var l=r[c];l.index<0&&(l.index=this.channels.findIndex((function(t){return!t})),this.channels[l.index]=l)}return r}},{key:"getModuleParameters",value:function(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}},{key:"cleanup",value:function(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}]),t}();function J(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return W(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return W(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var K=new y.a,X=function(){function t(){i()(this,t),u()(this,"effects",void 0),u()(this,"_internalEffects",void 0),u()(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}return a()(t,[{key:"setProps",value:function(t){"effects"in t&&(t.effects.length===this.effects.length&&Object(l.a)(t.effects,this.effects)||(this.setEffects(t.effects),this._needsRedraw="effects changed"))}},{key:"needsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1},e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}},{key:"getEffects",value:function(){return this._internalEffects}},{key:"finalize",value:function(){this.cleanup()}},{key:"setEffects",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.cleanup(),this.effects=t,this._internalEffects=t.slice(),this._internalEffects.push(new V),t.some((function(t){return t instanceof y.a}))||this._internalEffects.push(K)}},{key:"cleanup",value:function(){var t,e=J(this.effects);try{for(e.s();!(t=e.n()).done;){t.value.cleanup()}}catch(t){e.e(t)}finally{e.f()}var n,r=J(this._internalEffects);try{for(r.s();!(n=r.n()).done;){n.value.cleanup()}}catch(t){r.e(t)}finally{r.f()}this.effects.length=0,this._internalEffects.length=0}}]),t}(),q=n(184),Q=n(212),Z=n(191);function Y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var tt={pickedColor:null,pickedObjectIndex:-1};function et(t){for(var e=t.pickedColors,n=t.decodePickingColor,r=t.deviceX,i=t.deviceY,o=t.deviceRadius,a=t.deviceRect,s=a.x,u=a.y,c=a.width,l=a.height,h=o*o,d=-1,p=0,v=0;v<l;v++){var g=v+u-i,y=g*g;if(y>h)p+=4*c;else for(var m=0;m<c;m++){if(e[p+3]-1>=0){var b=m+s-r,A=b*b+y;A<=h&&(h=A,d=p)}p+=4}}if(d>=0){var _=e.slice(d,d+4),O=n(_);if(O){var w=Math.floor(d/4/c),x=d/4-w*c;return $($({},O),{},{pickedColor:_,pickedX:s+x,pickedY:u+w})}f.a.error("Picked non-existent layer. Is picking buffer corrupt?")()}return tt}function nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function rt(t){var e,n=t.pickInfo,r=t.viewports,i=t.pixelRatio,o=t.x,a=t.y,s=t.z,u=r[0];if(r.length>1&&(u=function(t,e){for(var n=t.length-1;n>=0;n--){var r=t[n];if(r.containsPixel(e))return r}return t[0]}((null==n?void 0:n.pickedViewports)||r,{x:o,y:a})),u){var c=[o-u.x,a-u.y];void 0!==s&&(c[2]=s),e=u.unproject(c)}return{color:null,layer:null,viewport:u,index:-1,picked:!1,x:o,y:a,pixel:[o,a],coordinate:e,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:i}}function it(t){var e=t.pickInfo,n=t.lastPickedInfo,r=t.mode,i=t.layers,o=e.pickedColor,a=e.pickedLayer,s=e.pickedObjectIndex,c=a?[a]:[];if("hover"===r){var l=n.index,f=n.layerId,h=a?a.props.id:null;if(h!==f||s!==l){if(h!==f){var d=i.find((function(t){return t.props.id===f}));d&&c.unshift(d)}n.layerId=h,n.index=s,n.info=null}}var p=rt(t),v=new Map;return v.set(null,p),c.forEach((function(t){var e=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},p);t===a&&(e.color=o,e.index=s,e.picked=!0);var i=(e=ot({layer:t,info:e,mode:r})).layer;t===a&&"hover"===r&&(n.info=e),v.set(i.id,e),"hover"===r&&i.updateAutoHighlight(e)})),v}function ot(t){for(var e=t.layer,n=t.info,r=t.mode;e&&n;){var i=n.layer||null;n.sourceLayer=i,n.layer=e,n=e.getPickingInfo({info:n,mode:r,sourceLayer:i}),e=e.parent}return n}function at(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return st(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return st(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function st(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var lt=function(){function t(e){i()(this,t),u()(this,"gl",void 0),u()(this,"pickingFBO",void 0),u()(this,"depthFBO",void 0),u()(this,"pickLayersPass",void 0),u()(this,"layerFilter",void 0),u()(this,"lastPickedInfo",void 0),u()(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new Z.a(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}return a()(t,[{key:"setProps",value:function(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}},{key:"finalize",value:function(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}},{key:"pickObject",value:function(t){return this._pickClosestObject(t)}},{key:"pickObjects",value:function(t){return this._pickVisibleObjects(t)}},{key:"getLastPickedObject",value:function(t){var e=t.x,n=t.y,r=t.layers,i=t.viewports,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.lastPickedInfo.info,a=o&&o.layer&&o.layer.id,s=o&&o.viewport&&o.viewport.id,u=a?r.find((function(t){return t.id===a})):null,c=s&&i.find((function(t){return t.id===s}))||i[0],l=c&&c.unproject([e-c.x,n-c.y]),f={x:e,y:n,viewport:c,coordinate:l,layer:u};return ct(ct({},o),f)}},{key:"_resizeBuffer",value:function(){var t,e,n=this.gl;if(!this.pickingFBO&&(this.pickingFBO=new E.a(n),E.a.isSupported(n,{colorBufferFloat:!0}))){var r=new E.a(n);r.attach(u()({},36064,new m.a(n,{format:Object(T.j)(n)?34836:6408,type:5126}))),this.depthFBO=r}null===(t=this.pickingFBO)||void 0===t||t.resize({width:n.canvas.width,height:n.canvas.height}),null===(e=this.depthFBO)||void 0===e||e.resize({width:n.canvas.width,height:n.canvas.height})}},{key:"_getPickable",value:function(t){if(!1===this._pickable)return null;var e=t.filter((function(t){return t.isPickable()&&!t.isComposite}));return e.length?e:null}},{key:"_pickClosestObject",value:function(t){var e=t.layers,n=t.views,r=t.viewports,i=t.x,o=t.y,a=t.radius,s=void 0===a?0:a,u=t.depth,c=void 0===u?1:u,l=t.mode,f=void 0===l?"query":l,h=t.unproject3D,d=t.onViewportActive,p=t.effects,v=this._getPickable(e),g=Object(T.e)(this.gl);if(!v)return{result:[],emptyInfo:rt({viewports:r,x:i,y:o,pixelRatio:g})};this._resizeBuffer();for(var y,m=Object(T.d)(this.gl,[i,o],!0),b=[m.x+Math.floor(m.width/2),m.y+Math.floor(m.height/2)],A=Math.round(s*g),_=this.pickingFBO,O=_.width,w=_.height,x=this._getPickingRect({deviceX:b[0],deviceY:b[1],deviceRadius:A,deviceWidth:O,deviceHeight:w}),C={x:i-s,y:o-s,width:2*s+1,height:2*s+1},P=[],S=new Set,B=0;B<c;B++){var k=void 0;if(x)k=et(ct(ct({},this._drawAndSample({layers:v,views:n,viewports:r,onViewportActive:d,deviceRect:x,cullRect:C,effects:p,pass:"picking:".concat(f)})),{},{deviceX:b[0],deviceY:b[1],deviceRadius:A,deviceRect:x}));else k={pickedColor:null,pickedObjectIndex:-1};var E=void 0;if(k.pickedLayer&&h&&this.depthFBO)E=this._drawAndSample({layers:[k.pickedLayer],views:n,viewports:r,onViewportActive:d,deviceRect:{x:k.pickedX,y:k.pickedY,width:1,height:1},cullRect:C,effects:p,pass:"picking:".concat(f,":z")},!0).pickedColors[0];k.pickedLayer&&B+1<c&&(S.add(k.pickedLayer),k.pickedLayer.disablePickingIndex(k.pickedObjectIndex));var j,M=at((y=it({pickInfo:k,lastPickedInfo:this.lastPickedInfo,mode:f,layers:v,viewports:r,x:i,y:o,z:E,pixelRatio:g})).values());try{for(M.s();!(j=M.n()).done;){var I=j.value;I.layer&&P.push(I)}}catch(t){M.e(t)}finally{M.f()}if(!k.pickedColor)break}var R,D=at(S);try{for(D.s();!(R=D.n()).done;){R.value.restorePickingColors()}}catch(t){D.e(t)}finally{D.f()}return{result:P,emptyInfo:y.get(null)}}},{key:"_pickVisibleObjects",value:function(t){var e=t.layers,n=t.views,r=t.viewports,i=t.x,o=t.y,a=t.width,s=void 0===a?1:a,u=t.height,c=void 0===u?1:u,l=t.mode,h=void 0===l?"query":l,d=t.maxObjects,p=void 0===d?null:d,v=t.onViewportActive,g=t.effects,y=this._getPickable(e);if(!y)return[];this._resizeBuffer();for(var m=Object(T.e)(this.gl),b=Object(T.d)(this.gl,[i,o],!0),A=b.x,_=b.y+b.height,O=Object(T.d)(this.gl,[i+s,o+c],!0),w=O.x+O.width,x=O.y,C={x:A,y:x,width:w-A,height:_-x},P=function(t){var e=t.pickedColors,n=t.decodePickingColor,r=new Map;if(e)for(var i=0;i<e.length;i+=4){if(e[i+3]-1>=0){var o=e.slice(i,i+4),a=o.join(",");if(!r.has(a)){var s=n(o);s?r.set(a,$($({},s),{},{color:o})):f.a.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(r.values())}(this._drawAndSample({layers:y,views:n,viewports:r,onViewportActive:v,deviceRect:C,cullRect:{x:i,y:o,width:s,height:c},effects:g,pass:"picking:".concat(h)})),S=new Map,B=Number.isFinite(p),k=0;k<P.length&&!(B&&p&&S.size>=p);k++){var E=P[k],j={color:E.pickedColor,layer:null,index:E.pickedObjectIndex,picked:!0,x:i,y:o,pixelRatio:m};j=ot({layer:E.pickedLayer,info:j,mode:h}),S.has(j.object)||S.set(j.object,j)}return Array.from(S.values())}},{key:"_drawAndSample",value:function(t){var e=t.layers,n=t.views,r=t.viewports,i=t.onViewportActive,o=t.deviceRect,a=t.cullRect,s=t.effects,u=t.pass,c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=c?this.depthFBO:this.pickingFBO,f=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:l,deviceRect:o,cullRect:a,effects:s,pass:u,pickZ:c}),h=f.decodePickingColor,d=o.x,p=o.y,v=o.width,g=o.height,y=new(c?Float32Array:Uint8Array)(v*g*4);return Object(Q.c)(l,{sourceX:d,sourceY:p,sourceWidth:v,sourceHeight:g,target:y}),{pickedColors:y,decodePickingColor:h}}},{key:"_getPickingRect",value:function(t){var e=t.deviceX,n=t.deviceY,r=t.deviceRadius,i=t.deviceWidth,o=t.deviceHeight,a=Math.max(0,e-r),s=Math.max(0,n-r),u=Math.min(i,e+r+1)-a,c=Math.min(o,n+r+1)-s;return u<=0||c<=0?null:{x:a,y:s,width:u,height:c}}}]),t}(),ft={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"},ht=function(){function t(e){i()(this,t),u()(this,"el",null),u()(this,"isVisible",!1);var n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,ft),n.appendChild(this.el))}return a()(t,[{key:"setTooltip",value:function(t,e,n){var r=this.el;if(r){if("string"==typeof t)r.innerText=t;else{if(!t)return this.isVisible=!1,void(r.style.display="none");t.text&&(r.innerText=t.text),t.html&&(r.innerHTML=t.html),t.className&&(r.className=t.className),Object.assign(r.style,t.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(e,"px, ").concat(n,"px)")}}},{key:"remove",value:function(){this.el&&(this.el.remove(),this.el=null)}}]),t}(),dt=n(90),pt=n(205),vt=n(342),gt=n(26),yt=n.n(gt),mt=n(19),bt=n.n(mt),At=n(14),_t=n.n(At),Ot=n(144),wt=n(17),xt=n(57),Ct=n(264),Pt=n(198);function St(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Bt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Bt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k()(t);if(e){var i=k()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var Et=function(t,e){C()(r,t);var n=kt(r);function r(t){var e;i()(this,r);var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e=n.call(this,t,o)).target=null,e._queryPending=!1,e._pollingPromise=null,Object.seal(_()(e)),e}return a()(r,[{key:e,get:function(){return"Query"}},{key:"beginTimeElapsedQuery",value:function(){return this.begin(35007)}},{key:"beginOcclusionQuery",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.conservative,n=void 0!==e&&e;return this.begin(n?36202:35887)}},{key:"beginTransformFeedbackQuery",value:function(){return this.begin(35976)}},{key:"begin",value:function(t){return this._queryPending?this:(this.target=t,this.gl2.beginQuery(this.target,this.handle),this)}},{key:"end",value:function(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}},{key:"isResultAvailable",value:function(){if(!this._queryPending)return!1;var t=this.gl2.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}},{key:"isTimerDisjoint",value:function(){return this.gl2.getParameter(36795)}},{key:"getResult",value:function(){return this.gl2.getQueryParameter(this.handle,34918)}},{key:"getTimerMilliseconds",value:function(){return this.getResult()/1e6}},{key:"createPoll",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;var n=0;return this._pollingPromise=new Promise((function(r,i){requestAnimationFrame((function o(){t.isResultAvailable()?(r(t.getResult()),t._pollingPromise=null):n++>e?(i("Timed out"),t._pollingPromise=null):requestAnimationFrame(o)}))})),this._pollingPromise}},{key:"_createHandle",value:function(){return r.isSupported(this.gl)?this.gl2.createQuery():null}},{key:"_deleteHandle",value:function(){this.gl2.deleteQuery(this.handle)}}],[{key:"isSupported",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=Object(T.j)(t),i=Object(Ct.c)(t,Pt.a.TIMER_QUERY),o=r||i,a=St(n);try{for(a.s();!(e=a.n()).done;){var s=e.value;switch(s){case"queries":o=o&&r;break;case"timers":o=o&&i;break;default:Object(wt.a)(!1)}}}catch(t){a.e(t)}finally{a.f()}return o}}]),r}(xt.a,Symbol.toStringTag);var Tt,jt,Mt=n(152),It=Object(Mt.a)()&&"undefined"!=typeof document,Rt=0,Dt=function(){function t(){i()(this,t);var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onCreateContext,r=void 0===n?function(t){return Object(T.c)(t)}:n,o=e.onAddHTML,a=void 0===o?null:o,s=e.onInitialize,u=void 0===s?function(){}:s,c=e.onRender,l=void 0===c?function(){}:c,f=e.onFinalize,h=void 0===f?function(){}:f,d=e.onError,p=e.gl,v=void 0===p?null:p,g=e.glOptions,y=void 0===g?{}:g,m=e.debug,b=void 0!==m&&m,A=e.createFramebuffer,_=void 0!==A&&A,O=e.autoResizeViewport,w=void 0===O||O,x=e.autoResizeDrawingBuffer,C=void 0===x||x,P=e.stats,S=void 0===P?Ot.b.get("animation-loop-".concat(Rt++)):P,B=e.useDevicePixels,k=void 0===B||B;"useDevicePixelRatio"in e&&(T.k.deprecated("useDevicePixelRatio","useDevicePixels")(),k=e.useDevicePixelRatio),this.props={onCreateContext:r,onAddHTML:a,onInitialize:u,onRender:l,onFinalize:h,onError:d,gl:v,glOptions:y,debug:b,createFramebuffer:_},this.gl=v,this.needsRedraw=null,this.timeline=null,this.stats=S,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:w,autoResizeDrawingBuffer:C,useDevicePixels:k}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}var e;return a()(t,[{key:"delete",value:function(){this.stop(),this._setDisplay(null)}},{key:"setNeedsRedraw",value:function(t){return Object(wt.a)("string"==typeof t),this.needsRedraw=this.needsRedraw||t,this}},{key:"setProps",value:function(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}},{key:"start",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;var n=this._getPageLoadPromise().then((function(){return!t._running||t._initialized?null:(t._createWebGLContext(e),t._createFramebuffer(),t._startEventHandling(),t._initializeCallbackData(),t._updateCallbackData(),t._resizeCanvasDrawingBuffer(),t._resizeViewport(),t._gpuTimeQuery=Et.isSupported(t.gl,["timers"])?new Et(t.gl):null,t._initialized=!0,t.onInitialize(t.animationProps))})).then((function(e){t._running&&(t._addCallbackData(e||{}),!1!==e&&t._startLoop())}));return this.props.onError&&n.catch(this.props.onError),this}},{key:"redraw",value:function(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}},{key:"stop",value:function(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}},{key:"attachTimeline",value:function(t){return this.timeline=t,this.timeline}},{key:"detachTimeline",value:function(){this.timeline=null}},{key:"waitForRender",value:function(){var t=this;return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((function(e){t._resolveNextFrame=e}))),this._nextFramePromise}},{key:"toDataURL",value:(e=bt()(_t.a.mark((function t(){return _t.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setNeedsRedraw("toDataURL"),t.next=3,this.waitForRender();case 3:return t.abrupt("return",this.gl.canvas.toDataURL());case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"isContextLost",value:function(){return this.gl.isContextLost()}},{key:"onCreateContext",value:function(){var t;return(t=this.props).onCreateContext.apply(t,arguments)}},{key:"onInitialize",value:function(){var t;return(t=this.props).onInitialize.apply(t,arguments)}},{key:"onRender",value:function(){var t;return(t=this.props).onRender.apply(t,arguments)}},{key:"onFinalize",value:function(){var t;return(t=this.props).onFinalize.apply(t,arguments)}},{key:"getHTMLControlValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=document.getElementById(t);return n?Number(n.value):e}},{key:"setViewParameters",value:function(){return T.k.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}},{key:"_startLoop",value:function(){var t=this;this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame((function e(){t._running&&(t.redraw(),t._animationFrameId=t._requestAnimationFrame(e))}))}},{key:"_getPageLoadPromise",value:function(){return this._pageLoadPromise||(this._pageLoadPromise=It?new Promise((function(t,e){It&&"complete"===document.readyState?t(document):window.addEventListener("load",(function(){t(document)}))})):Promise.resolve({})),this._pageLoadPromise}},{key:"_setDisplay",value:function(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}},{key:"_cancelAnimationFrame",value:function(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e));var e}},{key:"_requestAnimationFrame",value:function(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60));var e}},{key:"_renderFrame",value:function(){var t;this.display?(t=this.display)._renderFrame.apply(t,arguments):this.onRender.apply(this,arguments)}},{key:"_clearNeedsRedraw",value:function(){this.needsRedraw=null}},{key:"_setupFrame",value:function(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}},{key:"_initializeCallbackData",value:function(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}},{key:"_updateCallbackData",value:function(){var t=this._getSizeAndAspect(),e=t.width,n=t.height,r=t.aspect;e===this.animationProps.width&&n===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}},{key:"_finalizeCallbackData",value:function(){this.onFinalize(this.animationProps)}},{key:"_addCallbackData",value:function(t){"object"===yt()(t)&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}},{key:"_createWebGLContext",value:function(t){if(this.offScreen=t.canvas&&"undefined"!=typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?Object(T.h)(this.props.gl,t):this.onCreateContext(t),!Object(T.i)(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");Object(T.l)(this.gl),this._createInfoDiv()}},{key:"_createInfoDiv",value:function(){if(this.gl.canvas&&this.props.onAddHTML){var t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";var e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);var n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}},{key:"_getSizeAndAspect",value:function(){var t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight,n=1,r=this.gl.canvas;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}},{key:"_resizeViewport",value:function(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}},{key:"_resizeCanvasDrawingBuffer",value:function(){this.autoResizeDrawingBuffer&&Object(T.m)(this.gl,{useDevicePixels:this.useDevicePixels})}},{key:"_createFramebuffer",value:function(){this.props.createFramebuffer&&(this.framebuffer=new E.a(this.gl))}},{key:"_resizeFramebuffer",value:function(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}},{key:"_beginTimers",value:function(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}},{key:"_endTimers",value:function(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}},{key:"_startEventHandling",value:function(){var t=this.gl.canvas;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}},{key:"_onMousemove",value:function(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}},{key:"_onMouseleave",value:function(t){this.animationProps._mousePosition=null}}]),t}(),Lt=n(344),Ft=n(110),Gt=n(15),Nt=n.n(Gt),Ut=n(158),zt=n.n(Ut),Ht={mousedown:1,mousemove:2,mouseup:4};Tt=zt.a.PointerEventInput,jt=Tt.prototype.handler,Tt.prototype.handler=function(t){var e=this.store;t.button>0&&"pointerdown"===t.type&&(function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}(e,(function(e){return e.pointerId===t.pointerId}))||e.push(t)),jt.call(this,t)},zt.a.MouseInput.prototype.handler=function(t){var e=Ht[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};var Vt=zt.a.Manager,Jt=zt.a;function Wt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Kt=function t(e,n,r){i()(this,t),this.element=e,this.callback=n,this.options=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Wt(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({enable:!0},r)},Xt=Jt?[[Jt.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Jt.Rotate,{enable:!1}],[Jt.Pinch,{enable:!1}],[Jt.Swipe,{enable:!1}],[Jt.Pan,{threshold:0,enable:!1}],[Jt.Press,{enable:!1}],[Jt.Tap,{event:"doubletap",taps:2,enable:!1}],[Jt.Tap,{event:"anytap",enable:!1}],[Jt.Tap,{enable:!1}]]:null,qt={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Qt={doubletap:["tap"]},Zt={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Yt=["keydown","keyup"],$t=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],te=["wheel","mousewheel"],ee={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},ne={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},re="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ie="undefined"!=typeof window?window:global,oe=("undefined"!=typeof global?global:window,"undefined"!=typeof document&&document,!1);try{var ae={get passive(){return oe=!0,!0}};ie.addEventListener("test",null,ae),ie.removeEventListener("test",null)}catch(t){oe=!1}function se(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k()(t);if(e){var i=k()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var ue=-1!==re.indexOf("firefox"),ce=te,le=function(t){C()(n,t);var e=se(n);function n(t,r,o){var a;return i()(this,n),(a=e.call(this,t,r,o)).handleEvent=function(t){if(a.options.enable){var e=t.deltaY;ie.WheelEvent&&(ue&&t.deltaMode===ie.WheelEvent.DOM_DELTA_PIXEL&&(e/=ie.devicePixelRatio),t.deltaMode===ie.WheelEvent.DOM_DELTA_LINE&&(e*=40)),0!==e&&e%4.000244140625==0&&(e=Math.floor(e/4.000244140625)),t.shiftKey&&e&&(e*=.25),a.callback({type:"wheel",center:{x:t.clientX,y:t.clientY},delta:-e,srcEvent:t,pointerType:"mouse",target:t.target})}},a.events=(a.options.events||[]).concat(ce),a.events.forEach((function(e){return t.addEventListener(e,a.handleEvent,!!oe&&{passive:!1})})),a}return a()(n,[{key:"destroy",value:function(){var t=this;this.events.forEach((function(e){return t.element.removeEventListener(e,t.handleEvent)}))}},{key:"enableEventType",value:function(t,e){"wheel"===t&&(this.options.enable=e)}}]),n}(Kt);function fe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k()(t);if(e){var i=k()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var he=$t,de=function(t){C()(n,t);var e=fe(n);function n(t,r,o){var a;i()(this,n),(a=e.call(this,t,r,o)).handleEvent=function(t){a.handleOverEvent(t),a.handleOutEvent(t),a.handleEnterEvent(t),a.handleLeaveEvent(t),a.handleMoveEvent(t)},a.pressed=!1;var s=a.options.enable;return a.enableMoveEvent=s,a.enableLeaveEvent=s,a.enableEnterEvent=s,a.enableOutEvent=s,a.enableOverEvent=s,a.events=(a.options.events||[]).concat(he),a.events.forEach((function(e){return t.addEventListener(e,a.handleEvent)})),a}return a()(n,[{key:"destroy",value:function(){var t=this;this.events.forEach((function(e){return t.element.removeEventListener(e,t.handleEvent)}))}},{key:"enableEventType",value:function(t,e){"pointermove"===t&&(this.enableMoveEvent=e),"pointerover"===t&&(this.enableOverEvent=e),"pointerout"===t&&(this.enableOutEvent=e),"pointerenter"===t&&(this.enableEnterEvent=e),"pointerleave"===t&&(this.enableLeaveEvent=e)}},{key:"handleOverEvent",value:function(t){this.enableOverEvent&&"mouseover"===t.type&&this._emit("pointerover",t)}},{key:"handleOutEvent",value:function(t){this.enableOutEvent&&"mouseout"===t.type&&this._emit("pointerout",t)}},{key:"handleEnterEvent",value:function(t){this.enableEnterEvent&&"mouseenter"===t.type&&this._emit("pointerenter",t)}},{key:"handleLeaveEvent",value:function(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this._emit("pointerleave",t)}},{key:"handleMoveEvent",value:function(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this._emit("pointermove",t);break;case"mouseup":this.pressed=!1}}},{key:"_emit",value:function(t,e){this.callback({type:t,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}]),n}(Kt);function pe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k()(t);if(e){var i=k()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var ve=Yt,ge=function(t){C()(n,t);var e=pe(n);function n(t,r,o){var a;return i()(this,n),(a=e.call(this,t,r,o)).handleEvent=function(t){var e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(a.enableDownEvent&&"keydown"===t.type&&a.callback({type:"keydown",srcEvent:t,key:t.key,target:t.target}),a.enableUpEvent&&"keyup"===t.type&&a.callback({type:"keyup",srcEvent:t,key:t.key,target:t.target}))},a.enableDownEvent=a.options.enable,a.enableUpEvent=a.options.enable,a.events=(a.options.events||[]).concat(ve),t.tabIndex=a.options.tabIndex||0,t.style.outline="none",a.events.forEach((function(e){return t.addEventListener(e,a.handleEvent)})),a}return a()(n,[{key:"destroy",value:function(){var t=this;this.events.forEach((function(e){return t.element.removeEventListener(e,t.handleEvent)}))}},{key:"enableEventType",value:function(t,e){"keydown"===t&&(this.enableDownEvent=e),"keyup"===t&&(this.enableUpEvent=e)}}]),n}(Kt);function ye(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k()(t);if(e){var i=k()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S()(this,n)}}var me=function(t){C()(n,t);var e=ye(n);function n(t,r,o){var a;return i()(this,n),(a=e.call(this,t,r,o)).handleEvent=function(t){a.options.enable&&a.callback({type:"contextmenu",center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})},t.addEventListener("contextmenu",a.handleEvent),a}return a()(n,[{key:"destroy",value:function(){this.element.removeEventListener("contextmenu",this.handleEvent)}},{key:"enableEventType",value:function(t,e){"contextmenu"===t&&(this.options.enable=e)}}]),n}(Kt),be={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function Ae(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _e(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ae(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Oe={srcElement:"root",priority:0},we=function(){function t(e){var n=this;i()(this,t),this.handleEvent=function(t){if(!n.isEmpty()){for(var e=n._normalizeEvent(t),r=t.srcEvent.target;r&&r!==e.rootElement;){if(n._emit(e,r),e.handled)return;r=r.parentNode}n._emit(e,"root")}},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}return a()(t,[{key:"isEmpty",value:function(){return!this._active}},{key:"add",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this.handlers,a=this.handlersByElement,s=Oe;"string"==typeof n||n&&n.addEventListener?s=_e(_e({},Oe),{},{srcElement:n}):n&&(s=_e(_e({},Oe),n));var u=a.get(s.srcElement);u||(u=[],a.set(s.srcElement,u));var c={type:t,handler:e,srcElement:s.srcElement,priority:s.priority};r&&(c.once=!0),i&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;for(var l=u.length-1;l>=0&&!(u[l].priority>=c.priority);)l--;u.splice(l+1,0,c)}},{key:"remove",value:function(t,e){for(var n=this.handlers,r=this.handlersByElement,i=n.length-1;i>=0;i--){var o=n[i];if(o.type===t&&o.handler===e){n.splice(i,1);var a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=n.some((function(t){return!t.passive}))}},{key:"_emit",value:function(t,e){var n=this.handlersByElement.get(e);if(n){for(var r=!1,i=function(){t.handled=!0},o=function(){t.handled=!0,r=!0},a=[],s=0;s<n.length;s++){var u=n[s],c=u.type,l=u.handler,f=u.once;if(l(_e(_e({},t),{},{type:c,stopPropagation:i,stopImmediatePropagation:o})),f&&a.push(n[s]),r)break}for(var h=0;h<a.length;h++){var d=a[h],p=d.type,v=d.handler;this.remove(p,v)}}}},{key:"_normalizeEvent",value:function(t){var e=this.eventManager.getElement();return _e(_e(_e(_e({},t),function(t){var e=be[t.srcEvent.type];if(!e)return null;var n=t.srcEvent,r=n.buttons,i=n.button,o=n.which,a=!1,s=!1,u=!1;return 4===e||2===e&&!Number.isFinite(r)?(a=1===o,s=2===o,u=3===o):2===e?(a=Boolean(1&r),s=Boolean(4&r),u=Boolean(2&r)):1===e&&(a=0===i,s=1===i,u=2===i),{leftButton:a,middleButton:s,rightButton:u}}(t)),function(t,e){var n=t.center;if(!n)return null;var r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,o=r.height/e.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/o}}}(t,e)),{},{preventDefault:function(){t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:e})}}]),t}();function xe(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ce(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ce(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Se(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pe(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Be={events:null,recognizers:null,recognizerOptions:{},Manager:Vt,touchAction:"none",tabIndex:0},ke=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;i()(this,t),this._onBasicInput=function(t){var n=t.srcEvent,r=Zt[n.type];r&&e.manager.emit(r,t)},this._onOtherEvent=function(t){e.manager.emit(t.type,t)},this.options=Se(Se({},Be),r),this.events=new Map,this.setElement(n);var o=this.options.events;o&&this.on(o)}return a()(t,[{key:"getElement",value:function(){return this.element}},{key:"setElement",value:function(t){var e=this;if(this.element&&this.destroy(),this.element=t,t){var n=this.options,r=n.Manager;for(var i in this.manager=new r(t,{touchAction:n.touchAction,recognizers:n.recognizers||Xt}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(qt).forEach((function(t){var n=e.manager.get(t);n&&qt[t].forEach((function(t){n.recognizeWith(t)}))})),n.recognizerOptions){var o=this.manager.get(i);if(o){var a=n.recognizerOptions[i];delete a.enable,o.set(a)}}this.wheelInput=new le(t,this._onOtherEvent,{enable:!1}),this.moveInput=new de(t,this._onOtherEvent,{enable:!1}),this.keyInput=new ge(t,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new me(t,this._onOtherEvent,{enable:!1});var s,u=xe(this.events);try{for(u.s();!(s=u.n()).done;){var c=Nt()(s.value,2),l=c[0],f=c[1];f.isEmpty()||(this._toggleRecognizer(f.recognizerName,!0),this.manager.on(l,f.handleEvent))}}catch(t){u.e(t)}finally{u.f()}}}},{key:"destroy",value:function(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}},{key:"on",value:function(t,e,n){this._addEventHandler(t,e,n,!1)}},{key:"once",value:function(t,e,n){this._addEventHandler(t,e,n,!0)}},{key:"watch",value:function(t,e,n){this._addEventHandler(t,e,n,!1,!0)}},{key:"off",value:function(t,e){this._removeEventHandler(t,e)}},{key:"_toggleRecognizer",value:function(t,e){var n=this.manager;if(n){var r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});var i=Qt[t];i&&!this.options.recognizers&&i.forEach((function(i){var o=n.get(i);e?(o.requireFailure(t),r.dropRequireFailure(i)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}}},{key:"_addEventHandler",value:function(t,e,n,r,i){if("string"==typeof t){var o=this.manager,a=this.events,s=ne[t]||t,u=a.get(s);u||(u=new we(this),a.set(s,u),u.recognizerName=ee[s]||s,o&&o.on(s,u.handleEvent)),u.add(t,e,n,r,i),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}else for(var c in n=e,t)this._addEventHandler(c,t[c],n,r,i)}},{key:"_removeEventHandler",value:function(t,e){if("string"==typeof t){var n=this.events,r=ne[t]||t,i=n.get(r);if(i&&(i.remove(t,e),i.isEmpty())){var o,a=i.recognizerName,s=!1,u=xe(n.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;if(c.recognizerName===a&&!c.isEmpty()){s=!0;break}}}catch(t){u.e(t)}finally{u.f()}s||this._toggleRecognizer(a,!1)}}else for(var l in t)this._removeEventHandler(l,t[l])}}]),t}(),Ee=n(44);function Te(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return je(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return je(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function je(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Me(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ie(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Me(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Re(){}n.d(e,"a",(function(){return Le}));var De={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Re,onResize:Re,onViewStateChange:Re,onInteractionStateChange:Re,onBeforeRender:Re,onAfterRender:Re,onLoad:Re,onError:function(t){return f.a.error(t.message)()},onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:function(t){return t.isDragging?"grabbing":"grab"},getTooltip:null,debug:!1,drawPickingColors:!1},Le=function(){function t(e){var n=this;i()(this,t),u()(this,"props",void 0),u()(this,"width",0),u()(this,"height",0),u()(this,"userData",{}),u()(this,"canvas",null),u()(this,"viewManager",null),u()(this,"layerManager",null),u()(this,"effectManager",null),u()(this,"deckRenderer",null),u()(this,"deckPicker",null),u()(this,"eventManager",null),u()(this,"tooltip",null),u()(this,"metrics",void 0),u()(this,"animationLoop",void 0),u()(this,"stats",void 0),u()(this,"viewState",void 0),u()(this,"cursorState",void 0),u()(this,"_needsRedraw",void 0),u()(this,"_pickRequest",void 0),u()(this,"_lastPointerDownInfo",null),u()(this,"_metricsCounter",void 0),u()(this,"_onPointerMove",(function(t){var e=n._pickRequest;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;var r=t.offsetCenter;if(!r)return;e.x=r.x,e.y=r.y,e.radius=n.props.pickingRadius}n.layerManager&&(n.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t})),u()(this,"_onEvent",(function(t){var e=j.b[t.type],r=t.offsetCenter;if(e&&r&&n.layerManager){var i=n.layerManager.getLayers(),o=n.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:i,viewports:n.getViewports(r)},n._lastPointerDownInfo),a=o.layer,s=a&&(a[e.handler]||a.props[e.handler]),u=n.props[e.handler],c=!1;s&&(c=s.call(a,o,t)),!c&&u&&u(o,t)}})),u()(this,"_onPointerDown",(function(t){var e=t.offsetCenter,r=n._pick("pickObject","pickObject Time",{x:e.x,y:e.y,radius:n.props.pickingRadius});n._lastPointerDownInfo=r.result[0]||r.emptyInfo})),this.props=Ie(Ie({},De),e),e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&f.a.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===Object(vt.a)()&&f.a.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new Ft.a({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&dt.a.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}return a()(t,[{key:"finalize",value:function(){var t,e,n,r,i,o,a,s;(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(t=this.layerManager)||void 0===t||t.finalize(),this.layerManager=null,null===(e=this.viewManager)||void 0===e||e.finalize(),this.viewManager=null,null===(n=this.effectManager)||void 0===n||n.finalize(),this.effectManager=null,null===(r=this.deckRenderer)||void 0===r||r.finalize(),this.deckRenderer=null,null===(i=this.deckPicker)||void 0===i||i.finalize(),this.deckPicker=null,null===(o=this.eventManager)||void 0===o||o.destroy(),this.eventManager=null,null===(a=this.tooltip)||void 0===a||a.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas)||(null===(s=this.canvas.parentElement)||void 0===s||s.removeChild(this.canvas),this.canvas=null)}},{key:"setProps",value:function(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&f.a.removed("onLayerHover","onHover")(),"onLayerClick"in t&&f.a.removed("onLayerClick","onClick")(),t.initialViewState&&!Object(l.a)(this.props.initialViewState,t.initialViewState)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);var e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}},{key:"needsRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{clearRedrawFlags:!1};if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";var e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);var n=this.viewManager.needsRedraw(t),r=this.layerManager.needsRedraw(t),i=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||r||i||o}},{key:"redraw",value:function(t){if(this.layerManager){var e=this.needsRedraw({clearRedrawFlags:!0});(e=t||e)&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}}},{key:"isInitialized",get:function(){return null!==this.viewManager}},{key:"getViews",value:function(){return Object(Ee.a)(this.viewManager),this.viewManager.views}},{key:"getViewports",value:function(t){return Object(Ee.a)(this.viewManager),this.viewManager.getViewports(t)}},{key:"pickObject",value:function(t){var e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}},{key:"pickMultipleObjects",value:function(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}},{key:"pickObjects",value:function(t){return this._pick("pickObjects","pickObjects Time",t)}},{key:"_addResources",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}},{key:"_removeResources",value:function(t){var e,n=Te(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.layerManager.resourceManager.remove(r)}}catch(t){n.e(t)}finally{n.f()}}},{key:"_pick",value:function(t,e,n){Object(Ee.a)(this.deckPicker);var r=this.stats;r.get("Pick Count").incrementCount(),r.get(e).timeStart();var i=this.deckPicker[t](Ie({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects()},n));return r.get(e).timeEnd(),i}},{key:"_createCanvas",value:function(t){var e=t.canvas;("string"==typeof e&&(e=document.getElementById(e),Object(Ee.a)(e)),e)||((e=document.createElement("canvas")).id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(e));return Object.assign(e.style,t.style),e}},{key:"_setCanvasSize",value:function(t){if(this.canvas){var e=t.width,n=t.height;if(e||0===e){var r=Number.isFinite(e)?"".concat(e,"px"):e;this.canvas.style.width=r}if(n||0===n){var i,o=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=(null===(i=t.style)||void 0===i?void 0:i.position)||"absolute",this.canvas.style.height=o}}}},{key:"_updateCanvasSize",value:function(){var t=this.canvas;if(t){var e,n=t.clientWidth||t.width,r=t.clientHeight||t.height;if(n!==this.width||r!==this.height)this.width=n,this.height=r,null===(e=this.viewManager)||void 0===e||e.setProps({width:n,height:r}),this.props.onResize({width:n,height:r})}}},{key:"_createAnimationLoop",value:function(t){var e=this,n=t.width,r=t.height,i=t.gl,o=t.glOptions,a=t.debug,s=t.onError,u=t.onBeforeRender,c=t.onAfterRender,l=t.useDevicePixels;return new Dt({width:n,height:r,useDevicePixels:l,autoResizeViewport:!1,gl:i,onCreateContext:function(t){return Object(T.c)(Ie(Ie(Ie({},o),t),{},{canvas:e.canvas,debug:a,onContextLost:function(){return e._onContextLost()}}))},onInitialize:function(t){return e._setGLContext(t.gl)},onRender:this._onRenderFrame.bind(this),onBeforeRender:u,onAfterRender:c,onError:s})}},{key:"_getViewState",value:function(){return this.props.viewState||this.viewState}},{key:"_getViews",value:function(){var t=this.props.views||[new g.a({id:"default-view"})];return(t=Array.isArray(t)?t:[t]).length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}},{key:"_onContextLost",value:function(){var t=this.props.onError;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}},{key:"_pickAndCallback",value:function(){var t=this._pickRequest;if(t.event){var e=this._pick("pickObject","pickObject Time",t),n=e.result,r=e.emptyInfo;this.cursorState.isHovering=n.length>0;var i,o=r,a=!1,s=Te(n);try{for(s.s();!(i=s.n()).done;){var u,c=i.value;o=c,a=(null===(u=c.layer)||void 0===u?void 0:u.onHover(c,t.event))||a}}catch(t){s.e(t)}finally{s.f()}if(!a&&this.props.onHover&&this.props.onHover(o,t.event),this.props.getTooltip&&this.tooltip){var l=this.props.getTooltip(o);this.tooltip.setTooltip(l,o.x,o.y)}t.event=null}}},{key:"_updateCursor",value:function(){var t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}},{key:"_setGLContext",value:function(t){if(!this.layerManager){this.canvas||(this.canvas=t.canvas,Object(T.h)(t,{enable:!0,copyState:!0})),this.tooltip=new ht(this.canvas),Object(T.n)(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);var e=new Lt.a;for(var n in e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new ke(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}}),j.b)this.eventManager.on(n,this._onEvent);this.viewManager=new v({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});var r=this.viewManager.getViewports()[0];this.layerManager=new c.a(t,{deck:this,stats:this.stats,viewport:r,timeline:e}),this.effectManager=new X,this.deckRenderer=new q.a(t),this.deckPicker=new lt(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}}},{key:"_drawLayers",value:function(t,e){var n=this.layerManager.context.gl;Object(T.n)(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers(Ie({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:t,effects:this.effectManager.getEffects()},e)),this.props.onAfterRender({gl:n})}},{key:"_onRenderFrame",value:function(t){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),f.a.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}},{key:"_onViewStateChange",value:function(t){var e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState=Ie(Ie({},this.viewState),{},u()({},t.viewId,e)),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}},{key:"_onInteractionStateChange",value:function(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}},{key:"_getFrameStats",value:function(){var t=this.stats;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();var e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}},{key:"_getMetrics",value:function(){var t=this.metrics,e=this.stats;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();var n=Ot.b.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}]),t}();u()(Le,"defaultProps",De),u()(Le,"VERSION",pt.a.VERSION)},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(5),u=n.n(s),c=n(7),l=n.n(c),f=n(2),h=n.n(f),d=n(0),p=n.n(d),v=n(204),g=n(120),y={source:0,target:1,custom:2,source_target:3},m={name:"brushing",dependencies:[g.a],vs:"\n  uniform bool brushing_enabled;\n  uniform int brushing_target;\n  uniform vec2 brushing_mousePos;\n  uniform float brushing_radius;\n\n  #ifdef NON_INSTANCED_MODEL\n  attribute vec2 brushingTargets;\n  #else\n  attribute vec2 instanceBrushingTargets;\n  #endif\n\n  varying float brushing_isVisible;\n\n  bool brushing_isPointInRange(vec2 position) {\n    if (!brushing_enabled) {\n      return true;\n    }\n    vec2 source_commonspace = project_position(position);\n    vec2 target_commonspace = project_position(brushing_mousePos);\n    float distance = length((target_commonspace - source_commonspace) / project_uCommonUnitsPerMeter.xy);\n\n    return distance <= brushing_radius;\n  }\n\n  bool brushing_arePointsInRange(vec2 sourcePos, vec2 targetPos) {\n    return brushing_isPointInRange(sourcePos) || brushing_isPointInRange(targetPos);\n  }\n\n  void brushing_setVisible(bool visible) {\n    brushing_isVisible = float(visible);\n  }\n",fs:"\n  uniform bool brushing_enabled;\n  varying float brushing_isVisible;\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    vec2 brushingTarget;\n    vec2 brushingSource;\n    if (brushing_target == 3) {\n      brushingTarget = geometry.worldPositionAlt.xy;\n      brushingSource = geometry.worldPosition.xy;\n    } else if (brushing_target == 0) {\n      brushingTarget = geometry.worldPosition.xy;\n    } else if (brushing_target == 1) {\n      brushingTarget = geometry.worldPositionAlt.xy;\n    } else {\n      #ifdef NON_INSTANCED_MODEL\n      brushingTarget = brushingTargets;\n      #else\n      brushingTarget = instanceBrushingTargets;\n      #endif\n    }\n    bool visible;\n    if (brushing_target == 3) {\n      visible = brushing_arePointsInRange(brushingSource, brushingTarget);\n    } else {\n      visible = brushing_isPointInRange(brushingTarget);\n    }\n    brushing_setVisible(visible);\n  ","fs:DECKGL_FILTER_COLOR":"\n    if (brushing_enabled && brushing_isVisible < 0.5) {\n      discard;\n    }\n  "},getUniforms:function(t){if(!(t&&"viewport"in t))return{};var e=t.brushingEnabled,n=void 0===e||e,r=t.brushingRadius,i=void 0===r?1e4:r,o=t.brushingTarget,a=void 0===o?"source":o,s=t.mousePosition,u=t.viewport;return{brushing_enabled:Boolean(n&&s&&u.containsPixel(s)),brushing_radius:i,brushing_target:y[a]||0,brushing_mousePos:s?u.unproject([s.x-u.x,s.y-u.y]):[0,0]}}};function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var A=function(t){u()(n,t);var e=b(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return{modules:[m]}}},{key:"initializeState",value:function(t,e){var n=this,r=this.getAttributeManager();r&&r.add({brushingTargets:{size:2,accessor:"getBrushingTarget",update:this.props.getBrushingTarget?void 0:e.useConstantTargetPositions,shaderAttributes:{brushingTargets:{divisor:0},instanceBrushingTargets:{divisor:1}}}}),this.state.onMouseMove=function(){var t;null===(t=n.getCurrentLayer())||void 0===t||t.setNeedsRedraw()},t.deck&&t.deck.eventManager.on({pointermove:this.state.onMouseMove,pointerleave:this.state.onMouseMove})}},{key:"finalizeState",value:function(t,e){t.deck&&t.deck.eventManager.off({pointermove:this.state.onMouseMove,pointerleave:this.state.onMouseMove})}},{key:"useConstantTargetPositions",value:function(t){t.constant=!0,t.value=new Float32Array(2)}}]),n}(v.a);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){p()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}p()(A,"defaultProps",{getBrushingTarget:{type:"accessor",value:[0,0]},brushingTarget:"source",brushingEnabled:!0,brushingRadius:1e4}),p()(A,"extensionName","BrushingExtension");var w="\nuniform DATAFILTER_TYPE filter_min;\nuniform DATAFILTER_TYPE filter_softMin;\nuniform DATAFILTER_TYPE filter_softMax;\nuniform DATAFILTER_TYPE filter_max;\nuniform bool filter_useSoftMargin;\nuniform bool filter_enabled;\nuniform bool filter_transformSize;\n\n#ifdef NON_INSTANCED_MODEL\n  #define DATAFILTER_ATTRIB filterValues\n  #define DATAFILTER_ATTRIB_64LOW filterValues64Low\n#else\n  #define DATAFILTER_ATTRIB instanceFilterValues\n  #define DATAFILTER_ATTRIB_64LOW instanceFilterValues64Low\n#endif\n\nattribute DATAFILTER_TYPE DATAFILTER_ATTRIB;\n#ifdef DATAFILTER_DOUBLE\n  attribute DATAFILTER_TYPE DATAFILTER_ATTRIB_64LOW;\n\n  uniform DATAFILTER_TYPE filter_min64High;\n  uniform DATAFILTER_TYPE filter_max64High;\n#endif\n\nvarying float dataFilter_value;\n\nfloat dataFilter_reduceValue(float value) {\n  return value;\n}\nfloat dataFilter_reduceValue(vec2 value) {\n  return min(value.x, value.y);\n}\nfloat dataFilter_reduceValue(vec3 value) {\n  return min(min(value.x, value.y), value.z);\n}\nfloat dataFilter_reduceValue(vec4 value) {\n  return min(min(value.x, value.y), min(value.z, value.w));\n}\nvoid dataFilter_setValue(DATAFILTER_TYPE valueFromMin, DATAFILTER_TYPE valueFromMax) {\n  if (filter_enabled) {\n    if (filter_useSoftMargin) {\n      dataFilter_value = dataFilter_reduceValue(\n        smoothstep(filter_min, filter_softMin, valueFromMin) *\n        (1.0 - smoothstep(filter_softMax, filter_max, valueFromMax))\n      );\n    } else {\n      dataFilter_value = dataFilter_reduceValue(\n        step(filter_min, valueFromMin) * step(valueFromMax, filter_max)\n      );\n    }\n  } else {\n    dataFilter_value = 1.0;\n  }\n}\n",x="\nuniform bool filter_transformColor;\nvarying float dataFilter_value;\n";function C(t){if(!(t&&"extensions"in t))return{};var e=t.filterRange,n=void 0===e?[-1,1]:e,r=t.filterEnabled,i=void 0===r||r,o=t.filterTransformSize,a=void 0===o||o,s=t.filterTransformColor,u=void 0===s||s,c=t.filterSoftRange||n;return O(O({},Number.isFinite(n[0])?{filter_min:n[0],filter_softMin:c[0],filter_softMax:c[1],filter_max:n[1]}:{filter_min:n.map((function(t){return t[0]})),filter_softMin:c.map((function(t){return t[0]})),filter_softMax:c.map((function(t){return t[1]})),filter_max:n.map((function(t){return t[1]}))}),{},{filter_enabled:i,filter_useSoftMargin:Boolean(t.filterSoftRange),filter_transformSize:i&&a,filter_transformColor:i&&u})}var P={"vs:#main-start":"\n    #ifdef DATAFILTER_DOUBLE\n      dataFilter_setValue(\n        DATAFILTER_ATTRIB - filter_min64High + DATAFILTER_ATTRIB_64LOW,\n        DATAFILTER_ATTRIB - filter_max64High + DATAFILTER_ATTRIB_64LOW\n      );\n    #else\n      dataFilter_setValue(DATAFILTER_ATTRIB, DATAFILTER_ATTRIB);\n    #endif\n  ","vs:DECKGL_FILTER_SIZE":"\n    if (filter_transformSize) {\n      size = size * dataFilter_value;\n    }\n  ","fs:DECKGL_FILTER_COLOR":"\n    if (dataFilter_value == 0.0) discard;\n    if (filter_transformColor) {\n      color.a *= dataFilter_value;\n    }\n  "},S={name:"data-filter",vs:w,fs:x,inject:P,getUniforms:C},B={name:"data-filter-fp64",vs:w,fs:x,inject:P,getUniforms:function(t){if(!(t&&"extensions"in t))return{};var e=C(t);if(Number.isFinite(e.filter_min)){var n=Math.fround(e.filter_min);e.filter_min-=n,e.filter_softMin-=n,e.filter_min64High=n;var r=Math.fround(e.filter_max);e.filter_max-=r,e.filter_softMax-=r,e.filter_max64High=r}else{var i=e.filter_min.map(Math.fround);e.filter_min=e.filter_min.map((function(t,e){return t-i[e]})),e.filter_softMin=e.filter_softMin.map((function(t,e){return t-i[e]})),e.filter_min64High=i;var o=e.filter_max.map(Math.fround);e.filter_max=e.filter_max.map((function(t,e){return t-o[e]})),e.filter_softMax=e.filter_softMax.map((function(t,e){return t-o[e]})),e.filter_max64High=o}return e}},k=n(95),E=n(123),T=n(12),j=n(194);function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function I(t,e,n){return e.defines.NON_INSTANCED_MODEL=1,n&&(e.defines.FLOAT_TARGET=1),new j.a(t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){p()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({id:"data-filter-aggregation-model",vertexCount:1,isInstanced:!1,drawMode:0,vs:"#define SHADER_NAME data-filter-vertex-shader\n\n#ifdef FLOAT_TARGET\n  attribute float filterIndices;\n  attribute float filterPrevIndices;\n#else\n  attribute vec2 filterIndices;\n  attribute vec2 filterPrevIndices;\n#endif\n\nvarying vec4 vColor;\nconst float component = 1.0 / 255.0;\n\nvoid main() {\n  #ifdef FLOAT_TARGET\n    dataFilter_value *= float(filterIndices != filterPrevIndices);\n    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n    vColor = vec4(0.0, 0.0, 0.0, 1.0);\n  #else\n    // Float texture is not supported: pack result into 4 channels x 256 px x 64px\n    dataFilter_value *= float(filterIndices.x != filterPrevIndices.x);\n    float col = filterIndices.x;\n    float row = filterIndices.y * 4.0;\n    float channel = floor(row);\n    row = fract(row);\n    vColor = component * vec4(bvec4(channel == 0.0, channel == 1.0, channel == 2.0, channel == 3.0));\n    gl_Position = vec4(col * 2.0 - 1.0, row * 2.0 - 1.0, 0.0, 1.0);\n  #endif\n  gl_PointSize = 1.0;\n}\n",fs:"#define SHADER_NAME data-filter-fragment-shader\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main() {\n  if (dataFilter_value < 0.5) {\n    discard;\n  }\n  gl_FragColor = vColor;\n}\n"},e))}var R={blend:!0,blendFunc:[1,1,1,1],blendEquation:[32774,32774],depthTest:!1},D=n(197),L=n(212);function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function G(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){p()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function N(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var U={1:"float",2:"vec2",3:"vec3",4:"vec4"},z=function(t){u()(n,t);var e=N(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.filterSize,o=void 0===r?1:r,a=t.fp64,s=void 0!==a&&a,u=t.countItems,c=void 0!==u&&u;if(i()(this,n),!U[o])throw new Error("filterSize out of range");return e.call(this,{filterSize:o,fp64:s,countItems:c})}return a()(n,[{key:"getShaders",value:function(t){var e=t.opts,n=e.filterSize,r=e.fp64;return{modules:[r?B:S],defines:{DATAFILTER_TYPE:U[n],DATAFILTER_DOUBLE:Boolean(r)}}}},{key:"initializeState",value:function(t,e){var n=this.getAttributeManager();n&&n.add({filterValues:{size:e.opts.filterSize,type:e.opts.fp64?5130:5126,accessor:"getFilterValue",shaderAttributes:{filterValues:{divisor:0},instanceFilterValues:{divisor:1}}}});var r=this.context.gl;if(n&&e.opts.countItems){var i=function(t){return Boolean(t.getExtension("EXT_float_blend")&&(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")))}(r);n.add({filterIndices:{size:i?1:2,vertexOffset:1,type:5121,normalized:!0,accessor:function(t,e){var n=e.index,r=t&&t.__source?t.__source.index:n;return i?(r+1)%255:[(r+1)%255,Math.floor(r/255)%255]},shaderAttributes:{filterPrevIndices:{vertexOffset:0},filterIndices:{vertexOffset:1}}}});var o=function(t,e){return e?new k.a(t,{width:1,height:1,attachments:p()({},36064,new E.a(t,{format:Object(T.j)(t)?34836:6408,type:5126,mipmaps:!1}))}):new k.a(t,{width:256,height:64,depth:!1})}(r,i),a=I(r,e.getShaders.call(this,e),i);this.setState({filterFBO:o,filterModel:a})}}},{key:"updateState",value:function(t){var e=t.props,n=t.oldProps;if(this.state.filterModel){var r=this.getAttributeManager().attributes.filterValues.needsUpdate()||e.filterEnabled!==n.filterEnabled||e.filterRange!==n.filterRange||e.filterSoftRange!==n.filterSoftRange;r&&this.setState({filterNeedsUpdate:r})}}},{key:"draw",value:function(t,e){var n=this.state,r=n.filterFBO,i=n.filterModel,o=n.filterNeedsUpdate,a=this.props.onFilteredItemsChange;if(o&&a&&i){var s=this.getAttributeManager().attributes,u=s.filterValues,c=s.filterIndices;i.setVertexCount(this.getNumInstances());var l=this.context.gl;Object(D.a)(l,{framebuffer:r,color:[0,0,0,0]}),i.updateModuleSettings(t.moduleParameters).setAttributes(G(G({},u.getShaderAttributes()),c&&c.getShaderAttributes())).draw({framebuffer:r,parameters:G(G({},R),{},{viewport:[0,0,r.width,r.height]})});for(var f=Object(L.c)(r),h=0,d=0;d<f.length;d++)h+=f[d];a({id:this.id,count:h}),this.state.filterNeedsUpdate=!1}}},{key:"finalizeState",value:function(){var t=this.state,e=t.filterFBO,n=t.filterModel;e&&(e.color.delete(),e.delete(),n.delete())}}]),n}(v.a);p()(z,"defaultProps",{getFilterValue:{type:"accessor",value:0},onFilteredItemsChange:{type:"function",value:null,compare:!1},filterEnabled:!0,filterRange:[-1,1],filterSoftRange:null,filterTransformSize:!0,filterTransformColor:!0}),p()(z,"extensionName","DataFilterExtension");var H=n(20),V=n(350),J=n(101),W=V.a.fp64ify,K=V.a.fp64ifyMatrix4,X={name:"project64",dependencies:[g.a,V.a],vs:"\nconst vec2 WORLD_SCALE_FP64 = vec2(81.4873275756836, 0.0000032873668232014097);\n\nuniform vec2 project_uViewProjectionMatrixFP64[16];\n\n// longitude: lnglat_fp64.xy; latitude: lnglat_fp64.zw\nvoid mercatorProject_fp64(vec4 lnglat_fp64, out vec2 out_val[2]) {\n\n#if defined(NVIDIA_FP64_WORKAROUND)\n  out_val[0] = sum_fp64(radians_fp64(lnglat_fp64.xy), PI_FP64 * ONE);\n#else\n  out_val[0] = sum_fp64(radians_fp64(lnglat_fp64.xy), PI_FP64);\n#endif\n  out_val[1] = sum_fp64(PI_FP64,\n    log_fp64(tan_fp64(sum_fp64(PI_4_FP64, radians_fp64(lnglat_fp64.zw) / 2.0))));\n  return;\n}\n\nvoid project_position_fp64(vec4 position_fp64, out vec2 out_val[2]) {\n  vec2 pos_fp64[2];\n  mercatorProject_fp64(position_fp64, pos_fp64);\n  out_val[0] = mul_fp64(pos_fp64[0], WORLD_SCALE_FP64);\n  out_val[1] = mul_fp64(pos_fp64[1], WORLD_SCALE_FP64);\n\n  return;\n}\n\nvoid project_position_fp64(vec2 position, vec2 position64xyLow, out vec2 out_val[2]) {\n  vec4 position64xy = vec4(\n    position.x, position64xyLow.x,\n    position.y, position64xyLow.y);\n\n  project_position_fp64(position64xy, out_val);\n}\n\nvec4 project_common_position_to_clipspace_fp64(vec2 vertex_pos_modelspace[4]) {\n  vec2 vertex_pos_clipspace[4];\n  mat4_vec4_mul_fp64(project_uViewProjectionMatrixFP64, vertex_pos_modelspace,\n    vertex_pos_clipspace);\n  return vec4(\n    vertex_pos_clipspace[0].x,\n    vertex_pos_clipspace[1].x,\n    vertex_pos_clipspace[2].x,\n    vertex_pos_clipspace[3].x\n    );\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64xyLow, vec3 offset, out vec4 commonPosition\n) {\n  // This is the local offset to the instance position\n  vec2 offset64[4];\n  vec4_fp64(vec4(offset, 0.0), offset64);\n\n  float z = project_size(position.z);\n\n  // Apply web mercator projection (depends on coordinate system imn use)\n  vec2 projectedPosition64xy[2];\n  project_position_fp64(position.xy, position64xyLow.xy, projectedPosition64xy);\n\n  vec2 commonPosition64[4];\n  commonPosition64[0] = sum_fp64(offset64[0], projectedPosition64xy[0]);\n  commonPosition64[1] = sum_fp64(offset64[1], projectedPosition64xy[1]);\n  commonPosition64[2] = sum_fp64(offset64[2], vec2(z, 0.0));\n  commonPosition64[3] = vec2(1.0, 0.0);\n\n  commonPosition = vec4(projectedPosition64xy[0].x, projectedPosition64xy[1].x, z, 1.0);\n\n  return project_common_position_to_clipspace_fp64(commonPosition64);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64xyLow, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(\n    position, position64xyLow, offset, commonPosition\n  );\n}\n",getUniforms:function(t){if(t&&"viewport"in t){var e=t.viewport,n=e.viewProjectionMatrix,r=e.scale;return q({viewProjectionMatrix:n,scale:r})}return{}}},q=Object(J.a)((function(t){var e=t.viewProjectionMatrix,n=t.scale,r=K(e),i=W(n);return{project_uViewProjectionMatrixFP64:r,project64_uViewProjectionMatrix:r,project64_uScale:i}}));function Q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var Z=function(t){u()(n,t);var e=Q(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){var t=this.props.coordinateSystem;if(t!==H.a.LNGLAT&&t!==H.a.DEFAULT)throw new Error("fp64: coordinateSystem must be LNGLAT");return{modules:[X]}}}]),n}(v.a);p()(Z,"extensionName","Fp64Extension");var Y=n(174),$={inject:{"vs:#decl":"\nattribute vec2 instanceDashArrays;\nattribute float instanceDashOffsets;\nvarying vec2 vDashArray;\nvarying float vDashOffset;\n","vs:#main-end":"\nvDashArray = instanceDashArrays;\nvDashOffset = instanceDashOffsets / width.x;\n","fs:#decl":"\nuniform float dashAlignMode;\nuniform float capType;\nuniform bool dashGapPickable;\nvarying vec2 vDashArray;\nvarying float vDashOffset;\n\nfloat round(float x) {\n  return floor(x + 0.5);\n}\n","fs:#main-start":"\n  float solidLength = vDashArray.x;\n  float gapLength = vDashArray.y;\n  float unitLength = solidLength + gapLength;\n\n  float offset;\n\n  if (unitLength > 0.0) {\n    if (dashAlignMode == 0.0) {\n      offset = vDashOffset;\n    } else {\n      unitLength = vPathLength / round(vPathLength / unitLength);\n      offset = solidLength / 2.0;\n    }\n\n    float unitOffset = mod(clamp(vPathPosition.y, 0.0, vPathLength) + offset, unitLength);\n\n    if (gapLength > 0.0 && unitOffset > solidLength) {\n      if (capType <= 0.5) {\n        if (!(dashGapPickable && picking_uActive)) {\n          discard;\n        }\n      } else {\n        // caps are rounded, test the distance to solid ends\n        float distToEnd = length(vec2(\n          min(unitOffset - solidLength, unitLength - unitOffset),\n          vPathPosition.x\n        ));\n        if (distToEnd > 1.0) {\n          if (!(dashGapPickable && picking_uActive)) {\n            discard;\n          }\n        }\n      }\n    }\n  }\n"}},tt={inject:{"vs:#decl":"\nattribute float instanceOffsets;\n","vs:DECKGL_FILTER_SIZE":"\n  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;\n  size *= offsetWidth;\n","vCornerOffset = offsetVec;":"\n  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;\n  vec2 offsetCenter = -instanceOffsets * (isCap ? perp : miterVec * miterSize) * 2.0;\n  vCornerOffset = vCornerOffset * offsetWidth - offsetCenter;\n","fs:#main-start":"\n  float isInside;\n  isInside = step(-1.0, vPathPosition.x) * step(vPathPosition.x, 1.0);\n  if (isInside == 0.0) {\n    discard;\n  }\n"}},et=n(39);function nt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var rt=function(t){u()(n,t);var e=nt(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.dash,o=void 0!==r&&r,a=t.offset,s=void 0!==a&&a,u=t.highPrecisionDash,c=void 0!==u&&u;return i()(this,n),e.call(this,{dash:o||c,offset:s,highPrecisionDash:c})}return a()(n,[{key:"isEnabled",value:function(t){return"pathTesselator"in t.state}},{key:"getShaders",value:function(t){if(!t.isEnabled(this))return null;var e={};return t.opts.dash&&(e=Object(Y.a)(e,$)),t.opts.offset&&(e=Object(Y.a)(e,tt)),e}},{key:"initializeState",value:function(t,e){var n=this.getAttributeManager();n&&e.isEnabled(this)&&(e.opts.dash&&n.addInstanced({instanceDashArrays:{size:2,accessor:"getDashArray"}}),e.opts.highPrecisionDash&&n.addInstanced({instanceDashOffsets:{size:1,accessor:"getPath",transform:e.getDashOffsets.bind(this)}}),e.opts.offset&&n.addInstanced({instanceOffsets:{size:1,accessor:"getOffset"}}))}},{key:"updateState",value:function(t,e){if(e.isEnabled(this)){var n={};e.opts.dash&&(n.dashAlignMode=this.props.dashJustified?1:0,n.dashGapPickable=Boolean(this.props.dashGapPickable)),this.state.model.setUniforms(n)}}},{key:"getDashOffsets",value:function(t){for(var e,n,r=[0],i="XY"===this.props.positionFormat?2:3,o=Array.isArray(t[0]),a=o?t.length:t.length/i,s=0;s<a-1;s++)e=o?t[s]:t.slice(s*i,s*i+i),e=this.projectPosition(e),s>0&&(r[s]=r[s-1]+Object(et.e)(n,e)),n=e;return r}}]),n}(v.a);p()(rt,"defaultProps",{getDashArray:{type:"accessor",value:[0,0]},getOffset:{type:"accessor",value:0},dashJustified:!1,dashGapPickable:!1}),p()(rt,"extensionName","PathStyleExtension");var it=n(19),ot=n.n(it),at=n(14),st=n.n(at),ut=n(52);var ct,lt={name:"fill-pattern",vs:"\n#ifdef NON_INSTANCED_MODEL\n  #define FILL_PATTERN_FRAME_ATTRIB fillPatternFrames\n  #define FILL_PATTERN_SCALE_ATTRIB fillPatternScales\n  #define FILL_PATTERN_OFFSET_ATTRIB fillPatternOffsets\n#else\n  #define FILL_PATTERN_FRAME_ATTRIB instanceFillPatternFrames\n  #define FILL_PATTERN_SCALE_ATTRIB instanceFillPatternScales\n  #define FILL_PATTERN_OFFSET_ATTRIB instanceFillPatternOffsets\n#endif\n\nattribute vec4 FILL_PATTERN_FRAME_ATTRIB;\nattribute float FILL_PATTERN_SCALE_ATTRIB;\nattribute vec2 FILL_PATTERN_OFFSET_ATTRIB;\n\nuniform bool fill_patternEnabled;\nuniform vec2 fill_patternTextureSize;\n\nvarying vec2 fill_uv;\nvarying vec4 fill_patternBounds;\nvarying vec4 fill_patternPlacement;\n",fs:"\nuniform bool fill_patternEnabled;\nuniform bool fill_patternMask;\nuniform sampler2D fill_patternTexture;\nuniform vec2 fill_uvCoordinateOrigin;\nuniform vec2 fill_uvCoordinateOrigin64Low;\n\nvarying vec4 fill_patternBounds;\nvarying vec4 fill_patternPlacement;\nvarying vec2 fill_uv;\n\nconst float FILL_UV_SCALE = 512.0 / 40000000.0;\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    fill_uv = geometry.position.xy;\n  ","vs:DECKGL_FILTER_COLOR":"\n    if (fill_patternEnabled) {\n      fill_patternBounds = FILL_PATTERN_FRAME_ATTRIB / vec4(fill_patternTextureSize, fill_patternTextureSize);\n      fill_patternPlacement.xy = FILL_PATTERN_OFFSET_ATTRIB;\n      fill_patternPlacement.zw = FILL_PATTERN_SCALE_ATTRIB * FILL_PATTERN_FRAME_ATTRIB.zw;\n    }\n  ","fs:DECKGL_FILTER_COLOR":"\n    if (fill_patternEnabled) {\n      vec2 scale = FILL_UV_SCALE * fill_patternPlacement.zw;\n      vec2 patternUV = mod(mod(fill_uvCoordinateOrigin, scale) + fill_uvCoordinateOrigin64Low + fill_uv, scale) / scale;\n      patternUV = mod(fill_patternPlacement.xy + patternUV, 1.0);\n\n      vec2 texCoords = fill_patternBounds.xy + fill_patternBounds.zw * patternUV;\n\n      vec4 patternColor = texture2D(fill_patternTexture, texCoords);\n      color.a *= patternColor.a;\n      if (!fill_patternMask) {\n        color.rgb = patternColor.rgb;\n      }\n    }\n  "},dependencies:[g.a],getUniforms:function(t,e){if(!t)return{};if("fillPatternTexture"in t){var n=t.fillPatternTexture;return{fill_patternTexture:n,fill_patternTextureSize:[n.width,n.height]}}if("viewport"in t){var r=t.viewport,i=t.fillPatternMask,o=void 0===i||i,a=t.fillPatternEnabled,s=void 0===a||a,u=e.project_uCoordinateOrigin,c=r.projectPosition(u),l=[Object(ut.b)(c[0]),Object(ut.b)(c[1])];return{fill_uvCoordinateOrigin:c.slice(0,2),fill_uvCoordinateOrigin64Low:l,fill_patternMask:o,fill_patternEnabled:s}}return{}}};function ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var ht=(ct={},p()(ct,10241,9729),p()(ct,10240,9729),p()(ct,10242,33071),p()(ct,10243,33071),ct),dt=function(t){u()(o,t);var e,n,r=ft(o);function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.pattern,n=void 0!==e&&e;return i()(this,o),r.call(this,{pattern:n})}return a()(o,[{key:"isEnabled",value:function(t){return null!==t.getAttributeManager()&&!("pathTesselator"in t.state)}},{key:"getShaders",value:function(t){return t.isEnabled(this)?{modules:[t.opts.pattern&&lt].filter(Boolean)}:null}},{key:"initializeState",value:function(t,e){if(e.isEnabled(this)){var n=this.getAttributeManager();e.opts.pattern&&n.add({fillPatternFrames:{size:4,accessor:"getFillPattern",transform:e.getPatternFrame.bind(this),shaderAttributes:{fillPatternFrames:{divisor:0},instanceFillPatternFrames:{divisor:1}}},fillPatternScales:{size:1,accessor:"getFillPatternScale",defaultValue:1,shaderAttributes:{fillPatternScales:{divisor:0},instanceFillPatternScales:{divisor:1}}},fillPatternOffsets:{size:2,accessor:"getFillPatternOffset",shaderAttributes:{fillPatternOffsets:{divisor:0},instanceFillPatternOffsets:{divisor:1}}}}),this.setState({emptyTexture:new E.a(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}}},{key:"updateState",value:function(t,e){var n=t.props,r=t.oldProps;e.isEnabled(this)&&(n.fillPatternAtlas&&n.fillPatternAtlas!==r.fillPatternAtlas&&e.loadPatternAtlas.call(this),n.fillPatternMapping&&n.fillPatternMapping!==r.fillPatternMapping&&e.loadPatternMapping.call(this))}},{key:"draw",value:function(t,e){if(e.isEnabled(this)){var n=this.state.patternTexture;this.setModuleParameters({fillPatternTexture:n||this.state.emptyTexture})}}},{key:"finalizeState",value:function(){var t=this.state,e=t.patternTexture,n=t.emptyTexture;null==e||e.delete(),null==n||n.delete()}},{key:"loadPatternAtlas",value:(n=ot()(st.a.mark((function t(){var e,n,r,i,o,a;return st.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.props,r=n.fillPatternAtlas,i=n.fetch,null===(e=this.state.patternTexture)||void 0===e||e.delete(),this.setState({patternTexture:null}),"string"!=typeof(o=r)){t.next=8;break}return t.next=7,i(o,{propName:"fillPatternAtlas",layer:this});case 7:o=t.sent;case 8:a=o instanceof E.a?o:new E.a(this.context.gl,{data:o,parameters:ht}),this.setState({patternTexture:a});case 10:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"loadPatternMapping",value:(e=ot()(st.a.mark((function t(){var e,n,r,i;return st.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.props,n=e.fillPatternMapping,r=e.fetch,this.setState({patternMapping:null}),"string"!=typeof(i=n)){t.next=7;break}return t.next=6,r(i,{propName:"fillPatternMapping",layer:this});case 6:i=t.sent;case 7:this.setState({patternMapping:i}),this.getAttributeManager().invalidate("getFillPattern"),this.setNeedsUpdate();case 10:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"getPatternFrame",value:function(t){var e=this.state.patternMapping,n=e&&e[t];return n?[n.x,n.y,n.width,n.height]:[0,0,0,0]}}]),o}(v.a);p()(dt,"defaultProps",{fillPatternEnabled:!0,fillPatternAtlas:null,fillPatternMapping:null,fillPatternMask:!0,getFillPattern:{type:"accessor",value:function(t){return t.pattern}},getFillPatternScale:{type:"accessor",value:1},getFillPatternOffset:{type:"accessor",value:[0,0]}}),p()(dt,"extensionName","FillStyleExtension");var pt=n(235),vt=n(31),gt={name:"mask",dependencies:[g.a],vs:"\nuniform vec4 mask_bounds;\nuniform bool mask_maskByInstance;\nvec2 mask_getCoords(vec4 position) {\n  return (position.xy - mask_bounds.xy) / (mask_bounds.zw - mask_bounds.xy);\n}\n",fs:"\nuniform sampler2D mask_texture;\nuniform int mask_channel;\nuniform bool mask_enabled;\nbool mask_isInBounds(vec2 texCoords) {\n  if (!mask_enabled) {\n    return true;\n  }\n  vec4 maskColor = texture2D(mask_texture, texCoords);\n  float maskValue = 1.0;\n  if (mask_channel == 0) {\n    maskValue = maskColor.r;\n  } else if (mask_channel == 1) {\n    maskValue = maskColor.g;\n  } else if (mask_channel == 2) {\n    maskValue = maskColor.b;\n  } else if (mask_channel == 3) {\n    maskValue = maskColor.a;\n  }\n  return maskValue < 0.5;\n}\n",inject:{"vs:#decl":"\nvarying vec2 mask_texCoords;\n","vs:#main-end":"\n   vec4 mask_common_position;\n   if (mask_maskByInstance) {\n     mask_common_position = project_position(vec4(geometry.worldPosition, 1.0));\n   } else {\n     mask_common_position = geometry.position;\n   }\n   mask_texCoords = mask_getCoords(mask_common_position);\n","fs:#decl":"\nvarying vec2 mask_texCoords;\n","fs:#main-start":"\n  if (mask_enabled) {\n    bool mask = mask_isInBounds(mask_texCoords);\n\n    // Debug: show extent of render target\n    // gl_FragColor = vec4(mask_texCoords, 0.0, 1.0);\n    gl_FragColor = texture2D(mask_texture, mask_texCoords);\n\n    if (!mask) discard;\n  }\n"},getUniforms:function(t){return t&&"maskMap"in t?{mask_texture:t.maskMap}:{}}};function yt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var mt=function(t){u()(n,t);var e=yt(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){var t="instancePositions"in this.getAttributeManager().attributes;return"maskByInstance"in this.props&&(t=Boolean(this.props.maskByInstance)),this.state.maskByInstance=t,{modules:[gt]}}},{key:"draw",value:function(t){var e=t.uniforms,n=t.context,r=t.moduleParameters;e.mask_maskByInstance=this.state.maskByInstance;var i=this.props.maskId,o=void 0===i?"":i,a=r.maskChannels,s=n.viewport;if(a&&a[o]){var u=a[o],c=u.index,l=u.bounds,f=u.coordinateOrigin,h=a[o].coordinateSystem;e.mask_enabled=!0,e.mask_channel=c,h===H.a.DEFAULT&&(h=s.isGeospatial?H.a.LNGLAT:H.a.CARTESIAN);var d={modelMatrix:null,fromCoordinateOrigin:f,fromCoordinateSystem:h},p=this.projectPosition([l[0],l[1],0],d),v=this.projectPosition([l[2],l[3],0],d);e.mask_bounds=[p[0],p[1],v[0],v[1]]}else o&&vt.a.warn("Could not find a mask layer with id: ".concat(o))(),e.mask_enabled=!1}}]),n}(v.a);p()(mt,"defaultProps",{maskId:""}),p()(mt,"extensionName","MaskExtension"),n.d(e,"BrushingExtension",(function(){return A})),n.d(e,"DataFilterExtension",(function(){return z})),n.d(e,"Fp64Extension",(function(){return Z})),n.d(e,"PathStyleExtension",(function(){return rt})),n.d(e,"FillStyleExtension",(function(){return dt})),n.d(e,"ClipExtension",(function(){return pt.a})),n.d(e,"MaskExtension",(function(){return mt})),n.d(e,"project64",(function(){return X}))},function(t,e,n){"use strict";var r=n(140),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(10),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(203),A=n(193);function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function w(t,e){if(!t)return null;var n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return-1!==n?function(t,e,n){var r={properties:O({},t.properties[e])};for(var i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}(t,r,n):null}var x=n(133),C=n(180),P=n(179),S=n(132),B=n(131),k={circle:{type:C.a,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:x.a,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:P.a,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},E={type:S.a,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},T={type:B.a,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function j(t){var e=t.type,n=t.props,r={};for(var i in n)r[i]=e.defaultProps[n[i]];return r}function M(t,e){var n=t.props,r=n.transitions,i=n.updateTriggers,o={updateTriggers:{},transitions:r&&{getPosition:r.geometry}};for(var a in e){var s=e[a],u=t.props[a];a.startsWith("get")&&(u=t.getSubLayerAccessor(u),o.updateTriggers[s]=i[a],r&&(o.transitions[s]=r[a])),o[s]=u}return o}var I=n(31);function R(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},i=n.startRow,o=void 0===i?0:i,a=n.endRow,s=void 0===a?t.length:a,u=o;u<s;u++){var c=t[u],l=c.geometry;if(l)if("GeometryCollection"===l.type){I.a.assert(Array.isArray(l.geometries),"GeoJSON does not have geometries array");for(var f=l.geometries,h=0;h<f.length;h++){var d=f[h];D(d,r,e,c,u)}}else D(l,r,e,c,u)}return r}function D(t,e,n,r,i){var o=t.type,a=t.coordinates,s=e.pointFeatures,u=e.lineFeatures,c=e.polygonFeatures,l=e.polygonOutlineFeatures;if(function(t,e){var n=L[t];I.a.assert(n,"Unknown GeoJSON type ".concat(t));for(;e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}(o,a))switch(o){case"Point":s.push(n({geometry:t},r,i));break;case"MultiPoint":a.forEach((function(t){s.push(n({geometry:{type:"Point",coordinates:t}},r,i))}));break;case"LineString":u.push(n({geometry:t},r,i));break;case"MultiLineString":a.forEach((function(t){u.push(n({geometry:{type:"LineString",coordinates:t}},r,i))}));break;case"Polygon":c.push(n({geometry:t},r,i)),a.forEach((function(t){l.push(n({geometry:{type:"LineString",coordinates:t}},r,i))}));break;case"MultiPolygon":a.forEach((function(t){c.push(n({geometry:{type:"Polygon",coordinates:t}},r,i)),t.forEach((function(t){l.push(n({geometry:{type:"LineString",coordinates:t}},r,i))}))}))}else I.a.warn("".concat(o," coordinates are malformed"))()}var L={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function G(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function N(t){return t.geometry.coordinates}function U(t,e){var n={points:{},lines:{},polygons:{},polygonsOutline:{}},r=t.points,i=t.lines,o=t.polygons,a=function(t,e){var n={points:null,lines:null,polygons:null};for(var r in n){var i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(3*i.length);for(var o=[],a=0;a<i.length;a++)e(i[a],o),n[r][3*a+0]=o[0],n[r][3*a+1]=o[1],n[r][3*a+2]=o[2]}return n}(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:G(G({},r.attributes),{},{getPosition:r.positions,instancePickingColors:{size:3,value:a.points}}),properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:G(G({},i.attributes),{},{getPath:i.positions,instancePickingColors:{size:3,value:a.lines}}),properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:G(G({},o.attributes),{},{getPolygon:o.positions,pickingColors:{size:3,value:a.polygons}}),properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:G(G({},o.attributes),{},{getPath:o.positions,instancePickingColors:{size:3,value:a.polygons}}),properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}n.d(e,"a",(function(){return Q}));var z=["instancePickingColors"];function H(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return V(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function J(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function K(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var X=["points","linestrings","polygons"],q=K(K(K(K(K(K({},j(k.circle)),j(k.icon)),j(k.text)),j(E)),j(T)),{},{stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:function(t){return t.properties.icon}},getText:{type:"accessor",value:function(t){return t.properties.text}},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}}),Q=function(t){h()(n,t);var e=J(n);function n(){return a()(this,n),e.apply(this,arguments)}return u()(n,[{key:"initializeState",value:function(){this.state={layerProps:{},features:{}}}},{key:"updateState",value:function(t){var e=t.props,n=t.changeFlags;if(n.dataChanged){var r=this.props.data,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}}},{key:"_updateStateBinary",value:function(t){var e=t.props,n=(t.changeFlags,U(e.data,this.encodePickingColor));this.setState({layerProps:n})}},{key:"_updateStateJSON",value:function(t){var e=t.props,n=t.changeFlags,r=function(t){if(Array.isArray(t))return t;switch(I.a.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return I.a.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(e.data),i=this.getSubLayerRow.bind(this),o={},a={};if(Array.isArray(n.dataChanged)){var s=this.state.features;for(var u in s)o[u]=s[u].slice(),a[u]=[];var c,l=H(n.dataChanged);try{for(l.s();!(c=l.n()).done;){var f=c.value,h=R(r,i,f);for(var d in s)a[d].push(Object(A.a)({data:o[d],getIndex:function(t){return t.__source.index},dataRange:f,replace:h[d]}))}}catch(t){l.e(t)}finally{l.f()}}else o=R(r,i);var p=function(t,e){var n={points:{},lines:{},polygons:{},polygonsOutline:{}},r=t.pointFeatures,i=t.lineFeatures,o=t.polygonFeatures,a=t.polygonOutlineFeatures;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&function(){return e.pointFeatures},n.points.getPosition=N,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&function(){return e.lineFeatures},n.lines.getPath=N,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&function(){return e.polygonFeatures},n.polygons.getPolygon=N,n.polygonsOutline.data=a,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&function(){return e.polygonOutlineFeatures},n.polygonsOutline.getPath=N,n}(o,a);this.setState({features:o,featuresDiff:a,layerProps:p})}},{key:"getPickingInfo",value:function(t){var e=this,r=l()(g()(n.prototype),"getPickingInfo",this).call(this,t),i=r.index,o=r.sourceLayer;return r.featureType=X.find((function(t){return o.id.startsWith("".concat(e.id,"-").concat(t,"-"))})),i>=0&&o.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(r.index=this.props.data.points.globalFeatureIds.value[i]),r}},{key:"_updateAutoHighlight",value:function(t){var e,n="".concat(this.id,"-points-"),r="points"===t.featureType,i=H(this.getSubLayers());try{for(i.s();!(e=i.n()).done;){var o=e.value;o.id.startsWith(n)===r&&o.updateAutoHighlight(t)}}catch(t){i.e(t)}finally{i.f()}}},{key:"_renderPolygonLayer",value:function(){var t=this.props,e=t.extruded,n=t.wireframe,r=this.state.layerProps,i="polygons-fill",o=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,T.type);if(o){var a=M(this,T.props),s=e&&n;return s||delete a.getLineColor,a.updateTriggers.lineColors=s,new o(a,this.getSubLayerProps({id:i,updateTriggers:a.updateTriggers}),r.polygons)}return null}},{key:"_renderLineLayers",value:function(){var t=this.props,e=t.extruded,n=t.stroked,r=this.state.layerProps,i=!e&&n&&this.shouldRenderSubLayer("polygons-stroke",r.polygonsOutline.data)&&this.getSubLayerClass("polygons-stroke",E.type),o=this.shouldRenderSubLayer("linestrings",r.lines.data)&&this.getSubLayerClass("linestrings",E.type);if(i||o){var a=M(this,E.props);return[i&&new i(a,this.getSubLayerProps({id:"polygons-stroke",updateTriggers:a.updateTriggers}),r.polygonsOutline),o&&new o(a,this.getSubLayerProps({id:"linestrings",updateTriggers:a.updateTriggers}),r.lines)]}return null}},{key:"_renderPointLayers",value:function(){var t=this.props.pointType,e=this.state,n=e.layerProps,r=e.binary,o=this.props.highlightedObjectIndex;!r&&Number.isFinite(o)&&(o=n.points.data.findIndex((function(t){return t.__source.index===o})));var a,s=[],u=H(new Set(t.split("+")));try{for(u.s();!(a=u.n()).done;){var c=a.value,l="points-".concat(c),f=k[c],h=f&&this.shouldRenderSubLayer(l,n.points.data)&&this.getSubLayerClass(l,f.type);if(h){var d=M(this,f.props),p=n.points;if("text"===c&&r){var v=p.data.attributes,g=(v.instancePickingColors,i()(v,z));p=K(K({},p),{},{data:K(K({},p.data),{},{attributes:g})})}s.push(new h(d,this.getSubLayerProps({id:l,updateTriggers:d.updateTriggers,highlightedObjectIndex:o}),p))}}}catch(t){u.e(t)}finally{u.f()}return s}},{key:"renderLayers",value:function(){var t=this.props.extruded,e=this._renderPolygonLayer();return[!t&&e,this._renderLineLayers(),this._renderPointLayers(),t&&e]}},{key:"getSubLayerAccessor",value:function(t){return this.state.binary&&"function"==typeof t?function(e,n){var r=w(n.data,n.index);return t(r,n)}:l()(g()(n.prototype),"getSubLayerAccessor",this).call(this,t)}}]),n}(b.a);m()(Q,"layerName","GeoJsonLayer"),m()(Q,"defaultProps",q)},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(10),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(228),A=n(247),_=n(20),O=n(176),w=n(194),x=n(82);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}n.d(e,"a",(function(){return E}));var B=[0,0,0,255],k={getSourcePosition:{type:"accessor",value:function(t){return t.sourcePosition}},getTargetPosition:{type:"accessor",value:function(t){return t.targetPosition}},getSourceColor:{type:"accessor",value:B},getTargetColor:{type:"accessor",value:B},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}},E=function(t){h()(n,t);var e=S(n);function n(){var t;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o)),m()(u()(t),"state",void 0),t}return a()(n,[{key:"getShaders",value:function(){return l()(g()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\nattribute float instanceHeights;\nattribute float instanceTilts;\n\nuniform bool greatCircle;\nuniform bool useShortestPath;\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\n  // d: distance on the xy plane\n  // r: ratio of the current point\n  // p: ratio of the peak of the arc\n  // h: height multiplier\n  // z = f(r) = sqrt(r * (p * 2 - r)) * d * h\n  // f(0) = 0\n  // f(1) = dz\n\n  float deltaZ = targetZ - sourceZ;\n  float dh = distance * instanceHeights;\n  if (dh == 0.0) {\n    return sourceZ + deltaZ * ratio;\n  }\n  float unitZ = deltaZ / dh;\n  float p2 = unitZ * unitZ + 1.0;\n\n  // sqrt does not deal with negative values, manually flip source and target if delta.z < 0\n  float dir = step(deltaZ, 0.0);\n  float z0 = mix(sourceZ, targetZ, dir);\n  float r = mix(ratio, 1.0 - ratio, dir);\n  return sqrt(r * (p2 - r)) * dh + z0;\n}\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\n  float distance = length(source.xy - target.xy);\n  float z = paraboloid(distance, source.z, target.z, segmentRatio);\n\n  float tiltAngle = radians(instanceTilts);\n  vec2 tiltDirection = normalize(target.xy - source.xy);\n  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n\n  return vec3(\n    mix(source.xy, target.xy, segmentRatio) + tilt,\n    z * cos(tiltAngle)\n  );\n}\n\n/* Great circle interpolation\n * http://www.movable-type.co.uk/scripts/latlong.html\n */\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 sourceRadians = radians(source);\n  vec2 targetRadians = radians(target);\n  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\n  vec2 shd_sq = sin_half_delta * sin_half_delta;\n\n  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\n  return 2.0 * asin(sqrt(a));\n}\n\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\n  vec2 lngLat;\n\n  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation\n  if(abs(angularDist - PI) < 0.001) {\n    lngLat = (1.0 - t) * source.xy + t * target.xy;\n  } else {\n    float a = sin((1.0 - t) * angularDist);\n    float b = sin(t * angularDist);\n    vec3 p = source3D.yxz * a + target3D.yxz * b;\n    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n  }\n\n  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\n\n  return vec3(lngLat, z);\n}\n\n/* END GREAT CIRCLE */\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\n  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));\n\n  // if it's the first point, use next - current as direction\n  // otherwise use current - prev\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  isValid = 1.0;\n\n  uv = vec2(segmentRatio, positions.y);\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  vec4 curr;\n  vec4 next;\n  vec3 source;\n  vec3 target;\n\n  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\n    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\n    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\n\n    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\n    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\n    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\n\n    if (abs(currPos.x - prevPos.x) > 180.0) {\n      indexDir = -1.0;\n      isValid = 0.0;\n    } else if (abs(currPos.x - nextPos.x) > 180.0) {\n      indexDir = 1.0;\n      isValid = 0.0;\n    }\n    nextPos = indexDir < 0.0 ? prevPos : nextPos;\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n\n    if (isValid == 0.0) {\n      // split at the 180th meridian\n      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\n      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\n      currPos = mix(currPos, nextPos, t);\n      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n    }\n\n    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\n    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\n  \n    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\n    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n  \n  } else {\n    vec3 source_world = instanceSourcePositions;\n    vec3 target_world = instanceTargetPositions;\n    if (useShortestPath) {\n      source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n      target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n\n      float deltaLng = target_world.x - source_world.x;\n      if (deltaLng > 180.) target_world.x -= 360.;\n      if (deltaLng < -180.) source_world.x -= 360.;\n    }\n    source = project_position(source_world, instanceSourcePositions64Low);\n    target = project_position(target_world, instanceTargetPositions64Low);\n\n    // common x at longitude=-180\n    float antiMeridianX = 0.0;\n\n    if (useShortestPath) {\n      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;\n      }\n      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);\n\n      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\n        isValid = 0.0;\n        indexDir = sign(segmentRatio - thresholdRatio);\n        segmentRatio = thresholdRatio;\n      }\n    }\n\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n    vec3 currPos = interpolateFlat(source, target, segmentRatio);\n    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\n\n    if (useShortestPath) {\n      if (nextPos.x < antiMeridianX) {\n        currPos.x += TILE_SIZE;\n        nextPos.x += TILE_SIZE;\n      }\n    }\n\n    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));\n    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));\n    geometry.position = vec4(currPos, 1.0);\n  }\n\n  // Multiply out width and clamp to limits\n  // mercator pixels are interpreted as screen pixels\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n\n  // extrude\n  vec3 offset = vec3(\n    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\n  vColor = vec4(color.rgb, color.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid == 0.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  geometry.uv = uv;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[b.a,A.a]})}},{key:"wrapLongitude",get:function(){return!1}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:B},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:B},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}},{key:"updateState",value:function(t){if(l()(g()(n.prototype),"updateState",this).call(this,t),t.changeFlags.extensionsChanged){var e,r=this.context.gl;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.widthUnits,i=n.widthScale,o=n.widthMinPixels,a=n.widthMaxPixels,s=n.greatCircle,u=n.wrapLongitude;this.state.model.setUniforms(e).setUniforms({greatCircle:s,widthUnits:_.e[r],widthScale:i,widthMinPixels:o,widthMaxPixels:a,useShortestPath:u}).draw()}},{key:"_getModel",value:function(t){for(var e=[],n=0;n<50;n++)e=e.concat([n,1,0,n,-1,0]);var r=new w.a(t,P(P({},this.getShaders()),{},{id:this.props.id,geometry:new x.a({drawMode:5,attributes:{positions:new Float32Array(e)}}),isInstanced:!0}));return r.setUniforms({numSegments:50}),r}}]),n}(O.a);m()(E,"layerName","ArcLayer"),m()(E,"defaultProps",k)},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(10),u=n.n(s),c=n(5),l=n.n(c),f=n(7),h=n.n(f),d=n(2),p=n.n(d),v=n(0),g=n.n(v),y=n(228),m=n(247),b=n(20),A=n(176),_=n(194),O=n(82);function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){g()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function C(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}n.d(e,"a",(function(){return S}));var P={getSourcePosition:{type:"accessor",value:function(t){return t.sourcePosition}},getTargetPosition:{type:"accessor",value:function(t){return t.targetPosition}},getColor:{type:"accessor",value:[0,0,0,255]},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}},S=function(t){l()(n,t);var e=C(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return u()(p()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float useShortestPath;\nuniform int widthUnits;\n\nvarying vec4 vColor;\nvarying vec2 uv;\n\n// offset vector by strokeWidth pixels\n// offset_direction is -1 (left) or 1 (right)\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  // normalized direction of the line\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  // rotate by 90 degrees\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nvec3 splitLine(vec3 a, vec3 b, float x) {\n  float t = (x - a.x) / (b.x - a.x);\n  return vec3(x, mix(a.yz, b.yz, t));\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  vec3 source_world = instanceSourcePositions;\n  vec3 target_world = instanceTargetPositions;\n  vec3 source_world_64low = instanceSourcePositions64Low;\n  vec3 target_world_64low = instanceTargetPositions64Low;\n\n  if (useShortestPath > 0.5 || useShortestPath < -0.5) {\n    source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n    target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n    float deltaLng = target_world.x - source_world.x;\n\n    if (deltaLng * useShortestPath > 180.) {\n      source_world.x += 360. * useShortestPath;\n      source_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      source_world_64low = vec3(0.0);\n    } else if (deltaLng * useShortestPath < -180.) {\n      target_world.x += 360. * useShortestPath;\n      target_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      target_world_64low = vec3(0.0);\n    } else if (useShortestPath < 0.) {\n      // Line is not split, abort\n      gl_Position = vec4(0.);\n      return;\n    }\n  }\n\n  // Position\n  vec4 source_commonspace;\n  vec4 target_commonspace;\n  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);\n  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);\n  \n  // linear interpolation of source & target to pick right coord\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);\n  uv = positions.xy;\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  // Multiply out width and clamp to limits\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels\n  );\n\n  // extrude\n  vec3 offset = vec3(\n    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Color\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[y.a,m.a]})}},{key:"wrapLongitude",get:function(){return!1}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}},{key:"updateState",value:function(t){if(u()(p()(n.prototype),"updateState",this).call(this,t),t.changeFlags.extensionsChanged){var e,r=this.context.gl;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.widthUnits,i=n.widthScale,o=n.widthMinPixels,a=n.widthMaxPixels,s=n.wrapLongitude;this.state.model.setUniforms(e).setUniforms({widthUnits:b.e[r],widthScale:i,widthMinPixels:o,widthMaxPixels:a,useShortestPath:s?1:0}).draw(),s&&this.state.model.setUniforms({useShortestPath:-1}).draw()}},{key:"_getModel",value:function(t){return new _.a(t,x(x({},this.getShaders()),{},{id:this.props.id,geometry:new O.a({drawMode:5,attributes:{positions:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}),isInstanced:!0}))}}]),n}(A.a);g()(S,"layerName","LineLayer"),g()(S,"defaultProps",P)},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(10),u=n.n(s),c=n(5),l=n.n(c),f=n(7),h=n.n(f),d=n(2),p=n.n(d),v=n(0),g=n.n(v),y=n(228),m=n(248),b=n(247),A=n(20),_=n(176),O=n(194),w=n(82);function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){g()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function P(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}n.d(e,"a",(function(){return E}));var S=[0,0,0,255],B=[0,0,1],k={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:function(t){return t.position}},getNormal:{type:"accessor",value:B},getColor:{type:"accessor",value:S},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};var E=function(t){l()(n,t);var e=P(n);function n(){return i()(this,n),e.apply(this,arguments)}return a()(n,[{key:"getShaders",value:function(){return u()(p()(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\nuniform int sizeUnits;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.normal = project_normal(instanceNormals);\n\n  // position on the containing square in [-1, 1] space\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  // Find the center of the point and add the current vertex\n  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\n  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply lighting\n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n\n  // Apply opacity to instance color, or return instance picking color\n  vColor = vec4(lightColor, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[y.a,m.a,b.a]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:B},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:S}})}},{key:"updateState",value:function(t){var e,r,i,o=t.changeFlags,a=t.props;if(u()(p()(n.prototype),"updateState",this).call(this,t),o.extensionsChanged){var s,c=this.context.gl;null===(s=this.state.model)||void 0===s||s.delete(),this.state.model=this._getModel(c),this.getAttributeManager().invalidateAll()}o.dataChanged&&(e=a.data,r=e.header,i=e.attributes,r&&i&&(e.length=r.vertexCount,i.POSITION&&(i.instancePositions=i.POSITION),i.NORMAL&&(i.instanceNormals=i.NORMAL),i.COLOR_0&&(i.instanceColors=i.COLOR_0)))}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.pointSize,i=n.sizeUnits;this.state.model.setUniforms(e).setUniforms({sizeUnits:A.e[i],radiusPixels:r}).draw()}},{key:"_getModel",value:function(t){for(var e=[],n=0;n<3;n++){var r=n/3*Math.PI*2;e.push(2*Math.cos(r),2*Math.sin(r),0)}return new O.a(t,C(C({},this.getShaders()),{},{id:this.props.id,geometry:new w.a({drawMode:4,attributes:{positions:new Float32Array(e)}}),isInstanced:!0}))}}]),n}(_.a);g()(E,"layerName","PointCloudLayer"),g()(E,"defaultProps",k)},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(10),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(0),m=n.n(y),b=n(31),A=n(228),_=n(248),O=n(247),w=n(176),x=n(82),C=n(12),P=n(123),S=n(194),B=n(264),k=n(198),E=n(143);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){m()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function M(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}function I(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),b.a.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function R(t,e){if(t.attributes)return I(t.attributes,e),t instanceof x.a?t:new x.a(t);if(t.positions||t.POSITION)return I(t,e),new x.a({attributes:t});throw Error("Invalid mesh")}n.d(e,"a",(function(){return L}));var D={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:function(t){return t.position}},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}},L=function(t){h()(n,t);var e=M(n);function n(){var t;i()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o)),m()(u()(t),"state",void 0),t}return a()(n,[{key:"getShaders",value:function(){var t=!Object(C.j)(this.context.gl),e={};return Object(B.b)(this.context.gl,k.a.GLSL_DERIVATIVES)&&(e.DERIVATIVES_AVAILABLE=1),l()(g()(n.prototype),"getShaders",this).call(this,{vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\n\n// Scale the model\nuniform float sizeScale;\nuniform bool composeModelMatrix;\n\n// Primitive attributes\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\n\n// Instance attributes\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\n\n// Outputs to fragment shader\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    // using instancePositions as world coordinates\n    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth\n    // call project_normal before setting position to avoid rotation\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n    geometry.position = position_commonspace;\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n    geometry.position = position_commonspace;\n    normals_commonspace = project_normal(instanceModelMatrix * normals);\n  }\n\n  geometry.normal = normals_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n\n// NOTE(Tarek): This is necessary because\n// headless.gl reports the extension as\n// available but does not support it in\n// the shader.\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[A.a,_.b,O.a],transpileToGLSL100:t,defines:e})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:E.a}),this.setState({emptyTexture:new P.a(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}},{key:"updateState",value:function(t){l()(g()(n.prototype),"updateState",this).call(this,t);var e=t.props,r=t.oldProps,i=t.changeFlags;if(e.mesh!==r.mesh||i.extensionsChanged){var o;if(null===(o=this.state.model)||void 0===o||o.delete(),e.mesh){this.state.model=this.getModel(e.mesh);var a=e.mesh.attributes||e.mesh;this.setState({hasNormals:Boolean(a.NORMAL||a.normals)})}this.getAttributeManager().invalidateAll()}e.texture!==r.texture&&this.setTexture(e.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}},{key:"finalizeState",value:function(t){l()(g()(n.prototype),"finalizeState",this).call(this,t),this.state.emptyTexture.delete()}},{key:"draw",value:function(t){var e=t.uniforms;if(this.state.model){var n=this.context.viewport,r=this.props,i=r.sizeScale,o=r.coordinateSystem,a=r._instanced;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!a||Object(E.b)(n,o),flatShading:!this.state.hasNormals}).draw()}}},{key:"getModel",value:function(t){var e=new S.a(this.context.gl,j(j({},this.getShaders()),{},{id:this.props.id,geometry:R(t,this.props._useMeshColors),isInstanced:!0})),n=this.props.texture,r=this.state.emptyTexture;return e.setUniforms({sampler:n||r,hasTexture:Boolean(n)}),e}},{key:"setTexture",value:function(t){var e=this.state,n=e.emptyTexture,r=e.model;r&&r.setUniforms({sampler:t||n,hasTexture:Boolean(t)})}}]),n}(w.a);m()(L,"defaultProps",D),m()(L,"layerName","SimpleMeshLayer")},function(t,e,n){"use strict";var r=n(0),i=n.n(r),o={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1};var a={name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){var n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){var r=Array.from(t.pickingHighlightColor,(function(t){return t/255}));Number.isFinite(r[3])||(r[3]=1),e.picking_uHighlightColor=r}return void 0!==t.pickingActive&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}};function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}e.a=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}},a)},function(t,e,n){"use strict";var r=n(156),i="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return c}));var o={};function a(t){var e=t.ambient,n=void 0===e?.35:e,r=t.diffuse,i=void 0===r?.6:r,o=t.shininess,a=void 0===o?32:o,s=t.specularColor;return{lighting_uAmbient:n,lighting_uDiffuse:i,lighting_uShininess:a,lighting_uSpecularColor:(void 0===s?[30,30,30]:s).map((function(t){return t/255}))}}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;if(!("material"in t))return{};var e=t.material;return e?a(e):{lighting_uEnabled:!1}}var u={name:"gouraud-lighting",dependencies:[r.a],vs:i,defines:{LIGHTING_VERTEX:1},getUniforms:s},c={name:"phong-lighting",dependencies:[r.a],fs:i,defines:{LIGHTING_FRAGMENT:1},getUniforms:s}},function(t,e,n){var r=n(220);function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function o(e,n,a){return i()?t.exports=o=Reflect.construct:t.exports=o=function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o},o.apply(null,arguments)}t.exports=o},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return f}));var r=n(0),i=n.n(r),o=n(123),a=n(251),s=n(252),u=n(95),c=n(17);function l(t,e){Object(c.a)(t instanceof o.a||t instanceof a.a||t instanceof s.a);var n=t.constructor,r=t.gl,i=t.width,u=t.height,l=t.format,f=t.type,h=t.dataFormat,d=t.border,p=t.mipmaps;return new n(r,Object.assign({width:i,height:u,format:l,type:f,dataFormat:h,border:d,mipmaps:p},e))}function f(t,e){var n=t.gl,r=t.width,o=t.height,a=t.id;return new u.a(n,Object.assign({},e,{id:"framebuffer-for-".concat(a),width:r,height:o,attachments:i()({},36064,t)}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));var r=n(19),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(9),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v),y=n(14),m=n.n(y),b=n(12),A=n(77);function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}var O=[34069,34070,34071,34072,34073,34074],w=function(t,e){h()(o,t);var n,r=_(o);function o(t){var e;a()(this,o);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(b.b)(t),(e=r.call(this,t,Object.assign({},n,{target:34067}))).initialize(n),Object.seal(l()(e)),e}return u()(o,[{key:e,get:function(){return"TextureCube"}},{key:"initialize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.mipmaps,r=void 0===n||n,i=e.parameters,o=void 0===i?{}:i;return this.opts=e,this.setCubeMapImageData(e).then((function(){t.loaded=!0,r&&t.generateMipmap(e),t.setParameters(o)})),this}},{key:"subImage",value:function(t){var e=t.face,n=t.data,r=t.x,i=void 0===r?0:r,o=t.y,a=void 0===o?0:o,s=t.mipmapLevel,u=void 0===s?0:s;return this._subImage({target:e,data:n,x:i,y:a,mipmapLevel:u})}},{key:"setCubeMapImageData",value:(n=i()(m.a.mark((function t(e){var n,r,i,o,a,s,u,c,l,f,h,d,p,v=this;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.width,r=e.height,i=e.pixels,o=e.data,a=e.border,s=void 0===a?0:a,u=e.format,c=void 0===u?6408:u,l=e.type,f=void 0===l?5121:l,h=this.gl,d=i||o,t.next=5,Promise.all(O.map((function(t){var e=d[t];return Promise.all(Array.isArray(e)?e:[e])})));case 5:p=t.sent,this.bind(),O.forEach((function(t,e){p[e].length>1&&!1!==v.opts.mipmaps&&b.k.warn("".concat(v.id," has mipmap and multiple LODs."))(),p[e].forEach((function(e,i){n&&r?h.texImage2D(t,i,c,n,r,s,c,f,e):h.texImage2D(t,i,c,c,f,e)}))})),this.unbind();case 9:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"setImageDataForFace",value:function(t){var e=this,n=t.face,r=t.width,i=t.height,o=t.pixels,a=t.data,s=t.border,u=void 0===s?0:s,c=t.format,l=void 0===c?6408:c,f=t.type,h=void 0===f?5121:f,d=this.gl,p=o||a;return this.bind(),p instanceof Promise?p.then((function(r){return e.setImageDataForFace(Object.assign({},t,{face:n,data:r,pixels:r}))})):this.width||this.height?d.texImage2D(n,0,l,r,i,u,l,h,p):d.texImage2D(n,0,l,l,h,p),this}}]),o}(A.a,Symbol.toStringTag);w.FACES=O},function(t,e,n){"use strict";n.d(e,"a",(function(){return A}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(5),l=n.n(c),f=n(7),h=n.n(f),d=n(2),p=n.n(d),v=n(12),g=n(77),y=n(104),m=n(49);function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var A=function(t,e){l()(r,t);var n=b(r);function r(t){var e;i()(this,r);var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(v.a)(t),o=Object.assign({depth:1},o,{target:32879,unpackFlipY:!1}),(e=n.call(this,t,o)).initialize(o),Object.seal(u()(e)),e}return a()(r,[{key:e,get:function(){return"Texture3D"}},{key:"setImageData",value:function(t){var e=this,n=t.level,r=void 0===n?0:n,i=t.dataFormat,o=void 0===i?6408:i,a=t.width,s=t.height,u=t.depth,c=void 0===u?1:u,l=t.border,f=void 0===l?0:l,h=t.format,d=t.type,p=void 0===d?5121:d,g=t.offset,b=void 0===g?0:g,A=t.data,_=t.parameters,O=void 0===_?{}:_;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Object(v.o)(this.gl,O,(function(){ArrayBuffer.isView(A)&&e.gl.texImage3D(e.target,r,o,a,s,c,f,h,p,A),A instanceof m.a&&(e.gl.bindBuffer(35052,A.handle),e.gl.texImage3D(e.target,r,o,a,s,c,f,h,p,b))})),A&&A.byteLength)this._trackAllocatedMemory(A.byteLength,"Texture");else{var w=y.a[this.dataFormat]||4,x=y.c[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*w*x,"Texture")}return this.loaded=!0,this}}],[{key:"isSupported",value:function(t){return Object(v.j)(t)}}]),r}(g.a,Symbol.toStringTag)},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t){var e;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(e=t[Symbol.asyncIterator]))return e.call(t);if(Symbol.iterator&&null!=(e=t[Symbol.iterator]))return e.call(t)}throw new TypeError("Object is not async iterable")}},function(t,e,n){var r=n(303),i=n(304),o=n(305),a=n(307);t.exports=function(t,e){return r(t)||i(t,e)||o(t,e)||a()},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t,e){var n={},r=!1;function i(n,i){return r=!0,i=new Promise((function(e){e(t[n](i))})),{done:!1,value:e(i)}}return"function"==typeof Symbol&&Symbol.iterator&&(n[Symbol.iterator]=function(){return this}),n.next=function(t){return r?(r=!1,t):i("next",t)},"function"==typeof t.throw&&(n.throw=function(t){if(r)throw r=!1,t;return i("throw",t)}),"function"==typeof t.return&&(n.return=function(t){return r?(r=!1,t):i("return",t)}),n}},function(t,e,n){"use strict";function r(t,e,n){n=n||2;var r,s,u,c,l,d,p,g=e&&e.length,y=g?e[0]*n:t.length,m=i(t,0,y,n,!0),b=[];if(!m||m.next===m.prev)return b;if(g&&(m=function(t,e,n,r){var a,s,u,c,l,d=[];for(a=0,s=e.length;a<s;a++)u=e[a]*r,c=a<s-1?e[a+1]*r:t.length,(l=i(t,u,c,r,!1))===l.next&&(l.steiner=!0),d.push(v(l));for(d.sort(f),a=0;a<d.length;a++)h(d[a],n),n=o(n,n.next);return n}(t,e,m,n)),t.length>80*n){r=u=t[0],s=c=t[1];for(var A=n;A<y;A+=n)(l=t[A])<r&&(r=l),(d=t[A+1])<s&&(s=d),l>u&&(u=l),d>c&&(c=d);p=0!==(p=Math.max(u-r,c-s))?1/p:0}return a(m,b,n,r,s,p),b}function i(t,e,n,r,i){var o,a;if(i===B(t,e,n,r)>0)for(o=e;o<n;o+=r)a=C(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=C(o,t[o],t[o+1],a);return a&&b(a,a.next)&&(P(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(P(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function a(t,e,n,r,i,f,h){if(t){!h&&f&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=p(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1)}(i)}(t,r,i,f);for(var d,v,g=t;t.prev!==t.next;)if(d=t.prev,v=t.next,f?u(t,r,i,f):s(t))e.push(d.i/n),e.push(t.i/n),e.push(v.i/n),P(t),t=v.next,g=v.next;else if((t=v)===g){h?1===h?a(t=c(o(t),e,n),e,n,r,i,f,2):2===h&&l(t,e,n,r,i,f):a(o(t),e,n,r,i,f,1);break}}}function s(t){var e=t.prev,n=t,r=t.next;if(m(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(g(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&m(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(t,e,n,r){var i=t.prev,o=t,a=t.next;if(m(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=p(s,u,e,n,r),h=p(c,l,e,n,r),d=t.prevZ,v=t.nextZ;d&&d.z>=f&&v&&v.z<=h;){if(d!==t.prev&&d!==t.next&&g(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,v!==t.prev&&v!==t.next&&g(i.x,i.y,o.x,o.y,a.x,a.y,v.x,v.y)&&m(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;d&&d.z>=f;){if(d!==t.prev&&d!==t.next&&g(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&m(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;v&&v.z<=h;){if(v!==t.prev&&v!==t.next&&g(i.x,i.y,o.x,o.y,a.x,a.y,v.x,v.y)&&m(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function c(t,e,n){var r=t;do{var i=r.prev,a=r.next.next;!b(i,a)&&A(i,r,r.next,a)&&w(i,a)&&w(a,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(a.i/n),P(r),P(r.next),r=t=a),r=r.next}while(r!==t);return o(r)}function l(t,e,n,r,i,s){var u=t;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&y(u,c)){var l=x(u,c);return u=o(u,u.next),l=o(l,l.next),a(u,e,n,r,i,s),void a(l,e,n,r,i,s)}c=c.next}u=u.next}while(u!==t)}function f(t,e){return t.x-e.x}function h(t,e){if(e=function(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n;var u,c=n,l=n.x,f=n.y,h=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&g(o<f?i:a,o,l,f,o<f?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),w(r,t)&&(u<h||u===h&&(r.x>n.x||r.x===n.x&&d(n,r)))&&(n=r,h=u)),r=r.next}while(r!==c);return n}(t,e)){var n=x(e,t);o(n,n.next)}}function d(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function p(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function g(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&A(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||b(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function A(t,e,n,r){var i=O(m(t,e,n)),o=O(m(t,e,r)),a=O(m(n,r,t)),s=O(m(n,r,e));return i!==o&&a!==s||(!(0!==i||!_(t,n,e))||(!(0!==o||!_(t,r,e))||(!(0!==a||!_(n,t,r))||!(0!==s||!_(n,e,r)))))}function _(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function O(t){return t>0?1:t<0?-1:0}function w(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function x(t,e){var n=new S(t.i,t.x,t.y),r=new S(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function C(t,e,n,r){var i=new S(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function P(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function B(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}t.exports=r,t.exports.default=r,r.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(B(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var c=e[s]*n,l=s<u-1?e[s+1]*n:t.length;a-=Math.abs(B(t,c,l,n))}var f=0;for(s=0;s<r.length;s+=3){var h=r[s]*n,d=r[s+1]*n,p=r[s+2]*n;f+=Math.abs((t[h]-t[p])*(t[d+1]-t[h+1])-(t[h]-t[d])*(t[p+1]-t[h+1]))}return 0===a&&0===f?0:Math.abs((f-a)/a)},r.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},function(t,e,n){"use strict";t.exports=r,t.exports.default=r;function r(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var a=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.d=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Int16Array(a),this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function i(t,e,n,r,i,a,s){for(var u=0;u<e;u++){for(var c=0;c<n;c++)r[c]=t[c*e+u];for(o(r,i,a,s,n),c=0;c<n;c++)t[c*e+u]=i[c]}for(c=0;c<n;c++){for(u=0;u<e;u++)r[u]=t[c*e+u];for(o(r,i,a,s,e),u=0;u<e;u++)t[c*e+u]=Math.sqrt(i[u])}}function o(t,e,n,r,i){n[0]=0,r[0]=-1e20,r[1]=1e20;for(var o=1,a=0;o<i;o++){for(var s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);s<=r[a];)a--,s=(t[o]+o*o-(t[n[a]]+n[a]*n[a]))/(2*o-2*n[a]);n[++a]=o,r[a]=s,r[a+1]=1e20}for(o=0,a=0;o<i;o++){for(;r[a+1]<o;)a++;e[o]=(o-n[a])*(o-n[a])+t[n[a]]}}r.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=new Uint8ClampedArray(this.size*this.size),r=0;r<this.size*this.size;r++){var o=e.data[4*r+3]/255;this.gridOuter[r]=1===o?0:0===o?1e20:Math.pow(Math.max(0,.5-o),2),this.gridInner[r]=1===o?1e20:0===o?0:Math.pow(Math.max(0,o-.5),2)}for(i(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),i(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++){var a=this.gridOuter[r]-this.gridInner[r];n[r]=Math.max(0,Math.min(255,Math.round(255-255*(a/this.radius+this.cutoff))))}return n}},function(t,e,n){var r=n(237),i=n(318);function o(e,n,a){return i()?t.exports=o=Reflect.construct:t.exports=o=function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o},o.apply(null,arguments)}t.exports=o},function(t,e,n){var r=n(319);function i(e,n,o){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=i=Reflect.get:t.exports=i=function(t,e,n){var i=r(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}},i(e,n,o||e)}t.exports=i},function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n(0),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(264),l=n(198),f=n(123),h=n(12);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v=function(){function t(e,n){a()(this,t);var r=n.attributes,i=n.material,o=n.pbrDebug,s=n.imageBasedLightingEnvironment,u=n.lights,f=n.useTangents;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},Object(c.b)(e,l.a.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),o&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(r.NORMAL,"HAS_NORMALS"),this.defineIfPresent(r.TANGENT&&f,"HAS_TANGENTS"),this.defineIfPresent(r.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(u,"USE_LIGHTS"),this.defineIfPresent(o,"PBR_DEBUG"),i&&this.parseMaterial(i)}return u()(t,[{key:"defineIfPresent",value:function(t,e){t&&(this.defines[e]=1)}},{key:"parseTexture",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=t.texture&&t.texture.sampler&&t.texture.sampler.parameters||{},a=t.texture.source.image,s={};a.compressed?(n=a,s=i()({},this.gl.TEXTURE_MIN_FILTER,a.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR)):n={data:a};var u=new f.a(this.gl,p({id:t.name||t.id,parameters:p(p({},o),s),pixelStore:i()({},this.gl.UNPACK_FLIP_Y_WEBGL,!1)},n));this.uniforms[e]=u,this.defineIfPresent(r,r),this.generatedTextures.push(u)}},{key:"parsePbrMetallicRoughness",value:function(t){t.baseColorTexture&&this.parseTexture(t.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&this.parseTexture(t.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");var e=t.metallicFactor,n=void 0===e?1:e,r=t.roughnessFactor,i=void 0===r?1:r;this.uniforms.u_MetallicRoughnessValues=[n,i]}},{key:"parseMaterial",value:function(t){if(this.uniforms.pbr_uUnlit=Boolean(t.unlit),t.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(t.pbrMetallicRoughness),t.normalTexture){this.parseTexture(t.normalTexture,"u_NormalSampler","HAS_NORMALMAP");var e=t.normalTexture.scale,n=void 0===e?1:e;this.uniforms.u_NormalScale=n}if(t.occlusionTexture){this.parseTexture(t.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");var r=t.occlusionTexture.strength,i=void 0===r?1:r;this.uniforms.u_OcclusionStrength=i}if(t.emissiveTexture&&(this.parseTexture(t.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=t.emissiveFactor||[0,0,0]),"MASK"===t.alphaMode){var o=t.alphaCutoff,a=void 0===o?.5:o;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=a}else"BLEND"===t.alphaMode&&(h.k.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}},{key:"delete",value:function(){this.generatedTextures.forEach((function(t){return t.delete()}))}}]),t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return l}));var r=n(198),i=n(12),o=n(17);function a(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){return c(t,e)}function c(t,e){return(e=Array.isArray(e)?e:[e]).every((function(e){return f(t,e)}))}function l(t){for(var e in t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},r.b)void 0===t.luma.caps[e]&&(t.luma.caps[e]=f(t,e));return t.luma.caps}function f(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=function(t,e){var n,s=r.b[e];Object(o.a)(s,e);var u=Object(i.j)(t)&&s[1]||s[0];if("function"==typeof u)n=u(t);else if(Array.isArray(u)){n=!0;var c,l=a(u);try{for(l.s();!(c=l.n()).done;){var f=c.value;n=n&&Boolean(t.getExtension(f))}}catch(t){l.e(t)}finally{l.f()}}else"string"==typeof u?n=Boolean(t.getExtension(u)):"boolean"==typeof u?n=u:Object(o.a)(!1);return n}(t,e)),t.luma.caps[e]||i.k.log(2,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}},function(t,e,n){var r=n(278);Object.assign(r,n(88),n(322),n(241),n(321),n(326),n(163),n(324)),r.H3HexagonLayer._checkH3Lib=function(){var t='include the <script src="https://unpkg.com/h3-js@^3.0.0"><\/script> tag before the deck.gl script tag. https://deck.gl/docs/api-reference/geo-layers/h3-hexagon-layer';if(!window.h3)throw new Error("To use H3 functionality, ".concat(t));if(!window.h3.polyfill&&window.h3.polygonToCells)throw new Error("Incompatible h3-js version. ".concat(t))},t.exports=r},,,,,,,,,,,,,function(t,e,n){var r=n(323),i=n(21),o=n(325).default,a=n(92),s=a.registerLoaders,u=a.load,c=a.parse,l=a.fetchFile,f="undefined"==typeof window?global:window;f.deck=f.deck||{},f.luma=f.luma||{},f.loaders=f.loaders||{},Object.assign(f.deck,i,{DeckGL:o}),Object.assign(f.luma,r),Object.assign(f.loaders,{registerLoaders:s,load:u,parse:c,fetchFile:l}),t.exports=f.deck},function(t,e){t.exports=function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}},function(t,e){t.exports=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,e){},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e,n){var r=n(2);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}},function(t,e,n){var r=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n,r){var i=e&&e.prototype instanceof l?e:l,o=Object.create(i.prototype),a=new O(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return x()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=u(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(t,n,a),o}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var c={};function l(){}function f(){}function h(){}var d={};d[i]=function(){return this};var p=Object.getPrototypeOf,v=p&&p(p(w([])));v&&v!==e&&n.call(v,i)&&(d=v);var g=h.prototype=l.prototype=Object.create(d);function y(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function m(t){var e;this._invoke=function(r,i){function o(){return new Promise((function(e,o){!function e(r,i,o,a){var s=u(t[r],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?Promise.resolve(l.__await).then((function(t){e("next",t,o,a)}),(function(t){e("throw",t,o,a)})):Promise.resolve(l).then((function(t){c.value=t,o(c)}),(function(t){return e("throw",t,o,a)}))}a(s.arg)}(r,i,e,o)}))}return e=e?e.then(o,o):o()}}function b(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,b(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var r=u(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,c;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function w(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=g.constructor=h,h.constructor=f,h[a]=f.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},y(m.prototype),m.prototype[o]=function(){return this},t.AsyncIterator=m,t.async=function(e,n,r,i){var o=new m(s(e,n,r,i));return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},y(g),g[a]="Generator",g[i]=function(){return this},g.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=w,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:w(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},t.exports.default=t.exports,t.exports.__esModule=!0,n(e,r)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var r=n(221);t.exports=function(t){if(Array.isArray(t))return r(t)},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t){if(Array.isArray(t))return t},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var r=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof f?e:f,o=Object.create(i.prototype),a=new w(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return C()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=A(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var l={};function f(){}function h(){}function d(){}var p={};p[i]=function(){return this};var v=Object.getPrototypeOf,g=v&&v(v(x([])));g&&g!==e&&n.call(g,i)&&(p=g);var y=d.prototype=f.prototype=Object.create(p);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var u=c(t[i],t,o);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function A(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,l;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function w(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function x(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:C}}function C(){return{value:void 0,done:!0}}return h.prototype=y.constructor=d,d.constructor=h,h.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(y),t},t.awrap=function(t){return{__await:t}},m(b.prototype),b.prototype[o]=function(){return this},t.AsyncIterator=b,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new b(u(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(y),s(y,a,"Generator"),y[i]=function(){return this},y.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=x,w.prototype={constructor:w,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:x(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){var r=n(224);t.exports=function(t){if(Array.isArray(t))return r(t)}},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e){},function(t,e){},function(t,e,n){var r=n(227);function i(t){var e,n;function i(e,n){try{var a=t[e](n),s=a.value,u=s instanceof r;Promise.resolve(u?s.wrapped:s).then((function(t){u?i("return"===e?"return":"next",t):o(a.done?"return":"normal",t)}),(function(t){i("throw",t)}))}catch(t){o("throw",t)}}function o(t,r){switch(t){case"return":e.resolve({value:r,done:!0});break;case"throw":e.reject(r);break;default:e.resolve({value:r,done:!1})}(e=e.next)?i(e.key,e.arg):n=null}this._invoke=function(t,r){return new Promise((function(o,a){var s={key:t,arg:r,resolve:o,reject:a,next:null};n?n=n.next=s:(e=n=s,i(t,r))}))},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(i.prototype[Symbol.asyncIterator]=function(){return this}),i.prototype.next=function(t){return this._invoke("next",t)},i.prototype.throw=function(t){return this._invoke("throw",t)},i.prototype.return=function(t){return this._invoke("return",t)},t.exports=i},function(t,e){t.exports=function(t){if(Array.isArray(t))return t},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var r=n(306);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){"use strict";var r=n(309);function i(){}function o(){}o.resetWarningCache=i,t.exports=function(){function t(t,e,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},function(t,e,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e){t.exports=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}},function(t,e,n){var r=n(236);t.exports=function(t){if(Array.isArray(t))return r(t)},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){var r=n(236);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e){t.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}},function(t,e,n){var r=n(38);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}},function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,d=t[e+f];for(f+=h,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+t[e+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=c}return(d?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),(e+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(e*u-1)*Math.pow(2,i),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[n+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+d]=255&a,d+=p,a/=256,c-=8);t[n+d-p]|=128*v}},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"name",(function(){return sh})),n.d(r,"decode",(function(){return uh}));var i={};n.r(i),n.d(i,"name",(function(){return yh})),n.d(i,"preprocess",(function(){return mh}));var o={};n.r(o),n.d(o,"name",(function(){return _h})),n.d(o,"preprocess",(function(){return Oh}));var a={};n.r(a),n.d(a,"name",(function(){return Eh})),n.d(a,"preprocess",(function(){return Th})),n.d(a,"decode",(function(){return jh})),n.d(a,"encode",(function(){return Ih}));var s={};n.r(s),n.d(s,"name",(function(){return Vh})),n.d(s,"decode",(function(){return Xh}));var u={};n.r(u),n.d(u,"name",(function(){return ed})),n.d(u,"decode",(function(){return nd})),n.d(u,"encode",(function(){return id}));var c={};n.r(c),n.d(c,"name",(function(){return ud})),n.d(c,"decode",(function(){return cd})),n.d(c,"encode",(function(){return fd}));var l={};n.r(l),n.d(l,"name",(function(){return pd})),n.d(l,"decode",(function(){return vd})),n.d(l,"encode",(function(){return yd}));var f={};n.r(f),n.d(f,"name",(function(){return _d})),n.d(f,"decode",(function(){return Od}));var h=n(1),d=n.n(h),p=n(5),v=n.n(p),g=n(7),y=n.n(g),m=n(2),b=n.n(m),A=n(0),_=n.n(A);function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var w=function(t){v()(n,t);var e=O(n);function n(){return d()(this,n),e.apply(this,arguments)}return n}(n(243).a);_()(w,"layerName","GreatCircleLayer"),_()(w,"defaultProps",{getHeight:{type:"accessor",value:0},greatCircle:!0});var x=n(3),C=n.n(x),P=n(203),S=n(234);function B(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var E=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},S.a.defaultProps),T=function(t){v()(n,t);var e=B(n);function n(){return d()(this,n),e.apply(this,arguments)}return C()(n,[{key:"indexToBounds",value:function(){return null}},{key:"renderLayers",value:function(){var t=this.props,e=t.elevationScale,n=t.extruded,r=t.wireframe,i=t.filled,o=t.stroked,a=t.lineWidthUnits,s=t.lineWidthScale,u=t.lineWidthMinPixels,c=t.lineWidthMaxPixels,l=t.lineJointRounded,f=t.lineMiterLimit,h=t.lineDashJustified,d=t.getElevation,p=t.getFillColor,v=t.getLineColor,g=t.getLineWidth,y=this.props,m=y.updateTriggers,b=y.material,A=y.transitions;return new(this.getSubLayerClass("cell",S.a))({filled:i,wireframe:r,extruded:n,elevationScale:e,stroked:o,lineWidthUnits:a,lineWidthScale:s,lineWidthMinPixels:u,lineWidthMaxPixels:c,lineJointRounded:l,lineMiterLimit:f,lineDashJustified:h,material:b,transitions:A,getElevation:d,getFillColor:p,getLineColor:v,getLineWidth:g},this.getSubLayerProps({id:"cell",updateTriggers:m&&{getElevation:m.getElevation,getFillColor:m.getFillColor,getLineColor:m.getLineColor,getLineWidth:m.getLineWidth}}),this.indexToBounds())}}]),n}(P.a);_()(T,"layerName","GeoCellLayer"),_()(T,"defaultProps",E);var j=n(15),M=n.n(j),I=n(142),R=n.n(I),D=180/Math.PI;function L(t,e,n){var r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function F(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function G(t){return[F(t[0]),F(t[1])]}function N(t,e){var n=M()(e,2),r=n[0],i=n[1];switch(t){case 0:return[1,r,i];case 1:return[-r,1,i];case 2:return[-r,-i,1];case 3:return[-1,-i,-r];case 4:return[i,-1,-r];case 5:return[i,r,-1];default:throw new Error("Invalid face")}}function U(t,e,n,r){if(0===r){1===n&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);var i=e[0];e[0]=e[1],e[1]=i}}function z(t){if("string"==typeof t){if(t.indexOf("/")>0)return t;t=function(t){var e=t.padEnd(16,"0");return R.a.fromString(e,16)}(t)}return function(t){for(var e=R.a.fromString(t,!0,10).toString(2);e.length<64;)e="0"+e;for(var n=e.lastIndexOf("1"),r=e.substring(0,3),i=e.substring(3,n),o=i.length/2,a=R.a.fromString(r,!0,2).toString(10),s=R.a.fromString(i,!0,2).toString(4);s.length<o;)s="0"+s;return"".concat(a,"/").concat(s)}(t.toString())}function H(t){return function(t){for(var e,n,r,i,o,a,s=t.face,u=t.ij,c=t.level,l=[[0,0],[0,1],[1,1],[1,0],[0,0]],f=Math.max(1,Math.ceil(100*Math.pow(2,-c))),h=new Float64Array(4*f*2+2),d=0,p=0,v=0;v<4;v++)for(var g=l[v].slice(0),y=l[v+1],m=(y[0]-g[0])/f,b=(y[1]-g[1])/f,A=0;A<f;A++){g[0]+=m,g[1]+=b;var _=N(s,G(L(u,c,g))),O=(e=_,n=void 0,r=void 0,i=void 0,o=void 0,a=void 0,n=M()(e,3),r=n[0],i=n[1],o=n[2],a=Math.atan2(o,Math.sqrt(r*r+i*i)),[Math.atan2(i,r)*D,a*D]);Math.abs(O[1])>89.999&&(O[0]=p);var w=O[0]-p;O[0]+=w>180?-360:w<-180?360:0,h[d++]=O[0],h[d++]=O[1],p=O[0]}return h[d++]=h[0],h[d++]=h[1],h}(function(t){for(var e,n=t.split("/"),r=parseInt(n[0],10),i=n[1],o=i.length,a=[0,0],s=o-1;s>=0;s--){e=o-s;var u=i[s],c=0,l=0;"1"===u?l=1:"2"===u?(c=1,l=1):"3"===u&&(c=1);var f=Math.pow(2,e-1);U(f,a,c,l),a[0]+=f*c,a[1]+=f*l}if(r%2==1){var h=a[0];a[0]=a[1],a[1]=h}return{face:r,ij:a,level:e}}(z(t)))}function V(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var J=function(t){v()(n,t);var e=V(n);function n(){return d()(this,n),e.apply(this,arguments)}return C()(n,[{key:"indexToBounds",value:function(){var t=this.props,e=t.data,n=t.getS2Token;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:function(t,e){return H(n(t,e))}}}}]),n}(T);_()(J,"layerName","S2Layer"),_()(J,"defaultProps",{getS2Token:{type:"accessor",value:function(t){return t.token}}});var W=n(33);function K(t){var e=function(t){for(var e=0,n=0,r=1<<t.length,i=r/512,o=0;o<t.length;o++){r>>=1;var a=parseInt(t[o]);a%2&&(e|=r),a>1&&(n|=r)}return[[e/i,512-n/i],[(e+.99)/i,512-(n+.99)/i]]}(t),n=M()(e,2),r=n[0],i=n[1],o=Object(W.o)(r),a=M()(o,2),s=a[0],u=a[1],c=Object(W.o)(i),l=M()(c,2),f=l[0],h=l[1];return[f,u,f,h,s,h,s,u,f,u]}function X(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var q=function(t){v()(n,t);var e=X(n);function n(){return d()(this,n),e.apply(this,arguments)}return C()(n,[{key:"indexToBounds",value:function(){var t=this.props,e=t.data,n=t.getQuadkey;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:function(t,e){return K(n(t,e))}}}}]),n}(T);_()(q,"layerName","QuadkeyLayer"),_()(q,"defaultProps",{getQuadkey:{type:"accessor",value:function(t){return t.quadkey}}});var Q=n(89),Z=n(242),Y=n(19),$=n.n(Y),tt=n(14),et=n.n(tt),nt=n(31),rt=function(){function t(e){d()(this,t),_()(this,"index",void 0),_()(this,"isVisible",void 0),_()(this,"isSelected",void 0),_()(this,"parent",void 0),_()(this,"children",void 0),_()(this,"content",void 0),_()(this,"state",void 0),_()(this,"layers",void 0),_()(this,"id",void 0),_()(this,"bbox",void 0),_()(this,"zoom",void 0),_()(this,"userData",void 0),_()(this,"_abortController",void 0),_()(this,"_loader",void 0),_()(this,"_loaderId",void 0),_()(this,"_isLoaded",void 0),_()(this,"_isCancelled",void 0),_()(this,"_needsReload",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}var e;return C()(t,[{key:"data",get:function(){var t=this;return this.isLoading&&this._loader?this._loader.then((function(){return t.data})):this.content}},{key:"isLoaded",get:function(){return this._isLoaded&&!this._needsReload}},{key:"isLoading",get:function(){return Boolean(this._loader)&&!this._isCancelled}},{key:"needsReload",get:function(){return this._needsReload||this._isCancelled}},{key:"byteLength",get:function(){var t=this.content?this.content.byteLength:0;return Number.isFinite(t)||nt.a.error("byteLength not defined in tile data")(),t}},{key:"_loadData",value:(e=$()(et.a.mark((function t(e){var n,r,i,o,a,s,u,c,l,f,h,d,p,v;return et.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getData,r=e.requestScheduler,i=e.onLoad,o=e.onError,a=this.index,s=this.id,u=this.bbox,c=this.userData,l=this.zoom,f=this._loaderId,this._abortController=new AbortController,h=this._abortController.signal,t.next=7,r.scheduleRequest(this,(function(t){return t.isSelected?1:-1}));case 7:if(d=t.sent){t.next=11;break}return this._isCancelled=!0,t.abrupt("return");case 11:if(!this._isCancelled){t.next=14;break}return d.done(),t.abrupt("return");case 14:return p=null,t.prev=15,t.next=18,n({index:a,id:s,bbox:u,userData:c,zoom:l,signal:h});case 18:p=t.sent,t.next=24;break;case 21:t.prev=21,t.t0=t.catch(15),v=t.t0||!0;case 24:return t.prev=24,d.done(),t.finish(24);case 27:if(f===this._loaderId){t.next=29;break}return t.abrupt("return");case 29:if(this._loader=void 0,this.content=p,!this._isCancelled||p){t.next=34;break}return this._isLoaded=!1,t.abrupt("return");case 34:this._isLoaded=!0,this._isCancelled=!1,v?o(v,this):i(this);case 37:case"end":return t.stop()}}),t,this,[[15,21,24,27]])}))),function(t){return e.apply(this,arguments)})},{key:"loadData",value:function(t){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(t),this._loader}},{key:"setNeedsReload",value:function(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}},{key:"abort",value:function(){var t;this.isLoaded||(this._isCancelled=!0,null===(t=this._abortController)||void 0===t||t.abort())}}]),t}(),it=n(27),ot=n.n(it),at=n(175),st=n(102),ut=-1,ct=0,lt=1,ft=n(72),ht=n.n(ft),dt=n(73),pt=n.n(dt);function vt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var gt,yt=n(106),mt=new yt.a,bt=new yt.a,At=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=arguments.length>2?arguments[2]:void 0;ht()(this,t),vt(this,"center",void 0),vt(this,"halfDiagonal",void 0),vt(this,"minimum",void 0),vt(this,"maximum",void 0),r=r||mt.copy(e).add(n).scale(.5),this.center=new yt.a(r),this.halfDiagonal=new yt.a(n).subtract(this.center),this.minimum=new yt.a(e),this.maximum=new yt.a(n)}return pt()(t,[{key:"clone",value:function(){return new t(this.minimum,this.maximum,this.center)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}},{key:"transform",value:function(t){return this.center.transformAsPoint(t),this.halfDiagonal.transform(t),this.minimum.transform(t),this.maximum.transform(t),this}},{key:"intersectPlane",value:function(t){var e=this.halfDiagonal,n=bt.from(t.normal),r=e.x*Math.abs(n.x)+e.y*Math.abs(n.y)+e.z*Math.abs(n.z),i=this.center.dot(n)+t.distance;return i-r>0?lt:i+r<0?ut:ct}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var e,n=mt.from(t).subtract(this.center),r=this.halfDiagonal,i=0;return(e=Math.abs(n.x)-r.x)>0&&(i+=e*e),(e=Math.abs(n.y)-r.y)>0&&(i+=e*e),(e=Math.abs(n.z)-r.z)>0&&(i+=e*e),i}}]),t}(),_t=n(40),Ot=new yt.a,wt=new yt.a,xt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;ht()(this,t),vt(this,"center",void 0),vt(this,"radius",void 0),this.radius=-0,this.center=new yt.a,this.fromCenterRadius(e,n)}return pt()(t,[{key:"fromCenterRadius",value:function(t,e){return this.center.from(t),this.radius=e,this}},{key:"fromCornerPoints",value:function(t,e){return e=Ot.from(e),this.center=(new yt.a).from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}},{key:"clone",value:function(){return new t(this.center,this.radius)}},{key:"union",value:function(t){var e=this.center,n=this.radius,r=t.center,i=t.radius,o=Ot.copy(r).subtract(e),a=o.magnitude();if(n>=a+i)return this.clone();if(i>=a+n)return t.clone();var s=.5*(n+a+i);return wt.copy(o).scale((-n+s)/a).add(e),this.center.copy(wt),this.radius=s,this}},{key:"expand",value:function(t){var e=Ot.from(t).subtract(this.center).magnitude();return e>this.radius&&(this.radius=e),this}},{key:"transform",value:function(t){this.center.transform(t);var e=_t.e(Ot,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}},{key:"distanceSquaredTo",value:function(t){var e=this.distanceTo(t);return e*e}},{key:"distanceTo",value:function(t){var e=Ot.from(t).subtract(this.center);return Math.max(0,e.len()-this.radius)}},{key:"intersectPlane",value:function(t){var e=this.center,n=this.radius,r=t.normal.dot(e)+t.distance;return r<-n?ut:r<n?ct:lt}}]),t}(),Ct=n(126),Pt=n.n(Ct),St=n(54),Bt=n.n(St),kt=n(55),Et=n.n(kt),Tt=n(58),jt=n.n(Tt),Mt=n(59),It=n.n(Mt),Rt=n(43),Dt=n.n(Rt),Lt=n(188),Ft=n(34),Gt=n(78),Nt=n(79),Ut=n(50),zt=n(39);function Ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Dt()(t);if(e){var i=Dt()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return It()(this,n)}}!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"}(gt||(gt={}));var Vt,Jt,Wt=Object.freeze([1,0,0,0,1,0,0,0,1]),Kt=function(t){jt()(n,t);var e=Ht(n);function n(t){for(var r,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return Bt()(this,n),r=e.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?r.copy(t):o.length>0?r.copy([t].concat(o)):r.identity(),r}return Et()(n,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return gt}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}},{key:"identity",value:function(){return this.copy(Wt)}},{key:"fromObject",value:function(t){return this.check()}},{key:"fromQuaternion",value:function(t){return Nt.c(this,t),this.check()}},{key:"set",value:function(t,e,n,r,i,o,a,s,u){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=a,this[7]=s,this[8]=u,this.check()}},{key:"setRowMajor",value:function(t,e,n,r,i,o,a,s,u){return this[0]=t,this[1]=r,this[2]=a,this[3]=e,this[4]=i,this[5]=s,this[6]=n,this[7]=o,this[8]=u,this.check()}},{key:"determinant",value:function(){return Nt.b(this)}},{key:"transpose",value:function(){return Nt.i(this,this),this.check()}},{key:"invert",value:function(){return Nt.d(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return Nt.e(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return Nt.e(this,this,t),this.check()}},{key:"rotate",value:function(t){return Nt.f(this,this,t),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?Nt.g(this,this,t):Nt.g(this,this,[t,t]),this.check()}},{key:"translate",value:function(t){return Nt.h(this,this,t),this.check()}},{key:"transform",value:function(t,e){var n;switch(t.length){case 2:n=Ut.i(e||[-0,-0],t,this);break;case 3:n=zt.p(e||[-0,-0,-0],t,this);break;case 4:n=Object(Gt.e)(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(Ft.b)(n,t.length),n}},{key:"transformVector",value:function(t,e){return this.transform(t,e)}},{key:"transformVector2",value:function(t,e){return this.transform(t,e)}},{key:"transformVector3",value:function(t,e){return this.transform(t,e)}}],[{key:"IDENTITY",get:function(){return function(){Jt||(Jt=new Kt,Object.freeze(Jt));return Jt}()}},{key:"ZERO",get:function(){return function(){Vt||(Vt=new Kt([0,0,0,0,0,0,0,0,0]),Object.freeze(Vt));return Vt}()}}]),n}(Lt.a);var Xt=n(351),qt=new yt.a,Qt=new yt.a,Zt=new yt.a,Yt=new yt.a,$t=new yt.a,te=new yt.a,ee=new yt.a,ne=0,re=1,ie=2,oe=3,ae=4,se=5,ue=6,ce=7,le=8,fe=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0,0,0,0,0,0];ht()(this,t),vt(this,"center",void 0),vt(this,"halfAxes",void 0),this.center=(new yt.a).from(e),this.halfAxes=new Kt(n)}return pt()(t,[{key:"halfSize",get:function(){var t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new yt.a(t).len(),new yt.a(e).len(),new yt.a(n).len()]}},{key:"quaternion",get:function(){var t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new yt.a(t).normalize(),i=new yt.a(e).normalize(),o=new yt.a(n).normalize();return(new Xt.a).fromMatrix3(new Kt([].concat(Pt()(r),Pt()(i),Pt()(o))))}},{key:"fromCenterHalfSizeQuaternion",value:function(t,e,n){var r=new Xt.a(n),i=(new Kt).fromQuaternion(r);return i[0]=i[0]*e[0],i[1]=i[1]*e[0],i[2]=i[2]*e[0],i[3]=i[3]*e[1],i[4]=i[4]*e[1],i[5]=i[5]*e[1],i[6]=i[6]*e[2],i[7]=i[7]*e[2],i[8]=i[8]*e[2],this.center=(new yt.a).from(t),this.halfAxes=i,this}},{key:"clone",value:function(){return new t(this.center,this.halfAxes)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}},{key:"getBoundingSphere",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new xt,e=this.halfAxes,n=e.getColumn(0,Zt),r=e.getColumn(1,Yt),i=e.getColumn(2,$t),o=qt.copy(n).add(r).add(i);return t.center.copy(this.center),t.radius=o.magnitude(),t}},{key:"intersectPlane",value:function(t){var e=this.center,n=t.normal,r=this.halfAxes,i=n.x,o=n.y,a=n.z,s=Math.abs(i*r[ne]+o*r[re]+a*r[ie])+Math.abs(i*r[oe]+o*r[ae]+a*r[se])+Math.abs(i*r[ue]+o*r[ce]+a*r[le]),u=n.dot(e)+t.distance;return u<=-s?ut:u>=s?lt:ct}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var e=Qt.from(t).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,Zt),i=n.getColumn(1,Yt),o=n.getColumn(2,$t),a=r.magnitude(),s=i.magnitude(),u=o.magnitude();r.normalize(),i.normalize(),o.normalize();var c,l=0;return(c=Math.abs(e.dot(r))-a)>0&&(l+=c*c),(c=Math.abs(e.dot(i))-s)>0&&(l+=c*c),(c=Math.abs(e.dot(o))-u)>0&&(l+=c*c),l}},{key:"computePlaneDistances",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-0,-0],r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,o=this.center,a=this.halfAxes,s=a.getColumn(0,Zt),u=a.getColumn(1,Yt),c=a.getColumn(2,$t),l=te.copy(s).add(u).add(c).add(o),f=ee.copy(l).subtract(t),h=e.dot(f);return r=Math.min(h,r),i=Math.max(h,i),l.copy(o).add(s).add(u).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),l.copy(o).add(s).subtract(u).add(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),l.copy(o).add(s).subtract(u).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),o.copy(l).subtract(s).add(u).add(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),o.copy(l).subtract(s).add(u).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),o.copy(l).subtract(s).subtract(u).add(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),o.copy(l).subtract(s).subtract(u).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),n[0]=r,n[1]=i,n}},{key:"transform",value:function(t){this.center.transformAsPoint(t);var e=this.halfAxes.getColumn(0,Zt);e.transformAsPoint(t);var n=this.halfAxes.getColumn(1,Yt);n.transformAsPoint(t);var r=this.halfAxes.getColumn(2,$t);return r.transformAsPoint(t),this.halfAxes=new Kt([].concat(Pt()(e),Pt()(n),Pt()(r))),this}},{key:"getTransform",value:function(){throw new Error("not implemented")}}]),t}(),he=n(154),de=n(24),pe=new yt.a,ve=new yt.a,ge=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,1],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;ht()(this,t),vt(this,"normal",void 0),vt(this,"distance",void 0),this.normal=new yt.a,this.distance=-0,this.fromNormalDistance(e,n)}return pt()(t,[{key:"fromNormalDistance",value:function(t,e){return Object(he.a)(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}},{key:"fromPointNormal",value:function(t,e){t=pe.from(t),this.normal.from(e).normalize();var n=-this.normal.dot(t);return this.distance=n,this}},{key:"fromCoefficients",value:function(t,e,n,r){return this.normal.set(t,e,n),Object(he.a)(Object(de.d)(this.normal.len(),1)),this.distance=r,this}},{key:"clone",value:function(){return new t(this.normal,this.distance)}},{key:"equals",value:function(t){return Object(de.d)(this.distance,t.distance)&&Object(de.d)(this.normal,t.normal)}},{key:"getPointDistance",value:function(t){return this.normal.dot(t)+this.distance}},{key:"transform",value:function(t){var e=ve.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}},{key:"projectPointOntoPlane",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];t=pe.from(t);var n=this.getPointDistance(t),r=ve.copy(this.normal).scale(n);return t.subtract(r).to(e)}}]),t}();function ye(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return me(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return me(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function me(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var be=[new yt.a([1,0,0]),new yt.a([0,1,0]),new yt.a([0,0,1])],Ae=new yt.a,_e=new yt.a,Oe=(new ge(new yt.a(1,0,0),0),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];ht()(this,t),vt(this,"planes",void 0),this.planes=e}return pt()(t,[{key:"fromBoundingSphere",value:function(t){this.planes.length=2*be.length;var e,n=t.center,r=t.radius,i=0,o=ye(be);try{for(o.s();!(e=o.n()).done;){var a=e.value,s=this.planes[i],u=this.planes[i+1];s||(s=this.planes[i]=new ge),u||(u=this.planes[i+1]=new ge);var c=Ae.copy(a).scale(-r).add(n);a.dot(c);s.fromPointNormal(c,a);var l=Ae.copy(a).scale(r).add(n),f=_e.copy(a).negate();f.dot(l);u.fromPointNormal(l,f),i+=2}}catch(t){o.e(t)}finally{o.f()}return this}},{key:"computeVisibility",value:function(t){var e,n=lt,r=ye(this.planes);try{for(r.s();!(e=r.n()).done;){var i=e.value;switch(t.intersectPlane(i)){case ut:return ut;case ct:n=ct}}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"computeVisibilityWithPlaneMask",value:function(e,n){if(Object(he.a)(Number.isFinite(n),"parentPlaneMask is required."),n===t.MASK_OUTSIDE||n===t.MASK_INSIDE)return n;for(var r=t.MASK_INSIDE,i=this.planes,o=0;o<this.planes.length;++o){var a=o<31?1<<o:0;if(!(o<31&&0==(n&a))){var s=i[o],u=e.intersectPlane(s);if(u===ut)return t.MASK_OUTSIDE;u===ct&&(r|=a)}}return r}}]),t}());vt(Oe,"MASK_OUTSIDE",4294967295),vt(Oe,"MASK_INSIDE",0),vt(Oe,"MASK_INDETERMINATE",2147483647);var we=n(98);new yt.a,new yt.a,new yt.a,new yt.a,new yt.a,n(346);new yt.a,new yt.a,new yt.a,new yt.a,new yt.a,new yt.a,new yt.a,new yt.a,new yt.a,new yt.a,new yt.a,new yt.a,Math.PI;var xe=1e-15,Ce=1e-20,Pe=(Math.PI,Math.PI,Math.PI,Math.PI,new Kt),Se=new Kt,Be=new Kt,ke=new Kt,Ee=new Kt;function Te(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ce,r=10,i=0,o=0,a=Se,s=Be;a.identity(),s.copy(t);for(var u=n*je(s);o<r&&Re(s)>u;)De(s,ke),Ee.copy(ke).transpose(),s.multiplyRight(ke),s.multiplyLeft(Ee),a.multiplyRight(ke),++i>2&&(++o,i=0);return e.unitary=a.toTarget(e.unitary),e.diagonal=s.toTarget(e.diagonal),e}function je(t){for(var e=0,n=0;n<9;++n){var r=t[n];e+=r*r}return Math.sqrt(e)}var Me=[1,0,0],Ie=[2,2,1];function Re(t){for(var e=0,n=0;n<3;++n){var r=t[Pe.getElementIndex(Ie[n],Me[n])];e+=2*r*r}return Math.sqrt(e)}function De(t,e){for(var n=xe,r=0,i=1,o=0;o<3;++o){var a=Math.abs(t[Pe.getElementIndex(Ie[o],Me[o])]);a>r&&(i=o,r=a)}var s=Me[i],u=Ie[i],c=1,l=0;if(Math.abs(t[Pe.getElementIndex(u,s)])>n){var f,h=(t[Pe.getElementIndex(u,u)]-t[Pe.getElementIndex(s,s)])/2/t[Pe.getElementIndex(u,s)];l=(f=h<0?-1/(-h+Math.sqrt(1+h*h)):1/(h+Math.sqrt(1+h*h)))*(c=1/Math.sqrt(1+f*f))}return Kt.IDENTITY.to(e),e[Pe.getElementIndex(s,s)]=e[Pe.getElementIndex(u,u)]=c,e[Pe.getElementIndex(u,s)]=l,e[Pe.getElementIndex(s,u)]=-l,e}function Le(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Fe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fe(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Fe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ge=new yt.a,Ne=new yt.a,Ue=new yt.a,ze=new yt.a,He=new yt.a,Ve=new Kt,Je={diagonal:new Kt,unitary:new Kt};function We(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ke(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ke(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ke(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Xe=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],qe=Xe.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),Qe=qe.concat([[.25,.5],[.75,.5]]),Ze=function(){function t(e,n,r){d()(this,t),_()(this,"x",void 0),_()(this,"y",void 0),_()(this,"z",void 0),_()(this,"childVisible",void 0),_()(this,"selected",void 0),_()(this,"_children",void 0),this.x=e,this.y=n,this.z=r}return C()(t,[{key:"children",get:function(){if(!this._children){var e=2*this.x,n=2*this.y,r=this.z+1;this._children=[new t(e,n,r),new t(e,n+1,r),new t(e+1,n,r),new t(e+1,n+1,r)]}return this._children}},{key:"update",value:function(t){var e=t.viewport,n=t.cullingVolume,r=t.elevationBounds,i=t.minZ,o=t.maxZ,a=t.bounds,s=t.offset,u=t.project,c=this.getBoundingVolume(r,s,u);if(a&&!this.insideBounds(a))return!1;if(n.computeVisibility(c)<0)return!1;if(!this.childVisible){var l=this.z;if(l<o&&l>=i){var f=c.distanceTo(e.cameraPosition)*e.scale/e.height;l+=Math.floor(Math.log2(f))}if(l>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;var h,d=We(this.children);try{for(d.s();!(h=d.n()).done;){h.value.update(t)}}catch(t){d.e(t)}finally{d.f()}return!0}},{key:"getSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(this.selected&&t.push(this),this._children){var e,n=We(this._children);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.getSelected(t)}}catch(t){n.e(t)}finally{n.f()}}return t}},{key:"insideBounds",value:function(t){var e=M()(t,4),n=e[0],r=e[1],i=e[2],o=e[3],a=512/Math.pow(2,this.z);return this.x*a<i&&this.y*a<o&&(this.x+1)*a>n&&(this.y+1)*a>r}},{key:"getBoundingVolume",value:function(t,e,n){if(n){var r,i=[],o=We(this.z<1?Qe:this.z<2?qe:Xe);try{for(o.s();!(r=o.n()).done;){var a=r.value,s=on(this.x+a[0],this.y+a[1],this.z);s[2]=t[0],i.push(n(s)),t[0]!==t[1]&&(s[2]=t[1],i.push(n(s)))}}catch(t){o.e(t)}finally{o.f()}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fe;if(!t||0===t.length)return e.halfAxes=new Kt([0,0,0,0,0,0,0,0,0]),e.center=new yt.a,e;var n,r=t.length,i=new yt.a(0,0,0),o=Le(t);try{for(o.s();!(n=o.n()).done;){var a=n.value;i.add(a)}}catch(t){o.e(t)}finally{o.f()}var s=1/r;i.multiplyByScalar(s);var u,c=0,l=0,f=0,h=0,d=0,p=0,v=Le(t);try{for(v.s();!(u=v.n()).done;){var g=u.value,y=Ge.copy(g).subtract(i);c+=y.x*y.x,l+=y.x*y.y,f+=y.x*y.z,h+=y.y*y.y,d+=y.y*y.z,p+=y.z*y.z}}catch(t){v.e(t)}finally{v.f()}c*=s,l*=s,f*=s,h*=s,d*=s,p*=s;var m=Ve;m[0]=c,m[1]=l,m[2]=f,m[3]=l,m[4]=h,m[5]=d,m[6]=f,m[7]=d,m[8]=p;var b,A=Te(m,Je),_=A.unitary,O=e.halfAxes.copy(_),w=O.getColumn(0,Ue),x=O.getColumn(1,ze),C=O.getColumn(2,He),P=-Number.MAX_VALUE,S=-Number.MAX_VALUE,B=-Number.MAX_VALUE,k=Number.MAX_VALUE,E=Number.MAX_VALUE,T=Number.MAX_VALUE,j=Le(t);try{for(j.s();!(b=j.n()).done;){var M=b.value;Ge.copy(M),P=Math.max(Ge.dot(w),P),S=Math.max(Ge.dot(x),S),B=Math.max(Ge.dot(C),B),k=Math.min(Ge.dot(w),k),E=Math.min(Ge.dot(x),E),T=Math.min(Ge.dot(C),T)}}catch(t){j.e(t)}finally{j.f()}w=w.multiplyByScalar(.5*(k+P)),x=x.multiplyByScalar(.5*(E+S)),C=C.multiplyByScalar(.5*(T+B)),e.center.copy(w).add(x).add(C);var I=Ne.set(P-k,S-E,B-T).multiplyByScalar(.5),R=new Kt([I[0],0,0,0,I[1],0,0,0,I[2]]);return e.halfAxes.multiplyRight(R),e}(i)}var u=512/Math.pow(2,this.z),c=this.x*u+512*e,l=512-(this.y+1)*u;return new At([c,l,t[0]],[c+u,l+u,t[1]])}}]),t}();var Ye=[-1/0,-1/0,1/0,1/0],$e={type:"url",value:null,validate:function(t,e){return e.optional&&null===t||"string"==typeof t||Array.isArray(t)&&t.every((function(t){return"string"==typeof t}))},equals:function(t,e){if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function tn(t,e){var n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min.apply(Math,ot()(n.map((function(t){return t[0]})))),Math.min.apply(Math,ot()(n.map((function(t){return t[1]})))),Math.max.apply(Math,ot()(n.map((function(t){return t[0]})))),Math.max.apply(Math,ot()(n.map((function(t){return t[1]}))))]}function en(t,e){if(!t||!t.length)return null;var n,r=e.index,i=e.id;Array.isArray(t)&&(t=t[(n=i,Math.abs(n.split("").reduce((function(t,e){return(t<<5)-t+e.charCodeAt(0)|0}),0))%t.length)]);for(var o=t,a=0,s=Object.keys(r);a<s.length;a++){var u=s[a],c=new RegExp("{".concat(u,"}"),"g");o=o.replace(c,String(r[u]))}return Number.isInteger(r.y)&&Number.isInteger(r.z)&&(o=o.replace(/\{-y\}/g,String(Math.pow(2,r.z)-r.y-1))),o}function nn(t){var e=t.viewport,n=t.z,r=t.cullRect,i=r.x-e.x,o=r.y-e.y,a=r.width,s=r.height;if(!Array.isArray(n)){var u={targetZ:n||0},c=e.unproject([i,o],u),l=e.unproject([i+a,o],u),f=e.unproject([i,o+s],u),h=e.unproject([i+a,o+s],u);return[Math.min(c[0],l[0],f[0],h[0]),Math.min(c[1],l[1],f[1],h[1]),Math.max(c[0],l[0],f[0],h[0]),Math.max(c[1],l[1],f[1],h[1])]}var d=nn({viewport:e,z:n[0],cullRect:r}),p=nn({viewport:e,z:n[1],cullRect:r});return[Math.min(d[0],p[0]),Math.min(d[1],p[1]),Math.max(d[2],p[2]),Math.max(d[3],p[3])]}function rn(t,e){return 512*Math.pow(2,t)/e}function on(t,e,n){var r=rn(n,512),i=t/r*360-180,o=Math.PI-2*Math.PI*e/r;return[i,180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)))]}function an(t,e,n,r){var i=rn(n,r);return[t/i*512,e/i*512]}function sn(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:512;if(t.isGeospatial){var o=on(e,n,r),a=M()(o,2),s=a[0],u=a[1],c=on(e+1,n+1,r),l=M()(c,2),f=l[0],h=l[1];return{west:s,north:u,east:f,south:h}}var d=an(e,n,r,i),p=M()(d,2),v=p[0],g=p[1],y=an(e+1,n+1,r,i),m=M()(y,2),b=m[0],A=m[1];return{left:v,top:g,right:b,bottom:A}}function un(t,e,n,r,i){for(var o=function(t,e,n){return n?tn(t,n).map((function(t){return t*e/512})):t.map((function(t){return t*e/512}))}(function(t,e,n){var r;if(e&&2===e.length){var i=M()(e,2),o=i[0],a=i[1],s=t.getBounds({z:o}),u=t.getBounds({z:a});r=[Math.min(s[0],u[0]),Math.min(s[1],u[1]),Math.max(s[2],u[2]),Math.max(s[3],u[3])]}else r=t.getBounds();return t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}(t,null,r),rn(e,n),i),a=M()(o,4),s=a[0],u=a[1],c=a[2],l=a[3],f=[],h=Math.floor(s);h<c;h++)for(var d=Math.floor(u);d<l;d++)f.push({x:h,y:d,z:e});return f}function cn(t){var e=t.viewport,n=t.maxZoom,r=t.minZoom,i=t.zRange,o=t.extent,a=t.tileSize,s=void 0===a?512:a,u=t.modelMatrix,c=t.modelMatrixInverse,l=t.zoomOffset,f=void 0===l?0:l,h=e.isGeospatial?Math.round(e.zoom+Math.log2(512/s))+f:Math.ceil(e.zoom)+f;if("number"==typeof r&&Number.isFinite(r)&&h<r){if(!o)return[];h=r}"number"==typeof n&&Number.isFinite(n)&&h>n&&(h=n);var d=o;return u&&c&&o&&!e.isGeospatial&&(d=tn(o,u)),e.isGeospatial?function(t,e,n,r){var i=t instanceof at.a&&t.resolution?t.projectPosition:null,o=Object.values(t.getFrustumPlanes()).map((function(t){var e=t.normal,n=t.distance;return new ge(e.clone().negate(),n)})),a=new Oe(o),s=t.distanceScales.unitsPerMeter[2],u=n&&n[0]*s||0,c=n&&n[1]*s||0,l=t instanceof st.a&&t.pitch<=60?e:0;if(r){var f=r,h=M()(f,4),d=h[0],p=h[1],v=h[2],g=h[3],y=Object(W.l)([d,g]),m=Object(W.l)([v,p]);r=[y[0],512-y[1],m[0],512-m[1]]}var b=new Ze(0,0,0),A={viewport:t,project:i,cullingVolume:a,elevationBounds:[u,c],minZ:l,maxZ:e,bounds:r,offset:0};if(b.update(A),t instanceof st.a&&t.subViewports&&t.subViewports.length>1){for(A.offset=-1;b.update(A)&&!(--A.offset<-3););for(A.offset=1;b.update(A)&&!(++A.offset>3););}return b.getSelected()}(e,h,i,o):un(e,h,s,d||Ye,c)}var ln=n(13),fn=n(110);function hn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function dn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?hn(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var pn,vn={id:"request-scheduler",throttleRequests:!0,maxRequests:6},gn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d()(this,t),Object(ln.a)(this,"props",void 0),Object(ln.a)(this,"stats",void 0),Object(ln.a)(this,"activeRequestCount",0),Object(ln.a)(this,"requestQueue",[]),Object(ln.a)(this,"requestMap",new Map),Object(ln.a)(this,"deferredUpdate",null),this.props=dn(dn({},vn),e),this.stats=new fn.a({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}return C()(t,[{key:"scheduleRequest",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return 0};if(!this.props.throttleRequests)return Promise.resolve({done:function(){}});if(this.requestMap.has(t))return this.requestMap.get(t);var n={handle:t,priority:0,getPriority:e},r=new Promise((function(t){return n.resolve=t,n}));return this.requestQueue.push(n),this.requestMap.set(t,r),this._issueNewRequests(),r}},{key:"_issueRequest",value:function(t){var e=this,n=t.handle,r=t.resolve,i=!1,o=function(){i||(i=!0,e.requestMap.delete(n),e.activeRequestCount--,e._issueNewRequests())};return this.activeRequestCount++,r?r({done:o}):Promise.resolve({done:o})}},{key:"_issueNewRequests",value:function(){var t=this;this.deferredUpdate||(this.deferredUpdate=setTimeout((function(){return t._issueNewRequestsAsync()}),0))}},{key:"_issueNewRequestsAsync",value:function(){this.deferredUpdate=null;var t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(var e=0;e<t;++e){var n=this.requestQueue.shift();n&&this._issueRequest(n)}}}},{key:"_updateAllRequests",value:function(){for(var t=this.requestQueue,e=0;e<t.length;++e){var n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort((function(t,e){return t.priority-e.priority}))}},{key:"_updateRequest",value:function(t){return t.priority=t.getPriority(t.handle),!(t.priority<0)||(t.resolve(null),!1)}}]),t}(),yn=n(101);function mn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return bn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bn(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function bn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var An=(pn={},_()(pn,"best-available",(function(t){var e,n=mn(t);try{for(n.s();!(e=n.n()).done;){e.value.state=0}}catch(t){n.e(t)}finally{n.f()}var r,i=mn(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.isSelected&&!On(o)&&wn(o)}}catch(t){i.e(t)}finally{i.f()}var a,s=mn(t);try{for(s.s();!(a=s.n()).done;){var u=a.value;u.isVisible=Boolean(2&u.state)}}catch(t){s.e(t)}finally{s.f()}})),_()(pn,"no-overlap",(function(t){var e,n=mn(t);try{for(n.s();!(e=n.n()).done;){e.value.state=0}}catch(t){n.e(t)}finally{n.f()}var r,i=mn(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.isSelected&&On(o)}}catch(t){i.e(t)}finally{i.f()}var a,s=mn(Array.from(t).sort((function(t,e){return t.zoom-e.zoom})));try{for(s.s();!(a=s.n()).done;){var u=a.value;if(u.isVisible=Boolean(2&u.state),u.children&&(u.isVisible||1&u.state)){var c,l=mn(u.children);try{for(l.s();!(c=l.n()).done;){c.value.state=1}}catch(t){l.e(t)}finally{l.f()}}else u.isSelected&&wn(u)}}catch(t){s.e(t)}finally{s.f()}})),_()(pn,"never",(function(){})),pn),_n=function(){function t(e){var n=this;d()(this,t),_()(this,"opts",void 0),_()(this,"_requestScheduler",void 0),_()(this,"_cache",void 0),_()(this,"_dirty",void 0),_()(this,"_tiles",void 0),_()(this,"_cacheByteSize",void 0),_()(this,"_viewport",void 0),_()(this,"_zRange",void 0),_()(this,"_selectedTiles",void 0),_()(this,"_frameNumber",void 0),_()(this,"_modelMatrix",void 0),_()(this,"_modelMatrixInverse",void 0),_()(this,"_maxZoom",void 0),_()(this,"_minZoom",void 0),_()(this,"onTileLoad",void 0),_()(this,"_getCullBounds",Object(yn.a)(nn)),this.opts=e,this.onTileLoad=function(t){n.opts.onTileLoad(t),n.opts.maxCacheByteSize&&(n._cacheByteSize+=t.byteLength,n._resizeCache())},this._requestScheduler=new gn({maxRequests:e.maxRequests,throttleRequests:e.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new we.a,this._modelMatrixInverse=new we.a,this.setOptions(e)}return C()(t,[{key:"tiles",get:function(){return this._tiles}},{key:"selectedTiles",get:function(){return this._selectedTiles}},{key:"isLoaded",get:function(){return null!==this._selectedTiles&&this._selectedTiles.every((function(t){return t.isLoaded}))}},{key:"needsReload",get:function(){return null!==this._selectedTiles&&this._selectedTiles.some((function(t){return t.needsReload}))}},{key:"setOptions",value:function(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}},{key:"finalize",value:function(){var t,e=mn(this._cache.values());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.isLoading&&n.abort()}}catch(t){e.e(t)}finally{e.f()}this._cache.clear(),this._tiles=[],this._selectedTiles=null}},{key:"reloadAll",value:function(){var t,e=mn(this._cache.keys());try{for(e.s();!(t=e.n()).done;){var n=t.value,r=this._cache.get(n);this._selectedTiles&&this._selectedTiles.includes(r)?r.setNeedsReload():this._cache.delete(n)}}catch(t){e.e(t)}finally{e.f()}}},{key:"update",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.zRange,i=n.modelMatrix,o=new we.a(i),a=!o.equals(this._modelMatrix);if(this._viewport&&t.equals(this._viewport)&&Object(de.d)(this._zRange,r)&&!a)this.needsReload&&(this._selectedTiles=this._selectedTiles.map((function(t){return e._getTile(t.index,!0)})));else{a&&(this._modelMatrixInverse=o.clone().invert(),this._modelMatrix=o),this._viewport=t,this._zRange=r;var s=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:r,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=s.map((function(t){return e._getTile(t,!0)})),this._dirty&&this._rebuildTree()}var u=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),u&&this._frameNumber++,this._frameNumber}},{key:"isTileVisible",value:function(t,e){if(!t.isVisible)return!1;if(e&&this._viewport){var n=nn({viewport:this._viewport,z:this._zRange,cullRect:e}),r=M()(n,4),i=r[0],o=r[1],a=r[2],s=r[3],u=t.bbox;if("west"in u)return u.west<a&&u.east>i&&u.south<s&&u.north>o;var c=Math.min(u.top,u.bottom),l=Math.max(u.top,u.bottom);return u.left<a&&u.right>i&&c<s&&l>o}return!0}},{key:"getTileIndices",value:function(t){var e=t.viewport,n=t.maxZoom,r=t.minZoom,i=t.zRange,o=t.modelMatrix,a=t.modelMatrixInverse,s=this.opts;return cn({viewport:e,maxZoom:n,minZoom:r,zRange:i,tileSize:s.tileSize,extent:s.extent,modelMatrix:o,modelMatrixInverse:a,zoomOffset:s.zoomOffset})}},{key:"getTileId",value:function(t){return"".concat(t.x,"-").concat(t.y,"-").concat(t.z)}},{key:"getTileZoom",value:function(t){return t.z}},{key:"getTileMetadata",value:function(t){var e=this.opts.tileSize;return{bbox:sn(this._viewport,t.x,t.y,t.z,e)}}},{key:"getParentIndex",value:function(t){return{x:Math.floor(t.x/2),y:Math.floor(t.y/2),z:t.z-1}}},{key:"updateTileStates",value:function(){var t,e=this.opts.refinementStrategy||"best-available",n=new Array(this._cache.size),r=0,i=mn(this._cache.values());try{for(i.s();!(t=i.n()).done;){var o=t.value;n[r++]=o.isVisible,o.isSelected=!1,o.isVisible=!1}}catch(t){i.e(t)}finally{i.f()}var a,s=mn(this._selectedTiles);try{for(s.s();!(a=s.n()).done;){var u=a.value;u.isSelected=!0,u.isVisible=!0}}catch(t){s.e(t)}finally{s.f()}("function"==typeof e?e:An[e])(Array.from(this._cache.values())),r=0;var c,l=mn(this._cache.values());try{for(l.s();!(c=l.n()).done;){var f=c.value;if(n[r++]!==f.isVisible)return!0}}catch(t){l.e(t)}finally{l.f()}return!1}},{key:"_pruneRequests",value:function(){var t,e=this.opts.maxRequests,n=[],r=0,i=mn(this._cache.values());try{for(i.s();!(t=i.n()).done;){var o=t.value;o.isLoading&&(r++,o.isSelected||o.isVisible||n.push(o))}}catch(t){i.e(t)}finally{i.f()}for(;e>0&&r>e&&n.length>0;){n.shift().abort(),r--}}},{key:"_rebuildTree",value:function(){var t,e=this._cache,n=mn(e.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;r.parent=null,r.children&&(r.children.length=0)}}catch(t){n.e(t)}finally{n.f()}var i,o=mn(e.values());try{for(o.s();!(i=o.n()).done;){var a=i.value,s=this._getNearestAncestor(a);a.parent=s,null!=s&&s.children&&s.children.push(a)}}catch(t){o.e(t)}finally{o.f()}}},{key:"_resizeCache",value:function(){var t=this._cache,e=this.opts,n=e.maxCacheSize||(e.maxCacheByteSize?1/0:5*this.selectedTiles.length),r=e.maxCacheByteSize||1/0;if(t.size>n||this._cacheByteSize>r){var i,o=mn(t);try{for(o.s();!(i=o.n()).done;){var a=M()(i.value,2),s=a[0],u=a[1];if(u.isVisible||u.isSelected||(this._cacheByteSize-=e.maxCacheByteSize?u.byteLength:0,t.delete(s),this.opts.onTileUnload(u)),t.size<=n&&this._cacheByteSize<=r)break}}catch(t){o.e(t)}finally{o.f()}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((function(t,e){return t.zoom-e.zoom})),this._dirty=!1)}},{key:"_getTile",value:function(t,e){var n=this.getTileId(t),r=this._cache.get(n),i=!1;return!r&&e?(r=new rt(t),Object.assign(r,this.getTileMetadata(r.index)),Object.assign(r,{id:n,zoom:this.getTileZoom(r.index)}),i=!0,this._cache.set(n,r),this._dirty=!0):r&&r.needsReload&&(i=!0),r&&i&&r.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),r}},{key:"_getNearestAncestor",value:function(t){for(var e=this._minZoom,n=void 0===e?0:e,r=t.index;this.getTileZoom(r)>n;){r=this.getParentIndex(r);var i=this._getTile(r);if(i)return i}return null}}]),t}();function On(t){for(var e=t;e;){if(e.isLoaded||e.content)return e.state|=2,!0;e=e.parent}return!1}function wn(t){var e,n=mn(t.children);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.isLoaded||r.content?r.state|=2:wn(r)}}catch(t){n.e(t)}finally{n.f()}}function xn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Cn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xn(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Pn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var Sn={TilesetClass:_n,data:{type:"data",value:[]},dataComparator:$e.equals,renderSubLayers:{type:"function",value:function(t){return new Z.a(t)},compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:function(t){},compare:!1},onTileUnload:{type:"function",value:function(t){},compare:!1},onTileError:{type:"function",value:function(t){return console.error(t)},compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0},Bn=function(t){v()(n,t);var e=Pn(n);function n(){return d()(this,n),e.apply(this,arguments)}return C()(n,[{key:"initializeState",value:function(){this.state={tileset:null,isLoaded:!1}}},{key:"finalizeState",value:function(){var t,e;null===(t=this.state)||void 0===t||null===(e=t.tileset)||void 0===e||e.finalize()}},{key:"isLoaded",get:function(){var t,e;return null===(t=this.state)||void 0===t?void 0:null===(e=t.tileset)||void 0===e?void 0:e.selectedTiles.every((function(t){return t.isLoaded&&t.layers&&t.layers.every((function(t){return t.isLoaded}))}))}},{key:"shouldUpdateState",value:function(t){return t.changeFlags.somethingChanged}},{key:"updateState",value:function(t){var e=t.changeFlags,n=this.state.tileset,r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():this.state.tileset.tiles.forEach((function(t){t.layers=null}))):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}},{key:"_getTilesetOptions",value:function(){var t=this.props,e=t.tileSize,n=t.maxCacheSize,r=t.maxCacheByteSize,i=t.refinementStrategy,o=t.extent;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:e,refinementStrategy:i,extent:o,maxRequests:t.maxRequests,zoomOffset:t.zoomOffset,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}},{key:"_updateTileset",value:function(){var t=this.state.tileset,e=this.props,n=e.zRange,r=e.modelMatrix,i=t.update(this.context.viewport,{zRange:n,modelMatrix:r}),o=t.isLoaded,a=this.state.isLoaded!==o,s=this.state.frameNumber!==i;o&&(a||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:i}),this.state.isLoaded=o}},{key:"_onViewportLoad",value:function(){var t=this.state.tileset,e=this.props.onViewportLoad;e&&e(t.selectedTiles)}},{key:"_onTileLoad",value:function(t){this.props.onTileLoad(t),t.layers=null,this.setNeedsUpdate()}},{key:"_onTileError",value:function(t,e){this.props.onTileError(t),e.layers=null,this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(t){this.props.onTileUnload(t)}},{key:"getTileData",value:function(t){var e=this.props,n=e.data,r=e.getTileData,i=e.fetch,o=t.signal;return t.url="string"==typeof n||Array.isArray(n)?en(n,t):null,r?r(t):i&&t.url?i(t.url,{propName:"data",layer:this,signal:o}):null}},{key:"renderSubLayers",value:function(t){return this.props.renderSubLayers(t)}},{key:"getSubLayerPropsByTile",value:function(t){return null}},{key:"getPickingInfo",value:function(t){var e=t.info,n=t.sourceLayer;return e.picked&&(e.tile=n.props.tile),e}},{key:"_updateAutoHighlight",value:function(t){t.sourceLayer&&t.sourceLayer.updateAutoHighlight(t)}},{key:"renderLayers",value:function(){var t=this;return this.state.tileset.tiles.map((function(e){var n=t.getSubLayerPropsByTile(e);if(e.isLoaded||e.content)if(e.layers)n&&e.layers[0]&&Object.keys(n).some((function(t){return e.layers[0].props[t]!==n[t]}))&&(e.layers=e.layers.map((function(t){return t.clone(n)})));else{var r=t.renderSubLayers(Cn(Cn({},t.props),{},{id:"".concat(t.id,"-").concat(e.id),data:e.content,_offset:0,tile:e}));e.layers=Object(Q.b)(r,Boolean).map((function(t){return t.clone(Cn({tile:e},n))}))}else;return e.layers}))}},{key:"filterSubLayer",value:function(t){var e=t.layer,n=t.cullRect,r=e.props.tile;return this.state.tileset.isTileVisible(r,n)}}]),n}(P.a);_()(Bn,"defaultProps",Sn),_()(Bn,"layerName","TileLayer");var kn=n(10),En=n.n(kn);function Tn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function jn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Tn(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Mn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var In=function(t){v()(n,t);var e=Mn(n);function n(){return d()(this,n),e.apply(this,arguments)}return C()(n,[{key:"getShaders",value:function(){var t=En()(b()(n.prototype),"getShaders",this).call(this);return t.inject={"vs:#decl":"uniform float trailLength;\nattribute float instanceTimestamps;\nattribute float instanceNextTimestamps;\nvarying float vTime;\n","vs:#main-end":"vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;\n","fs:#decl":"uniform bool fadeTrail;\nuniform float trailLength;\nuniform float currentTime;\nvarying float vTime;\n","fs:#main-start":"if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {\n  discard;\n}\n","fs:DECKGL_FILTER_COLOR":"if(fadeTrail) {\n  color.a *= 1.0 - (currentTime - vTime) / trailLength;\n}\n"},t}},{key:"initializeState",value:function(){En()(b()(n.prototype),"initializeState",this).call(this),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}},{key:"draw",value:function(t){var e=this.props,r=e.fadeTrail,i=e.trailLength,o=e.currentTime;t.uniforms=jn(jn({},t.uniforms),{},{fadeTrail:r,trailLength:i,currentTime:o}),En()(b()(n.prototype),"draw",this).call(this,t)}}]),n}(n(132).a);_()(In,"layerName","TripsLayer"),_()(In,"defaultProps",{fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:function(t){return t.timestamps}}});var Rn=n(87),Dn=n(75),Ln=n(9),Fn=n.n(Ln),Gn=n(26),Nn=n.n(Gn),Un=n(178);function zn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}function Hn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Vn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Hn(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Hn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Jn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Wn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wn(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Wn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Kn(t,e){e=void 0===e?t[0][0]:e;var n,r=Jn(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i[0]-e;o>180?i[0]-=360:o<-180&&(i[0]+=360)}}catch(t){r.e(t)}finally{r.f()}}function Xn(t,e,n){var r=Object(Rn.h3ToGeo)(t),i=M()(r,2),o=i[0],a=i[1],s=e.length;Kn(e,a);for(var u=e[0]===e[s-1]?s-1:s,c=0;c<u;c++)e[c][0]=Object(de.g)(a,e[c][0],n),e[c][1]=Object(de.g)(o,e[c][1],n)}function qn(t,e,n){var r=t(e,n),i=Object(Rn.h3ToGeo)(r),o=M()(i,2),a=o[0];return[o[1],a]}function Qn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Object(Rn.h3ToGeoBoundary)(t,!0);return 1!==e?Xn(t,n,e):Kn(n),n}var Zn=Vn(Vn({},S.a.defaultProps),{},{highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:function(t){return t.hexagon}},extruded:!0}),Yn=function(t){v()(n,t);var e=zn(n);function n(){var t;d()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),_()(Fn()(t),"state",void 0),t}return C()(n,[{key:"initializeState",value:function(){n._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}},{key:"shouldUpdateState",value:function(t){var e=t.changeFlags;return this._shouldUseHighPrecision()?e.propsOrDataChanged:e.somethingChanged}},{key:"updateState",value:function(t){var e=t.props,n=t.changeFlags;if(!0!==e.highPrecision&&(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagon)){var r=this._calculateH3DataProps();this.setState(r)}this._updateVertices(this.context.viewport)}},{key:"_calculateH3DataProps",value:function(){var t,e=-1,n=!1,r=!1,i=Object(Dn.a)(this.props.data),o=i.iterable,a=i.objectInfo,s=Jn(o);try{for(s.s();!(t=s.n()).done;){var u=t.value;a.index++;var c=this.props.getHexagon(u,a),l=Object(Rn.h3GetResolution)(c);if(e<0){if(e=l,!this.props.highPrecision)break}else if(e!==l){r=!0;break}if(Object(Rn.h3IsPentagon)(c)){n=!0;break}}}catch(t){s.e(t)}finally{s.f()}return{resolution:e,edgeLengthKM:e>=0?Object(Rn.edgeLength)(e,"km"):0,hasMultipleRes:r,hasPentagon:n}}},{key:"_shouldUseHighPrecision",value:function(){if("auto"===this.props.highPrecision){var t=this.state,e=t.resolution,n=t.hasPentagon,r=t.hasMultipleRes,i=this.context.viewport;return Boolean(null==i?void 0:i.resolution)||r||n||e>=0&&e<=5}return this.props.highPrecision}},{key:"_updateVertices",value:function(t){if(!this._shouldUseHighPrecision()){var e=this.state,n=e.resolution,r=e.edgeLengthKM,i=e.centerHex;if(!(n<0)){var o=this.props.centerHexagon||Object(Rn.geoToH3)(t.latitude,t.longitude,n);if(i!==o){if(i){var a=Object(Rn.h3Distance)(i,o);if(a>=0&&a*r<10)return}var s=t.distanceScales.unitsPerMeter,u=Qn(o),c=Object(Rn.h3ToGeo)(o),l=M()(c,2),f=l[0],h=l[1],d=t.projectFlat([h,f]),p=M()(d,2),v=p[0],g=p[1];u=u.map((function(e){var n=t.projectFlat(e);return[(n[0]-v)/s[0],(n[1]-g)/s[1]]})),this.setState({centerHex:o,vertices:u})}}}}},{key:"renderLayers",value:function(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}},{key:"_getForwardProps",value:function(){var t=this.props,e=t.elevationScale,n=t.material,r=t.coverage,i=t.extruded,o=t.wireframe,a=t.stroked,s=t.filled,u=t.lineWidthUnits,c=t.lineWidthScale,l=t.lineWidthMinPixels,f=t.lineWidthMaxPixels,h=t.getFillColor,d=t.getElevation,p=t.getLineColor,v=t.getLineWidth,g=t.transitions,y=t.updateTriggers;return{elevationScale:e,extruded:i,coverage:r,wireframe:o,stroked:a,filled:s,lineWidthUnits:u,lineWidthScale:c,lineWidthMinPixels:l,lineWidthMaxPixels:f,material:n,getElevation:d,getFillColor:h,getLineColor:p,getLineWidth:v,transitions:g,updateTriggers:{getFillColor:y.getFillColor,getElevation:y.getElevation,getLineColor:y.getLineColor,getLineWidth:y.getLineWidth}}}},{key:"_renderPolygonLayer",value:function(){var t=this.props,e=t.data,n=t.getHexagon,r=t.updateTriggers,i=t.coverage,o=this.getSubLayerClass("hexagon-cell-hifi",S.a),a=this._getForwardProps();return a.updateTriggers.getPolygon=function(t,e){return null==t?e:"object"===Nn()(t)?Vn(Vn({},t),{},{coverage:e}):{getHexagon:t,coverage:e}}(r.getHexagon,i),new o(a,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:a.updateTriggers}),{data:e,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:function(t,e){return function(t){var e,n=new Float64Array(2*t.length),r=0,i=Jn(t);try{for(i.s();!(e=i.n()).done;){var o=e.value;n[r++]=o[0],n[r++]=o[1]}}catch(t){i.e(t)}finally{i.f()}return n}(Qn(n(t,e),i))}})}},{key:"_renderColumnLayer",value:function(){var t=this.props,e=t.data,n=t.getHexagon,r=t.updateTriggers,i=this.getSubLayerClass("hexagon-cell",Un.a),o=this._getForwardProps();return o.updateTriggers.getPosition=r.getHexagon,new i(o,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:o.updateTriggers}),{data:e,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:qn.bind(null,n)})}}]),n}(P.a);function $n(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return tr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tr(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function tr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function er(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}_()(Yn,"defaultProps",Zn),_()(Yn,"layerName","H3HexagonLayer"),_()(Yn,"_checkH3Lib",(function(){}));var nr=function(t){v()(n,t);var e=er(n);function n(){return d()(this,n),e.apply(this,arguments)}return C()(n,[{key:"initializeState",value:function(){Yn._checkH3Lib()}},{key:"updateState",value:function(t){var e=t.props,n=t.changeFlags;if(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagons){var r,i=e.data,o=e.getHexagons,a=[],s=Object(Dn.a)(i),u=s.iterable,c=s.objectInfo,l=$n(u);try{for(l.s();!(r=l.n()).done;){var f=r.value;c.index++;var h,d=o(f,c),p=$n(Object(Rn.h3SetToMultiPolygon)(d,!0));try{for(p.s();!(h=p.n()).done;){var v=h.value;a.push(this.getSubLayerRow({polygon:v},f,c.index))}}catch(t){p.e(t)}finally{p.f()}}}catch(t){l.e(t)}finally{l.f()}this.setState({polygons:a})}}},{key:"indexToBounds",value:function(){return{data:this.state.polygons,getPolygon:function(t){return t.polygon}}}}]),n}(T);_()(nr,"layerName","H3ClusterLayer"),_()(nr,"defaultProps",{getHexagons:{type:"accessor",value:function(t){return t.hexagons}}});var rr=n(82),ir=n(20),or=n(245),ar=n(239),sr=n(263),ur=n(352),cr=n(194),lr=n(246);function fr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function hr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fr(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function dr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var pr=function(t){v()(n,t);var e=dr(n);function n(){return d()(this,n),e.apply(this,arguments)}return C()(n,[{key:"getShaders",value:function(){var t=En()(b()(n.prototype),"getShaders",this).call(this);return t.modules.push(ur.a),hr(hr({},t),{},{vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\n\n// Scale the model\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nuniform bool pickFeatureIds;\n\n// Primitive attributes\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec4 uvRegions;\nin vec3 featureIdsPickingColors;\n\n// Instance attributes\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\n\n// Outputs to fragment shader\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvec2 applyUVRegion(vec2 uv) {\n  #ifdef HAS_UV_REGIONS\n    // https://github.com/Esri/i3s-spec/blob/master/docs/1.7/geometryUVRegion.cmn.md\n    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;\n  #else\n    return uv;\n  #endif\n}\n\nvoid main(void) {\n  vec2 uv = applyUVRegion(texCoords);\n  geometry.uv = uv;\n\n  if (pickFeatureIds) {\n    geometry.pickingColor = featureIdsPickingColors;\n  } else {\n    geometry.pickingColor = instancePickingColors;\n  }\n\n  vTexCoord = uv;\n  cameraPosition = project_uCameraPosition;\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale;\n  vec3 projectedPosition = project_position(positions);\n  position_commonspace = vec4(projectedPosition, 1.0);\n  gl_Position = project_common_position_to_clipspace(position_commonspace);\n\n  geometry.position = position_commonspace;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  geometry.normal = normals_commonspace;\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    // set PBR data\n    pbr_vPosition = geometry.position.xyz;\n    #ifdef HAS_NORMALS\n      pbr_vNormal = geometry.normal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = uv;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  \n#ifdef MODULE_PBR\n\n  fragColor = vColor * pbr_filterColor(vec4(0));\n  geometry.uv = pbr_vUV;\n  fragColor.a *= opacity;\n\n#else\n\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n\n// NOTE(Tarek): This is necessary because\n// headless.gl reports the extension as\n// available but does not support it in\n// the shader.\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n#endif\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n"})}},{key:"initializeState",value:function(){var t=this.props.featureIds;En()(b()(n.prototype),"initializeState",this).call(this);var e=this.getAttributeManager();t&&e.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}},{key:"updateState",value:function(t){En()(b()(n.prototype),"updateState",this).call(this,t);var e=t.props,r=t.oldProps;e.pbrMaterial!==r.pbrMaterial&&this.updatePbrMaterialUniforms(e.pbrMaterial)}},{key:"draw",value:function(t){var e=this.props.featureIds;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:Boolean(e)}),En()(b()(n.prototype),"draw",this).call(this,t))}},{key:"getModel",value:function(t){var e=this.props,n=e.id,r=e.pbrMaterial,i=this.parseMaterial(r,t);this.setState({materialParser:i});var o,a=this.getShaders();return(o=t.attributes).COLOR_0||o.colors||(o.colors={constant:!0,value:new Float32Array([1,1,1])}),new cr.a(this.context.gl,hr(hr({},this.getShaders()),{},{id:n,geometry:t,defines:hr(hr(hr({},a.defines),null==i?void 0:i.defines),{},{HAS_UV_REGIONS:t.attributes.uvRegions}),parameters:null==i?void 0:i.parameters,isInstanced:!0}))}},{key:"updatePbrMaterialUniforms",value:function(t){var e=this.state.model;if(e){var n=this.props.mesh,r=this.parseMaterial(t,n);this.setState({materialParser:r}),e.setUniforms(r.uniforms)}}},{key:"parseMaterial",value:function(t,e){var n,r=Boolean(t.pbrMetallicRoughness&&t.pbrMetallicRoughness.baseColorTexture);return null===(n=this.state.materialParser)||void 0===n||n.delete(),new sr.a(this.context.gl,{attributes:{NORMAL:e.attributes.normals,TEXCOORD_0:e.attributes.texCoords},material:hr({unlit:r},t),pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}},{key:"calculateFeatureIdsPickingColors",value:function(t){for(var e=this.props.featureIds,n=new Uint8ClampedArray(e.length*t.size),r=[],i=0;i<e.length;i++)this.encodePickingColor(e[i],r),n[3*i]=r[0],n[3*i+1]=r[1],n[3*i+2]=r[2];t.value=n}},{key:"finalizeState",value:function(t){var e;En()(b()(n.prototype),"finalizeState",this).call(this,t),null===(e=this.state.materialParser)||void 0===e||e.delete(),this.setState({materialParser:null})}}]),n}(lr.a);_()(pr,"layerName","MeshLayer"),_()(pr,"defaultProps",{pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}});var vr=n(223),gr=n(42),yr=n.n(gr),mr=n(8),br=n.n(mr),Ar=n(22),_r=n.n(Ar),Or=n(11),wr=n.n(Or),xr=n(16),Cr=n.n(xr),Pr=n(4),Sr=n.n(Pr),Br=n(6),kr=n(28),Er=n.n(kr),Tr=n(48),jr=n.n(Tr),Mr=n(38),Ir=n.n(Mr),Rr=n(23),Dr=n.n(Rr),Lr=(n(261),n(36)),Fr=n.n(Lr);function Gr(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}var Nr=1/Math.PI*180,Ur=1/180*Math.PI,zr={};function Hr(t){return Math.round(t/zr.EPSILON)*zr.EPSILON}function Vr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.precision,r=void 0===n?zr.precision||4:n;return t=Hr(t),"".concat(parseFloat(t.toPrecision(r)))}function Jr(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Wr(t,e,n){if(Jr(t)){n=n||((i=t).clone?i.clone():new Array(i.length));for(var r=0;r<n.length&&r<t.length;++r)n[r]=e(t[r],r,n);return n}var i;return e(t)}function Kr(t){return function(t,e){return Wr(t,(function(t){return t*Ur}),e)}(t)}function Xr(t){return qr(t)}function qr(t,e){return Wr(t,(function(t){return t*Nr}),e)}function Qr(t,e,n){return Wr(t,(function(t){return Math.max(e,Math.min(n,t))}))}function Zr(t,e,n){var r=zr.EPSILON;n&&(zr.EPSILON=n);try{if(t===e)return!0;if(Jr(t)&&Jr(e)){if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!Zr(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=zr.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{zr.EPSILON=r}}function Yr(t,e){if(t.length!==e)return!1;for(var n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function $r(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function ti(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(zr.debug&&!Yr(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}zr.EPSILON=1e-12,zr.debug=!1,zr.precision=4,zr.printTypes=!1,zr.printDegrees=!1,zr.printRowMajor=!0;var ei={};function ni(t,e){ei[t]||(ei[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}function ri(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ir()(t);if(e){var i=Ir()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jr()(this,n)}}var ii=function(t){Er()(n,t);var e=ri(n);function n(){return wr()(this,n),e.apply(this,arguments)}return Cr()(n,[{key:"ELEMENTS",get:function(){return Gr(!1),0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"from",value:function(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}},{key:"to",value:function(t){return t===this?this:Jr(t)?this.toArray(t):this.toObject(t)}},{key:"toTarget",value:function(t){return t?this.to(t):this}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(zr)}},{key:"formatString",value:function(t){for(var e="",n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Vr(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!Zr(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"lerp",value:function(t,e,n){void 0===n&&(n=e,e=t,t=this);for(var r=0;r<this.ELEMENTS;++r){var i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0;a<this.ELEMENTS;++a)this[a]+=o[a];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0;a<this.ELEMENTS;++a)this[a]-=o[a];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}},{key:"multiplyByScalar",value:function(t){return this.scale(t)}},{key:"elements",get:function(){return this}},{key:"check",value:function(){if(zr.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var t=this.length===this.ELEMENTS,e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}}]),n}(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array));function oi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ir()(t);if(e){var i=Ir()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jr()(this,n)}}var ai=function(t){Er()(n,t);var e=oi(n);function n(){return wr()(this,n),e.apply(this,arguments)}return Cr()(n,[{key:"ELEMENTS",get:function(){return Gr(!1),0}},{key:"RANK",get:function(){return Gr(!1),0}},{key:"toString",value:function(){var t="[";if(zr.printRowMajor){t+="row-major:";for(var e=0;e<this.RANK;++e)for(var n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(var r=0;r<this.ELEMENTS;++r)t+=" ".concat(this[r])}return t+="]"}},{key:"getElementIndex",value:function(t,e){return e*this.RANK+t}},{key:"getElement",value:function(t,e){return this[e*this.RANK+t]}},{key:"setElement",value:function(t,e,n){return this[e*this.RANK+t]=$r(n),this}},{key:"getColumn",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0),n=t*this.RANK,r=0;r<this.RANK;++r)e[r]=this[n+r];return e}},{key:"setColumn",value:function(t,e){for(var n=t*this.RANK,r=0;r<this.RANK;++r)this[n+r]=e[r];return this}}]),n}(ii);function si(t,e,n){var r=e[0],i=e[1],o=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/o,t[1]=(n[1]*r+n[5]*i)/o,t}function ui(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o||1;return t[0]=(n[0]*r+n[4]*i+n[8]*o)/a,t[1]=(n[1]*r+n[5]*i+n[9]*o)/a,t[2]=(n[2]*r+n[6]*i+n[10]*o)/a,t}var ci="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function li(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],v=e[12],g=e[13],y=e[14],m=e[15],b=n[0],A=n[1],_=n[2],O=n[3];return t[0]=b*r+A*s+_*f+O*v,t[1]=b*i+A*u+_*h+O*g,t[2]=b*o+A*c+_*d+O*y,t[3]=b*a+A*l+_*p+O*m,b=n[4],A=n[5],_=n[6],O=n[7],t[4]=b*r+A*s+_*f+O*v,t[5]=b*i+A*u+_*h+O*g,t[6]=b*o+A*c+_*d+O*y,t[7]=b*a+A*l+_*p+O*m,b=n[8],A=n[9],_=n[10],O=n[11],t[8]=b*r+A*s+_*f+O*v,t[9]=b*i+A*u+_*h+O*g,t[10]=b*o+A*c+_*d+O*y,t[11]=b*a+A*l+_*p+O*m,b=n[12],A=n[13],_=n[14],O=n[15],t[12]=b*r+A*s+_*f+O*v,t[13]=b*i+A*u+_*h+O*g,t[14]=b*o+A*c+_*d+O*y,t[15]=b*a+A*l+_*p+O*m,t}function fi(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function hi(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,c,l),t}function di(t,e,n,r,i){var o,a=1/Math.tan(e/2);return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function pi(t,e,n,r){var i,o,a,s,u,c,l,f,h,d,p=e[0],v=e[1],g=e[2],y=r[0],m=r[1],b=r[2],A=n[0],_=n[1],O=n[2];return Math.abs(p-A)<1e-6&&Math.abs(v-_)<1e-6&&Math.abs(g-O)<1e-6?function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(t):(l=p-A,f=v-_,h=g-O,i=m*(h*=d=1/Math.hypot(l,f,h))-b*(f*=d),o=b*(l*=d)-y*h,a=y*f-m*l,(d=Math.hypot(i,o,a))?(i*=d=1/d,o*=d,a*=d):(i=0,o=0,a=0),s=f*a-h*o,u=h*i-l*a,c=l*o-f*i,(d=Math.hypot(s,u,c))?(s*=d=1/d,u*=d,c*=d):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=o,t[5]=u,t[6]=f,t[7]=0,t[8]=a,t[9]=c,t[10]=h,t[11]=0,t[12]=-(i*p+o*v+a*g),t[13]=-(s*p+u*v+c*g),t[14]=-(l*p+f*v+h*g),t[15]=1,t)}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function vi(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function gi(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var yi,mi;yi=new ci(2),ci!=Float32Array&&(yi[0]=0,yi[1]=0),mi=yi;function bi(){var t=new ci(3);return ci!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Ai(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function _i(t,e,n){var r=new ci(3);return r[0]=t,r[1]=e,r[2]=n,r}function Oi(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function wi(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function xi(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function Ci(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}var Pi=Ai;!function(){var t=bi()}();function Si(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function Bi(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function ki(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=n[3],l=c*r+s*o-u*i,f=c*i+u*r-a*o,h=c*o+a*i-s*r,d=-a*r-s*i-u*o;return t[0]=l*c+d*-a+f*-u-h*-s,t[1]=f*c+d*-s+h*-a-l*-u,t[2]=h*c+d*-u+l*-s-f*-a,t[3]=e[3],t}!function(){var t=function(){var t=new ci(4);return ci!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}();function Ei(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ir()(t);if(e){var i=Ir()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jr()(this,n)}}var Ti=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),ji=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Mi=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),Ii={},Ri=function(t){Er()(n,t);var e=Ei(n);function n(t){var r;return wr()(this,n),r=e.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?r.copy(t):r.identity(),r}return Cr()(n,[{key:"INDICES",get:function(){return Mi}},{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}},{key:"set",value:function(t,e,n,r,i,o,a,s,u,c,l,f,h,d,p,v){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=a,this[7]=s,this[8]=u,this[9]=c,this[10]=l,this[11]=f,this[12]=h,this[13]=d,this[14]=p,this[15]=v,this.check()}},{key:"setRowMajor",value:function(t,e,n,r,i,o,a,s,u,c,l,f,h,d,p,v){return this[0]=t,this[1]=i,this[2]=u,this[3]=h,this[4]=e,this[5]=o,this[6]=c,this[7]=d,this[8]=n,this[9]=a,this[10]=l,this[11]=p,this[12]=r,this[13]=s,this[14]=f,this[15]=v,this.check()}},{key:"toRowMajor",value:function(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}},{key:"identity",value:function(){return this.copy(Ti)}},{key:"fromQuaternion",value:function(t){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,d=i*s,p=i*u,v=o*a,g=o*s,y=o*u;t[0]=1-f-p,t[1]=l+y,t[2]=h-g,t[3]=0,t[4]=l-y,t[5]=1-c-p,t[6]=d+v,t[7]=0,t[8]=h+g,t[9]=d-v,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}},{key:"frustum",value:function(t){var e=t.left,r=t.right,i=t.bottom,o=t.top,a=t.near,s=t.far;return s===1/0?n._computeInfinitePerspectiveOffCenter(this,e,r,i,o,a):function(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0}(this,e,r,i,o,a,s),this.check()}},{key:"lookAt",value:function(t,e,n){if(1===arguments.length){var r=t;t=r.eye,e=r.center,n=r.up}return pi(this,t,e=e||[0,0,0],n=n||[0,1,0]),this.check()}},{key:"ortho",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,o=t.near,a=void 0===o?.1:o,s=t.far;return function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1}(this,e,n,r,i,a,void 0===s?500:s),this.check()}},{key:"orthographic",value:function(t){var e=t.fovy,r=void 0===e?45*Math.PI/180:e,i=t.aspect,o=void 0===i?1:i,a=t.focalDistance,s=void 0===a?1:a,u=t.near,c=void 0===u?.1:u,l=t.far,f=void 0===l?500:l;if(r>2*Math.PI)throw Error("radians");var h=r/2,d=s*Math.tan(h),p=d*o;return(new n).ortho({left:-p,right:p,bottom:-d,top:d,near:c,far:f})}},{key:"perspective",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fovy,n=void 0===e?void 0:e,r=t.fov,i=void 0===r?45*Math.PI/180:r,o=t.aspect,a=void 0===o?1:o,s=t.near,u=void 0===s?.1:s,c=t.far,l=void 0===c?500:c;if((n=n||i)>2*Math.PI)throw Error("radians");return di(this,n,a,u,l),this.check()}},{key:"determinant",value:function(){return e=(t=this)[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11],d=t[12],p=t[13],v=t[14],g=t[15],(e*a-n*o)*(f*g-h*v)-(e*s-r*o)*(l*g-h*p)+(e*u-i*o)*(l*v-f*p)+(n*s-r*a)*(c*g-h*d)-(n*u-i*a)*(c*v-f*d)+(r*u-i*s)*(c*p-l*d);var t,e,n,r,i,o,a,s,u,c,l,f,h,d,p,v,g}},{key:"getScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}},{key:"getTranslation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}},{key:"getRotation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{key:"getRotationMatrix3",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*o,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*o,t}},{key:"transpose",value:function(){return function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}},{key:"invert",value:function(){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],p=e[12],v=e[13],g=e[14],y=e[15],m=n*s-r*a,b=n*u-i*a,A=n*c-o*a,_=r*u-i*s,O=r*c-o*s,w=i*c-o*u,x=l*v-f*p,C=l*g-h*p,P=l*y-d*p,S=f*g-h*v,B=f*y-d*v,k=h*y-d*g,E=m*k-b*B+A*S+_*P-O*C+w*x;E&&(E=1/E,t[0]=(s*k-u*B+c*S)*E,t[1]=(i*B-r*k-o*S)*E,t[2]=(v*w-g*O+y*_)*E,t[3]=(h*O-f*w-d*_)*E,t[4]=(u*P-a*k-c*C)*E,t[5]=(n*k-i*P+o*C)*E,t[6]=(g*A-p*w-y*b)*E,t[7]=(l*w-h*A+d*b)*E,t[8]=(a*B-s*P+c*x)*E,t[9]=(r*P-n*B-o*x)*E,t[10]=(p*O-v*A+y*m)*E,t[11]=(f*A-l*O-d*m)*E,t[12]=(s*C-a*S-u*x)*E,t[13]=(n*S-r*C+i*x)*E,t[14]=(v*b-p*_-g*m)*E,t[15]=(l*_-f*b+h*m)*E)}(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return li(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return li(this,this,t),this.check()}},{key:"rotateX",value:function(t){return function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=s*i+f*r,t[7]=u*i+h*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-s*r,t[11]=h*i-u*r}(this,this,t),this.check()}},{key:"rotateY",value:function(t){return function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],l=e[9],f=e[10],h=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=s*i-f*r,t[3]=u*i-h*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=s*r+f*i,t[11]=u*r+h*i}(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=s*i+f*r,t[3]=u*i+h*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-s*r,t[7]=h*i-u*r}(this,this,t),this.check()}},{key:"rotateXYZ",value:function(t){var e=yr()(t,3),n=e[0],r=e[1],i=e[2];return this.rotateX(n).rotateY(r).rotateZ(i)}},{key:"rotateAxis",value:function(t,e){return function(t,e,n,r){var i,o,a,s,u,c,l,f,h,d,p,v,g,y,m,b,A,_,O,w,x,C,P,S,B=r[0],k=r[1],E=r[2],T=Math.hypot(B,k,E);T<1e-6||(B*=T=1/T,k*=T,E*=T,i=Math.sin(n),a=1-(o=Math.cos(n)),s=e[0],u=e[1],c=e[2],l=e[3],f=e[4],h=e[5],d=e[6],p=e[7],v=e[8],g=e[9],y=e[10],m=e[11],b=B*B*a+o,A=k*B*a+E*i,_=E*B*a-k*i,O=B*k*a-E*i,w=k*k*a+o,x=E*k*a+B*i,C=B*E*a+k*i,P=k*E*a-B*i,S=E*E*a+o,t[0]=s*b+f*A+v*_,t[1]=u*b+h*A+g*_,t[2]=c*b+d*A+y*_,t[3]=l*b+p*A+m*_,t[4]=s*O+f*w+v*x,t[5]=u*O+h*w+g*x,t[6]=c*O+d*w+y*x,t[7]=l*O+p*w+m*x,t[8]=s*C+f*P+v*S,t[9]=u*C+h*P+g*S,t[10]=c*C+d*P+y*S,t[11]=l*C+p*P+m*S,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?fi(this,this,t):fi(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return function(t,e,n){var r,i,o,a,s,u,c,l,f,h,d,p,v=n[0],g=n[1],y=n[2];e===t?(t[12]=e[0]*v+e[4]*g+e[8]*y+e[12],t[13]=e[1]*v+e[5]*g+e[9]*y+e[13],t[14]=e[2]*v+e[6]*g+e[10]*y+e[14],t[15]=e[3]*v+e[7]*g+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=d,t[11]=p,t[12]=r*v+s*g+f*y+e[12],t[13]=i*v+u*g+h*y+e[13],t[14]=o*v+c*g+d*y+e[14],t[15]=a*v+l*g+p*y+e[15])}(this,this,t),this.check()}},{key:"transform",value:function(t,e){return 4===t.length?(ti(e=function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}},{key:"transformAsPoint",value:function(t,e){switch(t.length){case 2:e=gi(e||[-0,-0],t,this);break;case 3:e=xi(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return ti(e,t.length),e}},{key:"transformAsVector",value:function(t,e){switch(t.length){case 2:e=si(e||[-0,-0],t,this);break;case 3:e=ui(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return ti(e,t.length),e}},{key:"makeRotationX",value:function(t){return this.identity().rotateX(t)}},{key:"makeTranslation",value:function(t,e,n){return this.identity().translate([t,e,n])}},{key:"transformPoint",value:function(t,e){return ni("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}},{key:"transformVector",value:function(t,e){return ni("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}},{key:"transformDirection",value:function(t,e){return ni("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}],[{key:"IDENTITY",get:function(){return Ii.IDENTITY=Ii.IDENTITY||Object.freeze(new n(Ti)),Ii.IDENTITY}},{key:"ZERO",get:function(){return Ii.ZERO=Ii.ZERO||Object.freeze(new n(ji)),Ii.ZERO}},{key:"_computeInfinitePerspectiveOffCenter",value:function(t,e,n,r,i,o){var a=2*o/(n-e),s=2*o/(i-r),u=(n+e)/(n-e),c=(i+r)/(i-r),l=-2*o;return t[0]=a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=u,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0,t}}]),n}(ai);function Di(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ir()(t);if(e){var i=Ir()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jr()(this,n)}}var Li=function(t){Er()(n,t);var e=Di(n);function n(){return wr()(this,n),e.apply(this,arguments)}return Cr()(n,[{key:"ELEMENTS",get:function(){return Gr(!1),0}},{key:"copy",value:function(t){return Gr(!1),this}},{key:"x",get:function(){return this[0]},set:function(t){this[0]=$r(t)}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=$r(t)}},{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n){var r=this[n]-t[n];e+=r*r}return $r(e)}},{key:"dot",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return $r(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0;a<this.ELEMENTS;++a)this[a]*=o[a];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var o=i[r],a=0;a<this.ELEMENTS;++a)this[a]/=o[a];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return Gr(t>=0&&t<this.ELEMENTS,"index is out of range"),$r(this[t])}},{key:"setComponent",value:function(t,e){return Gr(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}]),n}(ii);function Fi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ir()(t);if(e){var i=Ir()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jr()(this,n)}}var Gi=[0,0,0],Ni={},Ui=function(t){Er()(n,t);var e=Fi(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return wr()(this,n),t=e.call(this,-0,-0,-0),1===arguments.length&&Jr(r)?t.copy(r):(zr.debug&&($r(r),$r(i),$r(o)),t[0]=r,t[1]=i,t[2]=o),t}return Cr()(n,[{key:"set",value:function(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}},{key:"fromObject",value:function(t){return zr.debug&&($r(t.x),$r(t.y),$r(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=$r(t)}},{key:"angle",value:function(t){return n=t,r=(e=this)[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=Math.sqrt(r*r+i*i+o*o)*Math.sqrt(a*a+s*s+u*u),l=c&&Oi(e,n)/c,Math.acos(Math.min(Math.max(l,-1),1));var e,n,r,i,o,a,s,u,c,l}},{key:"cross",value:function(t){return wi(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,n=t.origin;return function(t,e,n,r){var i=[],o=[];i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,void 0===n?Gi:n,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,n=t.origin;return function(t,e,n,r){var i=[],o=[];i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,void 0===n?Gi:n,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,n=t.origin;return function(t,e,n,r){var i=[],o=[];i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,void 0===n?Gi:n,e),this.check()}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return xi(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return ui(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return Ci(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){return function(t,e,n){var r=e[0],i=e[1];t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2]}(this,this,t),this.check()}},{key:"transformByQuaternion",value:function(t){return function(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],l=i*c-o*u,f=o*s-r*c,h=r*u-i*s,d=i*h-o*f,p=o*l-r*h,v=r*f-i*l,g=2*a;l*=g,f*=g,h*=g,d*=2,p*=2,v*=2,t[0]=s+l+d,t[1]=u+f+p,t[2]=c+h+v}(this,this,t),this.check()}}],[{key:"ZERO",get:function(){return Ni.ZERO=Ni.ZERO||Object.freeze(new n(0,0,0,0))}}]),n}(Li),zi=.1,Hi=1e-12,Vi=1e-15,Ji=(Math.PI,Math.PI,Math.PI,Math.PI,Math.max(6378137,6378137,6356752.314245179),function(t){return t}),Wi=new Ui;function Ki(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ji;return Jr(t)?(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]):"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z),e}function Xi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wi;return Ki(t,e,zr._cartographicRadians?Ji:Kr)}function qi(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ji;return Jr(e)?(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]):"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]),e}function Qi(t,e){return qi(t,e,zr._cartographicRadians?Ji:Xr)}var Zi=new Ui,Yi=new Ui,$i=new Ui;var to=new Ui,eo={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},no={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},ro={east:new Ui,north:new Ui,up:new Ui,west:new Ui,south:new Ui,down:new Ui},io=new Ui,oo=new Ui,ao=new Ui;function so(t,e,n,r,i,o){var a,s,u,c=eo[e]&&eo[e][n];Gr(c&&(!r||r===c));var l=to.copy(i);if(Zr(l.x,0,1e-14)&&Zr(l.y,0,1e-14)){var f=Math.sign(l.z);a=io.fromArray(no[e]),"east"!==e&&"west"!==e&&a.scale(f),s=oo.fromArray(no[n]),"east"!==n&&"west"!==n&&s.scale(f),u=ao.fromArray(no[r]),"east"!==r&&"west"!==r&&u.scale(f)}else{var h=ro.up,d=ro.east,p=ro.north;d.set(-l.y,l.x,0).normalize(),t.geodeticSurfaceNormal(l,h),p.copy(h).cross(d);var v=ro.west,g=ro.south;ro.down.copy(h).scale(-1),v.copy(d).scale(-1),g.copy(p).scale(-1),a=ro[e],s=ro[n],u=ro[r]}return o[0]=a.x,o[1]=a.y,o[2]=a.z,o[3]=0,o[4]=s.x,o[5]=s.y,o[6]=s.z,o[7]=0,o[8]=u.x,o[9]=u.y,o[10]=u.z,o[11]=0,o[12]=l.x,o[13]=l.y,o[14]=l.z,o[15]=1,o}var uo,co=new Ui,lo=new Ui,fo=new Ui,ho=new Ui,po=new Ui,vo=new Ui,go=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;wr()(this,t),Gr(e>=0),Gr(n>=0),Gr(r>=0),this.radii=new Ui(e,n,r),this.radiiSquared=new Ui(e*e,n*n,r*r),this.radiiToTheFourth=new Ui(e*e*e*e,n*n*n*n,r*r*r*r),this.oneOverRadii=new Ui(0===e?0:1/e,0===n?0:1/n,0===r?0:1/r),this.oneOverRadiiSquared=new Ui(0===e?0:1/(e*e),0===n?0:1/(n*n),0===r?0:1/(r*r)),this.minimumRadius=Math.min(e,n,r),this.maximumRadius=Math.max(e,n,r),this.centerToleranceSquared=zi,0!==this.radiiSquared.z&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}return Cr()(t,[{key:"equals",value:function(t){return this===t||Boolean(t&&this.radii.equals(t.radii))}},{key:"toString",value:function(){return this.radii.toString()}},{key:"cartographicToCartesian",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=lo,r=fo,i=yr()(t,3),o=i[2];this.geodeticSurfaceNormalCartographic(t,n),r.copy(this.radiiSquared).scale(n);var a=Math.sqrt(n.dot(r));return r.scale(1/a),n.scale(o),r.add(n),r.to(e)}},{key:"cartesianToCartographic",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];vo.from(t);var n=this.scaleToGeodeticSurface(vo,ho);if(n){var r=this.geodeticSurfaceNormal(n,lo),i=po;i.copy(vo).subtract(n);var o=Math.atan2(r.y,r.x),a=Math.asin(r.z),s=Math.sign(Oi(i,vo))*Ai(i);return Qi([o,a,s],e)}}},{key:"eastNorthUpToFixedFrame",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ri;return so(this,"east","north","up",t,e)}},{key:"localFrameToFixedFrame",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Ri;return so(this,t,e,n,r,i)}},{key:"geocentricSurfaceNormal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return co.from(t).normalize().to(e)}},{key:"geodeticSurfaceNormalCartographic",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=Xi(t),r=n[0],i=n[1],o=Math.cos(i);return co.set(o*Math.cos(r),o*Math.sin(r),Math.sin(i)).normalize(),co.to(e)}},{key:"geodeticSurfaceNormal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return co.from(t).scale(this.oneOverRadiiSquared).normalize().to(e)}},{key:"scaleToGeodeticSurface",value:function(t,e){return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ui,r=e.oneOverRadii,i=e.oneOverRadiiSquared,o=e.centerToleranceSquared;Zi.from(t);var a=t.x,s=t.y,u=t.z,c=r.x,l=r.y,f=r.z,h=a*a*c*c,d=s*s*l*l,p=u*u*f*f,v=h+d+p,g=Math.sqrt(1/v);if(Number.isFinite(g)){var y=Yi;if(y.copy(t).scale(g),v<o)return y.to(n);var m=i.x,b=i.y,A=i.z,_=$i;_.set(y.x*m*2,y.y*b*2,y.z*A*2);var O,w,x,C,P=(1-g)*t.len()/(.5*_.len()),S=0;do{var B=(O=1/(1+(P-=S)*m))*O,k=(w=1/(1+P*b))*w,E=(x=1/(1+P*A))*x,T=B*O,j=k*w,M=E*x,I=h*T*m+d*j*b+p*M*A,R=-2*I;S=(C=h*B+d*k+p*E-1)/R}while(Math.abs(C)>Hi);return Zi.scale([O,w,x]).to(n)}}(t,this,e)}},{key:"scaleToGeocentricSurface",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];ho.from(t);var n=ho.x,r=ho.y,i=ho.z,o=this.oneOverRadiiSquared,a=1/Math.sqrt(n*n*o.x+r*r*o.y+i*i*o.z);return ho.multiplyScalar(a).to(e)}},{key:"transformPositionToScaledSpace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ho.from(t).scale(this.oneOverRadii).to(e)}},{key:"transformPositionFromScaledSpace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ho.from(t).scale(this.radii).to(e)}},{key:"getSurfaceNormalIntersectionWithZAxis",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0];Gr(Zr(this.radii.x,this.radii.y,Vi)),Gr(this.radii.z>0),ho.from(t);var r=ho.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(r)>=this.radii.z-e))return ho.set(0,0,r).to(n)}}],[{key:"WGS84",get:function(){return uo=uo||new t(6378137,6378137,6356752.314245179)}}]),t}(),yo=n(195),mo=n(122),bo=n(30),Ao=n(231),_o=function t(e,n,r){wr()(this,t),Object(Br.a)(this,"item",void 0),Object(Br.a)(this,"previous",void 0),Object(Br.a)(this,"next",void 0),this.item=e,this.previous=n,this.next=r},Oo=function(){function t(){wr()(this,t),Object(Br.a)(this,"head",null),Object(Br.a)(this,"tail",null),Object(Br.a)(this,"_length",0)}return Cr()(t,[{key:"length",get:function(){return this._length}},{key:"add",value:function(t){var e=new _o(t,this.tail,null);return this.tail?(this.tail.next=e,this.tail=e):(this.head=e,this.tail=e),++this._length,e}},{key:"remove",value:function(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)}},{key:"splice",value:function(t,e){t!==e&&(this.remove(e),this._insert(t,e))}},{key:"_insert",value:function(t,e){var n=t.next;t.next=e,this.tail===t?this.tail=e:n.previous=e,e.next=n,e.previous=t,++this._length}}]),t}();function wo(t){return null!=t}var xo=function(){function t(){wr()(this,t),Object(Br.a)(this,"_list",void 0),Object(Br.a)(this,"_sentinel",void 0),Object(Br.a)(this,"_trimTiles",void 0),this._list=new Oo,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}return Cr()(t,[{key:"reset",value:function(){this._list.splice(this._list.tail,this._sentinel)}},{key:"touch",value:function(t){var e=t._cacheNode;wo(e)&&this._list.splice(this._sentinel,e)}},{key:"add",value:function(t,e,n){wo(e._cacheNode)||(e._cacheNode=this._list.add(e),n&&n(t,e))}},{key:"unloadTile",value:function(t,e,n){var r=e._cacheNode;wo(r)&&(this._list.remove(r),e._cacheNode=void 0,n&&n(t,e))}},{key:"unloadTiles",value:function(t,e){var n=this._trimTiles;this._trimTiles=!1;for(var r=this._list,i=1024*t.maximumMemoryUsage*1024,o=this._sentinel,a=r.head;a!==o&&(t.gpuMemoryUsageInBytes>i||n);){var s=a.item;a=a.next,this.unloadTile(t,s,e)}}},{key:"trim",value:function(){this._trimTiles=!0}}]),t}();var Co=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1}),Po=(new Ui,new Ui,new Ui),So=new Ui,Bo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;wr()(this,t),this.radius=-0,this.center=new Ui,this.fromCenterRadius(e,n)}return Cr()(t,[{key:"fromCenterRadius",value:function(t,e){return this.center.from(t),this.radius=e,this}},{key:"fromCornerPoints",value:function(t,e){return e=Po.from(e),this.center=(new Ui).from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}},{key:"clone",value:function(){return new t(this.center,this.radius)}},{key:"union",value:function(t){var e=this.center,n=this.radius,r=t.center,i=t.radius,o=Po.copy(r).subtract(e),a=o.magnitude();if(n>=a+i)return this.clone();if(i>=a+n)return t.clone();var s=.5*(n+a+i);return So.copy(o).scale((-n+s)/a).add(e),this.center.copy(So),this.radius=s,this}},{key:"expand",value:function(t){var e=(t=Po.from(t)).subtract(this.center).magnitude();return e>this.radius&&(this.radius=e),this}},{key:"transform",value:function(t){this.center.transform(t);var e=hi(Po,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}},{key:"distanceSquaredTo",value:function(t){return(t=Po.from(t)).subtract(this.center).lengthSquared()-this.radius*this.radius}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"intersectPlane",value:function(t){var e=this.center,n=this.radius,r=t.normal.dot(e)+t.distance;return r<-n?Co.OUTSIDE:r<n?Co.INTERSECTING:Co.INSIDE}}]),t}();function ko(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=n[0],d=n[1],p=n[2],v=n[3],g=n[4],y=n[5],m=n[6],b=n[7],A=n[8];return t[0]=h*r+d*a+p*c,t[1]=h*i+d*s+p*l,t[2]=h*o+d*u+p*f,t[3]=v*r+g*a+y*c,t[4]=v*i+g*s+y*l,t[5]=v*o+g*u+y*f,t[6]=m*r+b*a+A*c,t[7]=m*i+b*s+A*l,t[8]=m*o+b*u+A*f,t}function Eo(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function To(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ir()(t);if(e){var i=Ir()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jr()(this,n)}}var jo=Object.freeze([1,0,0,0,1,0,0,0,1]),Mo=Object.freeze([0,0,0,0,0,0,0,0,0]),Io=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),Ro={},Do=function(t){Er()(n,t);var e=To(n);function n(t){var r;return wr()(this,n),r=e.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?r.copy(t):r.identity(),r}return Cr()(n,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return Io}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}},{key:"set",value:function(t,e,n,r,i,o,a,s,u){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=a,this[7]=s,this[8]=u,this.check()}},{key:"setRowMajor",value:function(t,e,n,r,i,o,a,s,u){return this[0]=t,this[1]=r,this[2]=a,this[3]=e,this[4]=i,this[5]=s,this[6]=n,this[7]=o,this[8]=u,this.check()}},{key:"determinant",value:function(){return e=(t=this)[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],e*(c*o-a*u)+n*(-c*i+a*s)+r*(u*i-o*s);var t,e,n,r,i,o,a,s,u,c}},{key:"identity",value:function(){return this.copy(jo)}},{key:"fromQuaternion",value:function(t){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,l=r*a,f=r*s,h=i*a,d=i*s,p=i*u,v=o*a,g=o*s,y=o*u;t[0]=1-f-p,t[3]=l-y,t[6]=h+g,t[1]=l+y,t[4]=1-c-p,t[7]=d-v,t[2]=h-g,t[5]=d+v,t[8]=1-c-f}(this,t),this.check()}},{key:"transpose",value:function(){return function(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8]}(this,this),this.check()}},{key:"invert",value:function(){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=l*a-s*c,h=-l*o+s*u,d=c*o-a*u,p=n*f+r*h+i*d;p&&(p=1/p,t[0]=f*p,t[1]=(-l*r+i*c)*p,t[2]=(s*r-i*a)*p,t[3]=h*p,t[4]=(l*n-i*u)*p,t[5]=(-s*n+i*o)*p,t[6]=d*p,t[7]=(-c*n+r*u)*p,t[8]=(a*n-r*o)*p)}(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return ko(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return ko(this,this,t),this.check()}},{key:"rotate",value:function(t){return function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=Math.sin(n),d=Math.cos(n);t[0]=d*r+h*a,t[1]=d*i+h*s,t[2]=d*o+h*u,t[3]=d*a-h*r,t[4]=d*s-h*i,t[5]=d*u-h*o,t[6]=c,t[7]=l,t[8]=f}(this,this,t),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?Eo(this,this,t):Eo(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return function(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=n[0],d=n[1];t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=h*r+d*a+c,t[7]=h*i+d*s+l,t[8]=h*o+d*u+f}(this,this,t),this.check()}},{key:"transform",value:function(t,e){switch(t.length){case 2:e=vi(e||[-0,-0],t,this);break;case 3:e=Ci(e||[-0,-0,-0],t,this);break;case 4:e=function(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*o,t[1]=n[1]*r+n[4]*i+n[7]*o,t[2]=n[2]*r+n[5]*i+n[8]*o,t[3]=e[3],t}(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return ti(e,t.length),e}},{key:"transformVector",value:function(t,e){return ni("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector2",value:function(t,e){return ni("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector3",value:function(t,e){return ni("Matrix3.transformVector"),this.transform(t,e)}}],[{key:"IDENTITY",get:function(){return Ro.IDENTITY=Ro.IDENTITY||Object.freeze(new n(jo)),Ro.IDENTITY}},{key:"ZERO",get:function(){return Ro.ZERO=Ro.ZERO||Object.freeze(new n(Mo)),Ro.ZERO}}]),n}(ai);function Lo(){var t=new ci(4);return ci!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Fo(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Go(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+a*s+i*c-o*u,t[1]=i*l+a*u+o*s-r*c,t[2]=o*l+a*c+r*u-i*s,t[3]=a*l-r*s-i*u-o*c,t}function No(t,e,n,r){var i,o,a,s,u,c=e[0],l=e[1],f=e[2],h=e[3],d=n[0],p=n[1],v=n[2],g=n[3];return(o=c*d+l*p+f*v+h*g)<0&&(o=-o,d=-d,p=-p,v=-v,g=-g),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),t[0]=s*c+u*d,t[1]=s*l+u*p,t[2]=s*f+u*v,t[3]=s*h+u*g,t}function Uo(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t}var zo,Ho,Vo,Jo,Wo,Ko,Xo=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},qo=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},Qo=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},Zo=function(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t},Yo=Si,$o=Bi,ta=function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a,t},ea=(zo=bi(),Ho=_i(1,0,0),Vo=_i(0,1,0),function(t,e,n){var r=Oi(e,n);return r<-.999999?(wi(zo,Ho,e),Pi(zo)<1e-6&&wi(zo,Vo,e),function(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o}(zo,zo),Fo(t,zo,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(wi(zo,e,n),t[0]=zo[0],t[1]=zo[1],t[2]=zo[2],t[3]=1+r,ta(t,t))});Jo=Lo(),Wo=Lo(),Ko=function(){var t=new ci(9);return ci!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}();function na(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ir()(t);if(e){var i=Ir()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jr()(this,n)}}var ra=[0,0,0,1],ia=function(t){Er()(n,t);var e=na(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return wr()(this,n),t=e.call(this,-0,-0,-0,-0),Array.isArray(r)&&1===arguments.length?t.copy(r):t.set(r,i,o,a),t}return Cr()(n,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}},{key:"set",value:function(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}},{key:"fromMatrix3",value:function(t){return Uo(this,t),this.check()}},{key:"identity",value:function(){return function(t){t[0]=0,t[1]=0,t[2]=0,t[3]=1}(this),this.check()}},{key:"fromAxisRotation",value:function(t,e){return Fo(this,t,e),this.check()}},{key:"setAxisAngle",value:function(t,e){return this.fromAxisRotation(t,e)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(t){this[0]=$r(t)}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=$r(t)}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=$r(t)}},{key:"w",get:function(){return this[3]},set:function(t){this[3]=$r(t)}},{key:"len",value:function(){return Yo(this)}},{key:"lengthSquared",value:function(){return $o(this)}},{key:"dot",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return Qo(this,t)}},{key:"rotationTo",value:function(t,e){return ea(this,t,e),this.check()}},{key:"add",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return Xo(this,this,t),this.check()}},{key:"calculateW",value:function(){return function(t,e){var n=e[0],r=e[1],i=e[2];t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i))}(this,this),this.check()}},{key:"conjugate",value:function(){return function(t,e){t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3]}(this,this),this.check()}},{key:"invert",value:function(){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s}(this,this),this.check()}},{key:"lerp",value:function(t,e,n){return Zo(this,t,e,n),this.check()}},{key:"multiplyRight",value:function(t,e){return Gr(!e),Go(this,this,t),this.check()}},{key:"multiplyLeft",value:function(t,e){return Gr(!e),Go(this,t,this),this.check()}},{key:"normalize",value:function(){var t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}},{key:"rotateX",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-r*s}(this,this,t),this.check()}},{key:"rotateY",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);t[0]=r*u-o*s,t[1]=i*u+a*s,t[2]=o*u+r*s,t[3]=a*u-i*s}(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=o*u+a*s,t[3]=a*u-o*s}(this,this,t),this.check()}},{key:"scale",value:function(t){return qo(this,this,t),this.check()}},{key:"slerp",value:function(t,e,n){switch(arguments.length){case 1:var r=arguments[0],i=r.start;t=void 0===i?ra:i,e=r.target,n=r.ratio;break;case 2:var o=Array.prototype.slice.call(arguments);e=o[0],n=o[1],t=this}return No(this,t,e,n),this.check()}},{key:"transformVector4",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return ki(e,t,this),ti(e,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(t,e){return this.setAxisAngle(t,e)}},{key:"premultiply",value:function(t,e){return this.multiplyLeft(t,e)}},{key:"multiply",value:function(t,e){return this.multiplyRight(t,e)}}]),n}(ii),oa=new Ui,aa=new Ui,sa=new Ui,ua=new Ui,ca=new Ui,la=new Ui,fa=new Ui,ha=0,da=1,pa=2,va=3,ga=4,ya=5,ma=6,ba=7,Aa=8,_a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0,0,0,0,0,0];wr()(this,t),this.center=(new Ui).from(e),this.halfAxes=new Do(n)}return Cr()(t,[{key:"halfSize",get:function(){var t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new Ui(t).len(),new Ui(e).len(),new Ui(n).len()]}},{key:"quaternion",get:function(){var t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new Ui(t).normalize(),i=new Ui(e).normalize(),o=new Ui(n).normalize();return(new ia).fromMatrix3(new Do([].concat(Fr()(r),Fr()(i),Fr()(o))))}},{key:"fromCenterHalfSizeQuaternion",value:function(t,e,n){var r=new ia(n),i=(new Do).fromQuaternion(r);return i[0]=i[0]*e[0],i[1]=i[1]*e[0],i[2]=i[2]*e[0],i[3]=i[3]*e[1],i[4]=i[4]*e[1],i[5]=i[5]*e[1],i[6]=i[6]*e[2],i[7]=i[7]*e[2],i[8]=i[8]*e[2],this.center=(new Ui).from(t),this.halfAxes=i,this}},{key:"clone",value:function(){return new t(this.center,this.halfAxes)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}},{key:"getBoundingSphere",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Bo,e=this.halfAxes,n=e.getColumn(0,sa),r=e.getColumn(1,ua),i=e.getColumn(2,ca),o=oa.copy(n).add(r).add(i);return t.center.copy(this.center),t.radius=o.magnitude(),t}},{key:"intersectPlane",value:function(t){var e=this.center,n=t.normal,r=this.halfAxes,i=n.x,o=n.y,a=n.z,s=Math.abs(i*r[ha]+o*r[da]+a*r[pa])+Math.abs(i*r[va]+o*r[ga]+a*r[ya])+Math.abs(i*r[ma]+o*r[ba]+a*r[Aa]),u=n.dot(e)+t.distance;return u<=-s?Co.OUTSIDE:u>=s?Co.INSIDE:Co.INTERSECTING}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var e=aa.from(t).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,sa),i=n.getColumn(1,ua),o=n.getColumn(2,ca),a=r.magnitude(),s=i.magnitude(),u=o.magnitude();r.normalize(),i.normalize(),o.normalize();var c,l=0;return(c=Math.abs(e.dot(r))-a)>0&&(l+=c*c),(c=Math.abs(e.dot(i))-s)>0&&(l+=c*c),(c=Math.abs(e.dot(o))-u)>0&&(l+=c*c),l}},{key:"computePlaneDistances",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-0,-0],r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,o=this.center,a=this.halfAxes,s=a.getColumn(0,sa),u=a.getColumn(1,ua),c=a.getColumn(2,ca),l=la.copy(s).add(u).add(c).add(o),f=fa.copy(l).subtract(t),h=e.dot(f);return r=Math.min(h,r),i=Math.max(h,i),l.copy(o).add(s).add(u).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),l.copy(o).add(s).subtract(u).add(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),l.copy(o).add(s).subtract(u).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),o.copy(l).subtract(s).add(u).add(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),o.copy(l).subtract(s).add(u).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),o.copy(l).subtract(s).subtract(u).add(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),o.copy(l).subtract(s).subtract(u).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),n[0]=r,n[1]=i,n}},{key:"transform",value:function(t){this.center.transformAsPoint(t);var e=this.halfAxes.getColumn(0,sa);e.transformAsPoint(t);var n=this.halfAxes.getColumn(1,ua);n.transformAsPoint(t);var r=this.halfAxes.getColumn(2,ca);return r.transformAsPoint(t),this.halfAxes=new Do([].concat(Fr()(e),Fr()(n),Fr()(r))),this}},{key:"getTransform",value:function(){throw new Error("not implemented")}}]),t}(),Oa=new Ui,wa=new Ui,xa=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,1],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;wr()(this,t),this.normal=new Ui,this.distance=-0,this.fromNormalDistance(e,n)}return Cr()(t,[{key:"fromNormalDistance",value:function(t,e){return Gr(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}},{key:"fromPointNormal",value:function(t,e){t=Oa.from(t),this.normal.from(e).normalize();var n=-this.normal.dot(t);return this.distance=n,this}},{key:"fromCoefficients",value:function(t,e,n,r){return this.normal.set(t,e,n),Gr(Zr(this.normal.len(),1)),this.distance=r,this}},{key:"clone",value:function(e){return new t(this.normal,this.distance)}},{key:"equals",value:function(t){return Zr(this.distance,t.distance)&&Zr(this.normal,t.normal)}},{key:"getPointDistance",value:function(t){return this.normal.dot(t)+this.distance}},{key:"transform",value:function(t){var e=wa.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}},{key:"projectPointOntoPlane",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];t=Oa.from(t);var n=this.getPointDistance(t),r=wa.copy(this.normal).scale(n);return t.subtract(r).to(e)}}]),t}();function Ca(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Pa(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pa(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Pa(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Sa=[new Ui([1,0,0]),new Ui([0,1,0]),new Ui([0,0,1])],Ba=new Ui,ka=new Ui,Ea=(new xa(new Ui(1,0,0),0),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];wr()(this,t),this.planes=e,Gr(this.planes.every((function(t){return t instanceof xa})))}return Cr()(t,[{key:"fromBoundingSphere",value:function(t){this.planes.length=2*Sa.length;var e,n=t.center,r=t.radius,i=0,o=Ca(Sa);try{for(o.s();!(e=o.n()).done;){var a=e.value,s=this.planes[i],u=this.planes[i+1];s||(s=this.planes[i]=new xa),u||(u=this.planes[i+1]=new xa);var c=Ba.copy(a).scale(-r).add(n);a.dot(c);s.fromPointNormal(c,a);var l=Ba.copy(a).scale(r).add(n),f=ka.copy(a).negate();f.dot(l);u.fromPointNormal(l,f),i+=2}}catch(t){o.e(t)}finally{o.f()}return this}},{key:"computeVisibility",value:function(t){Gr(t);var e,n=Co.INSIDE,r=Ca(this.planes);try{for(r.s();!(e=r.n()).done;){var i=e.value;switch(t.intersectPlane(i)){case Co.OUTSIDE:return Co.OUTSIDE;case Co.INTERSECTING:n=Co.INTERSECTING}}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"computeVisibilityWithPlaneMask",value:function(e,n){if(Gr(e,"boundingVolume is required."),Gr(Number.isFinite(n),"parentPlaneMask is required."),n===t.MASK_OUTSIDE||n===t.MASK_INSIDE)return n;for(var r=t.MASK_INSIDE,i=this.planes,o=0;o<this.planes.length;++o){var a=o<31?1<<o:0;if(!(o<31&&0==(n&a))){var s=i[o],u=e.intersectPlane(s);if(u===Co.OUTSIDE)return t.MASK_OUTSIDE;u===Co.INTERSECTING&&(r|=a)}}return r}}],[{key:"MASK_OUTSIDE",get:function(){return 4294967295}},{key:"MASK_INSIDE",get:function(){return 0}},{key:"MASK_INDETERMINATE",get:function(){return 2147483647}}]),t}());new Ui,new Ui,new Ui,new Ui,new Ui;new Ui,new Ui,new Ui,new Ui,new Ui,new Ui,new Ui,new Ui,new Ui,new Ui,new Ui,new Ui,Math.PI;new Do,new Do,new Do,new Do,new Do;new Ui,new Ui,new Ui,new Ui,new Ui,new Do,new Do,new Do;function Ta(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ja(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ja(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ja(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ma=new Ui,Ia=new Ui,Ra=new Ea([new xa,new xa,new xa,new xa,new xa,new xa]);function Da(t,e){var n=t.cameraDirection,r=t.cameraUp,i=t.height,o=t.distanceScales.metersPerUnit,a=Fa(t,t.center),s=go.WGS84.eastNorthUpToFixedFrame(a),u=t.unprojectPosition(t.cameraPosition),c=go.WGS84.cartographicToCartesian(u,new Ui),l=new Ui(s.transformAsVector(new Ui(n).scale(o))).normalize(),f=new Ui(s.transformAsVector(new Ui(r).scale(o))).normalize();return function(t){var e=t.getFrustumPlanes(),n=La(e.near,t.cameraPosition),r=Fa(t,n),i=Fa(t,t.cameraPosition,Ia),o=0;for(var a in Ra.planes[o++].fromPointNormal(r,Ma.copy(r).subtract(i)),e)if("near"!==a){var s=La(e[a],n,Ia),u=Fa(t,s,Ia);Ra.planes[o++].fromPointNormal(u,Ma.copy(r).subtract(u))}}(t),{camera:{position:c,direction:l,up:f},viewport:t,topDownViewport:new(0,t.constructor)({longitude:t.longitude,latitude:t.latitude,height:i,width:t.width,bearing:t.bearing,zoom:t.zoom,pitch:0}),height:i,cullingVolume:Ra,frameNumber:e,sseDenominator:1.15}}function La(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ui,r=t.normal.dot(e);return n.copy(t.normal).scale(t.distance-r).add(e),n}function Fa(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ui,r=t.unprojectPosition(e);return go.WGS84.cartographicToCartesian(r,n)}var Ga=new Ui;function Na(t,e){if(t instanceof _a){var n=function(t){t.getColumn(0,Ga);var e=t.getColumn(1),n=t.getColumn(2);return Ga.add(e).add(n).len()}(t.halfAxes);return Math.log2(6356752.314245179/(n+e[2]))}if(t instanceof Bo){var r=t.radius;return Math.log2(6356752.314245179/(r+e[2]))}if(t.width&&t.height){var i=t.width,o=t.height;return(Math.log2(6378137/i)+Math.log2(6378137/o))/2}return 1}function Ua(t,e,n){var r=go.WGS84.cartographicToCartesian([t.xmax,t.ymax,t.zmax],new Ui),i=Math.sqrt(Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2)+Math.pow(r[2]-n[2],2));return Math.log2(6356752.314245179/(i+e[2]))}var za=0,Ha=1,Va=3,Ja=4,Wa=5,Ka=1,Xa=2,qa="empty",Qa="scenegraph",Za="pointcloud",Ya="mesh",$a="I3S",ts="TILES3D",es="geometricError",ns=1;function rs(t){return null!=t}var is=new Ui,os=new Ui,as=new Ui;function ss(t,e,n){if(Object(mo.a)(t,"3D Tile: boundingVolume must be defined"),t.box)return function(t,e,n){var r=new Ui(t[0],t[1],t[2]);e.transform(r,r);var i=[];if(10===t.length){var o=t.slice(3,6),a=new ia;a.fromArray(t,6);var s=new Ui([1,0,0]),u=new Ui([0,1,0]),c=new Ui([0,0,1]);s.transformByQuaternion(a),s.scale(o[0]),u.transformByQuaternion(a),u.scale(o[1]),c.transformByQuaternion(a),c.scale(o[2]),i=[].concat(Fr()(s.toArray()),Fr()(u.toArray()),Fr()(c.toArray()))}else i=[].concat(Fr()(t.slice(3,6)),Fr()(t.slice(6,9)),Fr()(t.slice(9,12)));var l=e.transformAsVector(i.slice(0,3)),f=e.transformAsVector(i.slice(3,6)),h=e.transformAsVector(i.slice(6,9)),d=new Do([l[0],l[1],l[2],f[0],f[1],f[2],h[0],h[1],h[2]]);if(rs(n))return n.center=r,n.halfAxes=d,n;return new _a(r,d)}(t.box,e,n);if(t.region){var r=yr()(t.region,6),i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],c=r[5],l=go.WGS84.cartographicToCartesian([qr(i),qr(s),u],os),f=go.WGS84.cartographicToCartesian([qr(a),qr(o),c],as),h=(new Ui).addVectors(l,f).multiplyScalar(.5),d=(new Ui).subVectors(l,f).len()/2;return us([h[0],h[1],h[2],d],new Ri)}if(t.sphere)return us(t.sphere,e,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function us(t,e,n){var r=new Ui(t[0],t[1],t[2]);e.transform(r,r);var i=e.getScale(is),o=Math.max(Math.max(i[0],i[1]),i[2]),a=t[3]*o;return rs(n)?(n.center=r,n.radius=a,n):new Bo(r,a)}new Ui,new Ui,new Ri,new Ui,new Ui,new Ui;function cs(t,e){if(t.dynamicScreenSpaceError&&t.dynamicScreenSpaceErrorComputedDensity){var n=t.dynamicScreenSpaceErrorComputedDensity,r=t.dynamicScreenSpaceErrorFactor;return function(t,e){var n=t*e;return 1-Math.exp(-n*n)}(e,n)*r}return 0}var ls=new Ui,fs=new Ui,hs=new Ui,ds=new Ui,ps=new Ui,vs=new Ri,gs=new Ri;function ys(t,e){var n=e.topDownViewport,r=t.header.mbs[1],i=t.header.mbs[0],o=t.header.mbs[2],a=t.header.mbs[3],s=Fr()(t.boundingVolume.center),u=n.unprojectPosition(n.cameraPosition);go.WGS84.cartographicToCartesian(u,ls),fs.copy(ls).subtract(s).normalize(),go.WGS84.eastNorthUpToFixedFrame(s,vs),gs.copy(vs).invert(),hs.copy(ls).transform(gs);var c=Math.sqrt(hs[0]*hs[0]+hs[1]*hs[1]),l=c*c/hs[2];ds.copy([hs[0],hs[1],l]);var f=ds.transform(vs).subtract(s).normalize(),h=fs.cross(f).normalize().scale(a).add(s),d=go.WGS84.cartesianToCartographic(h),p=n.project([i,r,o]),v=n.project(d);return ps.copy(p).subtract(v).magnitude()}var ms=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;wr()(this,t),Object(Br.a)(this,"_map",new Map),Object(Br.a)(this,"_array",void 0),Object(Br.a)(this,"_length",void 0),this._array=new Array(e),this._length=e}return Cr()(t,[{key:"length",get:function(){return this._length},set:function(t){this._length=t,t>this._array.length&&(this._array.length=t)}},{key:"values",get:function(){return this._array}},{key:"get",value:function(t){return Object(mo.a)(t<this._array.length),this._array[t]}},{key:"set",value:function(t,e){Object(mo.a)(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=e,this._map.set(e,t)}},{key:"delete",value:function(t){var e=this._map.get(t);e>=0&&(this._array.splice(e,1),this._map.delete(t),this.length--)}},{key:"peek",value:function(){return this._array[this._length-1]}},{key:"push",value:function(t){if(!this._map.has(t)){var e=this.length++;this._array[e]=t,this._map.set(t,e)}}},{key:"pop",value:function(){var t=this._array[--this.length];return this._map.delete(t),t}},{key:"reserve",value:function(t){Object(mo.a)(t>=0),t>this._array.length&&(this._array.length=t)}},{key:"resize",value:function(t){Object(mo.a)(t>=0),this.length=t}},{key:"trim",value:function(t){null==t&&(t=this.length),this._array.length=t}},{key:"reset",value:function(){this._array=[],this._map=new Map,this._length=0}},{key:"find",value:function(t){return this._map.has(t)}}]),t}();function bs(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return As(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return As(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function As(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Os(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_s(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ws={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:function(){},viewportTraversersMap:{},basePath:""},xs=function(){function t(e){wr()(this,t),Object(Br.a)(this,"options",void 0),Object(Br.a)(this,"root",void 0),Object(Br.a)(this,"requestedTiles",void 0),Object(Br.a)(this,"selectedTiles",void 0),Object(Br.a)(this,"emptyTiles",void 0),Object(Br.a)(this,"lastUpdate",(new Date).getTime()),Object(Br.a)(this,"updateDebounceTime",1e3),Object(Br.a)(this,"_traversalStack",void 0),Object(Br.a)(this,"_emptyTraversalStack",void 0),Object(Br.a)(this,"_frameNumber",void 0),this.options=Os(Os({},ws),e),this._traversalStack=new ms,this._emptyTraversalStack=new ms,this._frameNumber=null,this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={}}return Cr()(t,[{key:"traversalFinished",value:function(t){return!0}},{key:"traverse",value:function(t,e,n){this.root=t,this.options=Os(Os({},this.options),n),this.reset(),this.updateTile(t,e),this._frameNumber=e.frameNumber,this.executeTraversal(t,e)}},{key:"reset",value:function(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}},{key:"executeTraversal",value:function(t,e){var n=this._traversalStack;for(t._selectionDepth=1,n.push(t);n.length>0;){var r=n.pop(),i=!1;this.canTraverse(r,e)&&(this.updateChildTiles(r,e),i=this.updateAndPushChildren(r,e,n,r.hasRenderContent?r._selectionDepth+1:r._selectionDepth));var o=r.parent,a=Boolean(!o||o._shouldRefine),s=!i;r.hasRenderContent?r.refine===Ka?(this.loadTile(r,e),this.selectTile(r,e)):r.refine===Xa&&(this.loadTile(r,e),s&&this.selectTile(r,e)):(this.emptyTiles[r.id]=r,this.loadTile(r,e),s&&this.selectTile(r,e)),this.touchTile(r,e),r._shouldRefine=i&&a}var u=(new Date).getTime();(this.traversalFinished(e)||u-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=u,this.options.onTraversalEnd(e))}},{key:"updateChildTiles",value:function(t,e){var n,r=bs(t.children);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.updateTile(i,e)}}catch(t){r.e(t)}finally{r.f()}return!0}},{key:"updateAndPushChildren",value:function(t,e,n,r){var i=this.options,o=i.loadSiblings,a=i.skipLevelOfDetail,s=t.children;s.sort(this.compareDistanceToCamera.bind(this));var u,c=t.refine===Xa&&t.hasRenderContent&&!a,l=!1,f=!0,h=bs(s);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(d._selectionDepth=r,d.isVisibleAndInRequestVolume?(n.find(d)&&n.delete(d),n.push(d),l=!0):(c||o)&&(this.loadTile(d,e),this.touchTile(d,e)),c){var p=void 0;if(p=!!d._inRequestVolume&&(d.hasRenderContent?d.contentAvailable:this.executeEmptyTraversal(d,e)),!(f=f&&p))return!1}}}catch(t){h.e(t)}finally{h.f()}return l||(f=!1),f}},{key:"updateTile",value:function(t,e){this.updateTileVisibility(t,e)}},{key:"selectTile",value:function(t,e){this.shouldSelectTile(t)&&(t._selectedFrame=e.frameNumber,this.selectedTiles[t.id]=t)}},{key:"loadTile",value:function(t,e){this.shouldLoadTile(t)&&(t._requestedFrame=e.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)}},{key:"touchTile",value:function(t,e){t.tileset._cache.touch(t),t._touchedFrame=e.frameNumber}},{key:"canTraverse",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!!t.hasChildren&&(t.hasTilesetContent?!t.contentExpired:!(!r&&!t.isVisibleAndInRequestVolume)&&this.shouldRefine(t,e,n))}},{key:"shouldLoadTile",value:function(t){return t.hasUnloadedContent||t.contentExpired}},{key:"shouldSelectTile",value:function(t){return t.contentAvailable&&!this.options.skipLevelOfDetail}},{key:"shouldRefine",value:function(t,e,n){var r=t._screenSpaceError;return n&&(r=t.getScreenSpaceError(e,!0)),r>this.options.maximumScreenSpaceError}},{key:"updateTileVisibility",value:function(t,e){var n=[];if(this.options.viewportTraversersMap)for(var r in this.options.viewportTraversersMap){this.options.viewportTraversersMap[r]===e.viewport.id&&n.push(r)}else n.push(e.viewport.id);t.updateVisibility(e,n)}},{key:"compareDistanceToCamera",value:function(t,e){return t._distanceToCamera-e._distanceToCamera}},{key:"anyChildrenVisible",value:function(t,e){var n,r=!1,i=bs(t.children);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.updateVisibility(e),r=r||o.isVisibleAndInRequestVolume}}catch(t){i.e(t)}finally{i.f()}return r}},{key:"executeEmptyTraversal",value:function(t,e){var n=!0,r=this._emptyTraversalStack;for(r.push(t);r.length>0&&n;){var i=r.pop();if(this.updateTile(i,e),i.isVisibleAndInRequestVolume||this.loadTile(i,e),this.touchTile(i,e),!i.hasRenderContent&&this.canTraverse(i,e,!1,!0)){var o,a=bs(i.children);try{for(a.s();!(o=a.n()).done;){var s=o.value;r.find(s)&&r.delete(s),r.push(s)}}catch(t){a.e(t)}finally{a.f()}}else i.contentAvailable||(n=!1)}return n}}]),t}();function Cs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ps(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Cs(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cs(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ss=new Ui;var Bs=function(){function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";wr()(this,t),Object(Br.a)(this,"tileset",void 0),Object(Br.a)(this,"header",void 0),Object(Br.a)(this,"id",void 0),Object(Br.a)(this,"url",void 0),Object(Br.a)(this,"parent",void 0),Object(Br.a)(this,"refine",void 0),Object(Br.a)(this,"type",void 0),Object(Br.a)(this,"contentUrl",void 0),Object(Br.a)(this,"lodMetricType",void 0),Object(Br.a)(this,"lodMetricValue",void 0),Object(Br.a)(this,"boundingVolume",void 0),Object(Br.a)(this,"content",void 0),Object(Br.a)(this,"contentState",void 0),Object(Br.a)(this,"gpuMemoryUsageInBytes",void 0),Object(Br.a)(this,"children",void 0),Object(Br.a)(this,"depth",void 0),Object(Br.a)(this,"viewportIds",void 0),Object(Br.a)(this,"transform",void 0),Object(Br.a)(this,"extensions",void 0),Object(Br.a)(this,"implicitTiling",void 0),Object(Br.a)(this,"userData",void 0),Object(Br.a)(this,"computedTransform",void 0),Object(Br.a)(this,"hasEmptyContent",void 0),Object(Br.a)(this,"hasTilesetContent",void 0),Object(Br.a)(this,"traverser",void 0),Object(Br.a)(this,"_cacheNode",void 0),Object(Br.a)(this,"_frameNumber",void 0),Object(Br.a)(this,"_lodJudge",void 0),Object(Br.a)(this,"_expireDate",void 0),Object(Br.a)(this,"_expiredContent",void 0),Object(Br.a)(this,"_shouldRefine",void 0),Object(Br.a)(this,"_distanceToCamera",void 0),Object(Br.a)(this,"_centerZDepth",void 0),Object(Br.a)(this,"_screenSpaceError",void 0),Object(Br.a)(this,"_visibilityPlaneMask",void 0),Object(Br.a)(this,"_visible",void 0),Object(Br.a)(this,"_inRequestVolume",void 0),Object(Br.a)(this,"_stackLength",void 0),Object(Br.a)(this,"_selectionDepth",void 0),Object(Br.a)(this,"_touchedFrame",void 0),Object(Br.a)(this,"_visitedFrame",void 0),Object(Br.a)(this,"_selectedFrame",void 0),Object(Br.a)(this,"_requestedFrame",void 0),Object(Br.a)(this,"_priority",void 0),Object(Br.a)(this,"_contentBoundingVolume",void 0),Object(Br.a)(this,"_viewerRequestVolume",void 0),Object(Br.a)(this,"_initialTransform",void 0),this.header=n,this.tileset=e,this.id=i||n.id,this.url=n.url,this.parent=r,this.refine=this._getRefine(n.refine),this.type=n.type,this.contentUrl=n.contentUrl,this.lodMetricType="geometricError",this.lodMetricValue=0,this.boundingVolume=null,this.content=null,this.contentState=za,this.gpuMemoryUsageInBytes=0,this.children=[],this.hasEmptyContent=!1,this.hasTilesetContent=!1,this.depth=0,this.viewportIds=[],this.userData={},this.extensions=null,this._priority=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._screenSpaceError=0,this._cacheNode=null,this._frameNumber=null,this._cacheNode=null,this.traverser=new xs({}),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._initialTransform=new Ri,this.transform=new Ri,this._initializeLodMetric(n),this._initializeTransforms(n),this._initializeBoundingVolumes(n),this._initializeContent(n),this._initializeRenderingState(n),this._lodJudge=null,this._expireDate=null,this._expiredContent=null,this.implicitTiling=null,Object.seal(this)}var e;return Cr()(t,[{key:"destroy",value:function(){this.header=null}},{key:"isDestroyed",value:function(){return null===this.header}},{key:"selected",get:function(){return this._selectedFrame===this.tileset._frameNumber}},{key:"isVisible",get:function(){return this._visible}},{key:"isVisibleAndInRequestVolume",get:function(){return this._visible&&this._inRequestVolume}},{key:"hasRenderContent",get:function(){return!this.hasEmptyContent&&!this.hasTilesetContent}},{key:"hasChildren",get:function(){return this.children.length>0||this.header.children&&this.header.children.length>0}},{key:"contentReady",get:function(){return this.contentState===Va||this.hasEmptyContent}},{key:"contentAvailable",get:function(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}},{key:"hasUnloadedContent",get:function(){return this.hasRenderContent&&this.contentUnloaded}},{key:"contentUnloaded",get:function(){return this.contentState===za}},{key:"contentExpired",get:function(){return this.contentState===Ja}},{key:"contentFailed",get:function(){return this.contentState===Wa}},{key:"distanceToCamera",get:function(){return this._distanceToCamera}},{key:"screenSpaceError",get:function(){return this._screenSpaceError}},{key:"getScreenSpaceError",value:function(t,e){switch(this.tileset.type){case $a:return ys(this,t);case ts:return function(t,e,n){var r=t.tileset,i=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,o=n?i:t.lodMetricValue;if(0===o)return 0;var a=Math.max(t._distanceToCamera,1e-7),s=e.height,u=e.sseDenominator,c=o*s*(r.options.viewDistanceScale||1)/(a*u);return c-=cs(r,a)}(this,t,e);default:throw new Error("Unsupported tileset type")}}},{key:"unselect",value:function(){this._selectedFrame=0}},{key:"_getPriority",value:function(){var t=this.tileset._traverser,e=t.options.skipLevelOfDetail,n=this.refine===Ka||e;if(n&&!this.isVisible&&void 0!==this._visible)return-1;if(this.tileset._frameNumber-this._touchedFrame>=1)return-1;if(this.contentState===za)return-1;var r=this.parent,i=r&&(!n||0===this._screenSpaceError||r.hasTilesetContent)?r._screenSpaceError:this._screenSpaceError,o=t.root?t.root._screenSpaceError:0;return Math.max(o-i,0)}},{key:"loadContent",value:(e=br()(Sr.a.mark((function t(){var e,n,r,i;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.hasEmptyContent){t.next=2;break}return t.abrupt("return",!1);case 2:if(!this.content){t.next=4;break}return t.abrupt("return",!0);case 4:return this.contentExpired&&(this._expireDate=null),this.contentState=Ha,t.next=9,this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));case 9:if(e=t.sent){t.next=13;break}return this.contentState=za,t.abrupt("return",!1);case 13:return t.prev=13,n=this.tileset.getTileUrl(this.contentUrl),r=this.tileset.loader,i=Ps(Ps({},this.tileset.loadOptions),{},_r()({},r.id,Ps(Ps({},this.tileset.loadOptions[r.id]),{},{isTileset:"json"===this.type},this._getLoaderSpecificOptions(r.id)))),t.next=19,Object(vr.a)(n,r,i);case 19:if(this.content=t.sent,!this.tileset.options.contentLoader){t.next=23;break}return t.next=23,this.tileset.options.contentLoader(this);case 23:return this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=Va,this._onContentLoaded(),t.abrupt("return",!0);case 29:throw t.prev=29,t.t0=t.catch(13),this.contentState=Wa,t.t0;case 33:return t.prev=33,e.done(),t.finish(33);case 36:case"end":return t.stop()}}),t,this,[[13,29,33,36]])}))),function(){return e.apply(this,arguments)})},{key:"unloadContent",value:function(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=za,!0}},{key:"updateVisibility",value:function(t,e){if(this._frameNumber!==t.frameNumber){var n=this.parent,r=n?n._visibilityPlaneMask:Ea.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){var i=n?n.computedTransform:this.tileset.modelMatrix;this._updateTransform(i)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,r),this._visible=this._visibilityPlaneMask!==Ea.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=e}}},{key:"visibility",value:function(t,e){var n=t.cullingVolume,r=this.boundingVolume;return n.computeVisibilityWithPlaneMask(r,e)}},{key:"contentVisibility",value:function(){return!0}},{key:"distanceToTile",value:function(t){var e=this.boundingVolume;return Math.sqrt(Math.max(e.distanceSquaredTo(t.camera.position),0))}},{key:"cameraSpaceZDepth",value:function(t){var e=t.camera,n=this.boundingVolume;return Ss.subVectors(n.center,e.position),e.direction.dot(Ss)}},{key:"insideViewerRequestVolume",value:function(t){var e=this._viewerRequestVolume;return!e||e.distanceSquaredTo(t.camera.position)<=0}},{key:"updateExpiration",value:function(){if(null!=this._expireDate&&this.contentReady&&!this.hasEmptyContent){var t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=Ja,this._expiredContent=this.content)}}},{key:"extras",get:function(){return this.header.extras}},{key:"_initializeLodMetric",value:function(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}},{key:"_initializeTransforms",value:function(t){this.transform=t.transform?new Ri(t.transform):new Ri;var e=this.parent,n=this.tileset,r=e&&e.computedTransform?e.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new Ri(r).multiplyRight(this.transform);var i=e&&e._initialTransform?e._initialTransform.clone():new Ri;this._initialTransform=new Ri(i).multiplyRight(this.transform)}},{key:"_initializeBoundingVolumes",value:function(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)}},{key:"_initializeContent",value:function(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=za,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}},{key:"_initializeRenderingState",value:function(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=Ea.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}},{key:"_getRefine",value:function(t){return t||this.parent&&this.parent.refine||Xa}},{key:"_isTileset",value:function(){return-1!==this.contentUrl.indexOf(".json")}},{key:"_onContentLoaded",value:function(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0}this._isTileset()&&(this.hasTilesetContent=!0)}},{key:"_updateBoundingVolume",value:function(t){this.boundingVolume=ss(t.boundingVolume,this.computedTransform,this.boundingVolume);var e=t.content;e&&(e.boundingVolume&&(this._contentBoundingVolume=ss(e.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=ss(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}},{key:"_updateTransform",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ri,e=t.clone().multiplyRight(this.transform),n=!e.equals(this.computedTransform);n&&(this.computedTransform=e,this._updateBoundingVolume(this.header))}},{key:"_getLoaderSpecificOptions",value:function(t){switch(t){case"i3s":return Ps(Ps({},this.tileset.options.i3s),{},{_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1});case"3d-tiles":case"cesium-ion":default:return{assetGltfUpAxis:(e=this.tileset.tileset).asset&&e.asset.gltfUpAxis||"Y"}}var e}}]),t}(),ks=n(262),Es=n.n(ks);function Ts(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ir()(t);if(e){var i=Ir()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jr()(this,n)}}var js=function(t){Er()(n,t);var e=Ts(n);function n(){return wr()(this,n),e.apply(this,arguments)}return Cr()(n,[{key:"compareDistanceToCamera",value:function(t,e){return 0===e._distanceToCamera&&0===t._distanceToCamera?e._centerZDepth-t._centerZDepth:e._distanceToCamera-t._distanceToCamera}},{key:"updateTileVisibility",value:function(t,e){if(Es()(Ir()(n.prototype),"updateTileVisibility",this).call(this,t,e),t.isVisibleAndInRequestVolume){var r=t.children.length>0;if(t.hasTilesetContent&&r){var i=t.children[0];return this.updateTileVisibility(i,e),void(t._visible=i._visible)}if(this.meetsScreenSpaceErrorEarly(t,e))t._visible=!1;else{var o=t.refine===Xa,a=t._optimChildrenWithinParent===ns;o&&a&&r&&!this.anyChildrenVisible(t,e)&&(t._visible=!1)}}}},{key:"meetsScreenSpaceErrorEarly",value:function(t,e){var n=t.parent;return!(!n||n.hasTilesetContent||n.refine!==Ka)&&!this.shouldRefine(t,e,!0)}}]),n}(xs),Ms=n(64),Is=n.n(Ms),Rs=function(){function t(){wr()(this,t),Object(Br.a)(this,"frameNumberMap",new Map)}return Cr()(t,[{key:"register",value:function(t,e){var n=this.frameNumberMap.get(t)||new Map,r=n.get(e)||0;n.set(e,r+1),this.frameNumberMap.set(t,n)}},{key:"deregister",value:function(t,e){var n=this.frameNumberMap.get(t);if(n){var r=n.get(e)||1;n.set(e,r-1)}}},{key:"isZero",value:function(t,e){var n;return 0===((null===(n=this.frameNumberMap.get(t))||void 0===n?void 0:n.get(e))||0)}}]),t}(),Ds="REQUESTED",Ls="COMPLETED",Fs="ERROR",Gs=function(){function t(){wr()(this,t),Object(Br.a)(this,"_statusMap",void 0),Object(Br.a)(this,"pendingTilesRegister",new Rs),this._statusMap={}}return Cr()(t,[{key:"add",value:function(t,e,n,r){var i=this;if(!this._statusMap[e]){var o=r.frameNumber,a=r.viewport.id;this._statusMap[e]={request:t,callback:n,key:e,frameState:r,status:Ds},this.pendingTilesRegister.register(a,o),t().then((function(t){i._statusMap[e].status=Ls;var n=i._statusMap[e].frameState,o=n.frameNumber,a=n.viewport.id;i.pendingTilesRegister.deregister(a,o),i._statusMap[e].callback(t,r)})).catch((function(t){i._statusMap[e].status=Fs;var r=i._statusMap[e].frameState,o=r.frameNumber,a=r.viewport.id;i.pendingTilesRegister.deregister(a,o),n(t)}))}}},{key:"update",value:function(t,e){if(this._statusMap[t]){var n=this._statusMap[t].frameState,r=n.frameNumber,i=n.viewport.id;this.pendingTilesRegister.deregister(i,r);var o=e.frameNumber,a=e.viewport.id;this.pendingTilesRegister.register(a,o),this._statusMap[t].frameState=e}}},{key:"find",value:function(t){return this._statusMap[t]}},{key:"hasPendingTiles",value:function(t,e){return!this.pendingTilesRegister.isZero(t,e)}}]),t}();function Ns(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Us(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ns(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ns(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function zs(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Hs(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hs(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Hs(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Vs(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ir()(t);if(e){var i=Ir()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jr()(this,n)}}var Js=function(t){Er()(r,t);var e,n=Vs(r);function r(t){var e;return wr()(this,r),e=n.call(this,t),Object(Br.a)(Is()(e),"_tileManager",void 0),e._tileManager=new Gs,e}return Cr()(r,[{key:"traversalFinished",value:function(t){return!this._tileManager.hasPendingTiles(t.viewport.id,this._frameNumber||0)}},{key:"shouldRefine",value:function(t,e){return t._lodJudge=function(t,e){if(0===t.lodMetricValue||isNaN(t.lodMetricValue))return"DIG";var n=2*ys(t,e);return n<2?"OUT":!t.header.children||n<=t.lodMetricValue?"DRAW":t.header.children?"DIG":"OUT"}(t,e),"DIG"===t._lodJudge}},{key:"updateChildTiles",value:function(t,e){var n,r=this,i=t.header.children||[],o=t.children,a=t.tileset,s=zs(i);try{var u=function(){var i=n.value,s="".concat(i.id,"-").concat(e.viewport.id),u=o&&o.find((function(t){return t.id===s}));if(u)u&&r.updateTile(u,e);else{var c=function(){return r._loadTile(i.id,a)};r._tileManager.find(s)?r._tileManager.update(s,e):(a.tileset.nodePages&&(c=function(){return a.tileset.nodePagesTile.formTileFromNodePages(i.id)}),r._tileManager.add(c,s,(function(e){return r._onTileLoad(e,t,s)}),e))}};for(s.s();!(n=s.n()).done;)u()}catch(t){s.e(t)}finally{s.f()}return!1}},{key:"_loadTile",value:(e=br()(Sr.a.mark((function t(e,n){var r,i,o;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.loader,i=n.getTileUrl("".concat(n.url,"/nodes/").concat(e)),o=Us(Us({},n.loadOptions),{},{i3s:Us(Us({},n.loadOptions.i3s),{},{isTileHeader:!0})}),t.next=5,Object(vr.a)(i,r,o);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)}))),function(t,n){return e.apply(this,arguments)})},{key:"_onTileLoad",value:function(t,e,n){var r=new Bs(e.tileset,t,e,n);e.children.push(r);var i=this._tileManager.find(r.id).frameState;this.updateTile(r,i),this._frameNumber===i.frameNumber&&(this.traversalFinished(i)||(new Date).getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(r,i)}}]),r}(xs);function Ws(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ks(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ks(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ks(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Xs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qs(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xs(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xs(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qs={description:"",ellipsoid:go.WGS84,modelMatrix:new Ri,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:function(){},onTileUnload:function(){},onTileError:function(){},onTraversalComplete:function(t){return t},contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},Zs="Tiles In Tileset(s)",Ys=function(){function t(e,n){wr()(this,t),Object(Br.a)(this,"options",void 0),Object(Br.a)(this,"loadOptions",void 0),Object(Br.a)(this,"type",void 0),Object(Br.a)(this,"tileset",void 0),Object(Br.a)(this,"loader",void 0),Object(Br.a)(this,"url",void 0),Object(Br.a)(this,"basePath",void 0),Object(Br.a)(this,"modelMatrix",void 0),Object(Br.a)(this,"ellipsoid",void 0),Object(Br.a)(this,"lodMetricType",void 0),Object(Br.a)(this,"lodMetricValue",void 0),Object(Br.a)(this,"refine",void 0),Object(Br.a)(this,"root",void 0),Object(Br.a)(this,"roots",void 0),Object(Br.a)(this,"asset",void 0),Object(Br.a)(this,"description",void 0),Object(Br.a)(this,"properties",void 0),Object(Br.a)(this,"extras",void 0),Object(Br.a)(this,"attributions",void 0),Object(Br.a)(this,"credits",void 0),Object(Br.a)(this,"stats",void 0),Object(Br.a)(this,"traverseCounter",void 0),Object(Br.a)(this,"geometricError",void 0),Object(Br.a)(this,"selectedTiles",void 0),Object(Br.a)(this,"updatePromise",null),Object(Br.a)(this,"tilesetInitializationPromise",void 0),Object(Br.a)(this,"cartographicCenter",void 0),Object(Br.a)(this,"cartesianCenter",void 0),Object(Br.a)(this,"zoom",void 0),Object(Br.a)(this,"boundingVolume",void 0),Object(Br.a)(this,"gpuMemoryUsageInBytes",void 0),Object(Br.a)(this,"dynamicScreenSpaceErrorComputedDensity",void 0),Object(Br.a)(this,"_traverser",void 0),Object(Br.a)(this,"_cache",void 0),Object(Br.a)(this,"_requestScheduler",void 0),Object(Br.a)(this,"_frameNumber",void 0),Object(Br.a)(this,"_queryParamsString",void 0),Object(Br.a)(this,"_queryParams",void 0),Object(Br.a)(this,"_extensionsUsed",void 0),Object(Br.a)(this,"_tiles",void 0),Object(Br.a)(this,"_pendingCount",void 0),Object(Br.a)(this,"lastUpdatedVieports",void 0),Object(Br.a)(this,"_requestedTiles",void 0),Object(Br.a)(this,"_emptyTiles",void 0),Object(Br.a)(this,"frameStateData",void 0),Object(Br.a)(this,"maximumMemoryUsage",void 0),Object(mo.a)(e),this.options=qs(qs({},Qs),n),this.tileset=e,this.loader=e.loader,this.type=e.type,this.url=e.url,this.basePath=e.basePath||bo.b.dirname(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=e.lodMetricType,this.lodMetricValue=e.lodMetricValue,this.refine=e.root.refine,this.loadOptions=this.options.loadOptions||{},this.root=null,this.roots={},this.cartographicCenter=null,this.cartesianCenter=null,this.zoom=1,this.boundingVolume=null,this.traverseCounter=0,this.geometricError=0,this._traverser=this._initializeTraverser(),this._cache=new xo,this._requestScheduler=new Ao.a({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this._frameNumber=0,this._pendingCount=0,this._tiles={},this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this.frameStateData={},this.lastUpdatedVieports=null,this._queryParams={},this._queryParamsString="",this.maximumMemoryUsage=this.options.maximumMemoryUsage||32,this.gpuMemoryUsageInBytes=0,this.stats=new yo.a({id:this.url}),this._initializeStats(),this._extensionsUsed=void 0,this.dynamicScreenSpaceErrorComputedDensity=0,this.extras=null,this.asset={},this.credits={},this.description=this.options.description||"",this.tilesetInitializationPromise=this._initializeTileSet(e)}var e,n,r;return Cr()(t,[{key:"destroy",value:function(){this._destroy()}},{key:"isLoaded",value:function(){return 0===this._pendingCount&&0!==this._frameNumber&&0===this._requestedTiles.length}},{key:"tiles",get:function(){return Object.values(this._tiles)}},{key:"frameNumber",get:function(){return this._frameNumber}},{key:"queryParams",get:function(){return this._queryParamsString||(this._queryParamsString=function(t){for(var e=[],n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];e.push("".concat(i,"=").concat(t[i]))}switch(e.length){case 0:return"";case 1:return"?".concat(e[0]);default:return"?".concat(e.join("&"))}}(this._queryParams)),this._queryParamsString}},{key:"setProps",value:function(t){this.options=qs(qs({},this.options),t)}},{key:"setOptions",value:function(t){this.options=qs(qs({},this.options),t)}},{key:"getTileUrl",value:function(t){return t.startsWith("data:")?t:"".concat(t).concat(this.queryParams)}},{key:"hasExtension",value:function(t){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(t)>-1)}},{key:"update",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.tilesetInitializationPromise.then((function(){!e&&t.lastUpdatedVieports?e=t.lastUpdatedVieports:t.lastUpdatedVieports=e,e&&t.doUpdate(e)}))}},{key:"selectTiles",value:(r=br()(Sr.a.mark((function t(){var e,n=this,r=arguments;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:null,t.next=3,this.tilesetInitializationPromise;case 3:return e&&(this.lastUpdatedVieports=e),this.updatePromise||(this.updatePromise=new Promise((function(t){setTimeout((function(){n.lastUpdatedVieports&&n.doUpdate(n.lastUpdatedVieports),t(n._frameNumber),n.updatePromise=null}),n.options.debounceTime)}))),t.abrupt("return",this.updatePromise);case 6:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"doUpdate",value:function(t){if((!("loadTiles"in this.options)||this.options.loadTiles)&&!(this.traverseCounter>0)){var e=t instanceof Array?t:[t];this._cache.reset(),this._frameNumber++,this.traverseCounter=e.length;var n,r=[],i=Ws(e);try{for(i.s();!(n=i.n()).done;){var o=n.value.id;this._needTraverse(o)?r.push(o):this.traverseCounter--}}catch(t){i.e(t)}finally{i.f()}var a,s=Ws(e);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u.id;if(this.roots[c]||(this.roots[c]=this._initializeTileHeaders(this.tileset,null)),r.includes(c)){var l=Da(u,this._frameNumber);this._traverser.traverse(this.roots[c],l,this.options)}}}catch(t){s.e(t)}finally{s.f()}}}},{key:"_needTraverse",value:function(t){var e=t;return this.options.viewportTraversersMap&&(e=this.options.viewportTraversersMap[t]),e===t}},{key:"_onTraversalEnd",value:function(t){var e=t.viewport.id;this.frameStateData[e]||(this.frameStateData[e]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});var n=this.frameStateData[e],r=function(t,e,n){if(0===n||t.length<=n)return[t,[]];var r,i=[],o=e.viewport,a=o.longitude,s=o.latitude,u=Ta(t.entries());try{for(u.s();!(r=u.n()).done;){var c=yr()(r.value,2),l=c[0],f=c[1],h=yr()(f.header.mbs,2),d=h[0],p=h[1],v=Math.abs(a-d),g=Math.abs(s-p),y=Math.sqrt(g*g+v*v);i.push([l,y])}}catch(t){u.e(t)}finally{u.f()}for(var m=i.sort((function(t,e){return t[1]-e[1]})),b=[],A=0;A<n;A++)b.push(t[m[A][0]]);for(var _=[],O=n;O<m.length;O++)_.push(t[m[O][0]]);return[b,_]}(Object.values(this._traverser.selectedTiles),t,this.options.maximumTilesSelected),i=yr()(r,2),o=i[0],a=i[1];n.selectedTiles=o;var s,u=Ws(a);try{for(u.s();!(s=u.n()).done;){s.value.unselect()}}catch(t){u.e(t)}finally{u.f()}n._requestedTiles=Object.values(this._traverser.requestedTiles),n._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,this.traverseCounter>0||this._updateTiles()}},{key:"_updateTiles",value:function(){for(var t in this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[],this.frameStateData){var e=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(e.selectedTiles),this._requestedTiles=this._requestedTiles.concat(e._requestedTiles),this._emptyTiles=this._emptyTiles.concat(e._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);var n,r=Ws(this.selectedTiles);try{for(r.s();!(n=r.n()).done;){var i=n.value;this._tiles[i.id]=i}}catch(t){r.e(t)}finally{r.f()}this._loadTiles(),this._unloadTiles(),this._updateStats()}},{key:"_tilesChanged",value:function(t,e){if(t.length!==e.length)return!0;var n=new Set(t.map((function(t){return t.id}))),r=new Set(e.map((function(t){return t.id}))),i=t.filter((function(t){return!r.has(t.id)})).length>0;return i=i||e.filter((function(t){return!n.has(t.id)})).length>0}},{key:"_loadTiles",value:function(){var t,e=Ws(this._requestedTiles);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.contentUnloaded&&this._loadTile(n)}}catch(t){e.e(t)}finally{e.f()}}},{key:"_unloadTiles",value:function(){this._cache.unloadTiles(this,(function(t,e){return t._unloadTile(e)}))}},{key:"_updateStats",value:function(){var t,e=0,n=0,r=Ws(this.selectedTiles);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.contentAvailable&&i.content&&(e++,i.content.pointCount?n+=i.content.pointCount:n+=i.content.vertexCount)}}catch(t){r.e(t)}finally{r.f()}this.stats.get("Tiles In View").count=this.selectedTiles.length,this.stats.get("Tiles To Render").count=e,this.stats.get("Points/Vertices").count=n}},{key:"_initializeTileSet",value:(n=br()(Sr.a.mark((function t(e){return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.type!==$a){t.next=5;break}return this.calculateViewPropsI3S(),t.next=4,e.root;case 4:e.root=t.sent;case 5:this.root=this._initializeTileHeaders(e,null),this.type===ts&&(this._initializeTiles3DTileset(e),this.calculateViewPropsTiles3D()),this.type===$a&&this._initializeI3STileset();case 8:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"calculateViewPropsI3S",value:function(){var t,e=this.tileset.fullExtent;if(e){var n=e.xmin,r=e.xmax,i=e.ymin,o=e.ymax,a=e.zmin,s=e.zmax;return this.cartographicCenter=new Ui(n+(r-n)/2,i+(o-i)/2,a+(s-a)/2),this.cartesianCenter=go.WGS84.cartographicToCartesian(this.cartographicCenter,new Ui),void(this.zoom=Ua(e,this.cartographicCenter,this.cartesianCenter))}var u=null===(t=this.tileset.store)||void 0===t?void 0:t.extent;if(u){var c=yr()(u,4),l=c[0],f=c[1],h=c[2],d=c[3];return this.cartographicCenter=new Ui(l+(h-l)/2,f+(d-f)/2,0),this.cartesianCenter=go.WGS84.cartographicToCartesian(this.cartographicCenter,new Ui),void(this.zoom=function(t,e,n){var r=yr()(t,4),i=r[0],o=r[1];return Ua({xmin:i,xmax:r[2],ymin:o,ymax:r[3],zmin:0,zmax:0},e,n)}(u,this.cartographicCenter,this.cartesianCenter))}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new Ui,this.zoom=1}},{key:"calculateViewPropsTiles3D",value:function(){var t=this.root;Object(mo.a)(t);var e=t.boundingVolume.center;if(!e)return console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new Ui,void(this.zoom=1);0!==e[0]||0!==e[1]||0!==e[2]?this.cartographicCenter=go.WGS84.cartesianToCartographic(e,new Ui):this.cartographicCenter=new Ui(0,0,-go.WGS84.radii[0]),this.cartesianCenter=e,this.zoom=Na(t.boundingVolume,this.cartographicCenter)}},{key:"_initializeStats",value:function(){this.stats.get(Zs),this.stats.get("Tiles Loading"),this.stats.get("Tiles In Memory"),this.stats.get("Tiles In View"),this.stats.get("Tiles To Render"),this.stats.get("Tiles Loaded"),this.stats.get("Tiles Unloaded"),this.stats.get("Failed Tile Loads"),this.stats.get("Points/Vertices","memory"),this.stats.get("Tile Memory Use","memory")}},{key:"_initializeTileHeaders",value:function(t,e){var n=new Bs(this,t.root,e);if(e&&(e.children.push(n),n.depth=e.depth+1),this.type===ts){var r=[];for(r.push(n);r.length>0;){var i=r.pop();this.stats.get(Zs).incrementCount();var o,a=Ws(i.header.children||[]);try{for(a.s();!(o=a.n()).done;){var s=o.value,u=new Bs(this,s,i);i.children.push(u),u.depth=i.depth+1,r.push(u)}}catch(t){a.e(t)}finally{a.f()}}}return n}},{key:"_initializeTraverser",value:function(){var t;switch(this.type){case ts:t=js;break;case $a:t=Js;break;default:t=xs}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}},{key:"_destroyTileHeaders",value:function(t){this._destroySubtree(t)}},{key:"_loadTile",value:(e=br()(Sr.a.mark((function t(e){var n;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._onStartTileLoading(),t.next=4,e.loadContent();case 4:n=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),this._onTileLoadError(e,t.t0);case 10:return t.prev=10,this._onEndTileLoading(),this._onTileLoad(e,n),t.finish(10);case 14:case"end":return t.stop()}}),t,this,[[0,7,10,14]])}))),function(t){return e.apply(this,arguments)})},{key:"_onTileLoadError",value:function(t,e){this.stats.get("Failed Tile Loads").incrementCount();var n=e.message||e.toString(),r=t.url;console.error("A 3D tile failed to load: ".concat(t.url," ").concat(n)),this.options.onTileError(t,n,r)}},{key:"_onTileLoad",value:function(t,e){if(e){if(this.type===$a){var n,r,i=(null===(n=this.tileset)||void 0===n?void 0:null===(r=n.nodePagesTile)||void 0===r?void 0:r.nodesInNodePages)||0;this.stats.get(Zs).reset(),this.stats.get(Zs).addCount(i)}t&&t.content&&function(t,e){Object(mo.a)(t),Object(mo.a)(e);var n=e.rtcCenter,r=e.gltfUpAxis,i=t.computedTransform,o=t.boundingVolume.center,a=new Ri(i);switch(n&&a.translate(n),r){case"Z":break;case"Y":var s=(new Ri).rotateX(Math.PI/2);a=a.multiplyRight(s);break;case"X":var u=(new Ri).rotateY(-Math.PI/2);a=a.multiplyRight(u)}e.isQuantized&&a.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);var c=new Ui(o);e.cartesianModelMatrix=a,e.cartesianOrigin=c;var l=go.WGS84.cartesianToCartographic(c,new Ui),f=go.WGS84.eastNorthUpToFixedFrame(c).invert();e.cartographicModelMatrix=f.multiplyRight(a),e.cartographicOrigin=l,e.coordinateSystem||(e.modelMatrix=e.cartographicModelMatrix)}(t,t.content),this._addTileToCache(t),this.options.onTileLoad(t)}}},{key:"_onStartTileLoading",value:function(){this._pendingCount++,this.stats.get("Tiles Loading").incrementCount()}},{key:"_onEndTileLoading",value:function(){this._pendingCount--,this.stats.get("Tiles Loading").decrementCount()}},{key:"_addTileToCache",value:function(t){this._cache.add(this,t,(function(e){return e._updateCacheStats(t)}))}},{key:"_updateCacheStats",value:function(t){this.stats.get("Tiles Loaded").incrementCount(),this.stats.get("Tiles In Memory").incrementCount(),this.gpuMemoryUsageInBytes+=t.content.byteLength||0,this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes}},{key:"_unloadTile",value:function(t){this.gpuMemoryUsageInBytes-=t.content&&t.content.byteLength||0,this.stats.get("Tiles In Memory").decrementCount(),this.stats.get("Tiles Unloaded").incrementCount(),this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()}},{key:"_destroy",value:function(){var t=[];for(this.root&&t.push(this.root);t.length>0;){var e,n=t.pop(),r=Ws(n.children);try{for(r.s();!(e=r.n()).done;){var i=e.value;t.push(i)}}catch(t){r.e(t)}finally{r.f()}this._destroyTile(n)}this.root=null}},{key:"_destroySubtree",value:function(t){var e=t,n=[];for(n.push(e);n.length>0;){var r,i=Ws((t=n.pop()).children);try{for(i.s();!(r=i.n()).done;){var o=r.value;n.push(o)}}catch(t){i.e(t)}finally{i.f()}t!==e&&this._destroyTile(t)}e.children=[]}},{key:"_destroyTile",value:function(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()}},{key:"_initializeTiles3DTileset",value:function(t){if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if("0.0"!==this.asset.version&&"1.0"!==this.asset.version)throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed,this.extras=t.extras}},{key:"_initializeI3STileset",value:function(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}]),t}();var $s={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};Object.keys($s);function tu(t,e,n){Object(mo.a)(t instanceof ArrayBuffer);var r=new TextDecoder("utf8"),i=new Uint8Array(t,e,n);return r.decode(i)}function eu(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new DataView(t);return"".concat(String.fromCharCode(n.getUint8(e+0))).concat(String.fromCharCode(n.getUint8(e+1))).concat(String.fromCharCode(n.getUint8(e+2))).concat(String.fromCharCode(n.getUint8(e+3)))}var nu=n(70),ru={draco:{decoderType:"object"===("undefined"==typeof WebAssembly?"undefined":Dr()(WebAssembly))?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},iu={name:"Draco",id:nu.b?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:"3.3.0-alpha.5",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:ru};function ou(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=t.POSITION?t.POSITION.value:[],u=s&&s.length,c=0;c<u;c+=3){var l=s[c],f=s[c+1],h=s[c+2];e=l<e?l:e,n=f<n?f:n,r=h<r?h:r,i=l>i?l:i,o=f>o?f:o,a=h>a?h:a}return[[e,n,r],[i,o,a]]}function au(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return su(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return su(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function su(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var uu=function(){function t(e,n){wr()(this,t),Object(Br.a)(this,"fields",void 0),Object(Br.a)(this,"metadata",void 0),function(t,e){if(!t)throw new Error(e||"loader assertion failed.")}(Array.isArray(e)),function(t){var e,n={},r=au(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n[i.name]&&console.warn("Schema: duplicated field name",i.name,i),n[i.name]=!0}}catch(t){r.e(t)}finally{r.f()}}(e),this.fields=e,this.metadata=n||new Map}return Cr()(t,[{key:"compareTo",value:function(t){if(this.metadata!==t.metadata)return!1;if(this.fields.length!==t.fields.length)return!1;for(var e=0;e<this.fields.length;++e)if(!this.fields[e].compareTo(t.fields[e]))return!1;return!0}},{key:"select",value:function(){for(var e=Object.create(null),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(var o=0,a=r;o<a.length;o++){var s=a[o];e[s]=!0}var u=this.fields.filter((function(t){return e[t.name]}));return new t(u,this.metadata)}},{key:"selectAt",value:function(){for(var e=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=r.map((function(t){return e.fields[t]})).filter(Boolean);return new t(o,this.metadata)}},{key:"assign",value:function(e){var n,r=this.metadata;if(e instanceof t){var i=e;n=i.fields,r=cu(cu(new Map,this.metadata),i.metadata)}else n=e;var o,a=Object.create(null),s=au(this.fields);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u.name]=u}}catch(t){s.e(t)}finally{s.f()}var c,l=au(n);try{for(l.s();!(c=l.n()).done;){var f=c.value;a[f.name]=f}}catch(t){l.e(t)}finally{l.f()}return new t(Object.values(a),r)}}]),t}();function cu(t,e){return new Map([].concat(Fr()(t||new Map),Fr()(e||new Map)))}var lu,fu=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map;wr()(this,t),Object(Br.a)(this,"name",void 0),Object(Br.a)(this,"type",void 0),Object(Br.a)(this,"nullable",void 0),Object(Br.a)(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=i}return Cr()(t,[{key:"typeId",get:function(){return this.type&&this.type.typeId}},{key:"clone",value:function(){return new t(this.name,this.type,this.nullable,this.metadata)}},{key:"compareTo",value:function(t){return this.name===t.name&&this.type===t.type&&this.nullable===t.nullable&&this.metadata===t.metadata}},{key:"toString",value:function(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}]),t}();function hu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ir()(t);if(e){var i=Ir()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jr()(this,n)}}!function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"}(lu||(lu={}));var du=function(){function t(){wr()(this,t)}return Cr()(t,[{key:"typeId",get:function(){return lu.NONE}},{key:"compareTo",value:function(t){return this===t}}],[{key:"isNull",value:function(t){return t&&t.typeId===lu.Null}},{key:"isInt",value:function(t){return t&&t.typeId===lu.Int}},{key:"isFloat",value:function(t){return t&&t.typeId===lu.Float}},{key:"isBinary",value:function(t){return t&&t.typeId===lu.Binary}},{key:"isUtf8",value:function(t){return t&&t.typeId===lu.Utf8}},{key:"isBool",value:function(t){return t&&t.typeId===lu.Bool}},{key:"isDecimal",value:function(t){return t&&t.typeId===lu.Decimal}},{key:"isDate",value:function(t){return t&&t.typeId===lu.Date}},{key:"isTime",value:function(t){return t&&t.typeId===lu.Time}},{key:"isTimestamp",value:function(t){return t&&t.typeId===lu.Timestamp}},{key:"isInterval",value:function(t){return t&&t.typeId===lu.Interval}},{key:"isList",value:function(t){return t&&t.typeId===lu.List}},{key:"isStruct",value:function(t){return t&&t.typeId===lu.Struct}},{key:"isUnion",value:function(t){return t&&t.typeId===lu.Union}},{key:"isFixedSizeBinary",value:function(t){return t&&t.typeId===lu.FixedSizeBinary}},{key:"isFixedSizeList",value:function(t){return t&&t.typeId===lu.FixedSizeList}},{key:"isMap",value:function(t){return t&&t.typeId===lu.Map}},{key:"isDictionary",value:function(t){return t&&t.typeId===lu.Dictionary}}]),t}(),pu=(Symbol.toStringTag,Symbol.toStringTag,function(t,e){Er()(r,t);var n=hu(r);function r(t,e){var i;return wr()(this,r),i=n.call(this),Object(Br.a)(Is()(i),"isSigned",void 0),Object(Br.a)(Is()(i),"bitWidth",void 0),i.isSigned=t,i.bitWidth=e,i}return Cr()(r,[{key:"typeId",get:function(){return lu.Int}},{key:e,get:function(){return"Int"}},{key:"toString",value:function(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}]),r}(du,Symbol.toStringTag)),vu=function(t){Er()(n,t);var e=hu(n);function n(){return wr()(this,n),e.call(this,!0,8)}return n}(pu),gu=function(t){Er()(n,t);var e=hu(n);function n(){return wr()(this,n),e.call(this,!0,16)}return n}(pu),yu=function(t){Er()(n,t);var e=hu(n);function n(){return wr()(this,n),e.call(this,!0,32)}return n}(pu),mu=function(t){Er()(n,t);var e=hu(n);function n(){return wr()(this,n),e.call(this,!1,8)}return n}(pu),bu=function(t){Er()(n,t);var e=hu(n);function n(){return wr()(this,n),e.call(this,!1,16)}return n}(pu),Au=function(t){Er()(n,t);var e=hu(n);function n(){return wr()(this,n),e.call(this,!1,32)}return n}(pu),_u=32,Ou=64,wu=function(t,e){Er()(r,t);var n=hu(r);function r(t){var e;return wr()(this,r),e=n.call(this),Object(Br.a)(Is()(e),"precision",void 0),e.precision=t,e}return Cr()(r,[{key:"typeId",get:function(){return lu.Float}},{key:e,get:function(){return"Float"}},{key:"toString",value:function(){return"Float".concat(this.precision)}}]),r}(du,Symbol.toStringTag),xu=function(t){Er()(n,t);var e=hu(n);function n(){return wr()(this,n),e.call(this,_u)}return n}(wu),Cu=function(t){Er()(n,t);var e=hu(n);function n(){return wr()(this,n),e.call(this,Ou)}return n}(wu),Pu=(Symbol.toStringTag,Symbol.toStringTag,{DAY:0,MILLISECOND:1}),Su=(Symbol.toStringTag,{SECOND:1,MILLISECOND:1e3,MICROSECOND:1e6,NANOSECOND:1e9}),Bu=(Symbol.toStringTag,Symbol.toStringTag,{DAY_TIME:0,YEAR_MONTH:1}),ku=(Symbol.toStringTag,function(t,e){Er()(r,t);var n=hu(r);function r(t,e){var i;return wr()(this,r),i=n.call(this),Object(Br.a)(Is()(i),"listSize",void 0),Object(Br.a)(Is()(i),"children",void 0),i.listSize=t,i.children=[e],i}return Cr()(r,[{key:"typeId",get:function(){return lu.FixedSizeList}},{key:"valueType",get:function(){return this.children[0].type}},{key:"valueField",get:function(){return this.children[0]}},{key:e,get:function(){return"FixedSizeList"}},{key:"toString",value:function(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}]),r}(du,Symbol.toStringTag));Symbol.toStringTag;function Eu(t,e,n){var r=function(t){switch(t.constructor){case Int8Array:return new vu;case Uint8Array:return new mu;case Int16Array:return new gu;case Uint16Array:return new bu;case Int32Array:return new yu;case Uint32Array:return new Au;case Float32Array:return new xu;case Float64Array:return new Cu;default:throw new Error("array type not supported")}}(e.value),i=n||function(t){var e=new Map;"byteOffset"in t&&e.set("byteOffset",t.byteOffset.toString(10));"byteStride"in t&&e.set("byteStride",t.byteStride.toString(10));"normalized"in t&&e.set("normalized",t.normalized.toString());return e}(e);return new fu(t,new ku(e.size,new fu("value",r)),!1,i)}function Tu(t,e,n){var r=Mu(e.metadata),i=[],o=function(t){var e={};for(var n in t){var r=t[n];e[r.name||"undefined"]=r}return e}(e.attributes);for(var a in t){var s=ju(a,t[a],o[a]);i.push(s)}if(n){var u=ju("indices",n);i.push(u)}return new uu(i,r)}function ju(t,e,n){return Eu(t,e,n?Mu(n.metadata):void 0)}function Mu(t){var e=new Map;for(var n in t)e.set("".concat(n,".string"),JSON.stringify(t[n]));return e}function Iu(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ru(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ru(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ru(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Du(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Lu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Du(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Du(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Fu={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},Gu={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},Nu=function(){function t(e){wr()(this,t),Object(Br.a)(this,"draco",void 0),Object(Br.a)(this,"decoder",void 0),Object(Br.a)(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}return Cr()(t,[{key:"destroy",value:function(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}},{key:"parseSync",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new this.draco.DecoderBuffer;n.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(e);var r=this.decoder.GetEncodedGeometryType(n),i=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{var o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(n,i);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(n,i);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!i.ptr){var a="DRACO decompression failed: ".concat(o.error_msg());throw new Error(a)}var s=this._getDracoLoaderData(i,r,e),u=this._getMeshData(i,s,e),c=ou(u.attributes),l=Tu(u.attributes,s,u.indices),f=Lu(Lu({loader:"draco",loaderData:s,header:{vertexCount:i.num_points(),boundingBox:c}},u),{},{schema:l});return f}finally{this.draco.destroy(n),i&&this.draco.destroy(i)}}},{key:"_getDracoLoaderData",value:function(t,e,n){var r=this._getTopLevelMetadata(t),i=this._getDracoAttributes(t,n);return{geometry_type:e,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:r,attributes:i}}},{key:"_getDracoAttributes",value:function(t,e){for(var n={},r=0;r<t.num_attributes();r++){var i=this.decoder.GetAttribute(t,r),o=this._getAttributeMetadata(t,r);n[i.unique_id()]={unique_id:i.unique_id(),attribute_type:i.attribute_type(),data_type:i.data_type(),num_components:i.num_components(),byte_offset:i.byte_offset(),byte_stride:i.byte_stride(),normalized:i.normalized(),attribute_index:r,metadata:o};var a=this._getQuantizationTransform(i,e);a&&(n[i.unique_id()].quantization_transform=a);var s=this._getOctahedronTransform(i,e);s&&(n[i.unique_id()].octahedron_transform=s)}return n}},{key:"_getMeshData",value:function(t,e,n){var r=this._getMeshAttributes(e,t,n);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(t instanceof this.draco.Mesh)switch(n.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(t),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(t),size:1}}}return{topology:"point-list",mode:0,attributes:r}}},{key:"_getMeshAttributes",value:function(t,e,n){for(var r={},i=0,o=Object.values(t.attributes);i<o.length;i++){var a=o[i],s=this._deduceAttributeName(a,n);a.name=s;var u=this._getAttributeValues(e,a),c=u.value,l=u.size;r[s]={value:c,size:l,byteOffset:a.byte_offset,byteStride:a.byte_stride,normalized:a.normalized}}return r}},{key:"_getTriangleListIndices",value:function(t){var e=3*t.num_faces(),n=4*e,r=this.draco._malloc(n);try{return this.decoder.GetTrianglesUInt32Array(t,n,r),new Uint32Array(this.draco.HEAPF32.buffer,r,e).slice()}finally{this.draco._free(r)}}},{key:"_getTriangleStripIndices",value:function(t){var e=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,e),function(t){for(var e=t.size(),n=new Int32Array(e),r=0;r<e;r++)n[r]=t.GetValue(r);return n}(e)}finally{this.draco.destroy(e)}}},{key:"_getAttributeValues",value:function(t,e){var n,r=Gu[e.data_type],i=e.num_components,o=t.num_points()*i,a=o*r.BYTES_PER_ELEMENT,s=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}(this.draco,r),u=this.draco._malloc(a);try{var c=this.decoder.GetAttribute(t,e.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,c,s,a,u),n=new r(this.draco.HEAPF32.buffer,u,o).slice()}finally{this.draco._free(u)}return{value:n,size:i}}},{key:"_deduceAttributeName",value:function(t,e){for(var n=t.unique_id,r=0,i=Object.entries(e.extraAttributes||{});r<i.length;r++){var o=yr()(i[r],2),a=o[0];if(o[1]===n)return a}var s=t.attribute_type;for(var u in Fu){if(this.draco[u]===s)return Fu[u]}var c=e.attributeNameEntry||"name";return t.metadata[c]?t.metadata[c].string:"CUSTOM_ATTRIBUTE_".concat(n)}},{key:"_getTopLevelMetadata",value:function(t){var e=this.decoder.GetMetadata(t);return this._getDracoMetadata(e)}},{key:"_getAttributeMetadata",value:function(t,e){var n=this.decoder.GetAttributeMetadata(t,e);return this._getDracoMetadata(n)}},{key:"_getDracoMetadata",value:function(t){if(!t||!t.ptr)return{};for(var e={},n=this.metadataQuerier.NumEntries(t),r=0;r<n;r++){var i=this.metadataQuerier.GetEntryName(t,r);e[i]=this._getDracoMetadataField(t,i)}return e}},{key:"_getDracoMetadataField",value:function(t,e){var n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,e,n);var r=function(t){for(var e=t.size(),n=new Int32Array(e),r=0;r<e;r++)n[r]=t.GetValue(r);return n}(n);return{int:this.metadataQuerier.GetIntEntry(t,e),string:this.metadataQuerier.GetStringEntry(t,e),double:this.metadataQuerier.GetDoubleEntry(t,e),intArray:r}}finally{this.draco.destroy(n)}}},{key:"_disableAttributeTransforms",value:function(t){var e,n=t.quantizedAttributes,r=void 0===n?[]:n,i=t.octahedronAttributes,o=void 0===i?[]:i,a=Iu([].concat(Fr()(r),Fr()(o)));try{for(a.s();!(e=a.n()).done;){var s=e.value;this.decoder.SkipAttributeTransform(this.draco[s])}}catch(t){a.e(t)}finally{a.f()}}},{key:"_getQuantizationTransform",value:function(t,e){var n=this,r=e.quantizedAttributes,i=void 0===r?[]:r,o=t.attribute_type();if(i.map((function(t){return n.decoder[t]})).includes(o)){var a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(t))return{quantization_bits:a.quantization_bits(),range:a.range(),min_values:new Float32Array([1,2,3]).map((function(t){return a.min_value(t)}))}}finally{this.draco.destroy(a)}}return null}},{key:"_getOctahedronTransform",value:function(t,e){var n=this,r=e.octahedronAttributes,i=void 0===r?[]:r,o=t.attribute_type();if(i.map((function(t){return n.decoder[t]})).includes(o)){var a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(t))return{quantization_bits:a.quantization_bits()}}finally{this.draco.destroy(a)}}return null}}]),t}();var Uu=n(145),zu=n(74),Hu={};function Vu(t){return Ju.apply(this,arguments)}function Ju(){return(Ju=br()(Sr.a.mark((function t(e){var n,r,i=arguments;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:null,r=i.length>2&&void 0!==i[2]?i[2]:{},n&&(e=Wu(e,n,r)),Hu[e]=Hu[e]||Ku(e),t.next=6,Hu[e];case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Wu(t,e,n){if(t.startsWith("http"))return t;var r=n.modules||{};return r[t]?r[t]:nu.b?n.CDN?(Object(zu.a)(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(e,"@").concat("3.3.0-alpha.5","/dist/libs/").concat(t)):nu.d?"../src/libs/".concat(t):"modules/".concat(e,"/src/libs/").concat(t):"modules/".concat(e,"/dist/libs/").concat(t)}function Ku(t){return Xu.apply(this,arguments)}function Xu(){return(Xu=br()(Sr.a.mark((function t(e){var n,r,i;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.endsWith("wasm")){t.next=7;break}return t.next=3,fetch(e);case 3:return n=t.sent,t.next=6,n.arrayBuffer();case 6:return t.abrupt("return",t.sent);case 7:if(nu.b){t.next=20;break}if(t.prev=8,t.t0=Uu&&Uu.requireFromFile,!t.t0){t.next=14;break}return t.next=13,Uu.requireFromFile(e);case 13:t.t0=t.sent;case 14:return t.abrupt("return",t.t0);case 17:return t.prev=17,t.t1=t.catch(8),t.abrupt("return",null);case 20:if(!nu.d){t.next=22;break}return t.abrupt("return",importScripts(e));case 22:return t.next=24,fetch(e);case 24:return r=t.sent,t.next=27,r.text();case 27:return i=t.sent,t.abrupt("return",qu(i,e));case 29:case"end":return t.stop()}}),t,null,[[8,17]])})))).apply(this,arguments)}function qu(t,e){if(!nu.b)return Uu.requireFromString&&Uu.requireFromString(t,e);if(nu.d)return eval.call(nu.a,t),null;var n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch(e){n.text=t}return document.body.appendChild(n),null}function Qu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Zu(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qu(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Yu,$u="https://www.gstatic.com/draco/versioned/decoders/".concat("1.4.1","/draco_decoder.js"),tc="https://www.gstatic.com/draco/versioned/decoders/".concat("1.4.1","/draco_wasm_wrapper.js"),ec="https://www.gstatic.com/draco/versioned/decoders/".concat("1.4.1","/draco_decoder.wasm");"https://raw.githubusercontent.com/google/draco/".concat("1.4.1","/javascript/draco_encoder.js");function nc(t){return rc.apply(this,arguments)}function rc(){return(rc=br()(Sr.a.mark((function t(e){var n;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.modules||{},Yu=n.draco3d?Yu||n.draco3d.createDecoderModule({}).then((function(t){return{draco:t}})):Yu||ic(e),t.next=4,Yu;case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ic(t){return oc.apply(this,arguments)}function oc(){return(oc=br()(Sr.a.mark((function t(e){var n,r,i,o;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.draco&&e.draco.decoderType,t.next="js"===t.t0?3:(t.t0,7);break;case 3:return t.next=5,Vu($u,"draco",e);case 5:return n=t.sent,t.abrupt("break",21);case 7:return t.t1=Promise,t.next=10,Vu(tc,"draco",e);case 10:return t.t2=t.sent,t.next=13,Vu(ec,"draco",e);case 13:return t.t3=t.sent,t.t4=[t.t2,t.t3],t.next=17,t.t1.all.call(t.t1,t.t4);case 17:i=t.sent,o=yr()(i,2),n=o[0],r=o[1];case 21:return n=n||globalThis.DracoDecoderModule,t.next=24,ac(n,r);case 24:return t.abrupt("return",t.sent);case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ac(t,e){var n={};return e&&(n.wasmBinary=e),new Promise((function(e){t(Zu(Zu({},n),{},{onModuleLoaded:function(t){return e({draco:t})}}))}))}function sc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function uc(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?sc(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}nu.b;var cc=uc(uc({},iu),{},{parse:function(t,e){return lc.apply(this,arguments)}});function lc(){return(lc=br()(Sr.a.mark((function t(e,n){var r,i,o;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,nc(n);case 2:return r=t.sent,i=r.draco,o=new Nu(i),t.prev=5,t.abrupt("return",o.parseSync(e,null==n?void 0:n.draco));case 7:return t.prev=7,o.destroy(),t.finish(7);case 10:case"end":return t.stop()}}),t,null,[[5,,7,10]])})))).apply(this,arguments)}var fc,hc=(fc={},_r()(fc,5130,Float64Array),_r()(fc,5126,Float32Array),_r()(fc,5123,Uint16Array),_r()(fc,5125,Uint32Array),_r()(fc,5121,Uint8Array),_r()(fc,5120,Int8Array),_r()(fc,5122,Int16Array),_r()(fc,5124,Int32Array),fc),dc={DOUBLE:5130,FLOAT:5126,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,UNSIGNED_BYTE:5121,BYTE:5120,SHORT:5122,INT:5124},pc=function(){function t(){wr()(this,t)}return Cr()(t,null,[{key:"fromTypedArray",value:function(t){for(var e in t=ArrayBuffer.isView(t)?t.constructor:t,hc){if(hc[e]===t)return e}throw new Error("Failed to convert GL type")}},{key:"fromName",value:function(t){var e=dc[t];if(!e)throw new Error("Failed to convert GL type");return e}},{key:"getArrayType",value:function(t){switch(t){case 33635:case 32819:case 32820:return Uint16Array;default:var e=hc[t];if(!e)throw new Error("Failed to convert GL type");return e}}},{key:"getByteSize",value:function(e){return t.getArrayType(e).BYTES_PER_ELEMENT}},{key:"validate",value:function(e){return Boolean(t.getArrayType(e))}},{key:"createTypedArray",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;void 0===i&&(i=(n.byteLength-r)/t.getByteSize(e));var o=t.getArrayType(e);return new o(n,r,i)}}]),t}(),vc=function(){function t(e,n){wr()(this,t),Object(Br.a)(this,"json",void 0),Object(Br.a)(this,"buffer",void 0),Object(Br.a)(this,"featuresLength",0),Object(Br.a)(this,"_cachedTypedArrays",{}),this.json=e,this.buffer=n}return Cr()(t,[{key:"getExtension",value:function(t){return this.json.extensions&&this.json.extensions[t]}},{key:"hasProperty",value:function(t){return Boolean(this.json[t])}},{key:"getGlobalProperty",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5125,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=this.json[t];return r&&Number.isFinite(r.byteOffset)?this._getTypedArrayFromBinary(t,e,n,1,r.byteOffset):r}},{key:"getPropertyArray",value:function(t,e,n){var r=this.json[t];return r&&Number.isFinite(r.byteOffset)?("componentType"in r&&(e=pc.fromName(r.componentType)),this._getTypedArrayFromBinary(t,e,n,this.featuresLength,r.byteOffset)):this._getTypedArrayFromArray(t,e,r)}},{key:"getProperty",value:function(t,e,n,r,i){var o=this.json[t];if(!o)return o;var a=this.getPropertyArray(t,e,n);if(1===n)return a[r];for(var s=0;s<n;++s)i[s]=a[n*r+s];return i}},{key:"_getTypedArrayFromBinary",value:function(t,e,n,r,i){var o=this._cachedTypedArrays,a=o[t];return a||(a=pc.createTypedArray(e,this.buffer.buffer,this.buffer.byteOffset+i,r*n),o[t]=a),a}},{key:"_getTypedArrayFromArray",value:function(t,e,n){var r=this._cachedTypedArrays,i=r[t];return i||(i=pc.createTypedArray(e,n),r[t]=i),i}}]),t}(),gc={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},yc={SCALAR:function(t,e){return t[e]},VEC2:function(t,e){return[t[2*e+0],t[2*e+1]]},VEC3:function(t,e){return[t[3*e+0],t[3*e+1],t[3*e+2]]},VEC4:function(t,e){return[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]]},MAT2:function(t,e){return[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]]},MAT3:function(t,e){return[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]]},MAT4:function(t,e){return[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]}},mc={SCALAR:function(t,e,n){e[n]=t},VEC2:function(t,e,n){e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:function(t,e,n){e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:function(t,e,n){e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:function(t,e,n){e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:function(t,e,n){e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:function(t,e,n){e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}};var bc=function(t){return void 0!==t};function Ac(t,e,n){if(!e)return null;var r=t.getExtension("3DTILES_batch_table_hierarchy"),i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?function(t,e){var n,r,i,o,a=t.instancesLength,s=t.classes,u=t.classIds,c=t.parentCounts,l=t.parentIds,f=a;bc(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,5123),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),u=i.createArrayBufferView(e.buffer,e.byteOffset+u.byteOffset,a));if(bc(c))for(bc(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,5123),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,a)),o=new Uint16Array(a),f=0,n=0;n<a;++n)o[n]=f,f+=c[n];bc(l)&&bc(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,5123),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),l=i.createArrayBufferView(e.buffer,e.byteOffset+l.byteOffset,f));var h=s.length;for(n=0;n<h;++n){var d=s[n].length,p=s[n].instances,v=getBinaryProperties(d,p,e);s[n].instances=combine(v,p)}var g=new Array(h).fill(0),y=new Uint16Array(a);for(n=0;n<a;++n)r=u[n],y[n]=g[r],++g[r];var m={classes:s,classIds:u,classIndexes:y,parentCounts:c,parentIndexes:o,parentIds:l};return function(t){for(var e=t.classIds.length,n=0;n<e;++n)Oc(t,n,stack)}(m),m}(r,n):null}function _c(t,e,n){if(t){var r=t.parentCounts;return t.parentIds?n(t,e):r>0?function(t,e,n){var r=t.classIds,i=t.parentCounts,o=t.parentIds,a=t.parentIndexes,s=r.length,u=scratchVisited;u.length=Math.max(u.length,s);var c=++marker,l=scratchStack;l.length=0,l.push(e);for(;l.length>0;)if(e=l.pop(),u[e]!==c){u[e]=c;var f=n(t,e);if(bc(f))return f;for(var h=i[e],d=a[e],p=0;p<h;++p){var v=o[d+p];v!==e&&l.push(v)}}return null}(t,e,n):function(t,e,n){var r=!0;for(;r;){var i=n(t,e);if(bc(i))return i;var o=t.parentIds[e];r=o!==e,e=o}throw new Error("traverseHierarchySingleParent")}(t,e,n)}}function Oc(t,e,n){var r=t.parentCounts,i=t.parentIds,o=t.parentIndexes,a=t.classIds.length;if(bc(i)){assert(e<a,"Parent index ".concat(e," exceeds the total number of instances: ").concat(a)),assert(-1===n.indexOf(e),"Circular dependency detected in the batch table hierarchy."),n.push(e);for(var s=bc(r)?r[e]:1,u=bc(r)?o[e]:e,c=0;c<s;++c){var l=i[u+c];l!==e&&Oc(t,l,n)}n.pop(e)}}function wc(t){return null!=t}var xc=function(t,e){return t},Cc={HIERARCHY:!0,extensions:!0,extras:!0},Pc=function(){function t(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};for(var a in wr()(this,t),Object(Br.a)(this,"json",void 0),Object(Br.a)(this,"binary",void 0),Object(Br.a)(this,"featureCount",void 0),Object(Br.a)(this,"_extensions",void 0),Object(Br.a)(this,"_properties",void 0),Object(Br.a)(this,"_binaryProperties",void 0),Object(Br.a)(this,"_hierarchy",void 0),Object(mo.a)(r>=0),this.json=e||{},this.binary=n,this.featureCount=r,this._extensions=(null===(i=this.json)||void 0===i?void 0:i.extensions)||{},this._properties={},this.json)Cc[a]||(this._properties[a]=this.json[a]);this._binaryProperties=this._initializeBinaryProperties(),o["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=Ac(this,this.json,this.binary))}return Cr()(t,[{key:"getExtension",value:function(t){return this.json&&this.json.extensions&&this.json.extensions[t]}},{key:"memorySizeInBytes",value:function(){return 0}},{key:"isClass",value:function(t,e){return this._checkBatchId(t),Object(mo.a)("string"==typeof e,e),!!this._hierarchy&&wc(_c(this._hierarchy,t,(function(t,n){var r=t.classIds[n];return t.classes[r].name===e})))}},{key:"isExactClass",value:function(t,e){return Object(mo.a)("string"==typeof e,e),this.getExactClassName(t)===e}},{key:"getExactClassName",value:function(t){if(this._checkBatchId(t),this._hierarchy){var e=this._hierarchy.classIds[t];return this._hierarchy.classes[e].name}}},{key:"hasProperty",value:function(t,e){return this._checkBatchId(t),Object(mo.a)("string"==typeof e,e),wc(this._properties[e])||this._hasPropertyInHierarchy(t,e)}},{key:"getPropertyNames",value:function(t,e){var n;this._checkBatchId(t),(e=wc(e)?e:[]).length=0;var r=Object.keys(this._properties);return(n=e).push.apply(n,Fr()(r)),this._hierarchy&&this._getPropertyNamesInHierarchy(t,e),e}},{key:"getProperty",value:function(t,e){if(this._checkBatchId(t),Object(mo.a)("string"==typeof e,e),this._binaryProperties){var n=this._binaryProperties[e];if(wc(n))return this._getBinaryProperty(n,t)}var r=this._properties[e];if(wc(r))return xc(r[t]);if(this._hierarchy){var i=this._getHierarchyProperty(t,e);if(wc(i))return i}}},{key:"setProperty",value:function(t,e,n){var r=this.featureCount;if(this._checkBatchId(t),Object(mo.a)("string"==typeof e,e),this._binaryProperties){var i=this._binaryProperties[e];if(i)return void this._setBinaryProperty(i,t,n)}if(!this._hierarchy||!this._setHierarchyProperty(this,t,e,n)){var o=this._properties[e];wc(o)||(this._properties[e]=new Array(r),o=this._properties[e]),o[t]=xc(n)}}},{key:"_checkBatchId",value:function(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}},{key:"_getBinaryProperty",value:function(t,e){return t.unpack(t.typedArray,e)}},{key:"_setBinaryProperty",value:function(t,e,n){t.pack(n,t.typedArray,e)}},{key:"_initializeBinaryProperties",value:function(){var t=null;for(var e in this._properties){var n=this._properties[e],r=this._initializeBinaryProperty(e,n);r&&((t=t||{})[e]=r)}return t}},{key:"_initializeBinaryProperty",value:function(t,e){if("byteOffset"in e){var n=e;Object(mo.a)(this.binary,"Property ".concat(t," requires a batch table binary.")),Object(mo.a)(n.type,"Property ".concat(t," requires a type."));var r=function(t,e,n,r){var i=t.componentType;Object(mo.a)(t.componentType);var o="string"==typeof i?pc.fromName(i):i,a=gc[t.type],s=yc[t.type],u=mc[t.type];return n+=t.byteOffset,{values:pc.createTypedArray(o,e,n,a*r),type:o,size:a,unpacker:s,packer:u}}(n,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:r.values,componentCount:r.size,unpack:r.unpacker,pack:r.packer}}return null}},{key:"_hasPropertyInHierarchy",value:function(t,e){if(!this._hierarchy)return!1;var n=_c(this._hierarchy,t,(function(t,n){var r=t.classIds[n];return wc(t.classes[r].instances[e])}));return wc(n)}},{key:"_getPropertyNamesInHierarchy",value:function(t,e){_c(this._hierarchy,t,(function(t,n){var r=t.classIds[n],i=t.classes[r].instances;for(var o in i)i.hasOwnProperty(o)&&-1===e.indexOf(o)&&e.push(o)}))}},{key:"_getHierarchyProperty",value:function(t,e){var n=this;return _c(this._hierarchy,t,(function(t,r){var i=t.classIds[r],o=t.classes[i],a=t.classIndexes[r],s=o.instances[e];return wc(s)?wc(s.typedArray)?n._getBinaryProperty(s,a):xc(s[a]):null}))}},{key:"_setHierarchyProperty",value:function(t,e,n,r){var i=this,o=_c(this._hierarchy,e,(function(t,o){var a=t.classIds[o],s=t.classes[a],u=t.classIndexes[o],c=s.instances[n];return!!wc(c)&&(Object(mo.a)(o===e,'Inherited property "'.concat(n,'" is read-only.')),wc(c.typedArray)?i._setBinaryProperty(c,u,r):c[u]=xc(r),!0)}));return wc(o)}}]),t}();function Sc(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=4,t.version=r.getUint32(n,!0),n+=4,t.byteLength=r.getUint32(n,!0),n+=4,1!==t.version)throw new Error("3D Tile Version ".concat(t.version," not supported"));return n}function Bc(t,e,n){var r,i=new DataView(e);t.header=t.header||{};var o=i.getUint32(n,!0);n+=4;var a=i.getUint32(n,!0);n+=4;var s=i.getUint32(n,!0);n+=4;var u=i.getUint32(n,!0);return n+=4,s>=570425344?(n-=8,r=o,s=a,u=0,o=0,a=0,console.warn("b3dm tile in legacy format.")):u>=570425344&&(n-=4,r=s,s=o,u=a,o=0,a=0,console.warn("b3dm tile in legacy format.")),t.header.featureTableJsonByteLength=o,t.header.featureTableBinaryByteLength=a,t.header.batchTableJsonByteLength=s,t.header.batchTableBinaryByteLength=u,t.header.batchLength=r,n}function kc(t,e,n,r){return n=function(t,e,n,r){var i=t.header,o=i.featureTableJsonByteLength,a=i.featureTableBinaryByteLength,s=i.batchLength;if(t.featureTableJson={BATCH_LENGTH:s||0},o>0){var u=tu(e,n,o);t.featureTableJson=JSON.parse(u)}return n+=o,t.featureTableBinary=new Uint8Array(e,n,a),n+=a}(t,e,n),n=function(t,e,n,r){var i=t.header,o=i.batchTableJsonByteLength,a=i.batchTableBinaryByteLength;if(o>0){var s=tu(e,n,o);t.batchTableJson=JSON.parse(s),n+=o,a>0&&(t.batchTableBinary=new Uint8Array(e,n,a),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=a)}return n}(t,e,n)}function Ec(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=t>>11&31,r=t>>5&63,i=31&t;return e[0]=n<<3,e[1]=r<<2,e[2]=i<<3,e}function Tc(t,e,n){if(!(e||t&&t.batchIds&&n))return null;var r=t.batchIds,i=t.isRGB565,o=t.pointCount;if(r&&n){for(var a=new Uint8ClampedArray(3*o),s=0;s<o;s++){var u=r[s],c=n.getProperty(u,"dimensions").map((function(t){return 255*t}));a[3*s]=c[0],a[3*s+1]=c[1],a[3*s+2]=c[2]}return{type:5121,value:a,size:3,normalized:!0}}if(i){for(var l=new Uint8ClampedArray(3*o),f=0;f<o;f++){var h=Ec(e[f]);l[3*f]=h[0],l[3*f+1]=h[1],l[3*f+2]=h[2]}return{type:5121,value:l,size:3,normalized:!0}}return e&&e.length===3*o?{type:5121,value:e,size:3,normalized:!0}:{type:5121,value:e,size:4,normalized:!0}}function jc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ir()(t);if(e){var i=Ir()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jr()(this,n)}}var Mc=function(t){Er()(n,t);var e=jc(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return wr()(this,n),t=e.call(this,2),Jr(r)&&1===arguments.length?t.copy(r):(zr.debug&&($r(r),$r(i)),t[0]=r,t[1]=i),t}return Cr()(n,[{key:"set",value:function(t,e){return this[0]=t,this[1]=e,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this.check()}},{key:"fromObject",value:function(t){return zr.debug&&($r(t.x),$r(t.y)),this[0]=t.x,this[1]=t.y,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t}},{key:"ELEMENTS",get:function(){return 2}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return gi(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return si(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return vi(this,this,t),this.check()}},{key:"transformByMatrix2x3",value:function(t){return function(t,e,n){var r=e[0],i=e[1];t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5]}(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){return function(t,e,n){var r=e[0],i=e[1];t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i}(this,this,t),this.check()}}]),n}(Li);function Ic(t,e){if(!t)throw new Error("math.gl assertion failed. ".concat(e))}new Mc,new Ui,new Mc,new Mc,new Uint8Array(1);function Rc(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;return Qr(t,0,e)/e*2-1}function Dc(t){return t<0?-1:1}function Lc(t,e,n,r){if(Ic(r),t<0||t>n||e<0||e>n)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(n));if(r.x=Rc(t,n),r.y=Rc(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){var i=r.x;r.x=(1-Math.abs(r.y))*Dc(i),r.y=(1-Math.abs(i))*Dc(r.y)}return r.normalize()}function Fc(t,e,n){return Lc(t,e,255,n)}var Gc=new Ui;function Nc(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,function(t,e){for(var n=new Ui,r=new Float32Array(3*t.pointCount),i=0;i<t.pointCount;i++)n.set(e[3*i],e[3*i+1],e[3*i+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,3*i);return r}(t,e)):{type:5123,value:e,size:3,normalized:!0}:e}function Uc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function zc(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Uc(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Uc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Hc(t,e,n,r,i){return Vc.apply(this,arguments)}function Vc(){return(Vc=br()(Sr.a.mark((function t(e,n,r,i,o){var a,s,u;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Sc(e,n,r),r=Bc(e,n,r),r=kc(e,n,r),Jc(e),a=Wc(e),s=a.featureTable,u=a.batchTable,t.next=7,Qc(e,s,u,i,o);case 7:return Kc(e,s,i),Xc(e,s,u),qc(e,s),t.abrupt("return",r);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Jc(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}function Wc(t){var e=new vc(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",5126,3);var r=function(t,e){var n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",5123,1),t.batchIds)){var r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");var i=t.batchTableJson,o=t.batchTableBinary;n=new Pc(i,o,r)}return n}(t,e);return{featureTable:e,batchTable:r}}function Kc(t,e,n){if(!t.attributes.positions)if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",5126,3);else if(e.hasProperty("POSITION_QUANTIZED")){var r=e.getPropertyArray("POSITION_QUANTIZED",5123,3);if(t.isQuantized=!0,t.quantizedRange=65535,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",5126,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",5126,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=Nc(t,r,n)}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function Xc(t,e,n){if(!t.attributes.colors){var r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",5121,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",5121,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",5123,1),t.isRGB565=!0),t.attributes.colors=Tc(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",5121,4))}function qc(t,e){if(!t.attributes.normals){var n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",5126,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",5121,2),t.isOctEncoded16P=!0),t.attributes.normals=function(t,e){if(!e)return null;if(t.isOctEncoded16P){for(var n=new Float32Array(3*t.pointsLength),r=0;r<t.pointsLength;r++)Fc(e[2*r],e[2*r+1],Gc),Gc.toArray(n,3*r);return{type:5126,size:2,value:n}}return{type:5126,size:2,value:e}}(t,n)}}function Qc(t,e,n,r,i){return Zc.apply(this,arguments)}function Zc(){return(Zc=br()(Sr.a.mark((function t(e,n,r,i,o){var a,s,u,c,l,f,h,d;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((c=e.batchTableJson&&e.batchTableJson.extensions&&e.batchTableJson.extensions["3DTILES_draco_point_compression"])&&(u=c.properties),!(l=n.getExtension("3DTILES_draco_point_compression"))){t.next=15;break}if(s=l.properties,f=l.byteOffset,h=l.byteLength,s&&Number.isFinite(f)&&h){t.next=9;break}throw new Error("Draco properties, byteOffset, and byteLength must be defined");case 9:a=e.featureTableBinary.slice(f,f+h),e.hasPositions=Number.isFinite(s.POSITION),e.hasColors=Number.isFinite(s.RGB)||Number.isFinite(s.RGBA),e.hasNormals=Number.isFinite(s.NORMAL),e.hasBatchIds=Number.isFinite(s.BATCH_ID),e.isTranslucent=Number.isFinite(s.RGBA);case 15:if(a){t.next=17;break}return t.abrupt("return",!0);case 17:return d={buffer:a,properties:zc(zc({},s),u),featureTableProperties:s,batchTableProperties:u,dequantizeInShader:!1},t.next=20,Yc(e,d,i,o);case 20:return t.abrupt("return",t.sent);case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Yc(t,e,n,r){return $c.apply(this,arguments)}function $c(){return($c=br()(Sr.a.mark((function t(e,n,r,i){var o,a,s,u,c,l,f,h,d,p,v,g,y,m,b;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=i.parse,delete(a=zc(zc({},r),{},{draco:zc(zc({},r.draco),{},{extraAttributes:n.batchTableProperties||{}})}))["3d-tiles"],t.next=5,o(n.buffer,cc,a);case 5:if(s=t.sent,u=s.attributes.POSITION&&s.attributes.POSITION.value,c=s.attributes.COLOR_0&&s.attributes.COLOR_0.value,l=s.attributes.NORMAL&&s.attributes.NORMAL.value,f=s.attributes.BATCH_ID&&s.attributes.BATCH_ID.value,h=u&&s.attributes.POSITION.value.quantization,d=l&&s.attributes.NORMAL.value.quantization,h&&(p=s.POSITION.data.quantization,v=p.range,e.quantizedVolumeScale=new Ui(v,v,v),e.quantizedVolumeOffset=new Ui(p.minValues),e.quantizedRange=(1<<p.quantizationBits)-1,e.isQuantizedDraco=!0),d&&(e.octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,e.isOctEncodedDraco=!0),g={},n.batchTableProperties)for(y=0,m=Object.keys(n.batchTableProperties);y<m.length;y++)b=m[y],s.attributes[b]&&s.attributes[b].value&&(g[b.toLowerCase()]=s.attributes[b].value);e.attributes=zc({positions:u,colors:Tc(e,c,void 0),normals:l,batchIds:f},g);case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var tl,el,nl="https://unpkg.com/@loaders.gl/textures@".concat("3.3.0-alpha.5","/dist/libs/basis_encoder.wasm"),rl="https://unpkg.com/@loaders.gl/textures@".concat("3.3.0-alpha.5","/dist/libs/basis_encoder.js");function il(t){return ol.apply(this,arguments)}function ol(){return(ol=br()(Sr.a.mark((function t(e){var n;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.modules||{}).basis){t.next=3;break}return t.abrupt("return",n.basis);case 3:return tl=tl||al(e),t.next=6,tl;case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function al(t){return sl.apply(this,arguments)}function sl(){return(sl=br()(Sr.a.mark((function t(e){var n,r,i,o;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=null,r=null,t.t0=Promise,t.next=5,Vu("basis_transcoder.js","textures",e);case 5:return t.t1=t.sent,t.next=8,Vu("basis_transcoder.wasm","textures",e);case 8:return t.t2=t.sent,t.t3=[t.t1,t.t2],t.next=12,t.t0.all.call(t.t0,t.t3);case 12:return i=t.sent,o=yr()(i,2),n=o[0],r=o[1],n=n||globalThis.BASIS,t.next=19,ul(n,r);case 19:return t.abrupt("return",t.sent);case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ul(t,e){var n={};return e&&(n.wasmBinary=e),new Promise((function(e){t(n).then((function(t){var n=t.BasisFile;(0,t.initializeBasis)(),e({BasisFile:n})}))}))}function cl(t){return ll.apply(this,arguments)}function ll(){return(ll=br()(Sr.a.mark((function t(e){var n;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.modules||{}).basisEncoder){t.next=3;break}return t.abrupt("return",n.basisEncoder);case 3:return el=el||fl(e),t.next=6,el;case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function fl(t){return hl.apply(this,arguments)}function hl(){return(hl=br()(Sr.a.mark((function t(e){var n,r,i,o;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=null,r=null,t.t0=Promise,t.next=5,Vu(rl,"textures",e);case 5:return t.t1=t.sent,t.next=8,Vu(nl,"textures",e);case 8:return t.t2=t.sent,t.t3=[t.t1,t.t2],t.next=12,t.t0.all.call(t.t0,t.t3);case 12:return i=t.sent,o=yr()(i,2),n=o[0],r=o[1],n=n||globalThis.BASIS,t.next=19,dl(n,r);case 19:return t.abrupt("return",t.sent);case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function dl(t,e){var n={};return e&&(n.wasmBinary=e),new Promise((function(e){t(n).then((function(t){var n=t.BasisFile,r=t.KTX2File,i=t.initializeBasis,o=t.BasisEncoder;i(),e({BasisFile:n,KTX2File:r,BasisEncoder:o})}))}))}var pl={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919};function vl(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return gl(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gl(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function gl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var yl=["","WEBKIT_","MOZ_"],ml={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"},bl=null;function Al(t){if(!bl){t=t||function(){try{return document.createElement("canvas").getContext("webgl")}catch(t){return null}}()||void 0,bl=new Set;var e,n=vl(yl);try{for(n.s();!(e=n.n()).done;){var r=e.value;for(var i in ml)if(t&&t.getExtension("".concat(r).concat(i))){var o=ml[i];bl.add(o)}}}catch(t){n.e(t)}finally{n.f()}}return bl}new Uint8Array([0]);var _l,Ol,wl,xl,Cl,Pl,Sl,Bl,kl;(kl=_l||(_l={}))[kl.NONE=0]="NONE",kl[kl.BASISLZ=1]="BASISLZ",kl[kl.ZSTD=2]="ZSTD",kl[kl.ZLIB=3]="ZLIB",function(t){t[t.BASICFORMAT=0]="BASICFORMAT"}(Ol||(Ol={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ETC1S=163]="ETC1S",t[t.UASTC=166]="UASTC"}(wl||(wl={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SRGB=1]="SRGB"}(xl||(xl={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LINEAR=1]="LINEAR",t[t.SRGB=2]="SRGB",t[t.ITU=3]="ITU",t[t.NTSC=4]="NTSC",t[t.SLOG=5]="SLOG",t[t.SLOG2=6]="SLOG2"}(Cl||(Cl={})),function(t){t[t.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",t[t.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(Pl||(Pl={})),function(t){t[t.RGB=0]="RGB",t[t.RRR=3]="RRR",t[t.GGG=4]="GGG",t[t.AAA=15]="AAA"}(Sl||(Sl={})),function(t){t[t.RGB=0]="RGB",t[t.RGBA=3]="RGBA",t[t.RRR=4]="RRR",t[t.RRRG=5]="RRRG"}(Bl||(Bl={}));var El=[171,75,84,88,32,50,48,187,13,10,26,10];function Tl(t){var e=new Uint8Array(t);return!(e.byteLength<El.length||e[0]!==El[0]||e[1]!==El[1]||e[2]!==El[2]||e[3]!==El[3]||e[4]!==El[4]||e[5]!==El[5]||e[6]!==El[6]||e[7]!==El[7]||e[8]!==El[8]||e[9]!==El[9]||e[10]!==El[10]||e[11]!==El[11])}var jl={etc1:{basisFormat:0,compressed:!0,format:pl.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:pl.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:pl.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:pl.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:pl.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:pl.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};function Ml(){return(Ml=br()(Sr.a.mark((function t(e,n){var r,i,o,a,s,u;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("auto"!==n.basis.containerFormat){t.next=11;break}if(!Tl(e)){t.next=6;break}return t.next=4,cl(n);case 4:return r=t.sent,t.abrupt("return",Dl(r.KTX2File,e,n));case 6:return t.next=8,il(n);case 8:return i=t.sent,o=i.BasisFile,t.abrupt("return",Il(o,e,n));case 11:t.t0=n.basis.module,t.next="encoder"===t.t0?14:(t.t0,22);break;case 14:return t.next=16,cl(n);case 16:a=t.sent,t.t1=n.basis.containerFormat,t.next="ktx2"===t.t1?20:(t.t1,21);break;case 20:return t.abrupt("return",Dl(a.KTX2File,e,n));case 21:return t.abrupt("return",Il(a.BasisFile,e,n));case 22:return t.next=24,il(n);case 24:return s=t.sent,u=s.BasisFile,t.abrupt("return",Il(u,e,n));case 27:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Il(t,e,n){var r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");for(var i=r.getNumImages(),o=[],a=0;a<i;a++){for(var s=r.getNumLevels(a),u=[],c=0;c<s;c++)u.push(Rl(r,a,c,n));o.push(u)}return o}finally{r.close(),r.delete()}}function Rl(t,e,n,r){var i=t.getImageWidth(e,n),o=t.getImageHeight(e,n),a=t.getHasAlpha(),s=Fl(r,a),u=s.compressed,c=s.format,l=s.basisFormat,f=t.getImageTranscodedSizeInBytes(e,n,l),h=new Uint8Array(f);if(!t.transcodeImage(h,e,n,l,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:o,data:h,compressed:u,format:c,hasAlpha:a}}function Dl(t,e,n){var r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");for(var i=r.getLevels(),o=[],a=0;a<i;a++){o.push(Ll(r,a,n));break}return[o]}finally{r.close(),r.delete()}}function Ll(t,e,n){var r=t.getImageLevelInfo(e,0,0),i=r.alphaFlag,o=r.height,a=r.width,s=Fl(n,i),u=s.compressed,c=s.format,l=s.basisFormat,f=t.getImageTranscodedSizeInBytes(e,0,0,l),h=new Uint8Array(f);if(!t.transcodeImage(h,e,0,0,l,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:a,height:o,data:h,compressed:u,hasAlpha:i,format:c}}function Fl(t,e){var n=t&&t.basis&&t.basis.format;return"auto"===n&&(n=Gl()),"object"===Dr()(n)&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),jl[n]}function Gl(){var t=Al();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}function Nl(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ul(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nl(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nl(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var zl={name:"Basis",id:nu.b?"basis":"basis-nodejs",module:"textures",version:"3.3.0-alpha.5",worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},Hl=Ul(Ul({},zl),{},{parse:function(t,e){return Ml.apply(this,arguments)}}),Vl=n(93),Jl=globalThis._parseImageNode,Wl="undefined"!=typeof Image,Kl="undefined"!=typeof ImageBitmap,Xl=Boolean(Jl),ql=!!Vl.c||Xl;function Ql(t){var e=Yl(t);if(!e)throw new Error("Not an image");return e}function Zl(t){switch(Ql(t)){case"data":return t;case"image":case"imagebitmap":var e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function Yl(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"===Dr()(t)&&t.data&&t.width&&t.height?"data":null}var $l=/^data:image\/svg\+xml/,tf=/\.svg((\?|#).*)?$/;function ef(t){return t&&($l.test(t)||tf.test(t))}function nf(t,e){if(ef(e)){var n=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(n=unescape(encodeURIComponent(n)))}catch(t){throw new Error(t.message)}return"data:image/svg+xml;base64,".concat(btoa(n))}return rf(t,e)}function rf(t,e){if(ef(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}function of(t,e,n){return af.apply(this,arguments)}function af(){return(af=br()(Sr.a.mark((function t(e,n,r){var i,o,a;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=nf(e,r),o=self.URL||self.webkitURL,a="string"!=typeof i&&o.createObjectURL(i),t.prev=3,t.next=6,sf(a||i,n);case 6:return t.abrupt("return",t.sent);case 7:return t.prev=7,a&&o.revokeObjectURL(a),t.finish(7);case 10:case"end":return t.stop()}}),t,null,[[3,,7,10]])})))).apply(this,arguments)}function sf(t,e){return uf.apply(this,arguments)}function uf(){return(uf=br()(Sr.a.mark((function t(e,n){var r;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=new Image).src=e,!(n.image&&n.image.decode&&r.decode)){t.next=6;break}return t.next=5,r.decode();case 5:return t.abrupt("return",r);case 6:return t.next=8,new Promise((function(t,n){try{r.onload=function(){return t(r)},r.onerror=function(t){return n(new Error("Could not load image ".concat(e,": ").concat(t)))}}catch(t){n(t)}}));case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var cf={},lf=!0;function ff(t,e,n){return hf.apply(this,arguments)}function hf(){return(hf=br()(Sr.a.mark((function t(e,n,r){var i,o,a;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!ef(r)){t.next=7;break}return t.next=3,of(e,n,r);case 3:o=t.sent,i=o,t.next=8;break;case 7:i=rf(e,r);case 8:return a=n&&n.imagebitmap,t.next=11,df(i,a);case 11:return t.abrupt("return",t.sent);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function df(t){return pf.apply(this,arguments)}function pf(){return(pf=br()(Sr.a.mark((function t(e){var n,r=arguments;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!vf(n=r.length>1&&void 0!==r[1]?r[1]:null)&&lf||(n=null),!n){t.next=13;break}return t.prev=3,t.next=6,createImageBitmap(e,n);case 6:return t.abrupt("return",t.sent);case 9:t.prev=9,t.t0=t.catch(3),console.warn(t.t0),lf=!1;case 13:return t.next=15,createImageBitmap(e);case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t,null,[[3,9]])})))).apply(this,arguments)}function vf(t){for(var e in t||cf)return!1;return!0}function gf(t){var e=yf(t);return function(t){var e=yf(t);if(!(e.byteLength>=24&&2303741511===e.getUint32(0,!1)))return null;return{mimeType:"image/png",width:e.getUint32(16,!1),height:e.getUint32(20,!1)}}(e)||function(t){var e=yf(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,!1)&&255===e.getUint8(2)))return null;var n=function(){for(var t=new Set([65499,65476,65484,65501,65534]),e=65504;e<65520;++e)t.add(e);var n=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:n}}(),r=n.tableMarkers,i=n.sofMarkers,o=2;for(;o+9<e.byteLength;){var a=e.getUint16(o,!1);if(i.has(a))return{mimeType:"image/jpeg",height:e.getUint16(o+5,!1),width:e.getUint16(o+7,!1)};if(!r.has(a))return null;o+=2,o+=e.getUint16(o,!1)}return null}(e)||function(t){var e=yf(t);if(!(e.byteLength>=10&&1195984440===e.getUint32(0,!1)))return null;return{mimeType:"image/gif",width:e.getUint16(6,!0),height:e.getUint16(8,!0)}}(e)||function(t){var e=yf(t);if(!(e.byteLength>=14&&16973===e.getUint16(0,!1)&&e.getUint32(2,!0)===e.byteLength))return null;return{mimeType:"image/bmp",width:e.getUint32(18,!0),height:e.getUint32(22,!0)}}(e)}function yf(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}function mf(t,e){return bf.apply(this,arguments)}function bf(){return(bf=br()(Sr.a.mark((function t(e,n){var r,i,o;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=gf(e)||{},i=r.mimeType,o=globalThis._parseImageNode,Object(mo.a)(o),t.next=5,o(e,i);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Af(){return(Af=br()(Sr.a.mark((function t(e,n,r){var i,o,a,s,u;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=(n=n||{}).image||{},o=i.type||"auto",a=(r||{}).url,s=_f(o),t.t0=s,t.next="imagebitmap"===t.t0?8:"image"===t.t0?12:"data"===t.t0?16:20;break;case 8:return t.next=10,ff(e,n,a);case 10:return u=t.sent,t.abrupt("break",21);case 12:return t.next=14,of(e,n,a);case 14:return u=t.sent,t.abrupt("break",21);case 16:return t.next=18,mf(e,n);case 18:return u=t.sent,t.abrupt("break",21);case 20:Object(mo.a)(!1);case 21:return"data"===o&&(u=Zl(u)),t.abrupt("return",u);case 23:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _f(t){switch(t){case"auto":case"data":return function(){if(Kl)return"imagebitmap";if(Wl)return"image";if(ql)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return Kl||Wl||ql;case"imagebitmap":return Kl;case"image":return Wl;case"data":return ql;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}(t),t}}var Of={id:"image",module:"images",name:"Images",version:"3.3.0-alpha.5",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(t,e,n){return Af.apply(this,arguments)},tests:[function(t){return Boolean(gf(new DataView(t)))}],options:{image:{type:"auto",decode:!0}}},wf=n(238),xf=n(109);function Cf(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function Pf(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;var n=e.baseUri||e.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url ".concat(t));return n.substr(0,n.lastIndexOf("/")+1)+t}function Sf(t,e,n){var r=t.bufferViews[n];Cf(r);var i=e[r.buffer];Cf(i);var o=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,o,r.byteLength)}var Bf=n(162),kf=["SCALAR","VEC2","VEC3","VEC4"],Ef=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],Tf=new Map(Ef),jf={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Mf={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},If={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Rf(t){return kf[t-1]||kf[0]}function Df(t){var e=Tf.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function Lf(t,e){var n=If[t.componentType],r=jf[t.type],i=Mf[t.componentType],o=t.count*r,a=t.count*r*i;return Cf(a>=0&&a<=e.byteLength),{ArrayType:n,length:o,byteLength:a}}function Ff(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Gf(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gf(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Gf(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Nf(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Uf(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nf(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nf(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var zf,Hf={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]},Vf=function(){function t(e){wr()(this,t),Object(Br.a)(this,"gltf",void 0),Object(Br.a)(this,"sourceBuffers",void 0),Object(Br.a)(this,"byteLength",void 0),this.gltf=e||{json:Uf({},Hf),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}return Cr()(t,[{key:"json",get:function(){return this.gltf.json}},{key:"getApplicationData",value:function(t){return this.json[t]}},{key:"getExtraData",value:function(t){return(this.json.extras||{})[t]}},{key:"getExtension",value:function(t){var e=this.getUsedExtensions().find((function(e){return e===t})),n=this.json.extensions||{};return e?n[t]||!0:null}},{key:"getRequiredExtension",value:function(t){return this.getRequiredExtensions().find((function(e){return e===t}))?this.getExtension(t):null}},{key:"getRequiredExtensions",value:function(){return this.json.extensionsRequired||[]}},{key:"getUsedExtensions",value:function(){return this.json.extensionsUsed||[]}},{key:"getObjectExtension",value:function(t,e){return(t.extensions||{})[e]}},{key:"getScene",value:function(t){return this.getObject("scenes",t)}},{key:"getNode",value:function(t){return this.getObject("nodes",t)}},{key:"getSkin",value:function(t){return this.getObject("skins",t)}},{key:"getMesh",value:function(t){return this.getObject("meshes",t)}},{key:"getMaterial",value:function(t){return this.getObject("materials",t)}},{key:"getAccessor",value:function(t){return this.getObject("accessors",t)}},{key:"getTexture",value:function(t){return this.getObject("textures",t)}},{key:"getSampler",value:function(t){return this.getObject("samplers",t)}},{key:"getImage",value:function(t){return this.getObject("images",t)}},{key:"getBufferView",value:function(t){return this.getObject("bufferViews",t)}},{key:"getBuffer",value:function(t){return this.getObject("buffers",t)}},{key:"getObject",value:function(t,e){if("object"===Dr()(e))return e;var n=this.json[t]&&this.json[t][e];if(!n)throw new Error("glTF file error: Could not find ".concat(t,"[").concat(e,"]"));return n}},{key:"getTypedArrayForBufferView",value:function(t){var e=(t=this.getBufferView(t)).buffer,n=this.gltf.buffers[e];Cf(n);var r=(t.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,t.byteLength)}},{key:"getTypedArrayForAccessor",value:function(t){t=this.getAccessor(t);var e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,r=Lf(t,e),i=r.ArrayType,o=r.length;return new i(n,e.byteOffset+t.byteOffset,o)}},{key:"getTypedArrayForImageData",value:function(t){t=this.getAccessor(t);var e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,r=e.byteOffset||0;return new Uint8Array(n,r,e.byteLength)}},{key:"addApplicationData",value:function(t,e){return this.json[t]=e,this}},{key:"addExtraData",value:function(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}},{key:"addObjectExtension",value:function(t,e,n){return t.extensions=t.extensions||{},t.extensions[e]=n,this.registerUsedExtension(e),this}},{key:"setObjectExtension",value:function(t,e,n){(t.extensions||{})[e]=n}},{key:"removeObjectExtension",value:function(t,e){var n=t.extensions||{},r=n[e];return delete n[e],r}},{key:"addExtension",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Cf(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}},{key:"addRequiredExtension",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Cf(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}},{key:"registerUsedExtension",value:function(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((function(e){return e===t}))||this.json.extensionsUsed.push(t)}},{key:"registerRequiredExtension",value:function(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((function(e){return e===t}))||this.json.extensionsRequired.push(t)}},{key:"removeExtension",value:function(t){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t]}},{key:"setDefaultScene",value:function(t){this.json.scene=t}},{key:"addScene",value:function(t){var e=t.nodeIndices;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:e}),this.json.scenes.length-1}},{key:"addNode",value:function(t){var e=t.meshIndex,n=t.matrix;this.json.nodes=this.json.nodes||[];var r={mesh:e};return n&&(r.matrix=n),this.json.nodes.push(r),this.json.nodes.length-1}},{key:"addMesh",value:function(t){var e=t.attributes,n=t.indices,r=t.material,i=t.mode,o=void 0===i?4:i,a={primitives:[{attributes:this._addAttributes(e),mode:o}]};if(n){var s=this._addIndices(n);a.primitives[0].indices=s}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}},{key:"addPointCloud",value:function(t){var e={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(e),this.json.meshes.length-1}},{key:"addImage",value:function(t,e){var n=gf(t),r=e||(null==n?void 0:n.mimeType),i={bufferView:this.addBufferView(t),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1}},{key:"addBufferView",value:function(t){var e=t.byteLength;Cf(Number.isFinite(e)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);var n={buffer:0,byteOffset:this.byteLength,byteLength:e};return this.byteLength+=Object(Bf.b)(e,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}},{key:"addAccessor",value:function(t,e){var n={bufferView:t,type:Rf(e.size),componentType:e.componentType,count:e.count,max:e.max,min:e.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}},{key:"addBinaryBuffer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{size:3},n=this.addBufferView(t),r={min:e.min,max:e.max};r.min&&r.max||(r=this._getAccessorMinMax(t,e.size));var i={size:e.size,componentType:Df(t),count:Math.round(t.length/e.size),min:r.min,max:r.max};return this.addAccessor(n,Object.assign(i,e))}},{key:"addTexture",value:function(t){var e={source:t.imageIndex};return this.json.textures=this.json.textures||[],this.json.textures.push(e),this.json.textures.length-1}},{key:"addMaterial",value:function(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}},{key:"createBinaryChunk",value:function(){var t,e;this.gltf.buffers=[];var n,r=this.byteLength,i=new ArrayBuffer(r),o=new Uint8Array(i),a=0,s=Ff(this.sourceBuffers||[]);try{for(s.s();!(n=s.n()).done;){var u=n.value;a=Object(Bf.a)(u,o,a)}}catch(t){s.e(t)}finally{s.f()}null!==(t=this.json)&&void 0!==t&&null!==(e=t.buffers)&&void 0!==e&&e[0]?this.json.buffers[0].byteLength=r:this.json.buffers=[{byteLength:r}],this.gltf.binary=i,this.sourceBuffers=[i]}},{key:"_removeStringFromArray",value:function(t,e){for(var n=!0;n;){var r=t.indexOf(e);r>-1?t.splice(r,1):n=!1}}},{key:"_addAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={};for(var n in t){var r=t[n],i=this._getGltfAttributeName(n),o=this.addBinaryBuffer(r.value,r);e[i]=o}return e}},{key:"_addIndices",value:function(t){return this.addBinaryBuffer(t,{size:1})}},{key:"_getGltfAttributeName",value:function(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}},{key:"_getAccessorMinMax",value:function(t,e){var n={min:null,max:null};if(t.length<e)return n;n.min=[],n.max=[];var r,i=Ff(t.subarray(0,e));try{for(i.s();!(r=i.n()).done;){var o=r.value;n.min.push(o),n.max.push(o)}}catch(t){i.e(t)}finally{i.f()}for(var a=e;a<t.length;a+=e)for(var s=0;s<e;s++)n.min[0+s]=Math.min(n.min[0+s],t[a+s]),n.max[0+s]=Math.max(n.max[0+s],t[a+s]);return n}}]),t}(),Jf=("undefined"==typeof WebAssembly||Dr()(WebAssembly),"B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB"),Wf="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",Kf=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),Xf=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),qf={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Qf={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};function Zf(t,e,n,r,i){return Yf.apply(this,arguments)}function Yf(){return(Yf=br()(Sr.a.mark((function t(e,n,r,i,o){var a,s,u=arguments;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=u.length>5&&void 0!==u[5]?u[5]:"NONE",t.next=3,$f();case 3:ih(s=t.sent,s.exports[Qf[o]],e,n,r,i,s.exports[qf[a||"NONE"]]);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $f(){return th.apply(this,arguments)}function th(){return(th=br()(Sr.a.mark((function t(){return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return zf||(zf=eh()),t.abrupt("return",zf);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function eh(){return nh.apply(this,arguments)}function nh(){return(nh=br()(Sr.a.mark((function t(){var e,n;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Jf,WebAssembly.validate(Kf)&&(e=Wf,console.log("Warning: meshopt_decoder is using experimental SIMD support")),t.next=4,WebAssembly.instantiate(rh(e),{});case 4:return n=t.sent,t.next=7,n.instance.exports.__wasm_call_ctors();case 7:return t.abrupt("return",n.instance);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function rh(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;++n){var r=t.charCodeAt(n);e[n]=r>96?r-71:r>64?r-65:r>47?r+4:r>46?63:62}for(var i=0,o=0;o<t.length;++o)e[i++]=e[o]<60?Xf[e[o]]:64*(e[o]-60)+e[++o];return e.buffer.slice(0,i)}function ih(t,e,n,r,i,o,a){var s=t.exports.sbrk,u=r+3&-4,c=s(u*i),l=s(o.length),f=new Uint8Array(t.exports.memory.buffer);f.set(o,l);var h=e(c,r,i,l,o.length);if(0===h&&a&&a(c,u,i),n.set(f.subarray(c,c+r*i)),s(c-s(0)),0!==h)throw new Error("Malformed buffer data: ".concat(h))}function oh(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ah(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ah(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ah(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var sh="EXT_meshopt_compression";function uh(t,e){return ch.apply(this,arguments)}function ch(){return(ch=br()(Sr.a.mark((function t(e,n){var r,i,o,a,s,u;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=new Vf(e),null!=n&&null!==(r=n.gltf)&&void 0!==r&&r.decompressMeshes){t.next=3;break}return t.abrupt("return");case 3:o=[],a=oh(e.json.bufferViews||[]);try{for(a.s();!(s=a.n()).done;)u=s.value,o.push(lh(i,u))}catch(t){a.e(t)}finally{a.f()}return t.next=8,Promise.all(o);case 8:i.removeExtension("EXT_meshopt_compression");case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function lh(t,e){return fh.apply(this,arguments)}function fh(){return(fh=br()(Sr.a.mark((function t(e,n){var r,i,o,a,s,u,c,l,f,h,d,p,v,g;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=e.getObjectExtension(n,"EXT_meshopt_compression"))){t.next=9;break}return i=r.byteOffset,o=void 0===i?0:i,a=r.byteLength,s=void 0===a?0:a,u=r.byteStride,c=r.count,l=r.mode,f=r.filter,h=void 0===f?"NONE":f,d=r.buffer,p=e.gltf.buffers[d],v=new Uint8Array(p.arrayBuffer,p.byteOffset+o,s),g=new Uint8Array(e.gltf.buffers[n.buffer].arrayBuffer,n.byteOffset,n.byteLength),t.next=8,Zf(g,c,u,v,l,h);case 8:return t.abrupt("return",g);case 9:return t.abrupt("return",null);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var hh=["image/png","image/jpeg","image/gif"],dh={};function ph(t){return void 0===dh[t]&&(dh[t]=function(t){switch(t){case"image/webp":return function(){if(!Vl.c)return!1;try{return 0===document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")}catch(t){return!1}}();case"image/svg":return Vl.c;default:if(!Vl.c){var e=globalThis._parseImageNode;return Boolean(e)&&hh.includes(t)}return!0}}(t)),dh[t]}function vh(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return gh(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gh(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function gh(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var yh="EXT_texture_webp";function mh(t,e){var n=new Vf(t);if(ph("image/webp")){var r,i=vh(n.json.textures||[]);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=n.getObjectExtension(o,"EXT_texture_webp");a&&(o.source=a.source),n.removeObjectExtension(o,"EXT_texture_webp")}}catch(t){i.e(t)}finally{i.f()}n.removeExtension("EXT_texture_webp")}else if(n.getRequiredExtensions().includes("EXT_texture_webp"))throw new Error("gltf: Required extension ".concat("EXT_texture_webp"," not supported by browser"))}function bh(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ah(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ah(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ah(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var _h="KHR_texture_basisu";function Oh(t,e){var n,r=new Vf(t),i=bh(r.json.textures||[]);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=r.getObjectExtension(o,"KHR_texture_basisu");a&&(o.source=a.source),r.removeObjectExtension(o,"KHR_texture_basisu")}}catch(t){i.e(t)}finally{i.f()}r.removeExtension("KHR_texture_basisu")}function wh(t){var e={};for(var n in t){var r=t[n];if("indices"!==n){var i=xh(r);e[n]=i}}return e}function xh(t){var e=function(t){var e=t,n=1,r=0;t&&t.value&&(e=t.value,n=t.size||1);e&&(ArrayBuffer.isView(e)||(e=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return null;if(Array.isArray(t))return new e(t);if(n&&!(t instanceof e))return new e(t);return t}(e,Float32Array)),r=e.length/n);return{buffer:e,size:n,count:r}}(t),n=e.buffer,r=e.size;return{value:n,size:r,byteOffset:0,count:e.count,type:Rf(r),componentType:Df(n)}}function Ch(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ph(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ch(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ch(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Sh=Sr.a.mark(Gh);function Bh(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return kh(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kh(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function kh(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Eh="KHR_draco_mesh_compression";function Th(t,e,n){var r,i=new Vf(t),o=Bh(Gh(i));try{for(o.s();!(r=o.n()).done;){var a=r.value;i.getObjectExtension(a,"KHR_draco_mesh_compression")}}catch(t){o.e(t)}finally{o.f()}}function jh(t,e,n){return Mh.apply(this,arguments)}function Mh(){return(Mh=br()(Sr.a.mark((function t(e,n,r){var i,o,a,s,u,c;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n&&null!==(i=n.gltf)&&void 0!==i&&i.decompressMeshes){t.next=2;break}return t.abrupt("return");case 2:o=new Vf(e),a=[],s=Bh(Gh(o));try{for(s.s();!(u=s.n()).done;)c=u.value,o.getObjectExtension(c,"KHR_draco_mesh_compression")&&a.push(Rh(o,c,n,r))}catch(t){s.e(t)}finally{s.f()}return t.next=8,Promise.all(a);case 8:o.removeExtension("KHR_draco_mesh_compression");case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ih(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new Vf(t),i=Bh(r.json.meshes||[]);try{for(i.s();!(e=i.n()).done;){var o=e.value;Lh(o,n),r.addRequiredExtension("KHR_draco_mesh_compression")}}catch(t){i.e(t)}finally{i.f()}}function Rh(t,e,n,r){return Dh.apply(this,arguments)}function Dh(){return(Dh=br()(Sr.a.mark((function t(e,n,r,i){var o,a,s,u,c,l,f,h,d,p,v,g,y,m;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.getObjectExtension(n,"KHR_draco_mesh_compression")){t.next=3;break}return t.abrupt("return");case 3:return a=e.getTypedArrayForBufferView(o.bufferView),s=Object(xf.c)(a.buffer,a.byteOffset),u=i.parse,delete(c=Ph({},r))["3d-tiles"],t.next=10,u(s,cc,c,i);case 10:for(l=t.sent,f=wh(l.attributes),h=0,d=Object.entries(f);h<d.length;h++)p=yr()(d[h],2),v=p[0],g=p[1],v in n.attributes&&(y=n.attributes[v],null!=(m=e.getAccessor(y))&&m.min&&null!=m&&m.max&&(g.min=m.min,g.max=m.max));n.attributes=f,l.indices&&(n.indices=xh(l.indices)),Fh(n);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Lh(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");var a=i.DracoWriter.encodeSync({attributes:t}),s=null==o?void 0:null===(n=o.parseSync)||void 0===n?void 0:n.call(o,{attributes:t}),u=i._addFauxAttributes(s.attributes),c=i.addBufferView(a),l={primitives:[{attributes:u,mode:r,extensions:_r()({},"KHR_draco_mesh_compression",{bufferView:c,attributes:u})}]};return l}function Fh(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function Gh(t){var e,n,r,i,o,a;return Sr.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:e=Bh(t.json.meshes||[]),s.prev=1,e.s();case 3:if((n=e.n()).done){s.next=24;break}r=n.value,i=Bh(r.primitives),s.prev=6,i.s();case 8:if((o=i.n()).done){s.next=14;break}return a=o.value,s.next=12,a;case 12:s.next=8;break;case 14:s.next=19;break;case 16:s.prev=16,s.t0=s.catch(6),i.e(s.t0);case 19:return s.prev=19,i.f(),s.finish(19);case 22:s.next=3;break;case 24:s.next=29;break;case 26:s.prev=26,s.t1=s.catch(1),e.e(s.t1);case 29:return s.prev=29,e.f(),s.finish(29);case 32:case"end":return s.stop()}}),Sh,null,[[1,26,29,32],[6,16,19,22]])}var Nh={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Uh={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4};function zh(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Hh(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hh(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Hh(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Vh="KHR_texture_transform",Jh=new Ui,Wh=new Do,Kh=new Do;function Xh(t,e){return qh.apply(this,arguments)}function qh(){return(qh=br()(Sr.a.mark((function t(e,n){var r,i,o;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=new Vf(e),r.getExtension("KHR_texture_transform")){t.next=4;break}return t.abrupt("return");case 4:for(i=e.json.materials||[],o=0;o<i.length;o++)Qh(o,e);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Qh(t,e){var n,r,i,o=[],a=null===(n=e.json.materials)||void 0===n?void 0:n[t],s=null==a?void 0:null===(r=a.pbrMetallicRoughness)||void 0===r?void 0:r.baseColorTexture;s&&Zh(e,t,s,o);var u=null==a?void 0:a.emissiveTexture;u&&Zh(e,t,u,o);var c=null==a?void 0:a.normalTexture;c&&Zh(e,t,c,o);var l=null==a?void 0:a.occlusionTexture;l&&Zh(e,t,l,o);var f=null==a?void 0:null===(i=a.pbrMetallicRoughness)||void 0===i?void 0:i.metallicRoughnessTexture;f&&Zh(e,t,f,o)}function Zh(t,e,n,r){var i=function(t,e){var n,r=null===(n=t.extensions)||void 0===n?void 0:n.KHR_texture_transform,i=t.texCoord,o=void 0===i?0:i,a=r.texCoord,s=void 0===a?o:a;if(-1===e.findIndex((function(t){var e=yr()(t,2),n=e[0],r=e[1];return n===o&&r===s}))){var u=(l=(c=r).offset,f=void 0===l?[0,0]:l,h=c.rotation,d=void 0===h?0:h,p=c.scale,v=void 0===p?[1,1]:p,g=(new Do).set(1,0,0,0,1,0,f[0],f[1],1),y=Wh.set(Math.cos(d),Math.sin(d),0,-Math.sin(d),Math.cos(d),0,0,0,1),m=Kh.set(v[0],0,0,0,v[1],0,0,0,1),g.multiplyRight(y).multiplyRight(m));return o!==s&&(t.texCoord=s),e.push([o,s]),{originalTexCoord:o,texCoord:s,matrix:u}}var c,l,f,h,d,p,v,g,y,m;return null}(n,r);if(i){var o,a=zh(t.json.meshes||[]);try{for(a.s();!(o=a.n()).done;){var s,u=zh(o.value.primitives);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=c.material;Number.isFinite(l)&&e===l&&Yh(t,c,i)}}catch(t){u.e(t)}finally{u.f()}}}catch(t){a.e(t)}finally{a.f()}}}function Yh(t,e,n){var r=n.originalTexCoord,i=n.texCoord,o=n.matrix,a=e.attributes["TEXCOORD_".concat(r)];if(Number.isFinite(a)){var s,u=null===(s=t.json.accessors)||void 0===s?void 0:s[a];if(u&&u.bufferView){var c,l=null===(c=t.json.bufferViews)||void 0===c?void 0:c[u.bufferView];if(l){for(var f=t.buffers[l.buffer],h=f.arrayBuffer,d=(f.byteOffset||0)+(u.byteOffset||0)+(l.byteOffset||0),p=Lf(u,l),v=p.ArrayType,g=p.length,y=Uh[u.componentType],m=Nh[u.type],b=l.byteStride||y*m,A=new Float32Array(g),_=0;_<u.count;_++){var O=new v(h,d+_*b,2);Jh.set(O[0],O[1],1),Jh.transformByMatrix3(o),A.set([Jh[0],Jh[1]],_*m)}r===i?function(t,e,n,r){t.componentType=5126,n.push({arrayBuffer:r.buffer,byteOffset:0,byteLength:r.buffer.byteLength}),e.buffer=n.length-1,e.byteLength=r.buffer.byteLength,e.byteOffset=0,delete e.byteStride}(u,l,t.buffers,A):function(t,e,n,r,i){r.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});var o=r.json.bufferViews;if(!o)return;o.push({buffer:r.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});var a=r.json.accessors;if(!a)return;a.push({bufferView:(null==o?void 0:o.length)-1,byteOffset:0,componentType:5126,count:e.count,type:"VEC2"}),n.attributes["TEXCOORD_".concat(t)]=a.length-1}(i,u,e,t,A)}}}}function $h(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return td(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return td(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function td(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var ed="KHR_lights_punctual";function nd(t){return rd.apply(this,arguments)}function rd(){return(rd=br()(Sr.a.mark((function t(e){var n,r,i,o,a,s,u;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new Vf(e),r=n.json,(i=n.getExtension("KHR_lights_punctual"))&&(n.json.lights=i.lights,n.removeExtension("KHR_lights_punctual")),o=$h(r.nodes||[]);try{for(o.s();!(a=o.n()).done;)s=a.value,(u=n.getObjectExtension(s,"KHR_lights_punctual"))&&(s.light=u.light),n.removeObjectExtension(s,"KHR_lights_punctual")}catch(t){o.e(t)}finally{o.f()}case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function id(t){return od.apply(this,arguments)}function od(){return(od=br()(Sr.a.mark((function t(e){var n,r,i,o,a,s,u;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=new Vf(e),(r=n.json).lights&&(Cf(!(i=n.addExtension("KHR_lights_punctual")).lights),i.lights=r.lights,delete r.lights),n.json.lights){o=$h(n.json.lights);try{for(o.s();!(a=o.n()).done;)s=a.value,u=s.node,n.addObjectExtension(u,"KHR_lights_punctual",s)}catch(t){o.e(t)}finally{o.f()}delete n.json.lights}case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ad(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return sd(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sd(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function sd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var ud="KHR_materials_unlit";function cd(t){return ld.apply(this,arguments)}function ld(){return(ld=br()(Sr.a.mark((function t(e){var n,r,i,o,a;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new Vf(e),r=n.json,n.removeExtension("KHR_materials_unlit"),i=ad(r.materials||[]);try{for(i.s();!(o=i.n()).done;)a=o.value,a.extensions&&a.extensions.KHR_materials_unlit&&(a.unlit=!0),n.removeObjectExtension(a,"KHR_materials_unlit")}catch(t){i.e(t)}finally{i.f()}case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function fd(t){var e=new Vf(t),n=e.json;if(e.materials){var r,i=ad(n.materials||[]);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.unlit&&(delete o.unlit,e.addObjectExtension(o,"KHR_materials_unlit",{}),e.addExtension("KHR_materials_unlit"))}}catch(t){i.e(t)}finally{i.f()}}}function hd(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return dd(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dd(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function dd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var pd="KHR_techniques_webgl";function vd(t){return gd.apply(this,arguments)}function gd(){return(gd=br()(Sr.a.mark((function t(e){var n,r,i,o,a,s,u,c;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=new Vf(e),r=n.json,i=n.getExtension("KHR_techniques_webgl")){o=bd(i,n),a=hd(r.materials||[]);try{for(a.s();!(s=a.n()).done;)u=s.value,(c=n.getObjectExtension(u,"KHR_techniques_webgl"))&&(u.technique=Object.assign({},c,o[c.technique]),u.technique.values=Ad(u.technique,n)),n.removeObjectExtension(u,"KHR_techniques_webgl")}catch(t){a.e(t)}finally{a.f()}n.removeExtension("KHR_techniques_webgl")}case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function yd(t,e){return md.apply(this,arguments)}function md(){return(md=br()(Sr.a.mark((function t(e,n){return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function bd(t,e){var n=t.programs,r=void 0===n?[]:n,i=t.shaders,o=void 0===i?[]:i,a=t.techniques,s=void 0===a?[]:a,u=new TextDecoder;return o.forEach((function(t){if(!Number.isFinite(t.bufferView))throw new Error("KHR_techniques_webgl: no shader code");t.code=u.decode(e.getTypedArrayForBufferView(t.bufferView))})),r.forEach((function(t){t.fragmentShader=o[t.fragmentShader],t.vertexShader=o[t.vertexShader]})),s.forEach((function(t){t.program=r[t.program]})),s}function Ad(t,e){var n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach((function(e){!t.uniforms[e].value||e in n||(n[e]=t.uniforms[e].value)})),Object.keys(n).forEach((function(t){"object"===Dr()(n[t])&&void 0!==n[t].index&&(n[t].texture=e.getTexture(n[t].index))})),n}var _d="EXT_feature_metadata";function Od(t){return wd.apply(this,arguments)}function wd(){return(wd=br()(Sr.a.mark((function t(e){return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:xd(new Vf(e));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function xd(t){var e,n=t.getExtension("EXT_feature_metadata"),r=null==n?void 0:null===(e=n.schema)||void 0===e?void 0:e.classes,i=null==n?void 0:n.featureTables;if((null==n?void 0:n.featureTextures)&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),r&&i)for(var o in r){var a=r[o],s=Sd(i,o);s&&Cd(t,s,a)}}function Cd(t,e,n){for(var r in n.properties){var i,o=n.properties[r],a=null==e?void 0:null===(i=e.properties)||void 0===i?void 0:i[r],s=e.count;if(a){var u=Pd(t,o,s,a);a.data=u}}}function Pd(t,e,n,r){var i=r.bufferView,o=t.getTypedArrayForBufferView(i);switch(e.type){case"STRING":var a=r.stringOffsetBufferView;o=function(t,e,n){for(var r=[],i=new TextDecoder("utf8"),o=0,a=0;a<n;a++){var s=e[4*(a+1)]-e[4*a],u=t.subarray(o,s+o),c=i.decode(u);r.push(c),o+=s}return r}(o,t.getTypedArrayForBufferView(a),n)}return o}function Sd(t,e){for(var n in t){var r=t[n];if(r.class===e)return r}return null}function Bd(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return kd(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kd(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function kd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ed=[r,i,o,a,u,c,l,s,f];function Td(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,i=Ed.filter((function(t){return Id(t.name,n)})),o=Bd(i);try{for(o.s();!(e=o.n()).done;){var a,s=e.value;null===(a=s.preprocess)||void 0===a||a.call(s,t,n,r)}}catch(t){o.e(t)}finally{o.f()}}function jd(t){return Md.apply(this,arguments)}function Md(){return(Md=br()(Sr.a.mark((function t(e){var n,r,i,o,a,s,u,c=arguments;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=c.length>1&&void 0!==c[1]?c[1]:{},r=c.length>2?c[2]:void 0,i=Ed.filter((function(t){return Id(t.name,n)})),o=Bd(i),t.prev=4,o.s();case 6:if((a=o.n()).done){t.next=12;break}return s=a.value,t.next=10,null===(u=s.decode)||void 0===u?void 0:u.call(s,e,n,r);case 10:t.next=6;break;case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(4),o.e(t.t0);case 17:return t.prev=17,o.f(),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[4,14,17,20]])})))).apply(this,arguments)}function Id(t,e){var n,r=(null==e?void 0:null===(n=e.gltf)||void 0===n?void 0:n.excludeExtensions)||{};return!(t in r&&!r[t])}function Rd(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Dd(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dd(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Dd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ld(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Fd(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fd(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Fd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Gd,Nd={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},Ud={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},zd=function(){function t(){wr()(this,t),Object(Br.a)(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),Object(Br.a)(this,"json",void 0)}return Cr()(t,[{key:"normalize",value:function(t,e){this.json=t.json;var n=t.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version ".concat(n.asset.version))}if(!e.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(t){var e,n=new Vf(t),r=n.json,i=Rd(r.images||[]);try{for(i.s();!(e=i.n()).done;){var o=e.value,a=n.getObjectExtension(o,"KHR_binary_glTF");a&&Object.assign(o,a),n.removeObjectExtension(o,"KHR_binary_glTF")}}catch(t){i.e(t)}finally{i.f()}r.buffers&&r.buffers[0]&&delete r.buffers[0].uri,n.removeExtension("KHR_binary_glTF")}(t),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}},{key:"_addAsset",value:function(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}},{key:"_convertTopLevelObjectsToArrays",value:function(t){for(var e in Nd)this._convertTopLevelObjectToArray(t,e)}},{key:"_convertTopLevelObjectToArray",value:function(t,e){var n=t[e];if(n&&!Array.isArray(n))for(var r in t[e]=[],n){var i=n[r];i.id=i.id||r;var o=t[e].length;t[e].push(i),this.idToIndexMap[e][r]=o}}},{key:"_convertObjectIdsToArrayIndices",value:function(t){for(var e in Nd)this._convertIdsToIndices(t,e);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));var n,r=Ld(t.textures);try{for(r.s();!(n=r.n()).done;){var i=n.value;this._convertTextureIds(i)}}catch(t){r.e(t)}finally{r.f()}var o,a=Ld(t.meshes);try{for(a.s();!(o=a.n()).done;){var s=o.value;this._convertMeshIds(s)}}catch(t){a.e(t)}finally{a.f()}var u,c=Ld(t.nodes);try{for(c.s();!(u=c.n()).done;){var l=u.value;this._convertNodeIds(l)}}catch(t){c.e(t)}finally{c.f()}var f,h=Ld(t.scenes);try{for(h.s();!(f=h.n()).done;){var d=f.value;this._convertSceneIds(d)}}catch(t){h.e(t)}finally{h.f()}}},{key:"_convertTextureIds",value:function(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}},{key:"_convertMeshIds",value:function(t){var e,n=Ld(t.primitives);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=r.attributes,o=r.indices,a=r.material;for(var s in i)i[s]=this._convertIdToIndex(i[s],"accessor");o&&(r.indices=this._convertIdToIndex(o,"accessor")),a&&(r.material=this._convertIdToIndex(a,"material"))}}catch(t){n.e(t)}finally{n.f()}}},{key:"_convertNodeIds",value:function(t){var e=this;t.children&&(t.children=t.children.map((function(t){return e._convertIdToIndex(t,"node")}))),t.meshes&&(t.meshes=t.meshes.map((function(t){return e._convertIdToIndex(t,"mesh")})))}},{key:"_convertSceneIds",value:function(t){var e=this;t.nodes&&(t.nodes=t.nodes.map((function(t){return e._convertIdToIndex(t,"node")})))}},{key:"_convertIdsToIndices",value:function(t,e){t[e]||(console.warn("gltf v1: json doesn't contain attribute ".concat(e)),t[e]=[]);var n,r=Ld(t[e]);try{for(r.s();!(n=r.n()).done;){var i=n.value;for(var o in i){var a=i[o],s=this._convertIdToIndex(a,o);i[o]=s}}}catch(t){r.e(t)}finally{r.f()}}},{key:"_convertIdToIndex",value:function(t,e){var n=Ud[e];if(n in this.idToIndexMap){var r=this.idToIndexMap[n][t];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve ".concat(e," with id ").concat(t));return r}return t}},{key:"_updateObjects",value:function(t){var e,n=Ld(this.json.buffers);try{for(n.s();!(e=n.n()).done;){delete e.value.type}}catch(t){n.e(t)}finally{n.f()}}},{key:"_updateMaterial",value:function(t){var e,n=Ld(t.materials);try{var r=function(){var n=e.value;n.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};var r=(null===(i=n.values)||void 0===i?void 0:i.tex)||(null===(o=n.values)||void 0===o?void 0:o.texture2d_0)||(null===(a=n.values)||void 0===a?void 0:a.diffuseTex),s=t.textures.findIndex((function(t){return t.id===r}));-1!==s&&(n.pbrMetallicRoughness.baseColorTexture={index:s})};for(n.s();!(e=n.n()).done;){var i,o,a;r()}}catch(t){n.e(t)}finally{n.f()}}}]),t}();function Hd(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(new zd).normalize(t,e)}function Vd(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Jd(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Vd(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vd(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Wd={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Kd={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Xd=10240,qd=10241,Qd=10242,Zd=10243,Yd=10497,$d=9729,tp=9986,ep={magFilter:Xd,minFilter:qd,wrapS:Qd,wrapT:Zd},np=(Gd={},_r()(Gd,Xd,$d),_r()(Gd,qd,tp),_r()(Gd,Qd,Yd),_r()(Gd,Zd,Yd),Gd);var rp=function(){function t(){wr()(this,t),Object(Br.a)(this,"baseUri",""),Object(Br.a)(this,"json",{}),Object(Br.a)(this,"buffers",[]),Object(Br.a)(this,"images",[])}return Cr()(t,[{key:"postProcess",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.json,r=t.buffers,i=void 0===r?[]:r,o=t.images,a=void 0===o?[]:o,s=t.baseUri,u=void 0===s?"":s;return Cf(n),this.baseUri=u,this.json=n,this.buffers=i,this.images=a,this._resolveTree(this.json,e),this.json}},{key:"_resolveTree",value:function(t){var e=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.bufferViews&&(t.bufferViews=t.bufferViews.map((function(t,n){return e._resolveBufferView(t,n)}))),t.images&&(t.images=t.images.map((function(t,n){return e._resolveImage(t,n)}))),t.samplers&&(t.samplers=t.samplers.map((function(t,n){return e._resolveSampler(t,n)}))),t.textures&&(t.textures=t.textures.map((function(t,n){return e._resolveTexture(t,n)}))),t.accessors&&(t.accessors=t.accessors.map((function(t,n){return e._resolveAccessor(t,n)}))),t.materials&&(t.materials=t.materials.map((function(t,n){return e._resolveMaterial(t,n)}))),t.meshes&&(t.meshes=t.meshes.map((function(t,n){return e._resolveMesh(t,n)}))),t.nodes&&(t.nodes=t.nodes.map((function(t,n){return e._resolveNode(t,n)}))),t.skins&&(t.skins=t.skins.map((function(t,n){return e._resolveSkin(t,n)}))),t.scenes&&(t.scenes=t.scenes.map((function(t,n){return e._resolveScene(t,n)}))),void 0!==t.scene&&(t.scene=t.scenes[this.json.scene])}},{key:"getScene",value:function(t){return this._get("scenes",t)}},{key:"getNode",value:function(t){return this._get("nodes",t)}},{key:"getSkin",value:function(t){return this._get("skins",t)}},{key:"getMesh",value:function(t){return this._get("meshes",t)}},{key:"getMaterial",value:function(t){return this._get("materials",t)}},{key:"getAccessor",value:function(t){return this._get("accessors",t)}},{key:"getCamera",value:function(t){return null}},{key:"getTexture",value:function(t){return this._get("textures",t)}},{key:"getSampler",value:function(t){return this._get("samplers",t)}},{key:"getImage",value:function(t){return this._get("images",t)}},{key:"getBufferView",value:function(t){return this._get("bufferViews",t)}},{key:"getBuffer",value:function(t){return this._get("buffers",t)}},{key:"_get",value:function(t,e){if("object"===Dr()(e))return e;var n=this.json[t]&&this.json[t][e];return n||console.warn("glTF file error: Could not find ".concat(t,"[").concat(e,"]")),n}},{key:"_resolveScene",value:function(t,e){var n=this;return t.id=t.id||"scene-".concat(e),t.nodes=(t.nodes||[]).map((function(t){return n.getNode(t)})),t}},{key:"_resolveNode",value:function(t,e){var n=this;return t.id=t.id||"node-".concat(e),t.children&&(t.children=t.children.map((function(t){return n.getNode(t)}))),void 0!==t.mesh?t.mesh=this.getMesh(t.mesh):void 0!==t.meshes&&t.meshes.length&&(t.mesh=t.meshes.reduce((function(t,e){var r=n.getMesh(e);return t.id=r.id,t.primitives=t.primitives.concat(r.primitives),t}),{primitives:[]})),void 0!==t.camera&&(t.camera=this.getCamera(t.camera)),void 0!==t.skin&&(t.skin=this.getSkin(t.skin)),t}},{key:"_resolveSkin",value:function(t,e){return t.id=t.id||"skin-".concat(e),t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}},{key:"_resolveMesh",value:function(t,e){var n=this;return t.id=t.id||"mesh-".concat(e),t.primitives&&(t.primitives=t.primitives.map((function(t){var e=(t=Jd({},t)).attributes;for(var r in t.attributes={},e)t.attributes[r]=n.getAccessor(e[r]);return void 0!==t.indices&&(t.indices=n.getAccessor(t.indices)),void 0!==t.material&&(t.material=n.getMaterial(t.material)),t}))),t}},{key:"_resolveMaterial",value:function(t,e){if(t.id=t.id||"material-".concat(e),t.normalTexture&&(t.normalTexture=Jd({},t.normalTexture),t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture=Jd({},t.occlustionTexture),t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture=Jd({},t.emmisiveTexture),t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.emissiveFactor||(t.emissiveFactor=t.emmisiveTexture?[1,1,1]:[0,0,0]),t.pbrMetallicRoughness){t.pbrMetallicRoughness=Jd({},t.pbrMetallicRoughness);var n=t.pbrMetallicRoughness;n.baseColorTexture&&(n.baseColorTexture=Jd({},n.baseColorTexture),n.baseColorTexture.texture=this.getTexture(n.baseColorTexture.index)),n.metallicRoughnessTexture&&(n.metallicRoughnessTexture=Jd({},n.metallicRoughnessTexture),n.metallicRoughnessTexture.texture=this.getTexture(n.metallicRoughnessTexture.index))}return t}},{key:"_resolveAccessor",value:function(t,e){var n,r;if(t.id=t.id||"accessor-".concat(e),void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=(n=t.componentType,Kd[n]),t.components=(r=t.type,Wd[r]),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){var i=t.bufferView.buffer,o=Lf(t,t.bufferView),a=o.ArrayType,s=o.byteLength,u=(t.bufferView.byteOffset||0)+(t.byteOffset||0)+i.byteOffset,c=i.arrayBuffer.slice(u,u+s);t.bufferView.byteStride&&(c=this._getValueFromInterleavedBuffer(i,u,t.bufferView.byteStride,t.bytesPerElement,t.count)),t.value=new a(c)}return t}},{key:"_getValueFromInterleavedBuffer",value:function(t,e,n,r,i){for(var o=new Uint8Array(i*r),a=0;a<i;a++){var s=e+a*n;o.set(new Uint8Array(t.arrayBuffer.slice(s,s+r)),a*r)}return o.buffer}},{key:"_resolveTexture",value:function(t,e){return t.id=t.id||"texture-".concat(e),t.sampler="sampler"in t?this.getSampler(t.sampler):np,t.source=this.getImage(t.source),t}},{key:"_resolveSampler",value:function(t,e){for(var n in t.id=t.id||"sampler-".concat(e),t.parameters={},t){var r=this._enumSamplerParameter(n);void 0!==r&&(t.parameters[r]=t[n])}return t}},{key:"_enumSamplerParameter",value:function(t){return ep[t]}},{key:"_resolveImage",value:function(t,e){t.id=t.id||"image-".concat(e),void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView));var n=this.images[e];return n&&(t.image=n),t}},{key:"_resolveBufferView",value:function(t,e){var n=t.buffer,r=Jd(Jd({id:"bufferView-".concat(e)},t),{},{buffer:this.buffers[n]}),i=this.buffers[n].arrayBuffer,o=this.buffers[n].byteOffset||0;return"byteOffset"in t&&(o+=t.byteOffset),r.data=new Uint8Array(i,o,t.byteLength),r}},{key:"_resolveCamera",value:function(t,e){return t.id=t.id||"camera-".concat(e),t.perspective,t.orthographic,t}}]),t}();function ip(t,e){return(new rp).postProcess(t,e)}function op(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"".concat(String.fromCharCode(t.getUint8(e+0))).concat(String.fromCharCode(t.getUint8(e+1))).concat(String.fromCharCode(t.getUint8(e+2))).concat(String.fromCharCode(t.getUint8(e+3)))}function ap(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new DataView(t),i=n.magic,o=void 0===i?1735152710:i,a=r.getUint32(e,!1);return a===o||1735152710===a}function sp(t,e,n){Object(mo.a)(t.header.byteLength>20);var r=e.getUint32(n+0,!0),i=e.getUint32(n+4,!0);return n+=8,Object(mo.a)(0===i),cp(t,e,n,r),n+=r,n+=lp(t,e,n,t.header.byteLength)}function up(t,e,n,r){return Object(mo.a)(t.header.byteLength>20),function(t,e,n,r){for(;n+8<=t.header.byteLength;){var i=e.getUint32(n+0,!0),o=e.getUint32(n+4,!0);switch(n+=8,o){case 1313821514:cp(t,e,n,i);break;case 5130562:lp(t,e,n,i);break;case 0:r.strict||cp(t,e,n,i);break;case 1:r.strict||lp(t,e,n,i)}n+=Object(Bf.b)(i,4)}}(t,e,n,r),n+t.header.byteLength}function cp(t,e,n,r){var i=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(i);return t.json=JSON.parse(o),Object(Bf.b)(r,4)}function lp(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),Object(Bf.b)(r,4)}function fp(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return hp(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hp(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function hp(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dp(t,e){return pp.apply(this,arguments)}function pp(){return(pp=br()(Sr.a.mark((function t(e,n){var r,i,o,a,s,u,c,l,f,h,d=arguments;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=d.length>2&&void 0!==d[2]?d[2]:0,i=d.length>3?d[3]:void 0,o=d.length>4?d[4]:void 0,vp(e,n,r,i),Hd(e,{normalize:null==i?void 0:null===(a=i.gltf)||void 0===a?void 0:a.normalize}),Td(e,i,o),l=[],null==i||null===(s=i.gltf)||void 0===s||!s.loadBuffers||!e.json.buffers){t.next=10;break}return t.next=10,gp(e,i,o);case 10:return null!=i&&null!==(u=i.gltf)&&void 0!==u&&u.loadImages&&(f=mp(e,i,o),l.push(f)),h=jd(e,i,o),l.push(h),t.next=15,Promise.all(l);case 15:return t.abrupt("return",null!=i&&null!==(c=i.gltf)&&void 0!==c&&c.postProcess?ip(e,i):e);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function vp(t,e,n,r){(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!ap(e,n,r))&&(e=(new TextDecoder).decode(e));if("string"==typeof e)t.json=Object(wf.a)(e);else if(e instanceof ArrayBuffer){var i={};n=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],new DataView(e)),i=op(r,n+0),o=r.getUint32(n+4,!0),a=r.getUint32(n+8,!0);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:i,version:o,json:{},binChunks:[]}),n+=12,t.version){case 1:return sp(t,r,n);case 2:return up(t,r,n,{});default:throw new Error("Invalid GLB version ".concat(t.version,". Only supports v1 and v2."))}}(i,e,n,r.glb),Cf("glTF"===i.type,"Invalid GLB magic string ".concat(i.type)),t._glb=i,t.json=i.json}else Cf(!1,"GLTF: must be ArrayBuffer or string");var o=t.json.buffers||[];if(t.buffers=new Array(o.length).fill(null),t._glb&&t._glb.header.hasBinChunk){var a=t._glb.binChunks;t.buffers[0]={arrayBuffer:a[0].arrayBuffer,byteOffset:a[0].byteOffset,byteLength:a[0].byteLength}}var s=t.json.images||[];t.images=new Array(s.length).fill({})}function gp(t,e,n){return yp.apply(this,arguments)}function yp(){return(yp=br()(Sr.a.mark((function t(e,n,r){var i,o,a,s,u,c,l,f;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.json.buffers||[],o=0;case 2:if(!(o<i.length)){t.next=22;break}if(!(a=i[o]).uri){t.next=18;break}return Cf(r.fetch),c=Pf(a.uri,n),t.next=10,null==r?void 0:null===(s=r.fetch)||void 0===s?void 0:s.call(r,c);case 10:return l=t.sent,t.next=13,null==l?void 0:null===(u=l.arrayBuffer)||void 0===u?void 0:u.call(l);case 13:f=t.sent,e.buffers[o]={arrayBuffer:f,byteOffset:0,byteLength:f.byteLength},delete a.uri,t.next=19;break;case 18:null===e.buffers[o]&&(e.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength});case 19:++o,t.next=2;break;case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mp(t,e,n){return bp.apply(this,arguments)}function bp(){return(bp=br()(Sr.a.mark((function t(e,n,r){var i,o,a,s,u,c;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=Ap(e),o=e.json.images||[],a=[],s=fp(i);try{for(s.s();!(u=s.n()).done;)c=u.value,a.push(_p(e,o[c],c,n,r))}catch(t){s.e(t)}finally{s.f()}return t.next=7,Promise.all(a);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ap(t){var e,n=new Set,r=fp(t.json.textures||[]);try{for(r.s();!(e=r.n()).done;){var i=e.value;void 0!==i.source&&n.add(i.source)}}catch(t){r.e(t)}finally{r.f()}return Array.from(n).sort()}function _p(t,e,n,r,i){return Op.apply(this,arguments)}function Op(){return(Op=br()(Sr.a.mark((function t(e,n,r,i,o){var a,s,u,c,l,f,h;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=o.fetch,s=o.parse,!n.uri||n.hasOwnProperty("bufferView")){t.next=10;break}return c=Pf(n.uri,i),t.next=5,a(c);case 5:return l=t.sent,t.next=8,l.arrayBuffer();case 8:u=t.sent,n.bufferView={data:u};case 10:return Number.isFinite(n.bufferView)&&(f=Sf(e.json,e.buffers,n.bufferView),u=Object(xf.c)(f.buffer,f.byteOffset,f.byteLength)),Cf(u,"glTF image has no data"),t.next=14,s(u,[Of,Hl],{mimeType:n.mimeType,basis:i.basis||{format:Gl()}},o);case 14:(h=t.sent)&&h[0]&&(h={compressed:!0,mipmaps:!1,width:h[0].width,height:h[0].height,data:h[0]}),e.images=e.images||[],e.images[r]=h;case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function wp(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function xp(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?wp(Object(n),!0).forEach((function(e){_r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wp(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Cp={name:"glTF",id:"gltf",module:"gltf",version:"3.3.0-alpha.5",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(t){return Pp.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function Pp(){return(Pp=br()(Sr.a.mark((function t(e){var n,r,i,o,a,s=arguments;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},r=s.length>2?s[2]:void 0,(n=xp(xp({},Cp.options),n)).gltf=xp(xp({},Cp.options.gltf),n.gltf),i=n.byteOffset,o=void 0===i?0:i,a={},t.next=8,dp(a,e,o,n,r);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Sp=0,Bp=1;function kp(t,e,n,r){t.rotateYtoZ=!0;var i=t.byteOffset+t.byteLength-n;if(0===i)throw new Error("glTF byte length must be greater than 0.");return t.gltfUpAxis=r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",t.gltfArrayBuffer=Object(xf.c)(e,n,i),t.gltfByteOffset=0,t.gltfByteLength=i,n%4==0||console.warn("".concat(t.type,": embedded glb is not aligned to a 4-byte boundary.")),t.byteOffset+t.byteLength}function Ep(t,e,n,r){return Tp.apply(this,arguments)}function Tp(){return(Tp=br()(Sr.a.mark((function t(e,n,r,i){var o,a,s;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=r["3d-tiles"]||{},jp(e,n,r),!o.loadGLTF){t.next=16;break}if(a=i.parse,s=i.fetch,!e.gltfUrl){t.next=9;break}return t.next=7,s(e.gltfUrl,r);case 7:e.gltfArrayBuffer=t.sent,e.gltfByteOffset=0;case 9:if(!e.gltfArrayBuffer){t.next=16;break}return t.next=12,a(e.gltfArrayBuffer,Cp,r,i);case 12:e.gltf=t.sent,delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function jp(t,e,n){switch(e){case Sp:var r=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),i=(new TextDecoder).decode(r);t.gltfUrl=i.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case Bp:break;default:throw new Error("b3dm: Illegal glTF format field")}}function Mp(t,e,n,r,i){return Ip.apply(this,arguments)}function Ip(){return(Ip=br()(Sr.a.mark((function t(e,n,r,i,o){var a,s;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Rp(e,n,r,i,o),t.next=3,Ep(e,Bp,i,o);case 3:return(s=null==e?void 0:null===(a=e.gltf)||void 0===a?void 0:a.extensions)&&s.CESIUM_RTC&&(e.rtcCenter=s.CESIUM_RTC.center),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Rp(t,e,n,r,i){n=kp(t,e,n=kc(t,e,n=Bc(t,e,n=Sc(t,e,n))),r);var o=new vc(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=o.getGlobalProperty("RTC_CENTER",5126,3),n}function Dp(t,e,n,r,i){return Lp.apply(this,arguments)}function Lp(){return(Lp=br()(Sr.a.mark((function t(e,n,r,i,o){return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Fp(e,n,r,i,o),t.next=3,Ep(e,e.gltfFormat,i,o);case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Fp(t,e,n,r,i){if(n=Sc(t,e,n),1!==t.version)throw new Error("Instanced 3D Model version ".concat(t.version," is not supported"));n=Bc(t,e,n);var o=new DataView(e);if(t.gltfFormat=o.getUint32(n,!0),n=kp(t,e,n=kc(t,e,n+=4),r),0===t.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");var a=new vc(t.featureTableJson,t.featureTableBinary),s=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=s,!Number.isFinite(s))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");t.eastNorthUp=a.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=a.getGlobalProperty("RTC_CENTER",5126,3);new Pc(t.batchTableJson,t.batchTableBinary,s);return function(t,e,n,r){for(var i=[new Array(r),t._batchTable][0],o=new Ui,a=(new Ui,new Ui,new Ui,new Do),s=new ia,u=new Ui,c={},l=new Ri,f=[],h=[],d=new Ui,p=new Ui,v=0;v<r;v++){var g=void 0;if(e.hasProperty("POSITION"))g=e.getProperty("POSITION",5126,3,v,o);else if(e.hasProperty("POSITION_QUANTIZED")){g=e.getProperty("POSITION_QUANTIZED",5123,3,v,o);var y=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",5126,3,d);if(!y)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var m=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",5126,3,p);if(!m)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var b=0;b<3;b++)g[b]=g[b]/65535*m[b]+y[b]}if(!g)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");o.copy(g),c.translation=o,t.normalUp=e.getProperty("NORMAL_UP",5126,3,v,f),t.normalRight=e.getProperty("NORMAL_RIGHT",5126,3,v,h);if(t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",5123,2,f),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",5123,2,h),t.octNormalUp){if(!t.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}t.eastNorthUp?(go.WGS84.eastNorthUpToFixedFrame(o,l),l.getRotationMatrix3(a)):a.identity()}!1,s.fromMatrix3(a),c.rotation=s,u.set(1,1,1);var A=e.getProperty("SCALE",5126,1,v);Number.isFinite(A)&&u.multiplyByScalar(A);var _=e.getProperty("SCALE_NON_UNIFORM",5126,3,v,f);_&&u.scale(_),c.scale=u;var O=e.getProperty("BATCH_ID",5123,1,v);void 0===O&&(O=v);var w=(new Ri).fromQuaternion(c.rotation);l.identity(),l.translate(c.translation),l.multiplyRight(w),l.scale(c.scale);var x=l.clone();i[v]={modelMatrix:x,batchId:O}}t.instances=i}(t,a,0,s),n}function Gp(t,e,n,r,i,o){return Np.apply(this,arguments)}function Np(){return(Np=br()(Sr.a.mark((function t(e,n,r,i,o,a){var s,u;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=Sc(e,n,r),s=new DataView(n),e.tilesLength=s.getUint32(r,!0),r+=4,e.tiles=[];case 5:if(!(e.tiles.length<e.tilesLength&&e.byteLength-r>12)){t.next=13;break}return u={},e.tiles.push(u),t.next=10,a(n,r,i,o,u);case 10:r=t.sent,t.next=5;break;case 13:return t.abrupt("return",r);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Up(t,e,n,r){return zp.apply(this,arguments)}function zp(){return(zp=br()(Sr.a.mark((function t(e,n,r,i){var o;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.rotateYtoZ=!0,e.gltfUpAxis=r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",o=i.parse,t.next=5,o(n,Cp,r,i);case 5:e.gltf=t.sent;case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Hp(t){return Vp.apply(this,arguments)}function Vp(){return(Vp=br()(Sr.a.mark((function t(e){var n,r,i,o,a=arguments;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=a.length>1&&void 0!==a[1]?a[1]:0,r=a.length>2?a[2]:void 0,i=a.length>3?a[3]:void 0,(o=a.length>4&&void 0!==a[4]?a[4]:{}).byteOffset=n,o.type=eu(e,n),t.t0=o.type,t.next=t.t0===$s.COMPOSITE?9:t.t0===$s.BATCHED_3D_MODEL?12:t.t0===$s.GLTF?15:t.t0===$s.INSTANCED_3D_MODEL?18:t.t0===$s.POINT_CLOUD?21:24;break;case 9:return t.next=11,Gp(o,e,n,r,i,Hp);case 11:return t.abrupt("return",t.sent);case 12:return t.next=14,Mp(o,e,n,r,i);case 14:return t.abrupt("return",t.sent);case 15:return t.next=17,Up(o,e,r,i);case 17:return t.abrupt("return",t.sent);case 18:return t.next=20,Dp(o,e,n,r,i);case 20:return t.abrupt("return",t.sent);case 21:return t.next=23,Hc(o,e,n,r,i);case 23:return t.abrupt("return",t.sent);case 24:throw new Error("3DTileLoader: unknown type ".concat(o.type));case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Jp(){return(Jp=br()(Sr.a.mark((function t(e,n,r){var i,o,a,s,u,c,l;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1952609651===new Uint32Array(e.slice(0,4))[0]){t.next=3;break}throw new Error("Wrong subtree file magic number");case 3:if(1===new Uint32Array(e.slice(4,8))[0]){t.next=6;break}throw new Error("Wrong subtree file verson, must be 1");case 6:if(i=qp(e.slice(8,16)),o=new Uint8Array(e,24,i),a=new TextDecoder("utf8"),s=a.decode(o),u=JSON.parse(s),c=qp(e.slice(16,24)),l=new ArrayBuffer(0),c&&(l=e.slice(24+i)),!("bufferView"in u.tileAvailability)){t.next=18;break}return t.next=17,Kp(u,"tileAvailability",l,r);case 17:u.tileAvailability.explicitBitstream=t.sent;case 18:if(!("bufferView"in u.contentAvailability)){t.next=22;break}return t.next=21,Kp(u,"contentAvailability",l,r);case 21:u.contentAvailability.explicitBitstream=t.sent;case 22:if(!("bufferView"in u.childSubtreeAvailability)){t.next=26;break}return t.next=25,Kp(u,"childSubtreeAvailability",l,r);case 25:u.childSubtreeAvailability.explicitBitstream=t.sent;case 26:return t.abrupt("return",u);case 27:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Wp(t,e){if(e.startsWith("http")){var n=new URL(t,e);return decodeURI(n.toString())}var r="http://".concat(e),i=new URL(t,r);return"/".concat(i.host).concat(i.pathname)}function Kp(t,e,n,r){return Xp.apply(this,arguments)}function Xp(){return(Xp=br()(Sr.a.mark((function t(e,n,r,i){var o,a,s,u,c,l;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e[n].bufferView,a=e.bufferViews[o],s=e.buffers[a.buffer],null!=i&&i.url&&i.fetch){t.next=5;break}throw new Error("Url is not provided");case 5:if(i.fetch){t.next=7;break}throw new Error("fetch is not provided");case 7:if(!s.uri){t.next=16;break}return u=Wp(s.uri,null==i?void 0:i.url),t.next=11,i.fetch(u);case 11:return c=t.sent,t.next=14,c.arrayBuffer();case 14:return l=t.sent,t.abrupt("return",new Uint8Array(l,a.byteOffset,a.byteLength));case 16:return t.abrupt("return",new Uint8Array(r,a.byteOffset,a.byteLength));case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function qp(t){var e=new DataView(t),n=e.getUint32(0,!0),r=e.getUint32(4,!0);return n+Math.pow(2,32)*r}var Qp={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:"3.3.0-alpha.5",extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:function(t,e,n){return Jp.apply(this,arguments)},options:{}},Zp={QUADTREE:4,OCTREE:8};function Yp(t){return $p.apply(this,arguments)}function $p(){return($p=br()(Sr.a.mark((function t(e){var n,r,i,o,a,s,u,c,l,f,h,d,p,v,g,y,m,b,A,_,O,w,x,C,P,S,B,k,E,T,j,M,I,R,D,L,F,G,N,U;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.options,r=e.parentData,i=void 0===r?{mortonIndex:0,x:0,y:0,z:0}:r,o=e.childIndex,a=void 0===o?0:o,s=e.globalData,u=void 0===s?{level:0,mortonIndex:0,x:0,y:0,z:0}:s,c=e.subtree,l=e.level,f=void 0===l?0:l,h=n.subdivisionScheme,d=n.subtreeLevels,p=n.maximumLevel,v=n.contentUrlTemplate,g=n.subtreesUriTemplate,y=n.basePath,m={children:[],lodMetricValue:0,contentUrl:""},b=Zp[h],A=1&a,_=a>>1&1,O=a>>2&1,w=(Math.pow(b,f)-1)/(b-1),x=nv(i.mortonIndex,a),C=w+x,P=nv(i.x,A),S=nv(i.y,_),B=nv(i.z,O),k=!1,f+1>d&&(k=tv(c.childSubtreeAvailability,x)),E=nv(u.x,P),T=nv(u.y,S),j=nv(u.z,B),M=f+u.level,!k){t.next=38;break}return I="".concat(y,"/").concat(g),R=rv(I,M,E,T,j),t.next=25,Object(vr.a)(R,Qp);case 25:D=t.sent,c=D,u.mortonIndex=x,u.x=P,u.y=S,u.z=B,u.level=f,x=0,C=0,P=0,S=0,B=0,f=0;case 38:if(tv(c.tileAvailability,C)&&!(f>p)){t.next=41;break}return t.abrupt("return",m);case 41:tv(c.contentAvailability,C)&&(m.contentUrl=rv(v,M,E,T,j)),L=f+1,F={mortonIndex:x,x:P,y:S,z:B},G=0;case 46:if(!(G<b)){t.next=54;break}return t.next=49,Yp({subtree:c,options:n,parentData:F,childIndex:G,level:L,globalData:u});case 49:((N=t.sent).contentUrl||N.children.length)&&(U=ev(N,M+1,{childTileX:P,childTileY:S,childTileZ:B},n),m.children.push(U));case 51:G++,t.next=46;break;case 54:return t.abrupt("return",m);case 55:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function tv(t,e){return"constant"in t?Boolean(t.constant):!!t.explicitBitstream&&(n=e,r=t.explicitBitstream,i=Math.floor(n/8),o=n%8,1==(r[i]>>o&1));var n,r,i,o}function ev(t,e,n,r){var i=r.basePath,o=r.refine,a=r.getRefine,s=r.lodMetricType,u=r.getTileType,c=r.rootLodMetricValue,l=r.rootBoundingVolume,f=t.contentUrl&&t.contentUrl.replace("".concat(i,"/"),""),h=c/Math.pow(2,e),d=function(t,e,n){if(e.region){var r=n.childTileX,i=n.childTileY,o=n.childTileZ,a=yr()(e.region,6),s=a[0],u=a[1],c=a[2],l=a[3],f=a[4],h=a[5],d=Math.pow(2,t),p=(c-s)/d,v=(l-u)/d,g=(h-f)/d;return{region:[s+p*r,u+v*i,s+p*(r+1),u+v*(i+1),f+g*o,f+g*(o+1)]}}return console.warn("Unsupported bounding volume type: ",e),null}(e,l,n);return{children:t.children,contentUrl:t.contentUrl,content:{uri:f},id:t.contentUrl,refine:a(o),type:u(t),lodMetricType:s,lodMetricValue:h,geometricError:h,transform:t.transform,boundingVolume:d}}function nv(t,e){return parseInt(t.toString(2)+e.toString(2),2)}function rv(t,e,n,r,i){var o=function(t){var e={};for(var n in t)e["{".concat(n,"}")]=t[n];return e}({level:e,x:n,y:r,z:i});return t.replace(/{level}|{x}|{y}|{z}/gi,(function(t){return o[t]}))}function iv(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ov(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ov(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ov(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function av(t){if(!t.contentUrl)return qa;var e=t.contentUrl.split(".").pop();switch(e){case"pnts":return Za;case"i3dm":case"b3dm":case"glb":case"gltf":return Qa;default:return e}}function sv(t){switch(t){case"REPLACE":case"replace":return Xa;case"ADD":case"add":return Ka;default:return t}}function uv(t,e){if(/^[a-z][0-9a-z+.-]*:/i.test(e)){var n=new URL(t,"".concat(e,"/"));return decodeURI(n.toString())}return t.startsWith("/")?t:"".concat(e,"/").concat(t)}function cv(t,e){if(!t)return null;if(t.content){var n=t.content.uri||t.content.url;t.contentUrl=uv(n,e.basePath)}return t.id=t.contentUrl,t.lodMetricType=es,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=av(t),t.refine=sv(t.refine),t}function lv(t,e){return fv.apply(this,arguments)}function fv(){return(fv=br()(Sr.a.mark((function t(e,n){var r,i,o,a,s,u,c,l,f,h;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.basePath,!(o=gv(null==e?void 0:e.root))||!e.root){t.next=8;break}return t.next=5,hv(e.root,e,o,n);case 5:i=t.sent,t.next=9;break;case 8:i=cv(e.root,e);case 9:(a=[]).push(i);case 11:if(!(a.length>0)){t.next=40;break}s=a.pop()||{},u=s.children||[],c=iv(u),t.prev=15,c.s();case 17:if((l=c.n()).done){t.next=30;break}if(f=l.value,!(h=gv(f))){t.next=26;break}return t.next=23,hv(f,e,h,n);case 23:f=t.sent,t.next=27;break;case 26:cv(f,{basePath:r});case 27:a.push(f);case 28:t.next=17;break;case 30:t.next=35;break;case 32:t.prev=32,t.t0=t.catch(15),c.e(t.t0);case 35:return t.prev=35,c.f(),t.finish(35);case 38:t.next=11;break;case 40:return t.abrupt("return",i);case 41:case"end":return t.stop()}}),t,null,[[15,32,35,38]])})))).apply(this,arguments)}function hv(t,e,n,r){return dv.apply(this,arguments)}function dv(){return(dv=br()(Sr.a.mark((function t(e,n,r,i){var o,a,s,u,c,l,f,h,d,p,v,g,y,m;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.basePath,s=r.subdivisionScheme,u=r.maximumLevel,c=r.subtreeLevels,l=r.subtrees.uri,f=rv(l,0,0,0,0),h=uv(f,a),t.next=6,Object(vr.a)(h,Qp,i);case 6:return d=t.sent,p=uv(e.content.uri,a),v=null==n?void 0:null===(o=n.root)||void 0===o?void 0:o.refine,g=e.geometricError,y=e.boundingVolume,m={contentUrlTemplate:p,subtreesUriTemplate:l,subdivisionScheme:s,subtreeLevels:c,maximumLevel:u,refine:v,basePath:a,lodMetricType:es,rootLodMetricValue:g,rootBoundingVolume:y,getTileType:av,getRefine:sv},t.next=14,pv(e,d,m);case 14:return t.abrupt("return",t.sent);case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function pv(t,e,n){return vv.apply(this,arguments)}function vv(){return(vv=br()(Sr.a.mark((function t(e,n,r){var i,o,a;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",null);case 2:return e.lodMetricType=es,e.lodMetricValue=e.geometricError,e.transformMatrix=e.transform,t.next=7,Yp({subtree:n,options:r});case 7:return i=t.sent,o=i.children,(a=i.contentUrl)&&(e.contentUrl=a,e.content={uri:a.replace("".concat(r.basePath,"/"),"")}),e.refine=sv(e.refine),e.type=av(e),e.children=o,e.id=e.contentUrl,t.abrupt("return",e);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function gv(t){var e;return(null==t?void 0:null===(e=t.extensions)||void 0===e?void 0:e["3DTILES_implicit_tiling"])||(null==t?void 0:t.implicitTiling)}var yv={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:"3.3.0-alpha.5",extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:function(t,e,n){return wv.apply(this,arguments)},options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function mv(t){return bo.b.dirname(t.url)}function bv(t,e,n){return Av.apply(this,arguments)}function Av(){return(Av=br()(Sr.a.mark((function t(e,n,r){var i;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={content:{featureIds:null}},0,t.next=4,Hp(e,0,n,r,i.content);case 4:return t.abrupt("return",i.content);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _v(t,e,n){return Ov.apply(this,arguments)}function Ov(){return(Ov=br()(Sr.a.mark((function t(e,n,r){var i,o;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(o=JSON.parse((new TextDecoder).decode(e))).loader=n.loader||yv,o.url=r.url,o.basePath=mv(o),t.next=6,lv(o,n);case 6:return o.root=t.sent,o.type=ts,o.lodMetricType=es,o.lodMetricValue=(null===(i=o.root)||void 0===i?void 0:i.lodMetricValue)||0,t.abrupt("return",o);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function wv(){return(wv=br()(Sr.a.mark((function t(e,n,r){var i;return Sr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n["3d-tiles"]||{},!("auto"===i.isTileset?r.url&&-1!==r.url.indexOf(".json"):i.isTileset)){t.next=8;break}return t.next=5,_v(e,n,r);case 5:e=t.sent,t.next=11;break;case 8:return t.next=10,bv(e,n,r);case 10:e=t.sent;case 11:return t.abrupt("return",e);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function xv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Cv(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xv(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Pv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var Sv=[0],Bv={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:null,loader:yv,onTilesetLoad:{type:"function",value:function(t){},compare:!1},onTileLoad:{type:"function",value:function(t){},compare:!1},onTileUnload:{type:"function",value:function(t){},compare:!1},onTileError:{type:"function",value:function(t,e,n){},compare:!1},_getMeshColor:{type:"function",value:function(t){return[255,255,255]},compare:!1}},kv=function(t){v()(r,t);var e,n=Pv(r);function r(){var t;d()(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return t=n.call.apply(n,[this].concat(i)),_()(Fn()(t),"state",void 0),t}return C()(r,[{key:"initializeState",value:function(){"onTileLoadFail"in this.props&&nt.a.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}},{key:"isLoaded",get:function(){var t=this.state.tileset3d;return null!==t&&t.isLoaded()}},{key:"shouldUpdateState",value:function(t){return t.changeFlags.somethingChanged}},{key:"updateState",value:function(t){var e=t.props,n=t.oldProps,r=t.changeFlags;if(e.data&&e.data!==n.data&&this._loadTileset(e.data),r.viewportChanged){var i=this.state.activeViewports;Object.keys(i).length&&(this._updateTileset(i),this.state.lastUpdatedViewports=i,this.state.activeViewports={})}if(r.propsChanged){var o=this.state.layerMap;for(var a in o)o[a].needsUpdate=!0}}},{key:"activateViewport",value:function(t){var e=this.state,n=e.activeViewports,r=e.lastUpdatedViewports;this.internalState.viewport=t,n[t.id]=t;var i=null==r?void 0:r[t.id];i&&t.equals(i)||(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}},{key:"getPickingInfo",value:function(t){var e=t.info,n=t.sourceLayer,r=this.state.layerMap,i=n&&n.id;if(i){var o=i.substring(this.id.length+1),a=o.substring(o.indexOf("-")+1);e.object=r[a]&&r[a].tile}return e}},{key:"filterSubLayer",value:function(t){var e=t.layer,n=t.viewport,r=e.props.tile,i=n.id;return r.selected&&r.viewportIds.includes(i)}},{key:"_updateAutoHighlight",value:function(t){t.sourceLayer&&t.sourceLayer.updateAutoHighlight(t)}},{key:"_loadTileset",value:(e=$()(et.a.mark((function t(e){var n,r,i,o,a,s,u;return et.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.props.loadOptions,r=void 0===n?{}:n,i=this.props.loader||this.props.loaders,Array.isArray(i)&&(i=i[0]),o={loadOptions:Cv({},r)},!i.preload){t.next=10;break}return t.next=7,i.preload(e,r);case 7:(a=t.sent).headers&&(o.loadOptions.fetch=Cv(Cv({},o.loadOptions.fetch),{},{headers:a.headers})),Object.assign(o,a);case 10:return t.next=12,Object(vr.a)(e,i,o.loadOptions);case 12:s=t.sent,u=new Ys(s,Cv({onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError},o)),this.setState({tileset3d:u,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(u);case 17:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"_onTileLoad",value:function(t){var e=this.state.lastUpdatedViewports;this.props.onTileLoad(t),this._updateTileset(e),this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(t){delete this.state.layerMap[t.id],this.props.onTileUnload(t)}},{key:"_updateTileset",value:function(t){var e=this;if(t){var n=this.state.tileset3d,r=this.context.timeline,i=Object.keys(t).length;r&&i&&n&&n.selectTiles(Object.values(t)).then((function(t){e.state.frameNumber!==t&&e.setState({frameNumber:t})}))}}},{key:"_getSubLayer",value:function(t,e){if(!t.content)return null;switch(t.type){case Za:return this._makePointCloudLayer(t,e);case Qa:return this._make3DModelLayer(t);case Ya:return this._makeSimpleMeshLayer(t,e);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(t.content.type))}}},{key:"_makePointCloudLayer",value:function(t,e){var n=t.content,r=n.attributes,i=n.pointCount,o=n.constantRGBA,a=n.cartographicOrigin,s=n.modelMatrix,u=r.positions,c=r.normals,l=r.colors;if(!u)return null;var f=e&&e.props.data||{header:{vertexCount:i},attributes:{POSITION:u,NORMAL:c,COLOR_0:l}},h=this.props,d=h.pointSize,p=h.getPointColor;return new(this.getSubLayerClass("pointcloud",or.a))({pointSize:d},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(t.id),tile:t,data:f,coordinateSystem:ir.a.METER_OFFSETS,coordinateOrigin:a,modelMatrix:s,getColor:o||p,_offset:0})}},{key:"_make3DModelLayer",value:function(t){var e=t.content,n=e.gltf,r=e.instances,i=e.cartographicOrigin,o=e.modelMatrix;return new(this.getSubLayerClass("scenegraph",ar.a))({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(t.id),tile:t,data:r||Sv,scenegraph:n,coordinateSystem:ir.a.METER_OFFSETS,coordinateOrigin:i,modelMatrix:o,getTransformMatrix:function(t){return t.modelMatrix},getPosition:[0,0,0],_offset:0})}},{key:"_makeSimpleMeshLayer",value:function(t,e){var n=t.content,r=n.attributes,i=n.indices,o=n.modelMatrix,a=n.cartographicOrigin,s=n.coordinateSystem,u=void 0===s?ir.a.METER_OFFSETS:s,c=n.material,l=n.featureIds,f=this.props._getMeshColor,h=e&&e.props.mesh||new rr.a({drawMode:4,attributes:Ev(r),indices:i});return new(this.getSubLayerClass("mesh",pr))(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(t.id),tile:t,mesh:h,data:Sv,getColor:f(t),pbrMaterial:c,modelMatrix:o,coordinateOrigin:a,coordinateSystem:u,featureIds:l,_offset:0})}},{key:"renderLayers",value:function(){var t=this,e=this.state,n=e.tileset3d,r=e.layerMap;return n?n.tiles.map((function(e){var n=r[e.id]=r[e.id]||{tile:e},i=n.layer;return e.selected&&(i?n.needsUpdate&&(i=t._getSubLayer(e,i),n.needsUpdate=!1):i=t._getSubLayer(e)),n.layer=i,i})).filter(Boolean):null}}]),r}(P.a);function Ev(t){var e={};return e.positions=Cv(Cv({},t.positions),{},{value:new Float32Array(t.positions.value)}),t.normals&&(e.normals=t.normals),t.texCoords&&(e.texCoords=t.texCoords),t.colors&&(e.colors=t.colors),t.uvRegions&&(e.uvRegions=t.uvRegions),e}_()(kv,"defaultProps",Bv),_()(kv,"layerName","Tile3DLayer");var Tv={name:"Terrain",id:"terrain",module:"terrain",version:"3.2.10",worker:!0,extensions:["png","pngraw","jpg","jpeg","gif","webp","bmp"],mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp"],options:{terrain:{tesselator:"auto",bounds:null,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:null}}};function jv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}function Mv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Iv(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Mv(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Rv=[1],Dv=Iv(Iv({},Bn.defaultProps),{},{elevationData:$e,texture:Iv(Iv({},$e),{},{optional:!0}),meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:{type:"string",value:null},wireframe:!1,material:!0,loaders:[Tv]});function Lv(t){return Array.isArray(t)?t.join(";"):t||""}var Fv=function(t){v()(n,t);var e=jv(n);function n(){var t;d()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),_()(Fn()(t),"state",void 0),t}return C()(n,[{key:"updateState",value:function(t){var e=t.props,n=t.oldProps,r=e.elevationData!==n.elevationData;if(r){var i=e.elevationData,o=i&&(Array.isArray(i)||i.includes("{x}")&&i.includes("{y}"));this.setState({isTiled:o})}var a=r||e.meshMaxError!==n.meshMaxError||e.elevationDecoder!==n.elevationDecoder||e.bounds!==n.bounds;if(!this.state.isTiled&&a){var s=this.loadTerrain(e);this.setState({terrain:s})}e.workerUrl&&nt.a.removed("workerUrl","loadOptions.terrain.workerUrl")()}},{key:"loadTerrain",value:function(t){var e,n=t.elevationData,r=t.bounds,i=t.elevationDecoder,o=t.meshMaxError,a=t.signal;if(!n)return null;var s=this.getLoadOptions();return s=Iv(Iv({},s),{},{terrain:Iv(Iv({skirtHeight:this.state.isTiled?2*o:0},null===(e=s)||void 0===e?void 0:e.terrain),{},{bounds:r,meshMaxError:o,elevationDecoder:i})}),(0,this.props.fetch)(n,{propName:"elevationData",layer:this,loadOptions:s,signal:a})}},{key:"getTiledTerrainData",value:function(t){var e=this.props,n=e.elevationData,r=e.fetch,i=e.texture,o=e.elevationDecoder,a=e.meshMaxError,s=this.context.viewport,u=en(n,t),c=i&&en(i,t),l=t.signal,f=[0,0],h=[0,0];if(s.isGeospatial){var d=t.bbox;f=s.projectFlat([d.west,d.south]),h=s.projectFlat([d.east,d.north])}else{var p=t.bbox;f=[p.left,p.bottom],h=[p.right,p.top]}var v=[f[0],f[1],h[0],h[1]],g=this.loadTerrain({elevationData:u,bounds:v,elevationDecoder:o,meshMaxError:a,signal:l}),y=c?r(c,{propName:"texture",layer:this,loaders:[],signal:l}).catch((function(t){return null})):Promise.resolve(null);return Promise.all([g,y])}},{key:"renderSubLayers",value:function(t){var e=this.getSubLayerClass("mesh",lr.a),n=this.props,r=n.color,i=n.wireframe,o=n.material,a=t.data;if(!a)return null;var s=M()(a,2),u=s[0],c=s[1];return new e(t,{data:Rv,mesh:u,texture:c,_instanced:!1,coordinateSystem:ir.a.CARTESIAN,getPosition:function(t){return[0,0,0]},getColor:r,wireframe:i,material:o})}},{key:"onViewportLoad",value:function(t){if(t){var e=this.state.zRange,n=t.map((function(t){return t.content})).filter(Boolean).map((function(t){return t[0].header.boundingBox.map((function(t){return t[2]}))}));if(0!==n.length){var r=Math.min.apply(Math,ot()(n.map((function(t){return t[0]})))),i=Math.max.apply(Math,ot()(n.map((function(t){return t[1]}))));(!e||r<e[0]||i>e[1])&&this.setState({zRange:[r,i]})}}}},{key:"renderLayers",value:function(){var t=this.props,e=t.color,n=t.material,r=t.elevationData,i=t.texture,o=t.wireframe,a=t.meshMaxError,s=t.elevationDecoder,u=t.tileSize,c=t.maxZoom,l=t.minZoom,f=t.extent,h=t.maxRequests,d=t.onTileLoad,p=t.onTileUnload,v=t.onTileError,g=t.maxCacheSize,y=t.maxCacheByteSize,m=t.refinementStrategy;return this.state.isTiled?new Bn(this.getSubLayerProps({id:"tiles"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:Lv(r),texture:Lv(i),meshMaxError:a,elevationDecoder:s}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:u,maxZoom:c,minZoom:l,extent:f,maxRequests:h,onTileLoad:d,onTileUnload:p,onTileError:v,maxCacheSize:g,maxCacheByteSize:y,refinementStrategy:m}):new(this.getSubLayerClass("mesh",lr.a))(this.getSubLayerProps({id:"mesh"}),{data:Rv,mesh:this.state.terrain,texture:i,_instanced:!1,getPosition:function(t){return[0,0,0]},getColor:e,material:n,wireframe:o})}}]),n}(P.a);_()(Fv,"defaultProps",Dv),_()(Fv,"layerName","TerrainLayer");var Gv=n(56);function Nv(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Uv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Uv(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Uv(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function zv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Hv(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zv(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Vv(t,e,n){var r=Jv(t),i=Object.keys(r).filter((function(t){return r[t]!==Array}));return function(t,e,n){for(var r=e.pointPositionsCount,i=e.pointFeaturesCount,o=e.linePositionsCount,a=e.linePathsCount,s=e.lineFeaturesCount,u=e.polygonPositionsCount,c=e.polygonObjectsCount,l=e.polygonRingsCount,f=e.polygonFeaturesCount,h=e.propArrayTypes,d=e.coordLength,p=n.numericPropKeys,v=void 0===p?[]:p,g=n.PositionDataType,y=void 0===g?Float32Array:g,m=(t[0]&&"id"in t[0]),b=t.length>65535?Uint32Array:Uint16Array,A={type:"Point",positions:new y(r*d),globalFeatureIds:new b(r),featureIds:i>65535?new Uint32Array(r):new Uint16Array(r),numericProps:{},properties:[],fields:[]},_={type:"LineString",pathIndices:o>65535?new Uint32Array(a+1):new Uint16Array(a+1),positions:new y(o*d),globalFeatureIds:new b(o),featureIds:s>65535?new Uint32Array(o):new Uint16Array(o),numericProps:{},properties:[],fields:[]},O={type:"Polygon",polygonIndices:u>65535?new Uint32Array(c+1):new Uint16Array(c+1),primitivePolygonIndices:u>65535?new Uint32Array(l+1):new Uint16Array(l+1),positions:new y(u*d),triangles:[],globalFeatureIds:new b(u),featureIds:f>65535?new Uint32Array(u):new Uint16Array(u),numericProps:{},properties:[],fields:[]},w=0,x=[A,_,O];w<x.length;w++){var C,P=x[w],S=Nv(v);try{for(S.s();!(C=S.n()).done;){var B=C.value,k=h[B];P.numericProps[B]=new k(P.positions.length/d)}}catch(t){S.e(t)}finally{S.f()}}_.pathIndices[a]=o,O.polygonIndices[c]=u,O.primitivePolygonIndices[l]=u;var E,T={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0},j=Nv(t);try{for(j.s();!(E=j.n()).done;){var M=E.value,I=M.geometry,R=M.properties||{};switch(I.type){case"Point":Wv(I,A,T,d,R),A.properties.push(Yv(R,v)),m&&A.fields.push({id:M.id}),T.pointFeature++;break;case"LineString":Kv(I,_,T,d,R),_.properties.push(Yv(R,v)),m&&_.fields.push({id:M.id}),T.lineFeature++;break;case"Polygon":Xv(I,O,T,d,R),O.properties.push(Yv(R,v)),m&&O.fields.push({id:M.id}),T.polygonFeature++;break;default:throw new Error("Invalid geometry type")}T.feature++}}catch(t){j.e(t)}finally{j.f()}return function(t,e,n,r){return{points:Hv(Hv({},t),{},{positions:{value:t.positions,size:r},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:Qv(t.numericProps,1)}),lines:Hv(Hv({},e),{},{positions:{value:e.positions,size:r},pathIndices:{value:e.pathIndices,size:1},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:Qv(e.numericProps,1)}),polygons:Hv(Hv({},n),{},{positions:{value:n.positions,size:r},polygonIndices:{value:n.polygonIndices,size:1},primitivePolygonIndices:{value:n.primitivePolygonIndices,size:1},triangles:{value:new Uint32Array(n.triangles),size:1},globalFeatureIds:{value:n.globalFeatureIds,size:1},featureIds:{value:n.featureIds,size:1},numericProps:Qv(n.numericProps,1)})}}(A,_,O,d)}(t,Hv({propArrayTypes:r},e),{numericPropKeys:n&&n.numericPropKeys||i,PositionDataType:n?n.PositionDataType:Float32Array})}function Jv(t){var e,n={},r=Nv(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(i.properties)for(var o in i.properties){var a=i.properties[o];n[o]=$v(a,n[o])}}}catch(t){r.e(t)}finally{r.f()}return n}function Wv(t,e,n,r,i){e.positions.set(t.data,n.pointPosition*r);var o=t.data.length/r;Zv(e,i,n.pointPosition,o),e.globalFeatureIds.fill(n.feature,n.pointPosition,n.pointPosition+o),e.featureIds.fill(n.pointFeature,n.pointPosition,n.pointPosition+o),n.pointPosition+=o}function Kv(t,e,n,r,i){e.positions.set(t.data,n.linePosition*r);var o=t.data.length/r;Zv(e,i,n.linePosition,o),e.globalFeatureIds.fill(n.feature,n.linePosition,n.linePosition+o),e.featureIds.fill(n.lineFeature,n.linePosition,n.linePosition+o);for(var a=0,s=t.indices.length;a<s;++a){var u=t.indices[a],c=a===s-1?t.data.length:t.indices[a+1];e.pathIndices[n.linePath++]=n.linePosition,n.linePosition+=(c-u)/r}}function Xv(t,e,n,r,i){e.positions.set(t.data,n.polygonPosition*r);var o=t.data.length/r;Zv(e,i,n.polygonPosition,o),e.globalFeatureIds.fill(n.feature,n.polygonPosition,n.polygonPosition+o),e.featureIds.fill(n.polygonFeature,n.polygonPosition,n.polygonPosition+o);for(var a=0,s=t.indices.length;a<s;++a){var u=n.polygonPosition;e.polygonIndices[n.polygonObject++]=u;for(var c=t.areas[a],l=t.indices[a],f=t.indices[a+1],h=0,d=l.length;h<d;++h){var p=l[h],v=h===d-1?void 0===f?t.data.length:f[0]:l[h+1];e.primitivePolygonIndices[n.polygonRing++]=n.polygonPosition,n.polygonPosition+=(v-p)/r}qv(e,c,l,{startPosition:u,endPosition:n.polygonPosition,coordLength:r})}}function qv(t,e,n,r){for(var i=r.startPosition,o=r.endPosition,a=r.coordLength,s=i*a,u=o*a,c=t.positions.subarray(s,u),l=n[0],f=n.slice(1).map((function(t){return(t-l)/a})),h=Object(Gv.f)(c,f,a,e),d=0,p=h.length;d<p;++d)t.triangles.push(i+h[d])}function Qv(t,e){var n={};for(var r in t)n[r]={value:t[r],size:e};return n}function Zv(t,e,n,r){for(var i in t.numericProps)if(i in e){var o=e[i];t.numericProps[i].fill(o,n,n+r)}}function Yv(t,e){var n={};for(var r in t)e.includes(r)||(n[r]=t[r]);return n}function $v(t,e){return e!==Array&&Number.isFinite(t)?e===Float64Array||Math.fround(t)!==t?Float64Array:Float32Array:Array}var tg=n(209),eg=n.n(tg);function ng(t){for(var e,n,r=0,i=0,o=t.length-1;i<t.length;o=i++)e=t[i],r+=((n=t[o])[0]-e[0])*(e[1]+n[1]);return r}function rg(t,e,n){e&&n&&(1===t?e.id=n.readVarint():2===t?function(t,e){var n=t.readVarint()+t.pos;for(;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3===t?e.type=n.readVarint():4===t&&(e._geometry=n.pos))}var ig=function(){function t(e,n,r,i,o){d()(this,t),Object(ln.a)(this,"properties",void 0),Object(ln.a)(this,"extent",void 0),Object(ln.a)(this,"type",void 0),Object(ln.a)(this,"id",void 0),Object(ln.a)(this,"_pbf",void 0),Object(ln.a)(this,"_geometry",void 0),Object(ln.a)(this,"_keys",void 0),Object(ln.a)(this,"_values",void 0),this.properties={},this.extent=r,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=i,this._values=o,e.readFields(rg,this,n)}return C()(t,[{key:"loadGeometry",value:function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,r=1,i=0,o=0,a=0,s=[];t.pos<n;){if(i<=0){var u=t.readVarint();r=7&u,i=u>>3}if(i--,1===r||2===r)o+=t.readSVarint(),a+=t.readSVarint(),1===r&&(e&&s.push(e),e=[]),e&&e.push([o,a]);else{if(7!==r)throw new Error("unknown command ".concat(r));e&&e.push(e[0].slice())}}return e&&s.push(e),s}},{key:"bbox",value:function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,r=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,c=-1/0;t.pos<e;){if(r<=0){var l=t.readVarint();n=7&l,r=l>>3}if(r--,1===n||2===n)(i+=t.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=t.readSVarint())<u&&(u=o),o>c&&(c=o);else if(7!==n)throw new Error("unknown command ".concat(n))}return[a,u,s,c]}},{key:"_toGeoJSON",value:function(e){var n,r,i=this.loadGeometry(),o=t.types[this.type];switch(this.type){case 1:var a=[];for(n=0;n<i.length;n++)a[n]=i[n][0];e(i=a,this);break;case 2:for(n=0;n<i.length;n++)e(i[n],this);break;case 3:for(i=function(t){var e=t.length;if(e<=1)return[t];for(var n,r,i=[],o=0;o<e;o++){var a=ng(t[o]);0!==a&&(void 0===r&&(r=a<0),r===a<0?(n&&i.push(n),n=[t[o]]):n&&n.push(t[o]))}return n&&i.push(n),i}(i),n=0;n<i.length;n++)for(r=0;r<i[n].length;r++)e(i[n][r],this)}1===i.length?i=i[0]:o="Multi".concat(o);var s={type:"Feature",geometry:{type:o,coordinates:i},properties:this.properties};return null!==this.id&&(s.id=this.id),s}},{key:"toGeoJSON",value:function(t){if("function"==typeof t)return this._toGeoJSON(t);var e=t.x,n=t.y,r=t.z,i=this.extent*Math.pow(2,r),o=this.extent*e,a=this.extent*n;return this._toGeoJSON((function(t){for(var e=0;e<t.length;e++){var n=t[e];n[0]=360*(n[0]+o)/i-180;var r=180-360*(n[1]+a)/i;n[1]=360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90}}))}}],[{key:"types",get:function(){return["Unknown","Point","LineString","Polygon"]}}]),t}(),og=function(){function t(e,n){d()(this,t),Object(ln.a)(this,"version",void 0),Object(ln.a)(this,"name",void 0),Object(ln.a)(this,"extent",void 0),Object(ln.a)(this,"length",void 0),Object(ln.a)(this,"_pbf",void 0),Object(ln.a)(this,"_keys",void 0),Object(ln.a)(this,"_values",void 0),Object(ln.a)(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(ag,this,n),this.length=this._features.length}return C()(t,[{key:"feature",value:function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new ig(this._pbf,e,this.extent,this._keys,this._values)}}]),t}();function ag(t,e,n){e&&n&&(15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){var e=null,n=t.readVarint()+t.pos;for(;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n)))}var sg,ug,cg,lg,fg,hg,dg,pg=function t(e,n){d()(this,t),Object(ln.a)(this,"layers",void 0),this.layers=e.readFields(vg,{},n)};function vg(t,e,n){if(3===t&&n){var r=new og(n,n.readVarint()+n.pos);r.length&&e&&(e[r.name]=r)}}function gg(t){var e=t.indices.length;if(e<=1)return{type:"Polygon",data:t.data,areas:[[Object(Gv.g)(t.data)]],indices:[t.indices]};for(var n,r,i,o=[],a=[],s=[],u=[],c=0,l=0;l<e;l++){i=t.indices[l]-c,r=t.indices[l+1]-c||t.data.length;var f=t.data.slice(i,r),h=Object(Gv.g)(f);if(0!==h)void 0===n&&(n=h<0),n===h<0?(u.length&&(o.push(s),a.push(u)),u=[i],s=[h]):(s.push(h),u.push(i));else{var d=t.data.slice(0,i),p=t.data.slice(r);t.data=d.concat(p),c+=r-i}}return s&&o.push(s),u.length&&a.push(u),{type:"Polygon",areas:o,indices:a,data:t.data}}function yg(t,e,n){e&&n&&(1===t?e.id=n.readVarint():2===t?function(t,e){var n=t.readVarint()+t.pos;for(;t.pos<n;){var r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}(n,e):3===t?e.type=n.readVarint():4===t&&(e._geometry=n.pos))}function mg(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return bg(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bg(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function bg(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ag(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ag(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ag(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Og=function(){function t(e,n,r,i,o,a){d()(this,t),Object(ln.a)(this,"properties",void 0),Object(ln.a)(this,"extent",void 0),Object(ln.a)(this,"type",void 0),Object(ln.a)(this,"id",void 0),Object(ln.a)(this,"_pbf",void 0),Object(ln.a)(this,"_geometry",void 0),Object(ln.a)(this,"_keys",void 0),Object(ln.a)(this,"_values",void 0),Object(ln.a)(this,"_geometryInfo",void 0),this.properties={},this.extent=r,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=i,this._values=o,this._geometryInfo=a,e.readFields(yg,this,n)}return C()(t,[{key:"loadGeometry",value:function(){var t=this._pbf;t.pos=this._geometry,sg=t.readVarint()+t.pos,ug=1,lg=0,fg=0,hg=0,dg=0;for(var e=[],n=[];t.pos<sg;)if(lg<=0&&(cg=t.readVarint(),ug=7&cg,lg=cg>>3),lg--,1===ug||2===ug)fg+=t.readSVarint(),hg+=t.readSVarint(),1===ug&&e.push(dg),n.push(fg,hg),dg+=2;else{if(7!==ug)throw new Error("unknown command ".concat(ug));if(dg>0){var r=e[e.length-1];n.push(n[r],n[r+1]),dg+=2}}return{data:n,indices:e}}},{key:"_toBinaryCoordinates",value:function(t){var e,n=this.loadGeometry();t(n.data,this);switch(this.type){case 1:this._geometryInfo.pointFeaturesCount++,this._geometryInfo.pointPositionsCount+=n.indices.length,e=_g({type:"Point"},n);break;case 2:this._geometryInfo.lineFeaturesCount++,this._geometryInfo.linePathsCount+=n.indices.length,this._geometryInfo.linePositionsCount+=n.data.length/2,e=_g({type:"LineString"},n);break;case 3:e=gg(n),this._geometryInfo.polygonFeaturesCount++,this._geometryInfo.polygonObjectsCount+=e.indices.length;var r,i=mg(e.indices);try{for(i.s();!(r=i.n()).done;){var o=r.value;this._geometryInfo.polygonRingsCount+=o.length}}catch(t){i.e(t)}finally{i.f()}this._geometryInfo.polygonPositionsCount+=e.data.length/2;break;default:throw new Error("Invalid geometry type: ".concat(this.type))}var a={type:"Feature",geometry:e,properties:this.properties};return null!==this.id&&(a.id=this.id),a}},{key:"toBinaryCoordinates",value:function(t){if("function"==typeof t)return this._toBinaryCoordinates(t);var e=t.x,n=t.y,r=t.z,i=this.extent*Math.pow(2,r),o=this.extent*e,a=this.extent*n;return this._toBinaryCoordinates((function(t){return function(t,e,n,r){for(var i=0,o=t.length;i<o;i+=2){t[i]=360*(t[i]+e)/r-180;var a=180-360*(t[i+1]+n)/r;t[i+1]=360/Math.PI*Math.atan(Math.exp(a*Math.PI/180))-90}}(t,o,a,i)}))}}]),t}(),wg=function(){function t(e,n){d()(this,t),Object(ln.a)(this,"version",void 0),Object(ln.a)(this,"name",void 0),Object(ln.a)(this,"extent",void 0),Object(ln.a)(this,"length",void 0),Object(ln.a)(this,"_pbf",void 0),Object(ln.a)(this,"_keys",void 0),Object(ln.a)(this,"_values",void 0),Object(ln.a)(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(xg,this,n),this.length=this._features.length}return C()(t,[{key:"feature",value:function(t,e){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var n=this._pbf.readVarint()+this._pbf.pos;return new Og(this._pbf,n,this.extent,this._keys,this._values,e)}}]),t}();function xg(t,e,n){e&&n&&(15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){var e=null,n=t.readVarint()+t.pos;for(;t.pos<n;){var r=t.readVarint()>>3;e=1===r?t.readString():2===r?t.readFloat():3===r?t.readDouble():4===r?t.readVarint64():5===r?t.readVarint():6===r?t.readSVarint():7===r?t.readBoolean():null}return e}(n)))}var Cg=function t(e,n){d()(this,t),Object(ln.a)(this,"layers",void 0),this.layers=e.readFields(Pg,{},n)};function Pg(t,e,n){if(3===t&&n){var r=new wg(n,n.readVarint()+n.pos);r.length&&e&&(e[r.name]=r)}}function Sg(t,e){var n,r,i=function(t){var e;if(null==t||!t.mvt)throw new Error("mvt options required");var n="wgs84"===(null===(e=t.mvt)||void 0===e?void 0:e.coordinates),r=t.mvt.tileIndex,i=r&&Number.isFinite(r.x)&&Number.isFinite(r.y)&&Number.isFinite(r.z);if(n&&!i)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property");return t.mvt}(e),o=(null==e?void 0:null===(n=e.gis)||void 0===n?void 0:n.format)||(null==e?void 0:null===(r=e.mvt)||void 0===r?void 0:r.shape);switch(o){case"columnar-table":return{shape:"columnar-table",data:Bg(t,i)};case"geojson-row-table":return{shape:"geojson-row-table",data:kg(t,i)};case"geojson":return kg(t,i);case"binary-geometry":case"binary":return Bg(t,i);default:throw new Error(o)}}function Bg(t,e){var n=function(t,e){var n=[],r={coordLength:2,pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(t.byteLength<=0)return[n,r];var i=new Cg(new eg.a(t));return(e&&Array.isArray(e.layers)?e.layers:Object.keys(i.layers)).forEach((function(t){var o=i.layers[t];if(o)for(var a=0;a<o.length;a++){var s=Tg(o.feature(a,r),e,t);n.push(s)}})),[n,r]}(t,e),r=M()(n,2),i=Vv(r[0],r[1]);return i.byteLength=t.byteLength,i}function kg(t,e){if(t.byteLength<=0)return[];var n=[],r=new pg(new eg.a(t));return(Array.isArray(e.layers)?e.layers:Object.keys(r.layers)).forEach((function(t){var i=r.layers[t];if(i)for(var o=0;o<i.length;o++){var a=Eg(i.feature(o),e,t);n.push(a)}})),n}function Eg(t,e,n){var r=t.toGeoJSON("wgs84"===e.coordinates?e.tileIndex:jg);return e.layerProperty&&(r.properties[e.layerProperty]=n),r}function Tg(t,e,n){var r=t.toBinaryCoordinates("wgs84"===e.coordinates?e.tileIndex:Mg);return e.layerProperty&&r.properties&&(r.properties[e.layerProperty]=n),r}function jg(t,e){for(var n=e.extent,r=0;r<t.length;r++){var i=t[r];i[0]/=n,i[1]/=n}}function Mg(t,e){for(var n=e.extent,r=0,i=t.length;r<i;++r)t[r]/=n}function Ig(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Rg(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ig(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ig(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Dg,Lg={name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:"3.2.10",extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:{mvt:{shape:"geojson",coordinates:"local",layerProperty:"layerName",layers:void 0,tileIndex:null}}};Rg(Rg({},Lg),{},{parse:(Dg=$()(et.a.mark((function t(e,n){return et.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Sg(e,n));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return Dg.apply(this,arguments)}),parseSync:Sg,binary:!0});function Fg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Gg(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ng(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ng(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ng(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ug(t,e){var n=null==e?void 0:e.globalFeatureId;return void 0!==n?function(t,e){var n,r=Gg(Vg(t));try{for(r.s();!(n=r.n()).done;){for(var i=n.value,o=0,a=i.featureIds.value[0],s=0;s<i.featureIds.value.length;s++){var u=i.featureIds.value[s];if(u!==a){if(e===i.globalFeatureIds.value[o])return Jg(i,o,s);o=s,a=u}}if(e===i.globalFeatureIds.value[o])return Jg(i,o,i.featureIds.value.length)}}catch(t){r.e(t)}finally{r.f()}throw new Error("featureId:".concat(e," not found"))}(t,n):zg(t,null==e?void 0:e.type)}function zg(t,e){return function(t){var e,n=[],r=Gg(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(0!==i.featureIds.value.length){for(var o=0,a=i.featureIds.value[0],s=0;s<i.featureIds.value.length;s++){var u=i.featureIds.value[s];u!==a&&(n.push(Jg(i,o,s)),o=s,a=u)}n.push(Jg(i,o,i.featureIds.value.length))}}}catch(t){r.e(t)}finally{r.f()}return n}(Vg(t,e))}function Hg(t,e,n){switch(t.type){case"Point":return function(t,e,n){var r=Wg(t.positions,e,n);if(r.length>1)return{type:"MultiPoint",coordinates:r};return{type:"Point",coordinates:r[0]}}(t,e,n);case"LineString":return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,r=t.positions,i=t.pathIndices.value.filter((function(t){return t>=e&&t<=n})),o=i.length>2;if(!o){var a=Wg(r,i[0],i[1]);return{type:"LineString",coordinates:a}}for(var s=[],u=0;u<i.length-1;u++){var c=Wg(r,i[u],i[u+1]);s.push(c)}return{type:"MultiLineString",coordinates:s}}(t,e,n);case"Polygon":return function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,i=e.positions,o=e.polygonIndices.value.filter((function(t){return t>=n&&t<=r})),a=e.primitivePolygonIndices.value.filter((function(t){return t>=n&&t<=r})),s=o.length>2;if(!s){for(var u=[],c=0;c<a.length-1;c++){var l=a[c],f=a[c+1],h=Wg(i,l,f);u.push(h)}return{type:"Polygon",coordinates:u}}for(var d=[],p=0;p<o.length-1;p++){var v=o[p],g=o[p+1],y=t(e,v,g).coordinates;d.push(y)}return{type:"MultiPolygon",coordinates:d}}(t,e,n);default:var r=t;throw new Error("Unsupported geometry type: ".concat(null==r?void 0:r.type))}}function Vg(t,e){if(!Boolean(t.points||t.lines||t.polygons))return t.type=e||function(t){if(t.pathIndices)return"LineString";if(t.polygonIndices)return"Polygon";return"Point"}(t),[t];var n=[];return t.points&&(t.points.type="Point",n.push(t.points)),t.lines&&(t.lines.type="LineString",n.push(t.lines)),t.polygons&&(t.polygons.type="Polygon",n.push(t.polygons)),n}function Jg(t,e,n){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fg(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fg(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({type:"Feature",geometry:Hg(t,e,n),properties:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(arguments.length>2&&arguments[2],Object.assign({},t.properties[t.featureIds.value[e]]));for(var r in t.numericProps)n[r]=t.numericProps[r].value[e];return n}(t,e,n)},function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;arguments.length>2&&arguments[2];return t.fields&&t.fields[t.featureIds.value[e]]}(t,e,n))}function Wg(t,e,n){e=e||0,n=n||t.value.length/t.size;for(var r=[],i=e;i<n;i++){for(var o=Array(),a=i*t.size;a<(i+1)*t.size;a++)o.push(Number(t.value[a]));r.push(o)}return r}var Kg=n(235);function Xg(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function qg(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xg(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xg(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Qg={Point:Zg,MultiPoint:function(t,e,n){return Yg(t,e,n)},LineString:$g,MultiLineString:function(t,e,n){return t.map((function(t){return $g(t,e,n)}))},Polygon:ty,MultiPolygon:function(t,e,n){return t.map((function(t){return ty(t,e,n)}))}};function Zg(t,e,n){var r=M()(t,2),i=r[0],o=r[1],a=M()(e,2),s=a[0],u=a[1],c=Object(de.g)(s[0],u[0],i),l=Object(de.g)(s[1],u[1],o);return n.unprojectFlat([c,l])}function Yg(t,e,n){return t.map((function(t){return Zg(t,e,n)}))}function $g(t,e,n){return Yg(t,e,n)}function ty(t,e,n){return t.map((function(t){return Yg(t,e,n)}))}function ey(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return ny(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ny(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ny(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var ry=["points","lines","polygons"];function iy(t,e,n,r){var i=t.featureIds.value;if(!i.length)return-1;var o=0,a=i[i.length-1]+1;if(r){var s=function(t,e){if(!t.__layers){for(var n={},r=t.properties,i=0;i<r.length;i++){var o=r[i].layerName;o&&(n[o]?n[o][1]=i:n[o]=[i,i])}t.__layers=n}return t.__layers[e]}(t,r);if(!s)return-1;o=s[0],a=s[1]+1}var u=-1;if(e in t.numericProps){var c=t.numericProps[e].value.findIndex((function(t,e){return t===n&&i[e]>=o&&i[e]<a}));return c>=0?t.globalFeatureIds.value[c]:-1}return e?u=oy(t.properties,(function(t){return t[e]===n}),o,a):t.fields&&(u=oy(t.fields,(function(t){return t.id===n}),o,a)),u>=0?function(t,e){if(!t.__ids){for(var n=[],r=t.featureIds.value,i=t.globalFeatureIds.value,o=0;o<r.length;o++)n[r[o]]=i[o];t.__ids=n}return t.__ids[e]}(t,u):-1}function oy(t,e,n,r){for(var i=n;i<r;i++)if(e(t[i],i))return i;return-1}function ay(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return sy(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sy(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function sy(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function uy(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}function cy(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ly(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?cy(Object(n),!0).forEach((function(e){_()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cy(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var fy=ly(ly({},Z.a.defaultProps),{},{onDataLoad:{type:"function",value:null,optional:!0,compare:!1},uniqueIdProperty:"",highlightedFeatureId:null,loaders:[Lg],binary:!0}),hy=function(t){v()(r,t);var e,n=uy(r);function r(){return d()(this,r),n.apply(this,arguments)}return C()(r,[{key:"initializeState",value:function(){En()(b()(r.prototype),"initializeState",this).call(this);var t=void 0===this.context.viewport.resolution&&this.props.binary;this.setState({binary:t,data:null,tileJSON:null})}},{key:"isLoaded",get:function(){return this.state&&this.state.data&&this.state.tileset&&En()(b()(r.prototype),"isLoaded",this)}},{key:"updateState",value:function(t){var e,n=t.props,i=t.oldProps,o=t.context,a=t.changeFlags;a.dataChanged&&this._updateTileData(),null!==(e=this.state)&&void 0!==e&&e.data&&(En()(b()(r.prototype),"updateState",this).call(this,{props:n,oldProps:i,context:o,changeFlags:a}),this._setWGS84PropertyForTiles());var s=n.highlightColor;s!==i.highlightColor&&Array.isArray(s)&&this.setState({highlightColor:s})}},{key:"_updateTileData",value:(e=$()(et.a.mark((function t(){var e,n,r,i,o;return et.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.props.data,n=null,"string"!=typeof e||/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(e)){t.next=18;break}return r=this.props,i=r.onDataLoad,o=r.fetch,this.setState({data:null,tileJSON:null}),t.prev=5,t.next=8,o(e,{propName:"data",layer:this,loaders:[]});case 8:n=t.sent,t.next=15;break;case 11:t.prev=11,t.t0=t.catch(5),this.raiseError(t.t0,"loading TileJSON"),e=null;case 15:i&&i(n,{propName:"data",layer:this}),t.next=19;break;case 18:e.tilejson&&(n=e);case 19:n&&(e=n.tiles),this.setState({data:e,tileJSON:n});case 21:case"end":return t.stop()}}),t,this,[[5,11]])}))),function(){return e.apply(this,arguments)})},{key:"_getTilesetOptions",value:function(){var t=En()(b()(r.prototype),"_getTilesetOptions",this).call(this),e=this.state.tileJSON,n=this.props,i=n.minZoom,o=n.maxZoom;return e&&(Number.isFinite(e.minzoom)&&e.minzoom>i&&(t.minZoom=e.minzoom),Number.isFinite(e.maxzoom)&&(!Number.isFinite(o)||e.maxzoom<o)&&(t.maxZoom=e.maxzoom)),t}},{key:"renderLayers",value:function(){var t;return null!==(t=this.state)&&void 0!==t&&t.data?En()(b()(r.prototype),"renderLayers",this).call(this):null}},{key:"getTileData",value:function(t){var e,n=this.state,r=n.data,i=n.binary,o=t.index,a=t.signal,s=en(r,t);if(!s)return Promise.reject("Invalid URL");var u=this.getLoadOptions();return(0,this.props.fetch)(s,{propName:"data",layer:this,loadOptions:u=ly(ly({},u),{},{mimeType:"application/x-protobuf",mvt:ly(ly({},null===(e=u)||void 0===e?void 0:e.mvt),{},{coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:o}),gis:i?{format:"binary"}:{}}),signal:a})}},{key:"renderSubLayers",value:function(t){var e=t.tile.index,n=e.x,i=e.y,o=e.z,a=Math.pow(2,o),s=512/a,u=-s,c=512*n/a,l=512*(1-i/a),f=(new we.a).scale([s,u,1]);t.autoHighlight=!1,this.context.viewport.resolution||(t.modelMatrix=f,t.coordinateOrigin=[c,l,0],t.coordinateSystem=ir.a.CARTESIAN,t.extensions=[].concat(ot()(t.extensions||[]),[new Kg.a]));var h=En()(b()(r.prototype),"renderSubLayers",this).call(this,t);return!this.state.binary||h instanceof Z.a||nt.a.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),h}},{key:"_updateAutoHighlight",value:function(t){var e,n,r=this.props.uniqueIdProperty,i=this.state,o=i.hoveredFeatureId,a=i.hoveredFeatureLayerName,s=t.object;s&&(e=dy(s,r),n=py(s));var u=this.props.highlightColor;"function"==typeof u&&(u=u(t)),o===e&&a===n||this.setState({highlightColor:u,hoveredFeatureId:e,hoveredFeatureLayerName:n})}},{key:"getPickingInfo",value:function(t){var e=En()(b()(r.prototype),"getPickingInfo",this).call(this,t),n=Boolean(this.context.viewport.resolution);if(this.state.binary&&-1!==e.index){var i=t.sourceLayer.props.data;e.object=Ug(i,{globalFeatureId:e.index})}return e.object&&!n&&(e.object=gy(e.object,e.tile.bbox,this.context.viewport)),e}},{key:"getSubLayerPropsByTile",value:function(t){return{highlightedObjectIndex:this.getHighlightedObjectIndex(t),highlightColor:this.state.highlightColor}}},{key:"getHighlightedObjectIndex",value:function(t){var e=this.state,n=e.hoveredFeatureId,r=e.hoveredFeatureLayerName,i=e.binary,o=this.props,a=o.uniqueIdProperty,s=o.highlightedFeatureId,u=t.content,c=vy(s);if(!(vy(n)||c))return-1;var l=c?s:n;return Array.isArray(u)?u.findIndex((function(t){var e=dy(t,a)===l,n=c||py(t)===r;return e&&n})):u&&i?function(t,e,n,r){var i,o=ey(ry);try{for(o.s();!(i=o.n()).done;){var a=i.value,s=t[a]&&iy(t[a],e,n,r);if(s>=0)return s}}catch(t){o.e(t)}finally{o.f()}return-1}(u,a,l,c?"":r):-1}},{key:"_pickObjects",value:function(t){var e=this.context,n=e.deck,r=e.viewport,i=r.width,o=r.height,a=r.x,s=r.y,u=[this.id];return n.pickObjects({x:a,y:s,width:i,height:o,layerIds:u,maxObjects:t})}},{key:"getRenderedFeatures",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this._pickObjects(e),r=new Set,i=[],o=ay(n);try{for(o.s();!(t=o.n()).done;){var a=t.value,s=dy(a.object,this.props.uniqueIdProperty);void 0===s?i.push(a.object):r.has(s)||(r.add(s),i.push(a.object))}}catch(t){o.e(t)}finally{o.f()}return i}},{key:"_setWGS84PropertyForTiles",value:function(){var t=this;this.state.tileset.selectedTiles.forEach((function(e){e.hasOwnProperty("dataInWGS84")||Object.defineProperty(e,"dataInWGS84",{get:function(){if(!e.content)return null;if(t.state.binary&&Array.isArray(e.content)&&!e.content.length)return[];var n,r=e.bbox;if(void 0===e._contentWGS84&&(n=r,Number.isFinite(n.west)&&Number.isFinite(n.north)&&Number.isFinite(n.east)&&Number.isFinite(n.south))){var i=t.state.binary?Ug(e.content):e.content;e._contentWGS84=i.map((function(e){return gy(e,r,t.context.viewport)}))}return e._contentWGS84}})}))}}]),r}(Bn);function dy(t,e){return t.properties&&e?t.properties[e]:"id"in t?t.id:void 0}function py(t){var e;return(null===(e=t.properties)||void 0===e?void 0:e.layerName)||null}function vy(t){return null!=t&&""!==t}function gy(t,e,n){var r=ly(ly({},t),{},{geometry:{type:t.geometry.type}});return Object.defineProperty(r.geometry,"coordinates",{get:function(){return function(t,e,n){var r=[n.projectFlat([e.west,e.north]),n.projectFlat([e.east,e.south])];return qg(qg({},t),{},{coordinates:Qg[t.type](t.coordinates,r,n)})}(t.geometry,e,n).coordinates}}),r}_()(hy,"layerName","MVTLayer"),_()(hy,"defaultProps",fy);for(var yy={},my=0;my<"0123456789bcdefghjkmnpqrstuvwxyz".length;my++)yy["0123456789bcdefghjkmnpqrstuvwxyz".charAt(my)]=my;function by(t){var e=function(t){for(var e,n=!0,r=90,i=-90,o=180,a=-180,s=0,u=0,c=t.length;u<c;u++){var l=t[u].toLowerCase();s=yy[l];for(var f=4;f>=0;f--){var h=s>>f&1;n?(e=(o+a)/2,1===h?a=e:o=e):(e=(r+i)/2,1===h?i=e:r=e),n=!n}}return[i,a,r,o]}(t),n=M()(e,4),r=n[0],i=n[1],o=n[2],a=n[3];return[a,o,a,r,i,r,i,o,a,o]}function Ay(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b()(t);if(e){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var _y=function(t){v()(n,t);var e=Ay(n);function n(){return d()(this,n),e.apply(this,arguments)}return C()(n,[{key:"indexToBounds",value:function(){var t=this.props,e=t.data,n=t.getGeohash;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:function(t,e){return by(n(t,e))}}}}]),n}(T);_()(_y,"layerName","GeohashLayer"),_()(_y,"defaultProps",{getGeohash:{type:"accessor",value:function(t){return t.geohash}}}),n.d(e,"GreatCircleLayer",(function(){return w})),n.d(e,"S2Layer",(function(){return J})),n.d(e,"QuadkeyLayer",(function(){return q})),n.d(e,"TileLayer",(function(){return Bn})),n.d(e,"TripsLayer",(function(){return In})),n.d(e,"H3ClusterLayer",(function(){return nr})),n.d(e,"H3HexagonLayer",(function(){return Yn})),n.d(e,"Tile3DLayer",(function(){return kv})),n.d(e,"TerrainLayer",(function(){return Fv})),n.d(e,"MVTLayer",(function(){return hy})),n.d(e,"GeohashLayer",(function(){return _y})),n.d(e,"_GeoCellLayer",(function(){return T})),n.d(e,"_getURLFromTemplate",(function(){return en})),n.d(e,"_Tileset2D",(function(){return _n})),n.d(e,"_Tile2DHeader",(function(){return rt}))},function(t,e,n){"use strict";n.r(e);var r,i,o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(9),l=n.n(c),f=n(10),h=n.n(f),d=n(5),p=n.n(d),v=n(7),g=n.n(v),y=n(2),m=n.n(y),b=n(0),A=n.n(b),_=n(31),O=n(198),w=n(12),x=n(264),C=n(212),P=n(194),S=n(349),B=n(350),k=n(174),E=n(228),T={SUM:1,MEAN:2,MIN:3,MAX:4};function j(t,e){return t+e}function M(t,e){return e>t?e:t}function I(t,e){return e<t?e:t}function R(t,e,n){var r=T[t]||T.SUM;switch(e=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Number.isFinite(t))return t;return function(n){return e.index=n.index,t(n.source,e)}}(e,n),r){case T.MIN:return function(t){return function(t,e){if(Number.isFinite(e))return t.length?e:null;var n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(I,1/0):null}(t,e)};case T.SUM:return function(t){return function(t,e){if(Number.isFinite(e))return t.length?t.length*e:null;var n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(j,0):null}(t,e)};case T.MEAN:return function(t){return function(t,e){if(Number.isFinite(e))return t.length?e:null;var n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(j,0)/n.length:null}(t,e)};case T.MAX:return function(t){return function(t,e){if(Number.isFinite(e))return t.length?e:null;var n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(M,-1/0):null}(t,e)};default:return null}}function D(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){return e.indices=n.map((function(t){return t.index})),t(n.map((function(t){return t.source})),e)}}var L,F={projectPoints:!1,viewport:null,createBufferObjects:!0,moduleSettings:{}},G=[32775,32774],N=[32776,32774],U=[32776,32775],z=(r={},A()(r,T.SUM,32774),A()(r,T.MEAN,32774),A()(r,T.MIN,G),A()(r,T.MAX,N),r),H={size:1,operation:T.SUM,needMin:!1,needMax:!1,combineMaxMin:!1},V=(i={},A()(i,10240,9728),A()(i,10241,9728),n(123)),J=n(95),W=(L={},A()(L,10240,9728),A()(L,10241,9728),L);function K(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.width,r=void 0===n?1:n,i=e.height,o=void 0===i?1:i,a=e.data,s=void 0===a?null:a,u=e.unpackFlipY,c=void 0===u||u,l=e.parameters,f=void 0===l?W:l,h=new V.a(t,{data:s,format:Object(w.j)(t)?34836:6408,type:5126,border:0,mipmaps:!1,parameters:f,dataFormat:6408,width:r,height:o,unpackFlipY:c});return h}function X(t,e){var n=e.id,r=e.width,i=void 0===r?1:r,o=e.height,a=void 0===o?1:o,s=e.texture;return new J.a(t,{id:n,width:i,height:a,attachments:A()({},36064,s)})}function q(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var $=["aggregationBuffer","maxMinBuffer","minBuffer","maxBuffer"],tt={maxData:"maxBuffer",minData:"minBuffer",maxMinData:"maxMinBuffer"},et=[O.a.WEBGL2,O.a.COLOR_ATTACHMENT_RGBA32F,O.a.BLEND_EQUATION_MINMAX,O.a.FLOAT_BLEND,O.a.TEXTURE_FLOAT],nt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a()(this,t),this.id=n.id||"gpu-grid-aggregator",this.gl=e,this.state={weightAttributes:{},textures:{},meanTextures:{},buffers:{},framebuffers:{},maxMinFramebuffers:{},minFramebuffers:{},maxFramebuffers:{},equations:{},resources:{},results:{}},this._hasGPUSupport=Object(w.j)(e)&&Object(x.c)(this.gl,O.a.BLEND_EQUATION_MINMAX,O.a.COLOR_ATTACHMENT_RGBA32F,O.a.TEXTURE_FLOAT),this._hasGPUSupport&&this._setupModels()}return u()(t,[{key:"delete",value:function(){var t=this.gridAggregationModel,e=this.allAggregationModel,n=this.meanTransform,r=this.state,i=r.textures,o=r.framebuffers,a=r.maxMinFramebuffers,s=r.minFramebuffers,u=r.maxFramebuffers,c=r.meanTextures,l=r.resources;null==t||t.delete(),null==e||e.delete(),null==n||n.delete(),function(t){(t=Array.isArray(t)?t:[t]).forEach((function(t){for(var e in t)t[e].delete()}))}([o,i,a,s,u,c,l])}},{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setState({results:{}});var e=this._normalizeAggregationParams(t);return this._hasGPUSupport||_.a.log(1,"GPUGridAggregator: not supported")(),this._runAggregation(e)}},{key:"getData",value:function(t){var e={},n=this.state.results;for(var r in n[t].aggregationData||(n[t].aggregationData=n[t].aggregationBuffer.getData()),e.aggregationData=n[t].aggregationData,tt){var i=tt[r];(n[t][r]||n[t][i])&&(n[t][r]=n[t][r]||n[t][i].getData(),e[r]=n[t][r])}return e}},{key:"updateShaders",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setState({shaderOptions:t,modelDirty:!0})}},{key:"_normalizeAggregationParams",value:function(t){var e=Y(Y({},F),t),n=e.weights;return n&&(e.weights=function(t){var e={};for(var n in t)e[n]=Y(Y({},H),t[n]);return e}(n)),e}},{key:"setState",value:function(t){Object.assign(this.state,t)}},{key:"_getAggregateData",value:function(t){var e={},n=this.state,r=n.textures,i=n.framebuffers,o=n.maxMinFramebuffers,a=n.minFramebuffers,s=n.maxFramebuffers,u=n.resources,c=t.weights;for(var l in c){e[l]={};var f=c[l],h=f.needMin,d=f.needMax,p=f.combineMaxMin;e[l].aggregationTexture=r[l],e[l].aggregationBuffer=Object(C.d)(i[l],{target:c[l].aggregationBuffer,sourceType:5126}),h&&d&&p?(e[l].maxMinBuffer=Object(C.d)(o[l],{target:c[l].maxMinBuffer,sourceType:5126}),e[l].maxMinTexture=u["".concat(l,"-maxMinTexture")]):(h&&(e[l].minBuffer=Object(C.d)(a[l],{target:c[l].minBuffer,sourceType:5126}),e[l].minTexture=u["".concat(l,"-minTexture")]),d&&(e[l].maxBuffer=Object(C.d)(s[l],{target:c[l].maxBuffer,sourceType:5126}),e[l].maxTexture=u["".concat(l,"-maxTexture")]))}return this._trackGPUResultBuffers(e,c),e}},{key:"_renderAggregateData",value:function(t){var e=t.cellSize,n=t.projectPoints,r=t.attributes,i=t.moduleSettings,o=t.numCol,a=t.numRow,s=t.weights,u=t.translation,c=t.scaling,l=this.state,f=l.maxMinFramebuffers,h=l.minFramebuffers,d=l.maxFramebuffers,p=[o,a],v={blend:!0,depthTest:!1,blendFunc:[1,1]},g={cellSize:e,gridSize:p,projectPoints:n,translation:u,scaling:c};for(var y in s){var m=s[y],b=m.needMin,A=m.needMax,_=b&&A&&s[y].combineMaxMin;this._renderToWeightsTexture({id:y,parameters:v,moduleSettings:i,uniforms:g,gridSize:p,attributes:r,weights:s}),_?this._renderToMaxMinTexture({id:y,parameters:Y(Y({},v),{},{blendEquation:U}),gridSize:p,minOrMaxFb:f[y],clearParams:{clearColor:[0,0,0,3402823466e29]},combineMaxMin:_}):(b&&this._renderToMaxMinTexture({id:y,parameters:Y(Y({},v),{},{blendEquation:G}),gridSize:p,minOrMaxFb:h[y],clearParams:{clearColor:[3402823466e29,3402823466e29,3402823466e29,0]},combineMaxMin:_}),A&&this._renderToMaxMinTexture({id:y,parameters:Y(Y({},v),{},{blendEquation:N}),gridSize:p,minOrMaxFb:d[y],clearParams:{clearColor:[0,0,0,0]},combineMaxMin:_}))}}},{key:"_renderToMaxMinTexture",value:function(t){var e=t.id,n=t.parameters,r=t.gridSize,i=t.minOrMaxFb,o=t.combineMaxMin,a=t.clearParams,s=void 0===a?{}:a,u=this.state.framebuffers,c=this.gl,l=this.allAggregationModel;Object(w.o)(c,Y(Y({},s),{},{framebuffer:i,viewport:[0,0,r[0],r[1]]}),(function(){c.clear(16384),l.draw({parameters:n,uniforms:{uSampler:u[e].texture,gridSize:r,combineMaxMin:o}})}))}},{key:"_renderToWeightsTexture",value:function(t){var e=t.id,n=t.parameters,r=t.moduleSettings,i=t.uniforms,o=t.gridSize,a=t.weights,s=this.state,u=s.framebuffers,c=s.equations,l=s.weightAttributes,f=this.gl,h=this.gridAggregationModel,d=a[e].operation,p=d===T.MIN?[3402823466e29,3402823466e29,3402823466e29,0]:[0,0,0,0];if(Object(w.o)(f,{framebuffer:u[e],viewport:[0,0,o[0],o[1]],clearColor:p},(function(){f.clear(16384);var t={weights:l[e]};h.draw({parameters:Y(Y({},n),{},{blendEquation:c[e]}),moduleSettings:r,uniforms:i,attributes:t})})),d===T.MEAN){var v=this.state,g=v.meanTextures,y=v.textures,m={_sourceTextures:{aggregationValues:g[e]},_targetTexture:y[e],elementCount:y[e].width*y[e].height};this.meanTransform?this.meanTransform.update(m):this.meanTransform=function(t,e){return new S.a(t,Y({vs:"#define SHADER_NAME gpu-aggregation-transform-mean-vs\nattribute vec4 aggregationValues;\nvarying vec4 meanValues;\n\nvoid main()\n{\n  bool isCellValid = bool(aggregationValues.w > 0.);\n  meanValues.xyz = isCellValid ? aggregationValues.xyz/aggregationValues.w : vec3(0, 0, 0);\n  meanValues.w = aggregationValues.w;\n  gl_PointSize = 1.0;\n}\n",_targetTextureVarying:"meanValues"},e))}(f,m),this.meanTransform.run({parameters:{blend:!1,depthTest:!1}}),u[e].attach(A()({},36064,y[e]))}}},{key:"_runAggregation",value:function(t){this._updateModels(t),this._setupFramebuffers(t),this._renderAggregateData(t);var e=this._getAggregateData(t);return this.setState({results:e}),e}},{key:"_setupFramebuffers",value:function(t){var e=this.state,n=e.textures,r=e.framebuffers,i=e.maxMinFramebuffers,o=e.minFramebuffers,a=e.maxFramebuffers,s=e.meanTextures,u=e.equations,c=t.weights,l=t.numCol,f=t.numRow,h={width:l,height:f};for(var d in c){var p=c[d],v=p.needMin,g=p.needMax,y=p.combineMaxMin,m=p.operation;n[d]=c[d].aggregationTexture||n[d]||K(this.gl,{id:"".concat(d,"-texture"),width:l,height:f}),n[d].resize(h);var b=n[d];m===T.MEAN&&(s[d]=s[d]||K(this.gl,{id:"".concat(d,"-mean-texture"),width:l,height:f}),s[d].resize(h),b=s[d]),r[d]?r[d].attach(A()({},36064,b)):r[d]=X(this.gl,{id:"".concat(d,"-fb"),width:l,height:f,texture:b}),r[d].resize(h),u[d]=z[m]||z.SUM,(v||g)&&(v&&g&&y?i[d]||(b=c[d].maxMinTexture||this._getMinMaxTexture("".concat(d,"-maxMinTexture")),i[d]=X(this.gl,{id:"".concat(d,"-maxMinFb"),texture:b})):(v&&(o[d]||(b=c[d].minTexture||this._getMinMaxTexture("".concat(d,"-minTexture")),o[d]=X(this.gl,{id:"".concat(d,"-minFb"),texture:b}))),g&&(a[d]||(b=c[d].maxTexture||this._getMinMaxTexture("".concat(d,"-maxTexture")),a[d]=X(this.gl,{id:"".concat(d,"-maxFb"),texture:b})))))}}},{key:"_getMinMaxTexture",value:function(t){var e=this.state.resources;return e[t]||(e[t]=K(this.gl,{id:"resourceName"})),e[t]}},{key:"_setupModels",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.numCol,r=void 0===n?0:n,i=e.numRow,o=void 0===i?0:i,a=this.gl,s=this.state.shaderOptions;if(null===(t=this.gridAggregationModel)||void 0===t||t.delete(),this.gridAggregationModel=rt(a,s),!this.allAggregationModel){var u=r*o;this.allAggregationModel=it(a,u)}}},{key:"_setupWeightAttributes",value:function(t){var e=this.state.weightAttributes,n=t.weights;for(var r in n)e[r]=t.attributes[r]}},{key:"_trackGPUResultBuffers",value:function(t,e){var n=this.state.resources;for(var r in t)if(t[r]){var i,o=q($);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(t[r][a]&&e[r][a]!==t[r][a]){var s="gpu-result-".concat(r,"-").concat(a);n[s]&&n[s].delete(),n[s]=t[r][a]}}}catch(t){o.e(t)}finally{o.f()}}}},{key:"_updateModels",value:function(t){var e=t.vertexCount,n=t.attributes,r=t.numCol,i=t.numRow;this.state.modelDirty&&(this._setupModels(t),this.setState({modelDirty:!1})),this._setupWeightAttributes(t),this.gridAggregationModel.setVertexCount(e),this.gridAggregationModel.setAttributes(n),this.allAggregationModel.setInstanceCount(r*i)}}],[{key:"getAggregationData",value:function(t){var e=t.aggregationData,n=t.maxData,r=t.minData,i=t.maxMinData,o=4*t.pixelIndex,a={};return e&&(a.cellCount=e[o+3],a.cellWeight=e[o]),i?(a.maxCellWieght=i[0],a.minCellWeight=i[3]):(n&&(a.maxCellWieght=n[0],a.totalCount=n[3]),r&&(a.minCellWeight=r[0],a.totalCount=n[3])),a}},{key:"getCellData",value:function(t){for(var e=t.countsData,n=t.size,r=void 0===n?1:n,i=e.length/4,o=new Float32Array(i*r),a=new Uint32Array(i),s=0;s<i;s++){for(var u=0;u<r;u++)o[s*r+u]=e[4*s+u];a[s]=e[4*s+3]}return{cellCounts:a,cellWeights:o}}},{key:"isSupported",value:function(t){return Object(x.c)(t,et)}}]),t}();function rt(t,e){var n=Object(k.a)({vs:"#define SHADER_NAME gpu-aggregation-to-grid-vs\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute vec3 weights;\nuniform vec2 cellSize;\nuniform vec2 gridSize;\nuniform bool projectPoints;\nuniform vec2 translation;\nuniform vec3 scaling;\n\nvarying vec3 vWeights;\n\nvec2 project_to_pixel(vec4 pos) {\n  vec4 result;\n  pos.xy = pos.xy/pos.w;\n  result = pos + vec4(translation, 0., 0.);\n  result.xy = scaling.z > 0. ? result.xy * scaling.xy : result.xy;\n  return result.xy;\n}\n\nvoid main(void) {\n\n  vWeights = weights;\n\n  vec4 windowPos = vec4(positions, 1.);\n  if (projectPoints) {\n    windowPos = project_position_to_clipspace(positions, positions64Low, vec3(0));\n  }\n\n  vec2 pos = project_to_pixel(windowPos);\n\n  vec2 pixelXY64[2];\n  pixelXY64[0] = vec2(pos.x, 0.);\n  pixelXY64[1] = vec2(pos.y, 0.);\n  vec2 gridXY64[2];\n  gridXY64[0] = div_fp64(pixelXY64[0], vec2(cellSize.x, 0));\n  gridXY64[1] = div_fp64(pixelXY64[1], vec2(cellSize.y, 0));\n  float x = floor(gridXY64[0].x);\n  float y = floor(gridXY64[1].x);\n  pos = vec2(x, y);\n  pos = (pos * (2., 2.) / (gridSize)) - (1., 1.);\n  vec2 offset = 1.0 / gridSize;\n  pos = pos + offset;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n  gl_PointSize = 1.0;\n}\n",fs:"#define SHADER_NAME gpu-aggregation-to-grid-fs\n\nprecision highp float;\n\nvarying vec3 vWeights;\n\nvoid main(void) {\n  gl_FragColor = vec4(vWeights, 1.0);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[B.b,E.a]},e);return new P.a(t,Y({id:"Gird-Aggregation-Model",vertexCount:1,drawMode:0},n))}function it(t,e){return new P.a(t,{id:"All-Aggregation-Model",vs:"#version 300 es\n#define SHADER_NAME gpu-aggregation-all-vs-64\n\nin vec2 position;\nuniform ivec2 gridSize;\nout vec2 vTextureCoord;\n\nvoid main(void) {\n  vec2 pos = vec2(-1.0, -1.0);\n  vec2 offset = 1.0 / vec2(gridSize);\n  pos = pos + offset;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n\n  int yIndex = gl_InstanceID / gridSize[0];\n  int xIndex = gl_InstanceID - (yIndex * gridSize[0]);\n\n  vec2 yIndexFP64 = vec2(float(yIndex), 0.);\n  vec2 xIndexFP64 = vec2(float(xIndex), 0.);\n  vec2 gridSizeYFP64 = vec2(gridSize[1], 0.);\n  vec2 gridSizeXFP64 = vec2(gridSize[0], 0.);\n\n  vec2 texCoordXFP64 = div_fp64(yIndexFP64, gridSizeYFP64);\n  vec2 texCoordYFP64 = div_fp64(xIndexFP64, gridSizeXFP64);\n\n  vTextureCoord = vec2(texCoordYFP64.x, texCoordXFP64.x);\n  gl_PointSize = 1.0;\n}\n",fs:"#version 300 es\n#define SHADER_NAME gpu-aggregation-all-fs\n\nprecision highp float;\n\nin vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform bool combineMaxMin;\nout vec4 fragColor;\nvoid main(void) {\n  vec4 textureColor = texture(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n  if (textureColor.a == 0.) {\n    discard;\n  }\n  fragColor.rgb = textureColor.rgb;\n  fragColor.a = combineMaxMin ? textureColor.r : textureColor.a;\n}\n",modules:[B.b],vertexCount:1,drawMode:0,isInstanced:!0,instanceCount:e,attributes:{position:[0,0]}})}var ot=n(82),at=n(247),st=n(176),ut=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function ct(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float32Array;if(Number.isFinite(t[0]))e=new r(t);else{e=new r(4*t.length);for(var i=0,o=0;o<t.length;o++){var a=t[o];e[i++]=a[0],e[i++]=a[1],e[i++]=a[2],e[i++]=Number.isFinite(a[3])?a[3]:255}}if(n)for(var s=0;s<e.length;s++)e[s]/=255;return e}function lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lt(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ht(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var dt=[0,0,0,0],pt=[0,255,0,255],vt=["minColor","maxColor","colorRange","colorDomain"],gt={cellSizePixels:{value:100,min:1},cellMarginPixels:{value:2,min:0,max:5},colorDomain:null,colorRange:ut},yt=function(t){p()(n,t);var e=ht(n);function n(){var t;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),A()(l()(t),"state",void 0),t}return u()(n,[{key:"getShaders",value:function(){return{vs:"#define SHADER_NAME screen-grid-layer-vertex-shader\n#define RANGE_COUNT 6\n\nattribute vec3 positions;\nattribute vec3 instancePositions;\nattribute vec4 instanceCounts;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform vec3 cellScale;\nuniform vec4 minColor;\nuniform vec4 maxColor;\nuniform vec4 colorRange[RANGE_COUNT];\nuniform vec2 colorDomain;\nuniform bool shouldUseMinMax;\nuniform sampler2D maxTexture;\n\nvarying vec4 vColor;\nvarying float vSampleCount;\n\nvec4 quantizeScale(vec2 domain, vec4 range[RANGE_COUNT], float value) {\n  vec4 outColor = vec4(0., 0., 0., 0.);\n  if (value >= domain.x && value <= domain.y) {\n    float domainRange = domain.y - domain.x;\n    if (domainRange <= 0.) {\n      outColor = colorRange[0];\n    } else {\n      float rangeCount = float(RANGE_COUNT);\n      float rangeStep = domainRange / rangeCount;\n      float idx = floor((value - domain.x) / rangeStep);\n      idx = clamp(idx, 0., rangeCount - 1.);\n      int intIdx = int(idx);\n      outColor = colorRange[intIdx];\n    }\n  }\n  outColor = outColor / 255.;\n  return outColor;\n}\n\nvoid main(void) {\n  vSampleCount = instanceCounts.a;\n\n  float weight = instanceCounts.r;\n  float maxWeight = texture2D(maxTexture, vec2(0.5)).r;\n\n  float step = weight / maxWeight;\n  vec4 minMaxColor = mix(minColor, maxColor, step) / 255.;\n\n  vec2 domain = colorDomain;\n  float domainMaxValid = float(colorDomain.y != 0.);\n  domain.y = mix(maxWeight, colorDomain.y, domainMaxValid);\n  vec4 rangeColor = quantizeScale(domain, colorRange, weight);\n\n  float rangeMinMax = float(shouldUseMinMax);\n  vec4 color = mix(rangeColor, minMaxColor, rangeMinMax);\n  vColor = vec4(color.rgb, color.a * opacity);\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n\n  gl_Position = vec4(instancePositions + positions * cellScale, 1.);\n}\n",fs:"#define SHADER_NAME screen-grid-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying float vSampleCount;\n\nvoid main(void) {\n  if (vSampleCount <= 0.0) {\n    discard;\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[at.a]}}},{key:"initializeState",value:function(){var t=this.context.gl;this.getAttributeManager().addInstanced({instancePositions:{size:3,update:this.calculateInstancePositions},instanceCounts:{size:4,noAlloc:!0}}),this.setState({model:this._getModel(t)})}},{key:"shouldUpdateState",value:function(t){return t.changeFlags.somethingChanged}},{key:"updateState",value:function(t){h()(m()(n.prototype),"updateState",this).call(this,t);var e=t.oldProps,r=t.props,i=t.changeFlags,o=this.getAttributeManager();r.numInstances!==e.numInstances?o.invalidateAll():e.cellSizePixels!==r.cellSizePixels&&o.invalidate("instancePositions"),this._updateUniforms(e,r,i)}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.parameters,i=n.maxTexture,o=this.props.minColor||dt,a=this.props.maxColor||pt,s=this.props.colorDomain||[1,0];this.state.model.setUniforms(e).setUniforms({minColor:o,maxColor:a,maxTexture:i,colorDomain:s}).draw({parameters:ft({depthTest:!1,depthMask:!1},r)})}},{key:"calculateInstancePositions",value:function(t,e){for(var n=e.numInstances,r=this.context.viewport,i=r.width,o=r.height,a=this.props.cellSizePixels,s=Math.ceil(i/a),u=t.value,c=t.size,l=0;l<n;l++){var f=l%s,h=Math.floor(l/s);u[l*c+0]=f*a/i*2-1,u[l*c+1]=1-h*a/o*2,u[l*c+2]=0}}},{key:"_getModel",value:function(t){return new P.a(t,ft(ft({},this.getShaders()),{},{id:this.props.id,geometry:new ot.a({drawMode:6,attributes:{positions:new Float32Array([0,0,0,1,0,0,1,1,0,0,1,0])}}),isInstanced:!0}))}},{key:"_shouldUseMinMax",value:function(){var t=this.props,e=t.minColor,n=t.maxColor,r=t.colorDomain,i=t.colorRange;return e||n?(_.a.deprecated("ScreenGridLayer props: minColor and maxColor","colorRange, colorDomain")(),!0):!r&&!i}},{key:"_updateUniforms",value:function(t,e,n){var r=this.state.model;if(vt.some((function(n){return t[n]!==e[n]}))&&r.setUniforms({shouldUseMinMax:this._shouldUseMinMax()}),t.colorRange!==e.colorRange&&r.setUniforms({colorRange:ct(e.colorRange)}),t.cellMarginPixels!==e.cellMarginPixels||t.cellSizePixels!==e.cellSizePixels||n.viewportChanged){var i=this.context.viewport,o=i.width,a=i.height,s=this.props,u=s.cellSizePixels,c=s.cellMarginPixels,l=u>c?c:0,f=new Float32Array([(u-l)/o*2,-(u-l)/a*2,1]);r.setUniforms({cellScale:f})}}}],[{key:"isSupported",value:function(t){return Object(x.c)(t,[O.a.TEXTURE_FLOAT])}}]),n}(st.a);A()(yt,"layerName","ScreenGridCellLayer"),A()(yt,"defaultProps",gt);var mt=n(150),bt=n(177),At=n(203);function _t(t,e){var n={};for(var r in t)e.includes(r)||(n[r]=t[r]);return n}function Ot(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return wt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function xt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var Ct=function(t){p()(n,t);var e=xt(n);function n(){var t;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),A()(l()(t),"state",void 0),t}return u()(n,[{key:"initializeAggregationLayer",value:function(t){h()(m()(n.prototype),"initializeState",this).call(this,this.context),this.setState({ignoreProps:_t(this.constructor._propTypes,t.data.props),dimensions:t})}},{key:"updateState",value:function(t){if(h()(m()(n.prototype),"updateState",this).call(this,t),t.changeFlags.extensionsChanged){var e=this.getShaders({});e&&e.defines&&(e.defines.NON_INSTANCED_MODEL=1),this.updateShaders(e)}this._updateAttributes()}},{key:"updateAttributes",value:function(t){this.setState({changedAttributes:t})}},{key:"getAttributes",value:function(){return this.getAttributeManager().getShaderAttributes()}},{key:"getModuleSettings",value:function(){var t=this.context,e=t.viewport,n=t.mousePosition,r=t.gl;return Object.assign(Object.create(this.props),{viewport:e,mousePosition:n,pickingActive:0,devicePixelRatio:Object(w.e)(r)})}},{key:"updateShaders",value:function(t){}},{key:"isAggregationDirty",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.props,r=t.oldProps,i=t.changeFlags,o=e.compareAll,a=void 0!==o&&o,s=e.dimension,u=this.state.ignoreProps,c=s.props,l=s.accessors,f=void 0===l?[]:l,h=i.updateTriggersChanged;if(i.dataChanged)return!0;if(h){if(h.all)return!0;var d,p=Ot(f);try{for(p.s();!(d=p.n()).done;){var v=d.value;if(h[v])return!0}}catch(t){p.e(t)}finally{p.f()}}if(a)return!!i.extensionsChanged||Object(mt.a)({oldProps:r,newProps:n,ignoreProps:u,propTypes:this.constructor._propTypes});var g,y=Ot(c);try{for(y.s();!(g=y.n()).done;){var m=g.value;if(n[m]!==r[m])return!0}}catch(t){y.e(t)}finally{y.f()}return!1}},{key:"isAttributeChanged",value:function(t){var e=this.state.changedAttributes;return t?e&&void 0!==e[t]:!function(t){var e=!0;for(var n in t){e=!1;break}return e}(e)}},{key:"_getAttributeManager",value:function(){return new bt.a(this.context.gl,{id:this.props.id,stats:this.context.stats})}}]),n}(At.a);A()(Ct,"layerName","AggregationLayer");var Pt=n(49),St=n(15),Bt=n.n(St);function kt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Et(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Tt(t,e,n){var r=n;return r.domain=function(){return t},r.range=function(){return e},r}function jt(t,e){return Tt(t,e,(function(n){return function(t,e,n){var r=t[1]-t[0];if(r<=0)return _.a.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];var i=r/e.length,o=Math.floor((n-t[0])/i),a=Math.max(Math.min(o,e.length-1),0);return e[a]}(t,e,n)}))}function Mt(t,e){return Tt(t,e,(function(n){return function(t,e,n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}(t,e,n)}))}function It(t,e){for(var n=t.sort(Rt),r=0,i=Math.max(1,e.length),o=new Array(i-1);++r<i;)o[r-1]=Dt(n,r/i);var a=function(t){return function(t,e,n){return e[function(t,e){var n=0,r=t.length;for(;n<r;){var i=n+r>>>1;Rt(t[i],e)>0?r=i:n=i+1}return n}(t,n)]}(o,e,t)};return a.thresholds=function(){return o},Tt(t,e,a)}function Rt(t,e){return t-e}function Dt(t,e){var n=t.length;if(e<=0||n<2)return t[0];if(e>=1)return t[n-1];var r=(n-1)*e,i=Math.floor(r),o=t[i];return o+(t[i+1]-o)*(r-i)}function Lt(t,e){var n,r=new Map,i=[],o=kt(t);try{for(o.s();!(n=o.n()).done;){var a=n.value,s="".concat(a);r.has(s)||r.set(s,i.push(a))}}catch(t){o.e(t)}finally{o.f()}return Tt(t,e,(function(t){return function(t,e,n,r){var i="".concat(r),o=e.get(i);return void 0===o&&(o=t.push(r),e.set(i,o)),n[(o-1)%n.length]}(i,r,e,t)}))}function Ft(t){return null!=t}function Gt(t,e){return("function"==typeof e?t.map(e):t).filter(Ft)}function Nt(t,e){return Gt(t,e)}function Ut(t,e){return n=Gt(t,e),r=[],n.forEach((function(t){!r.includes(t)&&Ft(t)&&r.push(t)})),r;var n,r}function zt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ht(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ht(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Vt=function(t){return t.length},Jt=function(t){return t.points},Wt=function(t){return t.index},Kt=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Xt={getValue:Vt,getPoints:Jt,getIndex:Wt,filterData:null},qt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xt;a()(this,t),A()(this,"maxCount",void 0),A()(this,"maxValue",void 0),A()(this,"minValue",void 0),A()(this,"totalCount",void 0),A()(this,"aggregatedBins",void 0),A()(this,"sortedBins",void 0),A()(this,"binMap",void 0),this.aggregatedBins=this.getAggregatedBins(e,n),this._updateMinMaxValues(),this.binMap=this.getBinMap()}return u()(t,[{key:"getAggregatedBins",value:function(t,e){for(var n=e.getValue,r=void 0===n?Vt:n,i=e.getPoints,o=void 0===i?Jt:i,a=e.getIndex,s=void 0===a?Wt:a,u=e.filterData,c="function"==typeof u,l=t.length,f=[],h=0,d=0;d<l;d++){var p=t[d],v=o(p),g=s(p),y=c?v.filter(u):v;p.filteredPoints=c?y:null;var m=y.length?r(y):null;null!=m&&(f[h]={i:Number.isFinite(g)?g:d,value:m,counts:y.length},h++)}return f}},{key:"_percentileToIndex",value:function(t){var e=this.sortedBins.length;if(e<2)return[0,0];var n=t.map((function(t){return e=t,n=0,r=100,Math.max(n,Math.min(r,e));var e,n,r})),r=Bt()(n,2),i=r[0],o=r[1];return[Math.ceil(i/100*(e-1)),Math.floor(o/100*(e-1))]}},{key:"getBinMap",value:function(){var t,e={},n=zt(this.aggregatedBins);try{for(n.s();!(t=n.n()).done;){var r=t.value;e[r.i]=r}}catch(t){n.e(t)}finally{n.f()}return e}},{key:"_updateMinMaxValues",value:function(){var t,e=0,n=0,r=3402823466e29,i=0,o=zt(this.aggregatedBins);try{for(o.s();!(t=o.n()).done;){var a=t.value;e=e>a.counts?e:a.counts,n=n>a.value?n:a.value,r=r<a.value?r:a.value,i+=a.counts}}catch(t){o.e(t)}finally{o.f()}this.maxCount=e,this.maxValue=n,this.minValue=r,this.totalCount=i}},{key:"getValueRange",value:function(t){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((function(t,e){return Kt(t.value,e.value)}))),!this.sortedBins.length)return[];var e=0,n=this.sortedBins.length-1;if(Array.isArray(t)){var r=this._percentileToIndex(t);e=r[0],n=r[1]}return[this.sortedBins[e].value,this.sortedBins[n].value]}},{key:"getValueDomainByScale",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Bt()(e,2),r=n[0],i=void 0===r?0:r,o=n[1],a=void 0===o?100:o;if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((function(t,e){return Kt(t.value,e.value)}))),!this.sortedBins.length)return[];var s=this._percentileToIndex([i,a]);return this._getScaleDomain(t,s)}},{key:"_getScaleDomain",value:function(t,e){var n=Bt()(e,2),r=n[0],i=n[1],o=this.sortedBins;switch(t){case"quantize":case"linear":return[o[r].value,o[i].value];case"quantile":return Nt(o.slice(r,i+1),(function(t){return t.value}));case"ordinal":return Ut(o,(function(t){return t.value}));default:return[o[r].value,o[i].value]}}}]),t}(),Qt=n(75),Zt=n(20);function Yt(t){return Number.isFinite(t)?t:0}function $t(t,e){for(var n,r,i=t.positions.value,o=1/0,a=-1/0,s=1/0,u=-1/0,c=0;c<e;c++)r=i[3*c],o=(n=i[3*c+1])<o?n:o,a=n>a?n:a,s=r<s?r:s,u=r>u?r:u;return{xMin:Yt(s),xMax:Yt(u),yMin:Yt(o),yMax:Yt(a)}}function te(t,e){var n=t<0?-1:1,r=n<0?Math.abs(t)+e:Math.abs(t);return(r=Math.floor(r/e)*e)*n}function ee(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!n)return{xOffset:e,yOffset:e};var r=t.yMin,i=t.yMax,o=(r+i)/2;return re(e,o)}function ne(t,e,n,r){var i=ee(t,e,r!==Zt.a.CARTESIAN),o=function(t,e,n,r){var i=r.width,o=r.height,a=n===Zt.a.CARTESIAN?[-i/2,-o/2]:[-180,-90];_.a.assert(n===Zt.a.CARTESIAN||n===Zt.a.LNGLAT||n===Zt.a.DEFAULT);var s=t.xMin,u=t.yMin;return[-1*(te(s-a[0],e.xOffset)+a[0]),-1*(te(u-a[1],e.yOffset)+a[1])]}(t,i,r,n),a=t.xMin,s=t.yMin,u=t.xMax,c=t.yMax,l=u-a+i.xOffset,f=c-s+i.yOffset;return{gridOffset:i,translation:o,width:l,height:f,numCol:Math.ceil(l/i.xOffset),numRow:Math.ceil(f/i.yOffset)}}function re(t,e){var n;return{yOffset:t/6378e3*(180/Math.PI),xOffset:(n=e,t/6378e3*(180/Math.PI)/Math.cos(n*Math.PI/180))}}function ie(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ie(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ae(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return se(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function se(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ue(t,e){var n=function(t,e){var n=t.data,r=void 0===n?[]:n,i=t.cellSize,o=e.attributes,a=e.viewport,s=e.projectPoints,u=e.numInstances,c=o.positions.value,l=o.positions.getAccessor().size,f=e.boundingBox||function(t,e){for(var n,r,i=t.value,o=t.getAccessor().size,a=1/0,s=-1/0,u=1/0,c=-1/0,l=0;l<e;l++)r=i[l*o],n=i[l*o+1],Number.isFinite(r)&&Number.isFinite(n)&&(a=n<a?n:a,s=n>s?n:s,u=r<u?r:u,c=r>c?r:c);return{xMin:u,xMax:c,yMin:a,yMax:s}}(o.positions,u),h=e.posOffset||[180,90],d=e.gridOffset||ee(f,i);if(d.xOffset<=0||d.yOffset<=0)return{gridHash:{},gridOffset:d};var p,v=a.width,g=a.height,y=Math.ceil(v/d.xOffset),m=Math.ceil(g/d.yOffset),b={},A=Object(Qt.a)(r),_=A.iterable,O=A.objectInfo,w=new Array(3),x=ae(_);try{for(x.s();!(p=x.n()).done;){var C=p.value;O.index++,w[0]=c[O.index*l],w[1]=c[O.index*l+1],w[2]=l>=3?c[O.index*l+2]:0;var P=s?a.project(w):w,S=Bt()(P,2),B=S[0],k=S[1];if(Number.isFinite(B)&&Number.isFinite(k)){var E=Math.floor((k+h[1])/d.yOffset),T=Math.floor((B+h[0])/d.xOffset);if(!s||T>=0&&T<y&&E>=0&&E<m){var j="".concat(E,"-").concat(T);b[j]=b[j]||{count:0,points:[],lonIdx:T,latIdx:E},b[j].count+=1,b[j].points.push({source:C,index:O.index})}}}}catch(t){x.e(t)}finally{x.f()}return{gridHash:b,gridOffset:d,offsets:[-1*h[0],-1*h[1]]}}(t,e),r=function(t){var e=t.gridHash,n=t.gridOffset,r=t.offsets,i=new Array(Object.keys(e).length),o=0;for(var a in e){var s=a.split("-"),u=parseInt(s[0],10),c=parseInt(s[1],10),l=o++;i[l]=oe({index:l,position:[r[0]+n.xOffset*c,r[1]+n.yOffset*u]},e[a])}return i}(n);return{gridHash:n.gridHash,gridOffset:n.gridOffset,data:r}}function ce(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return le(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return le(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function le(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function fe(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var he=function(t){p()(n,t);var e=fe(n);function n(){var t;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),A()(l()(t),"state",void 0),t}return u()(n,[{key:"initializeAggregationLayer",value:function(t){var e=t.dimensions,r=this.context.gl;h()(m()(n.prototype),"initializeAggregationLayer",this).call(this,e),this.setState({layerData:{},gpuGridAggregator:new nt(r,{id:"".concat(this.id,"-gpu-aggregator")}),cpuGridAggregator:ue})}},{key:"updateState",value:function(t){h()(m()(n.prototype),"updateState",this).call(this,t),this.updateAggregationState(t);var e=this.state,r=e.aggregationDataDirty,i=e.aggregationWeightsDirty,o=e.gpuAggregation;if(!(this.getNumInstances()<=0)){var a=!1;(r||o&&i)&&(this._updateAggregation(t),a=!0),o||!r&&!i||(this._updateWeightBins(),this._uploadAggregationResults(),a=!0),this.setState({aggregationDirty:a})}}},{key:"finalizeState",value:function(t){var e,r=this.state.weights.count;r&&r.aggregationBuffer&&r.aggregationBuffer.delete(),null===(e=this.state.gpuGridAggregator)||void 0===e||e.delete(),h()(m()(n.prototype),"finalizeState",this).call(this,t)}},{key:"updateShaders",value:function(t){this.state.gpuAggregation&&this.state.gpuGridAggregator.updateShaders(t)}},{key:"updateAggregationState",value:function(t){_.a.assert(!1)}},{key:"allocateResources",value:function(t,e){if(this.state.numRow!==t||this.state.numCol!==e){var n=e*t*4*4,r=this.context.gl,i=this.state.weights;for(var o in i){var a=i[o];a.aggregationBuffer&&a.aggregationBuffer.delete(),a.aggregationBuffer=new Pt.a(r,{byteLength:n,accessor:{size:4,type:5126,divisor:1}})}}}},{key:"updateResults",value:function(t){var e=t.aggregationData,n=t.maxMinData,r=t.maxData,i=t.minData,o=this.state.weights.count;o&&(o.aggregationData=e,o.maxMinData=n,o.maxData=r,o.minData=i)}},{key:"_updateAggregation",value:function(t){var e=this.state,n=e.cpuGridAggregator,r=e.gpuGridAggregator,i=e.gridOffset,o=e.posOffset,a=e.translation,s=void 0===a?[0,0]:a,u=e.scaling,c=void 0===u?[0,0,0]:u,l=e.boundingBox,f=e.projectPoints,h=e.gpuAggregation,d=e.numCol,p=e.numRow,v=t.props,g=this.context.viewport,y=this.getAttributes(),m=this.getNumInstances();if(h){var b=this.state.weights;r.run({weights:b,cellSize:[i.xOffset,i.yOffset],numCol:d,numRow:p,translation:s,scaling:c,vertexCount:m,projectPoints:f,attributes:y,moduleSettings:this.getModuleSettings()})}else{var A=n(v,{gridOffset:i,projectPoints:f,attributes:y,viewport:g,posOffset:o,boundingBox:l});this.setState({layerData:A})}}},{key:"_updateWeightBins",value:function(){var t=this.state.getValue,e=new qt(this.state.layerData.data||[],{getValue:t});this.setState({sortedBins:e})}},{key:"_uploadAggregationResults",value:function(){var t,e=this.state,n=e.numCol,r=e.numRow,i=this.state.layerData.data,o=this.state.sortedBins,a=o.aggregatedBins,s=o.minValue,u=o.maxValue,c=o.totalCount,l=new Float32Array(n*r*4).fill(0),f=ce(a);try{for(f.s();!(t=f.n()).done;){var h=t.value,d=i[h.i],p=d.lonIdx,v=d.latIdx,g=h.value,y=h.counts,m=4*(p+v*n);l[m]=g,l[m+4-1]=y}}catch(t){f.e(t)}finally{f.f()}var b=new Float32Array([u,0,0,s]),A=new Float32Array([u,0,0,c]),_=new Float32Array([s,0,0,c]);this.updateResults({aggregationData:l,maxMinData:b,maxData:A,minData:_})}}]),n}(Ct);function de(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function pe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ve(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pe(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}A()(he,"layerName","GridAggregationLayer");var ge=ve(ve({},yt.defaultProps),{},{getPosition:{type:"accessor",value:function(t){return t.position}},getWeight:{type:"accessor",value:1},gpuAggregation:!0,aggregation:"SUM"}),ye={data:{props:["cellSizePixels"]},weights:{props:["aggregation"],accessors:["getWeight"]}},me=function(t){p()(n,t);var e=de(n);function n(){var t;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),A()(l()(t),"state",void 0),t}return u()(n,[{key:"initializeState",value:function(){var t,e=this.context.gl;if(!yt.isSupported(e))return this.setState({supported:!1}),void _.a.error("ScreenGridLayer: ".concat(this.id," is not supported on this browser"))();h()(m()(n.prototype),"initializeAggregationLayer",this).call(this,{dimensions:ye,getCellSize:function(t){return t.cellSizePixels}});var r={count:{size:1,operation:T.SUM,needMax:!0,maxTexture:K(e,{id:"".concat(this.id,"-max-texture")})}};this.setState({supported:!0,projectPoints:!0,weights:r,subLayerData:{attributes:{}},maxTexture:r.count.maxTexture,positionAttributeName:"positions",posOffset:[0,0],translation:[1,-1]}),this.getAttributeManager().add((t={},A()(t,"positions",{size:3,accessor:"getPosition",type:5130,fp64:this.use64bitPositions()}),A()(t,"count",{size:3,accessor:"getWeight"}),t))}},{key:"shouldUpdateState",value:function(t){var e=t.changeFlags;return this.state.supported&&e.somethingChanged}},{key:"updateState",value:function(t){h()(m()(n.prototype),"updateState",this).call(this,t)}},{key:"renderLayers",value:function(){if(!this.state.supported)return[];var t=this.state,e=t.maxTexture,n=t.numRow,r=t.numCol,i=t.weights,o=this.props.updateTriggers,a=i.count.aggregationBuffer;return new(this.getSubLayerClass("cells",yt))(this.props,this.getSubLayerProps({id:"cell-layer",updateTriggers:o}),{data:{attributes:{instanceCounts:a}},maxTexture:e,numInstances:n*r})}},{key:"finalizeState",value:function(t){h()(m()(n.prototype),"finalizeState",this).call(this,t);var e=this.state,r=e.aggregationBuffer,i=e.maxBuffer,o=e.maxTexture;null==r||r.delete(),null==i||i.delete(),null==o||o.delete()}},{key:"getPickingInfo",value:function(t){var e=t.info,n=e.index;if(n>=0){var r=this.state,i=r.gpuGridAggregator,o=r.gpuAggregation,a=r.weights,s=o?i.getData("count"):a.count;e.object=nt.getAggregationData(ve({pixelIndex:n},s))}return e}},{key:"updateResults",value:function(t){var e=t.aggregationData,n=t.maxData,r=this.state.weights.count;r.aggregationData=e,r.aggregationBuffer.setData({data:e}),r.maxData=n,r.maxTexture.setImageData({data:n})}},{key:"updateAggregationState",value:function(t){var e=t.props.cellSizePixels,n=t.oldProps.cellSizePixels!==e,r=t.changeFlags.viewportChanged,i=t.props.gpuAggregation;this.state.gpuAggregation!==t.props.gpuAggregation&&i&&!nt.isSupported(this.context.gl)&&(_.a.warn("GPU Grid Aggregation not supported, falling back to CPU")(),i=!1);var o=i!==this.state.gpuAggregation;this.setState({gpuAggregation:i});var a=this.isAttributeChanged("positions"),s=this.state.dimensions,u=s.data,c=s.weights,l=a||o||r||this.isAggregationDirty(t,{compareAll:i,dimension:u}),f=this.isAggregationDirty(t,{dimension:c});this.setState({aggregationDataDirty:l,aggregationWeightsDirty:f});var h=this.context.viewport;if(r||n){var d=h.width,p=h.height,v=Math.ceil(d/e),g=Math.ceil(p/e);this.allocateResources(g,v),this.setState({scaling:[d/2,-p/2,1],gridOffset:{xOffset:e,yOffset:e},width:d,height:p,numCol:v,numRow:g})}f&&this._updateAccessors(t),(l||f)&&this._resetResults()}},{key:"_updateAccessors",value:function(t){var e=t.props,n=e.getWeight,r=e.aggregation,i=e.data,o=this.state.weights.count;o&&(o.getWeight=n,o.operation=T[r]),this.setState({getValue:R(r,n,{data:i})})}},{key:"_resetResults",value:function(){var t=this.state.weights.count;t&&(t.aggregationData=null)}}]),n}(he);A()(me,"layerName","ScreenGridLayer"),A()(me,"defaultProps",ge);var be=n(233),Ae=n(26),_e=n.n(Ae);function Oe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function we(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Oe(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function xe(){}var Ce=["getBins","getDomain","getScaleFunc"],Pe=[{key:"fillColor",accessor:"getFillColor",pickingInfo:"colorValue",getBins:{triggers:{value:{prop:"getColorValue",updateTrigger:"getColorValue"},weight:{prop:"getColorWeight",updateTrigger:"getColorWeight"},aggregation:{prop:"colorAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"lowerPercentile"},upperPercentile:{prop:"upperPercentile"},scaleType:{prop:"colorScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"colorDomain"},range:{prop:"colorRange"}},onSet:{props:"onSetColorDomain"}},nullValue:[0,0,0,0]},{key:"elevation",accessor:"getElevation",pickingInfo:"elevationValue",getBins:{triggers:{value:{prop:"getElevationValue",updateTrigger:"getElevationValue"},weight:{prop:"getElevationWeight",updateTrigger:"getElevationWeight"},aggregation:{prop:"elevationAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"elevationLowerPercentile"},upperPercentile:{prop:"elevationUpperPercentile"},scaleType:{prop:"elevationScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"elevationDomain"},range:{prop:"elevationRange"}},onSet:{props:"onSetElevationDomain"}},nullValue:-1}],Se=function(t){return t.cellSize},Be=function(){function t(e){a()(this,t),this.state={layerData:{},dimensions:{}},this.changeFlags={},this.dimensionUpdaters={},this._getCellSize=e.getCellSize||Se,this._getAggregator=e.getAggregator,this._addDimension(e.dimensions||Pe)}return u()(t,[{key:"updateState",value:function(t,e){var n=t.oldProps,r=t.props,i=t.changeFlags;this.updateGetValueFuncs(n,r,i);var o=this.needsReProjectPoints(n,r,i),a=!1;i.dataChanged||o?(this.getAggregatedData(r,e),a=!0):((this.getDimensionChanges(n,r,i)||[]).forEach((function(t){return"function"==typeof t&&t()})),a=!0);return this.setState({aggregationDirty:a}),this.state}},{key:"setState",value:function(t){this.state=we(we({},this.state),t)}},{key:"setDimensionState",value:function(t,e){this.setState({dimensions:we(we({},this.state.dimensions),{},A()({},t,we(we({},this.state.dimensions[t]),e)))})}},{key:"normalizeResult",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.hexagons?we({data:t.hexagons},t):t.layerData?we({data:t.layerData},t):t}},{key:"getAggregatedData",value:function(t,e){var n=this._getAggregator(t)(t,e);this.setState({layerData:this.normalizeResult(n)}),this.changeFlags={layerData:!0},this.getSortedBins(t)}},{key:"updateGetValueFuncs",value:function(t,e,n){for(var r in this.dimensionUpdaters){var i=this.dimensionUpdaters[r].getBins.triggers,o=i.value,a=i.weight,s=i.aggregation,u=e[o.prop];this.needUpdateDimensionStep(this.dimensionUpdaters[r].getBins,t,e,n)&&(u=u?D(u,{data:e.data}):R(e[s.prop],e[a.prop],{data:e.data})),u&&this.setDimensionState(r,{getValue:u})}}},{key:"needsReProjectPoints",value:function(t,e,n){return this._getCellSize(t)!==this._getCellSize(e)||this._getAggregator(t)!==this._getAggregator(e)||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPosition)}},{key:"addDimension",value:function(t){this._addDimension(t)}},{key:"_addDimension",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){var n=e.key;t.dimensionUpdaters[n]=t.getDimensionUpdaters(e),t.state.dimensions[n]={getValue:null,domain:null,sortedBins:null,scaleFunc:xe}}))}},{key:"getDimensionUpdaters",value:function(t){var e=t.key,n=t.accessor,r=t.pickingInfo,i=t.getBins,o=t.getDomain,a=t.getScaleFunc,s=t.nullValue;return{key:e,accessor:n,pickingInfo:r,getBins:we({updater:this.getDimensionSortedBins},i),getDomain:we({updater:this.getDimensionValueDomain},o),getScaleFunc:we({updater:this.getDimensionScale},a),attributeAccessor:this.getSubLayerDimensionAttribute(e,s)}}},{key:"needUpdateDimensionStep",value:function(t,e,n,r){return Object.values(t.triggers).some((function(t){return t.updateTrigger?r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged[t.updateTrigger]):e[t.prop]!==n[t.prop]}))}},{key:"getDimensionChanges",value:function(t,e,n){var r=this,i=[],o=function(o){var a=Ce.find((function(i){return r.needUpdateDimensionStep(r.dimensionUpdaters[o][i],t,e,n)}));a&&i.push(r.dimensionUpdaters[o][a].updater.bind(r,e,r.dimensionUpdaters[o]))};for(var a in this.dimensionUpdaters)o(a);return i.length?i:null}},{key:"getUpdateTriggers",value:function(t){var e=this,n=t.updateTriggers||{},r={},i=function(i){var o=e.dimensionUpdaters[i].accessor;r[o]={},Ce.forEach((function(a){Object.values(e.dimensionUpdaters[i][a].triggers).forEach((function(e){var i=e.prop,a=e.updateTrigger;if(a){var s=n[a];"object"!==_e()(s)||Array.isArray(s)?void 0!==s&&(r[o][i]=s):Object.assign(r[o],s)}else r[o][i]=t[i]}))}))};for(var o in this.dimensionUpdaters)i(o);return r}},{key:"getSortedBins",value:function(t){for(var e in this.dimensionUpdaters)this.getDimensionSortedBins(t,this.dimensionUpdaters[e])}},{key:"getDimensionSortedBins",value:function(t,e){var n=e.key,r=this.state.dimensions[n].getValue,i=new qt(this.state.layerData.data||[],{getValue:r,filterData:t._filterData});this.setDimensionState(n,{sortedBins:i}),this.getDimensionValueDomain(t,e)}},{key:"getDimensionValueDomain",value:function(t,e){var n=e.getDomain,r=e.key,i=n.triggers,o=i.lowerPercentile,a=i.upperPercentile,s=i.scaleType,u=this.state.dimensions[r].sortedBins.getValueDomainByScale(t[s.prop],[t[o.prop],t[a.prop]]);this.setDimensionState(r,{valueDomain:u}),this.getDimensionScale(t,e)}},{key:"getDimensionScale",value:function(t,e){var n=e.key,r=e.getScaleFunc,i=e.getDomain,o=r.triggers,a=o.domain,s=o.range,u=i.triggers.scaleType,c=r.onSet,l=t[s.prop],f=t[a.prop]||this.state.dimensions[n].valueDomain,h=function(t){switch(t){case"quantize":return jt;case"linear":return Mt;case"quantile":return It;case"ordinal":return Lt;default:return jt}}(u&&t[u.prop])(f,l);"object"===_e()(c)&&"function"==typeof t[c.props]&&t[c.props](h.domain()),this.setDimensionState(n,{scaleFunc:h})}},{key:"getSubLayerDimensionAttribute",value:function(t,e){var n=this;return function(r){var i=n.state.dimensions[t],o=i.sortedBins,a=i.scaleFunc,s=o.binMap[r.index];if(s&&0===s.counts)return e;var u=s&&s.value,c=a.domain();return u>=c[0]&&u<=c[c.length-1]?a(u):e}}},{key:"getSubLayerAccessors",value:function(t){var e={};for(var n in this.dimensionUpdaters){e[this.dimensionUpdaters[n].accessor]=this.getSubLayerDimensionAttribute(t,n)}return e}},{key:"getPickingInfo",value:function(t){var e=t.info,n=null;if(e.picked&&e.index>-1){var r=this.state.layerData.data[e.index],i={};for(var o in this.dimensionUpdaters){var a=this.dimensionUpdaters[o].pickingInfo,s=this.state.dimensions[o].sortedBins,u=s.binMap[r.index]&&s.binMap[r.index].value;i[a]=u}n=Object.assign(i,r,{points:r.filteredPoints||r.points})}return e.picked=Boolean(n),e.object=n,e}},{key:"getAccessor",value:function(t){return this.dimensionUpdaters.hasOwnProperty(t)?this.dimensionUpdaters[t].attributeAccessor:xe}}],[{key:"defaultDimensions",value:function(){return Pe}}]),t}();function ke(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function Ee(){}var Te={colorDomain:null,colorRange:ut,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:Ee,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:Ee,gridAggregator:ue,cellSize:{type:"number",min:0,max:1e3,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:function(t){return t.position}},extruded:!1,material:!0,_filterData:{type:"function",value:null,optional:!0}},je=function(t){p()(n,t);var e=ke(n);function n(){return a()(this,n),e.apply(this,arguments)}return u()(n,[{key:"initializeState",value:function(){var t=new Be({getAggregator:function(t){return t.gridAggregator},getCellSize:function(t){return t.cellSize}});this.state={cpuAggregator:t,aggregatorState:t.state},this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"}})}},{key:"updateState",value:function(t){h()(m()(n.prototype),"updateState",this).call(this,t),this.setState({aggregatorState:this.state.cpuAggregator.updateState(t,{viewport:this.context.viewport,attributes:this.getAttributes(),numInstances:this.getNumInstances()})})}},{key:"getPickingInfo",value:function(t){var e=t.info;return this.state.cpuAggregator.getPickingInfo({info:e})}},{key:"_onGetSublayerColor",value:function(t){return this.state.cpuAggregator.getAccessor("fillColor")(t)}},{key:"_onGetSublayerElevation",value:function(t){return this.state.cpuAggregator.getAccessor("elevation")(t)}},{key:"_getSublayerUpdateTriggers",value:function(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}},{key:"renderLayers",value:function(){var t=this.props,e=t.elevationScale,n=t.extruded,r=t.cellSize,i=t.coverage,o=t.material,a=t.transitions,s=this.state.cpuAggregator,u=this.getSubLayerClass("grid-cell",be.a),c=this._getSublayerUpdateTriggers();return new u({cellSize:r,coverage:i,material:o,elevationScale:e,extruded:n,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:a&&{getFillColor:a.getColorValue||a.getColorWeight,getElevation:a.getElevationValue||a.getElevationWeight}},this.getSubLayerProps({id:"grid-cell",updateTriggers:c}),{data:s.state.layerData.data})}}]),n}(Ct);A()(je,"layerName","CPUGridLayer"),A()(je,"defaultProps",Te);var Me=n(178),Ie=Math.PI/3,Re=[0,Ie,2*Ie,3*Ie,4*Ie,5*Ie];function De(t){return t[0]}function Le(t){return t[1]}function Fe(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ge(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ge(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ge(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ue(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ze(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function He(){}var Ve={colorDomain:null,colorRange:ut,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},colorScaleType:"quantize",onSetColorDomain:He,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:He,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:function(t,e){var n,r=t.data,i=t.radius,o=e.viewport,a=e.attributes,s=r.length?function(t,e){var n,r=e.attributes,i=r.positions.value,o=r.positions.getAccessor().size,a=1/0,s=1/0,u=-1/0,c=-1/0;for(n=0;n<o*t.length;n+=o){var l=i[n],f=i[n+1];Number.isFinite(l)&&Number.isFinite(f)&&(a=Math.min(l,a),u=Math.max(l,u),s=Math.min(f,s),c=Math.max(f,c))}return[a,s,u,c].every(Number.isFinite)?[(a+u)/2,(s+c)/2]:null}(r,e):null,u=function(t,e,n){var r=e.getDistanceScales(n).unitsPerMeter;return t*r[0]}(i,o,s),c=[],l=Object(Qt.a)(r),f=l.iterable,h=l.objectInfo,d=a.positions.value,p=a.positions.getAccessor().size,v=Fe(f);try{for(v.s();!(n=v.n()).done;){var g=n.value;h.index++;var y=h.index*p,m=[d[y],d[y+1]];Number.isFinite(m[0])&&Number.isFinite(m[1])?c.push({screenCoord:o.projectFlat(m),source:g,index:h.index}):_.a.warn("HexagonLayer: invalid position")()}}catch(t){v.e(t)}finally{v.f()}return{hexagons:function(){var t,e,n,r=0,i=0,o=1,a=1,s=De,u=Le;function c(t){var r,i={},o=[],a=t.length;for(r=0;r<a;++r)if(!isNaN(l=+s.call(null,c=t[r],r,t))&&!isNaN(f=+u.call(null,c,r,t))){var c,l,f,h=Math.round(f/=n),d=Math.round(l=l/e-(1&h)/2),p=f-h;if(3*Math.abs(p)>1){var v=l-d,g=d+(l<d?-1:1)/2,y=h+(f<h?-1:1),m=l-g,b=f-y;v*v+p*p>m*m+b*b&&(d=g+(1&h?1:-1)/2,h=y)}var A=d+"-"+h,_=i[A];_?_.push(c):(o.push(_=i[A]=[c]),_.x=(d+(1&h)/2)*e,_.y=h*n)}return o}function l(t){var e=0,n=0;return Re.map((function(r){var i=Math.sin(r)*t,o=-Math.cos(r)*t,a=i-e,s=o-n;return e=i,n=o,[a,s]}))}return c.hexagon=function(e){return"m"+l(null==e?t:+e).join("l")+"z"},c.centers=function(){for(var s=[],u=Math.round(i/n),c=Math.round(r/e),l=u*n;l<a+t;l+=n,++u)for(var f=c*e+(1&u)*e/2;f<o+e/2;f+=e)s.push([f,l]);return s},c.mesh=function(){var e=l(t).slice(0,4).join("l");return c.centers().map((function(t){return"M"+t+"m"+e})).join("")},c.x=function(t){return arguments.length?(s=t,c):s},c.y=function(t){return arguments.length?(u=t,c):u},c.radius=function(r){return arguments.length?(e=2*(t=+r)*Math.sin(Ie),n=1.5*t,c):t},c.size=function(t){return arguments.length?(r=i=0,o=+t[0],a=+t[1],c):[o-r,a-i]},c.extent=function(t){return arguments.length?(r=+t[0][0],i=+t[0][1],o=+t[1][0],a=+t[1][1],c):[[r,i],[o,a]]},c.radius(1)}().radius(u).x((function(t){return t.screenCoord[0]})).y((function(t){return t.screenCoord[1]}))(c).map((function(t,e){return{position:o.unprojectFlat([t.x,t.y]),points:t,index:e}})),radiusCommon:u}},getPosition:{type:"accessor",value:function(t){return t.position}},material:!0,_filterData:{type:"function",value:null,optional:!0}},Je=function(t){p()(n,t);var e=ze(n);function n(){var t;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),A()(l()(t),"state",void 0),t}return u()(n,[{key:"initializeState",value:function(){var t=new Be({getAggregator:function(t){return t.hexagonAggregator},getCellSize:function(t){return t.radius}});this.state={cpuAggregator:t,aggregatorState:t.state,vertices:null},this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"}})}},{key:"updateState",value:function(t){if(h()(m()(n.prototype),"updateState",this).call(this,t),t.changeFlags.propsOrDataChanged){var e=this.state.cpuAggregator.updateState(t,{viewport:this.context.viewport,attributes:this.getAttributes()});if(this.state.aggregatorState.layerData!==e.layerData){var r=(e.layerData||{}).hexagonVertices;this.setState({vertices:r&&this.convertLatLngToMeterOffset(r)})}this.setState({aggregatorState:e})}}},{key:"convertLatLngToMeterOffset",value:function(t){var e=this.context.viewport;if(Array.isArray(t)&&6===t.length){var n=t[0],r=t[3],i=[(n[0]+r[0])/2,(n[1]+r[1])/2],o=e.projectFlat(i),a=e.getDistanceScales(i).metersPerUnit;return t.map((function(t){var n=e.projectFlat(t);return[(n[0]-o[0])*a[0],(n[1]-o[1])*a[1]]}))}return _.a.error("HexagonLayer: hexagonVertices needs to be an array of 6 points")(),null}},{key:"getPickingInfo",value:function(t){var e=t.info;return this.state.cpuAggregator.getPickingInfo({info:e})}},{key:"_onGetSublayerColor",value:function(t){return this.state.cpuAggregator.getAccessor("fillColor")(t)}},{key:"_onGetSublayerElevation",value:function(t){return this.state.cpuAggregator.getAccessor("elevation")(t)}},{key:"_getSublayerUpdateTriggers",value:function(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}},{key:"renderLayers",value:function(){var t=this.props,e=t.elevationScale,n=t.extruded,r=t.coverage,i=t.material,o=t.transitions,a=this.state,s=a.aggregatorState,u=a.vertices,c=this.getSubLayerClass("hexagon-cell",Me.a),l=this._getSublayerUpdateTriggers();return new c(Ue(Ue({},u?{vertices:u,radius:1}:{radius:s.layerData.radiusCommon||1,radiusUnits:"common",angle:90}),{},{diskResolution:6,elevationScale:e,extruded:n,coverage:r,material:i,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:o&&{getFillColor:o.getColorValue||o.getColorWeight,getElevation:o.getElevationValue||o.getElevationWeight}}),this.getSubLayerProps({id:"hexagon-cell",updateTriggers:l}),{data:s.layerData.data})}}]),n}(Ct);A()(Je,"layerName","HexagonLayer"),A()(Je,"defaultProps",Ve);var We,Ke=n(244),Xe=n(131),qe={N:[0,.5],E:[.5,0],S:[0,-.5],W:[-.5,0],NE:[.5,.5],NW:[-.5,.5],SE:[.5,-.5],SW:[-.5,-.5]},Qe=[qe.W,qe.SW,qe.S],Ze=[qe.S,qe.SE,qe.E],Ye=[qe.E,qe.NE,qe.N],$e=[qe.NW,qe.W,qe.N],tn=[[-.5,1/6],[-.5,-1/6],[-1/6,-.5],[1/6,-.5]],en=[[-1/6,-.5],[1/6,-.5],[.5,-1/6],[.5,1/6]],nn=[[.5,-1/6],[.5,1/6],[1/6,.5],[-1/6,.5]],rn=[[-.5,1/6],[-.5,-1/6],[1/6,.5],[-1/6,.5]],on=[qe.W,qe.SW,qe.SE,qe.E],an=[qe.S,qe.SE,qe.NE,qe.N],sn=[qe.NW,qe.W,qe.E,qe.NE],un=[qe.NW,qe.SW,qe.S,qe.N],cn=[[-.5,1/6],[-.5,-1/6],[.5,-1/6],[.5,1/6]],ln=[[-1/6,-.5],[1/6,-.5],[1/6,.5],[-1/6,.5]],fn=[qe.NW,qe.SW,qe.SE,qe.NE],hn=[qe.NW,qe.SW,qe.SE,qe.E,qe.N],dn=[qe.W,qe.SW,qe.SE,qe.NE,qe.N],pn=[qe.NW,qe.W,qe.S,qe.SE,qe.NE],vn=[qe.NW,qe.SW,qe.S,qe.E,qe.NE],gn=[qe.NW,qe.W,[.5,-1/6],[.5,1/6],qe.N],yn=[[-1/6,-.5],[1/6,-.5],qe.E,qe.NE,qe.N],mn=[[-.5,1/6],[-.5,-1/6],qe.S,qe.SE,qe.E],bn=[qe.W,qe.SW,qe.S,[1/6,.5],[-1/6,.5]],An=[qe.NW,qe.W,[-1/6,-.5],[1/6,-.5],qe.N],_n=[[-.5,1/6],[-.5,-1/6],qe.E,qe.NE,qe.N],On=[qe.S,qe.SE,qe.E,[1/6,.5],[-1/6,.5]],wn=[qe.W,qe.SW,qe.S,[.5,-1/6],[.5,1/6]],xn=[qe.W,qe.SW,qe.SE,qe.E,[1/6,.5],[-1/6,.5]],Cn=[[-.5,1/6],[-.5,-1/6],qe.S,qe.SE,qe.NE,qe.N],Pn=[qe.NW,qe.W,[-1/6,-.5],[1/6,-.5],qe.E,qe.NE],Sn=[qe.NW,qe.SW,qe.S,[.5,-1/6],[.5,1/6],qe.N],Bn=[qe.W,qe.SW,qe.S,qe.E,qe.NE,qe.N],kn=[qe.NW,qe.W,qe.S,qe.SE,qe.E,qe.N],En=[[-.5,1/6],[-.5,-1/6],[-1/6,-.5],[1/6,-.5],qe.E,qe.NE,qe.N],Tn=[qe.W,qe.SW,qe.S,[.5,-1/6],[.5,1/6],[1/6,.5],[-1/6,.5]],jn=[qe.NW,qe.W,[-1/6,-.5],[1/6,-.5],[.5,-1/6],[.5,1/6],qe.N],Mn=[[-.5,1/6],[-.5,-1/6],qe.S,qe.SE,qe.E,[1/6,.5],[-1/6,.5]],In=[[-.5,1/6],[-.5,-1/6],[-1/6,-.5],[1/6,-.5],[.5,-1/6],[.5,1/6],[1/6,.5],[-1/6,.5]],Rn={0:[],1:[[qe.W,qe.S]],2:[[qe.S,qe.E]],3:[[qe.W,qe.E]],4:[[qe.N,qe.E]],5:{0:[[qe.W,qe.S],[qe.N,qe.E]],1:[[qe.W,qe.N],[qe.S,qe.E]]},6:[[qe.N,qe.S]],7:[[qe.W,qe.N]],8:[[qe.W,qe.N]],9:[[qe.N,qe.S]],10:{0:[[qe.W,qe.N],[qe.S,qe.E]],1:[[qe.W,qe.S],[qe.N,qe.E]]},11:[[qe.N,qe.E]],12:[[qe.W,qe.E]],13:[[qe.S,qe.E]],14:[[qe.W,qe.S]],15:[]};function Dn(t){return parseInt(t,4)}var Ln=(We={},A()(We,Dn("0000"),[]),A()(We,Dn("2222"),[]),A()(We,Dn("2221"),[Qe]),A()(We,Dn("2212"),[Ze]),A()(We,Dn("2122"),[Ye]),A()(We,Dn("1222"),[$e]),A()(We,Dn("0001"),[Qe]),A()(We,Dn("0010"),[Ze]),A()(We,Dn("0100"),[Ye]),A()(We,Dn("1000"),[$e]),A()(We,Dn("2220"),[tn]),A()(We,Dn("2202"),[en]),A()(We,Dn("2022"),[nn]),A()(We,Dn("0222"),[rn]),A()(We,Dn("0002"),[tn]),A()(We,Dn("0020"),[en]),A()(We,Dn("0200"),[nn]),A()(We,Dn("2000"),[rn]),A()(We,Dn("0011"),[on]),A()(We,Dn("0110"),[an]),A()(We,Dn("1100"),[sn]),A()(We,Dn("1001"),[un]),A()(We,Dn("2211"),[on]),A()(We,Dn("2112"),[an]),A()(We,Dn("1122"),[sn]),A()(We,Dn("1221"),[un]),A()(We,Dn("2200"),[cn]),A()(We,Dn("2002"),[ln]),A()(We,Dn("0022"),[cn]),A()(We,Dn("0220"),[ln]),A()(We,Dn("1111"),[fn]),A()(We,Dn("1211"),[hn]),A()(We,Dn("2111"),[dn]),A()(We,Dn("1112"),[pn]),A()(We,Dn("1121"),[vn]),A()(We,Dn("1011"),[hn]),A()(We,Dn("0111"),[dn]),A()(We,Dn("1110"),[pn]),A()(We,Dn("1101"),[vn]),A()(We,Dn("1200"),[gn]),A()(We,Dn("0120"),[yn]),A()(We,Dn("0012"),[mn]),A()(We,Dn("2001"),[bn]),A()(We,Dn("1022"),[gn]),A()(We,Dn("2102"),[yn]),A()(We,Dn("2210"),[mn]),A()(We,Dn("0221"),[bn]),A()(We,Dn("1002"),[An]),A()(We,Dn("2100"),[_n]),A()(We,Dn("0210"),[On]),A()(We,Dn("0021"),[wn]),A()(We,Dn("1220"),[An]),A()(We,Dn("0122"),[_n]),A()(We,Dn("2012"),[On]),A()(We,Dn("2201"),[wn]),A()(We,Dn("0211"),[xn]),A()(We,Dn("2110"),[Cn]),A()(We,Dn("1102"),[Pn]),A()(We,Dn("1021"),[Sn]),A()(We,Dn("2011"),[xn]),A()(We,Dn("0112"),[Cn]),A()(We,Dn("1120"),[Pn]),A()(We,Dn("1201"),[Sn]),A()(We,Dn("2101"),[Bn]),A()(We,Dn("0121"),[Bn]),A()(We,Dn("1012"),[kn]),A()(We,Dn("1210"),[kn]),A()(We,Dn("0101"),{0:[Qe,Ye],1:[Bn],2:[Bn]}),A()(We,Dn("1010"),{0:[$e,Ze],1:[kn],2:[kn]}),A()(We,Dn("2121"),{0:[Bn],1:[Bn],2:[Qe,Ye]}),A()(We,Dn("1212"),{0:[kn],1:[kn],2:[$e,Ze]}),A()(We,Dn("2120"),{0:[En],1:[En],2:[tn,Ye]}),A()(We,Dn("2021"),{0:[Tn],1:[Tn],2:[Qe,nn]}),A()(We,Dn("1202"),{0:[jn],1:[jn],2:[$e,en]}),A()(We,Dn("0212"),{0:[Mn],1:[Mn],2:[Ze,rn]}),A()(We,Dn("0102"),{0:[tn,Ye],1:[En],2:[En]}),A()(We,Dn("0201"),{0:[Qe,nn],1:[Tn],2:[Tn]}),A()(We,Dn("1020"),{0:[$e,en],1:[jn],2:[jn]}),A()(We,Dn("2010"),{0:[Ze,rn],1:[Mn],2:[Mn]}),A()(We,Dn("2020"),{0:[rn,en],1:[In],2:[tn,nn]}),A()(We,Dn("0202"),{0:[nn,tn],1:[In],2:[rn,en]}),We);function Fn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Gn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fn(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Nn=1,Un=2,zn={zIndex:0,zOffset:.005};function Hn(t,e){return Array.isArray(e)?t<e[0]?0:t<e[1]?1:2:t>=e?1:0}function Vn(t){var e=t.cellWeights,n=t.x,r=t.y,i=t.width,o=t.height,a=t.threshold;t.thresholdValue&&(_.a.deprecated("thresholdValue","threshold")(),a=t.thresholdValue);var s=n<0,u=n>=i-1,c=r<0,l=r>=o-1,f=s||u||c||l,h={},d={};s||l?d.top=0:(h.top=e[(r+1)*i+n],d.top=Hn(h.top,a)),u||l?d.topRight=0:(h.topRight=e[(r+1)*i+n+1],d.topRight=Hn(h.topRight,a)),u||c?d.right=0:(h.right=e[r*i+n+1],d.right=Hn(h.right,a)),s||c?d.current=0:(h.current=e[r*i+n],d.current=Hn(h.current,a));var p=d.top,v=d.topRight,g=d.right,y=d.current,m=-1;Number.isFinite(a)&&(m=p<<3|v<<2|g<<1|y),Array.isArray(a)&&(m=p<<6|v<<4|g<<2|y);var b=0;return f||(b=Hn((h.top+h.topRight+h.right+h.current)/4,a)),{code:m,meanCode:b}}function Jn(t){var e=t.gridOrigin,n=t.cellSize,r=t.x,i=t.y,o=t.code,a=t.meanCode,s=t.type,u=void 0===s?Nn:s,c=Gn(Gn({},zn),t.thresholdData),l=u===Un?Ln[o]:Rn[o];Array.isArray(l)||(l=l[a]);var f=c.zIndex*c.zOffset,h=(r+1)*n[0],d=(i+1)*n[1],p=e[0]+h,v=e[1]+d;if(u===Un){var g=[];return l.forEach((function(t){var e=[];t.forEach((function(t){var r=p+t[0]*n[0],i=v+t[1]*n[1];e.push([r,i,f])})),g.push(e)})),g}var y=[];return l.forEach((function(t){t.forEach((function(t){var e=p+t[0]*n[0],r=v+t[1]*n[1];y.push([e,r,f])}))})),y}function Wn(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Kn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kn(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Kn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Xn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var qn=[255,255,255,255],Qn={cellSize:{type:"number",min:1,max:1e3,value:1e3},getPosition:{type:"accessor",value:function(t){return t.position}},getWeight:{type:"accessor",value:1},gpuAggregation:!0,aggregation:"SUM",contours:[{threshold:1}],zOffset:.005},Zn={data:{props:["cellSize"]},weights:{props:["aggregation"],accessors:["getWeight"]}},Yn=function(t){p()(n,t);var e=Xn(n);function n(){return a()(this,n),e.apply(this,arguments)}return u()(n,[{key:"initializeState",value:function(){var t;h()(m()(n.prototype),"initializeAggregationLayer",this).call(this,{dimensions:Zn}),this.setState({contourData:{},projectPoints:!1,weights:{count:{size:1,operation:T.SUM}}}),this.getAttributeManager().add((t={},A()(t,"positions",{size:3,accessor:"getPosition",type:5130,fp64:this.use64bitPositions()}),A()(t,"count",{size:3,accessor:"getWeight"}),t))}},{key:"updateState",value:function(t){h()(m()(n.prototype),"updateState",this).call(this,t);var e=!1,r=t.oldProps,i=t.props,o=this.state.aggregationDirty;r.contours===i.contours&&r.zOffset===i.zOffset||(e=!0,this._updateThresholdData(t.props)),this.getNumInstances()>0&&(o||e)&&this._generateContours()}},{key:"renderLayers",value:function(){var t=this.state.contourData,e=t.contourSegments,n=t.contourPolygons,r=this.getSubLayerClass("lines",Ke.a),i=this.getSubLayerClass("bands",Xe.a);return[e&&e.length>0&&new r(this.getSubLayerProps({id:"lines"}),{data:this.state.contourData.contourSegments,getSourcePosition:function(t){return t.start},getTargetPosition:function(t){return t.end},getColor:function(t){return t.contour.color||qn},getWidth:function(t){return t.contour.strokeWidth||1}}),n&&n.length>0&&new i(this.getSubLayerProps({id:"bands"}),{data:this.state.contourData.contourPolygons,getPolygon:function(t){return t.vertices},getFillColor:function(t){return t.contour.color||qn}})]}},{key:"updateAggregationState",value:function(t){var e=t.props,n=t.oldProps,r=e.cellSize,i=e.coordinateSystem,o=this.context.viewport,a=n.cellSize!==r,s=e.gpuAggregation;this.state.gpuAggregation!==e.gpuAggregation&&s&&!nt.isSupported(this.context.gl)&&(_.a.warn("GPU Grid Aggregation not supported, falling back to CPU")(),s=!1);var u=s!==this.state.gpuAggregation;this.setState({gpuAggregation:s});var c=this.state.dimensions,l=this.isAttributeChanged("positions"),f=c.data,h=c.weights,d=this.state.boundingBox;if(l&&(d=$t(this.getAttributes(),this.getNumInstances()),this.setState({boundingBox:d})),l||a){var p=ne(d,r,o,i),v=p.gridOffset,g=p.translation,y=p.width,m=p.height,b=p.numCol,A=p.numRow;this.allocateResources(A,b),this.setState({gridOffset:v,boundingBox:d,translation:g,posOffset:g.slice(),gridOrigin:[-1*g[0],-1*g[1]],width:y,height:m,numCol:b,numRow:A})}var O=l||u||this.isAggregationDirty(t,{dimension:f,compareAll:s}),w=this.isAggregationDirty(t,{dimension:h});w&&this._updateAccessors(t),(O||w)&&this._resetResults(),this.setState({aggregationDataDirty:O,aggregationWeightsDirty:w})}},{key:"_updateAccessors",value:function(t){var e=t.props,n=e.getWeight,r=e.aggregation,i=e.data,o=this.state.weights.count;o&&(o.getWeight=n,o.operation=T[r]),this.setState({getValue:R(r,n,{data:i})})}},{key:"_resetResults",value:function(){var t=this.state.weights.count;t&&(t.aggregationData=null)}},{key:"_generateContours",value:function(){var t=this.state,e=t.numCol,n=t.numRow,r=t.gridOrigin,i=t.gridOffset,o=t.thresholdData,a=this.state.weights.count,s=a.aggregationData;s||(s=a.aggregationBuffer.getData(),a.aggregationData=s);var u=function(t){var e,n=t.thresholdData,r=t.cellWeights,i=t.gridSize,o=t.gridOrigin,a=t.cellSize,s=[],u=[],c=i[0],l=i[1],f=0,h=0,d=Wn(n);try{for(d.s();!(e=d.n()).done;)for(var p=e.value,v=p.contour,g=v.threshold,y=-1;y<c;y++)for(var m=-1;m<l;m++){var b=Vn({cellWeights:r,threshold:g,x:y,y:m,width:c,height:l}),A=b.code,_=b.meanCode,O={type:Un,gridOrigin:o,cellSize:a,x:y,y:m,width:c,height:l,code:A,meanCode:_,thresholdData:p};if(Array.isArray(g)){O.type=Un;var w,x=Wn(Jn(O));try{for(x.s();!(w=x.n()).done;){var C=w.value;u[h++]={vertices:C,contour:v}}}catch(t){x.e(t)}finally{x.f()}}else{O.type=Nn;for(var P=Jn(O),S=0;S<P.length;S+=2)s[f++]={start:P[S],end:P[S+1],contour:v}}}}catch(t){d.e(t)}finally{d.f()}return{contourSegments:s,contourPolygons:u}}({thresholdData:o,cellWeights:nt.getCellData({countsData:s}).cellWeights,gridSize:[e,n],gridOrigin:r,cellSize:[i.xOffset,i.yOffset]});this.setState({contourData:u})}},{key:"_updateThresholdData",value:function(t){for(var e=t.contours,n=t.zOffset,r=e.length,i=new Array(r),o=0;o<r;o++){var a=e[o];i[o]={contour:a,zIndex:a.zIndex||o,zOffset:n}}this.setState({thresholdData:i})}}]),n}(he);A()(Yn,"layerName","ContourLayer"),A()(Yn,"defaultProps",Qn);var $n=n(248),tr=n(52),er=n(327);function nr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function rr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nr(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ir(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var or={colorDomain:null,colorRange:ut,elevationDomain:null,elevationRange:[0,1e3],elevationScale:{type:"number",min:0,value:1},gridSize:{type:"array",value:[1,1]},gridOrigin:{type:"array",value:[0,0]},gridOffset:{type:"array",value:[0,0]},cellSize:{type:"number",min:0,max:1e3,value:1e3},offset:{type:"array",value:[1,1]},coverage:{type:"number",min:0,max:1,value:1},extruded:!0,material:!0},ar=function(t){p()(n,t);var e=ir(n);function n(){return a()(this,n),e.apply(this,arguments)}return u()(n,[{key:"getShaders",value:function(){return h()(m()(n.prototype),"getShaders",this).call(this,{vs:"#version 300 es\n#define SHADER_NAME gpu-grid-cell-layer-vertex-shader\n#define RANGE_COUNT 6\n\nin vec3 positions;\nin vec3 normals;\n\nin vec4 colors;\nin vec4 elevations;\nin vec3 instancePickingColors;\n\n// Custom uniforms\nuniform vec2 offset;\nuniform bool extruded;\nuniform float cellSize;\nuniform float coverage;\nuniform float opacity;\nuniform float elevationScale;\n\nuniform ivec2 gridSize;\nuniform vec2 gridOrigin;\nuniform vec2 gridOriginLow;\nuniform vec2 gridOffset;\nuniform vec2 gridOffsetLow;\nuniform vec4 colorRange[RANGE_COUNT];\nuniform vec2 elevationRange;\n\n// Domain uniforms\nuniform vec2 colorDomain;\nuniform bool colorDomainValid;\nuniform vec2 elevationDomain;\nuniform bool elevationDomainValid;\n\nlayout(std140) uniform;\nuniform ColorData\n{\n  vec4 maxMinCount;\n} colorData;\nuniform ElevationData\n{\n  vec4 maxMinCount;\n} elevationData;\n\n#define EPSILON 0.00001\n\n// Result\nout vec4 vColor;\n\nvec4 quantizeScale(vec2 domain, vec4 range[RANGE_COUNT], float value) {\n  vec4 outColor = vec4(0., 0., 0., 0.);\n  if (value >= (domain.x - EPSILON) && value <= (domain.y + EPSILON)) {\n    float domainRange = domain.y - domain.x;\n    if (domainRange <= 0.) {\n      outColor = colorRange[0];\n    } else {\n      float rangeCount = float(RANGE_COUNT);\n      float rangeStep = domainRange / rangeCount;\n      float idx = floor((value - domain.x) / rangeStep);\n      idx = clamp(idx, 0., rangeCount - 1.);\n      int intIdx = int(idx);\n      outColor = colorRange[intIdx];\n    }\n  }\n  return outColor;\n}\n\nfloat linearScale(vec2 domain, vec2 range, float value) {\n  if (value >= (domain.x - EPSILON) && value <= (domain.y + EPSILON)) {\n    return ((value - domain.x) / (domain.y - domain.x)) * (range.y - range.x) + range.x;\n  }\n  return -1.;\n}\n\nvoid main(void) {\n  vec2 clrDomain = colorDomainValid ? colorDomain : vec2(colorData.maxMinCount.a, colorData.maxMinCount.r);\n  vec4 color = quantizeScale(clrDomain, colorRange, colors.r);\n\n  float elevation = 0.0;\n\n  if (extruded) {\n    vec2 elvDomain = elevationDomainValid ? elevationDomain : vec2(elevationData.maxMinCount.a, elevationData.maxMinCount.r);\n    elevation = linearScale(elvDomain, elevationRange, elevations.r);\n    elevation = elevation  * (positions.z + 1.0) / 2.0 * elevationScale;\n  }\n\n  // if aggregated color or elevation is 0 do not render\n  float shouldRender = float(color.r > 0.0 && elevations.r >= 0.0);\n  float dotRadius = cellSize / 2. * coverage * shouldRender;\n\n  int yIndex = (gl_InstanceID / gridSize[0]);\n  int xIndex = gl_InstanceID - (yIndex * gridSize[0]);\n\n  vec2 instancePositionXFP64 = mul_fp64(vec2(gridOffset[0], gridOffsetLow[0]), vec2(float(xIndex), 0.));\n  instancePositionXFP64 = sum_fp64(instancePositionXFP64, vec2(gridOrigin[0], gridOriginLow[0]));\n  vec2 instancePositionYFP64 = mul_fp64(vec2(gridOffset[1], gridOffsetLow[1]), vec2(float(yIndex), 0.));\n  instancePositionYFP64 = sum_fp64(instancePositionYFP64, vec2(gridOrigin[1], gridOriginLow[1]));\n\n  vec3 centroidPosition = vec3(instancePositionXFP64[0], instancePositionYFP64[0], elevation);\n  vec3 centroidPosition64Low = vec3(instancePositionXFP64[1], instancePositionYFP64[1], 0.0);\n  geometry.worldPosition = centroidPosition;\n  vec3 pos = vec3(project_size(positions.xy + offset) * dotRadius, 0.);\n\n  // Set color to be rendered to picking fbo (also used to check for selection highlight).\n  picking_setPickingColor(instancePickingColors);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n\n  // Light calculations\n  // Worldspace is the linear space after Mercator projection\n\n  vec3 normals_commonspace = project_normal(normals);\n\n   if (extruded) {\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, normals_commonspace);\n    vColor = vec4(lightColor, color.a * opacity) / 255.;\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity) / 255.;\n  }\n}\n",fs:"#version 300 es\n#define SHADER_NAME gpu-grid-cell-layer-fragment-shader\n\nprecision highp float;\n\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  fragColor = vColor;\n  fragColor = picking_filterColor(fragColor);\n}\n",modules:[E.a,$n.a,at.a,B.b]})}},{key:"initializeState",value:function(t){var e=t.gl;this.getAttributeManager().addInstanced({colors:{size:4,noAlloc:!0},elevations:{size:4,noAlloc:!0}});var n=this._getModel(e);this._setupUniformBuffer(n),this.setState({model:n})}},{key:"_getModel",value:function(t){return new P.a(t,rr(rr({},this.getShaders()),{},{id:this.props.id,geometry:new er.a,isInstanced:!0}))}},{key:"draw",value:function(t){var e=t.uniforms,n=this.props,r=n.cellSize,i=n.offset,o=n.extruded,a=n.elevationScale,s=n.coverage,u=n.gridSize,c=n.gridOrigin,l=n.gridOffset,f=n.elevationRange,h=n.colorMaxMinBuffer,d=n.elevationMaxMinBuffer,p=[Object(tr.b)(c[0]),Object(tr.b)(c[1])],v=[Object(tr.b)(l[0]),Object(tr.b)(l[1])],g=this.getDomainUniforms(),y=ct(this.props.colorRange);this.bindUniformBuffers(h,d),this.state.model.setUniforms(e).setUniforms(g).setUniforms({cellSize:r,offset:i,extruded:o,elevationScale:a,coverage:s,gridSize:u,gridOrigin:c,gridOriginLow:p,gridOffset:l,gridOffsetLow:v,colorRange:y,elevationRange:f}).draw(),this.unbindUniformBuffers(h,d)}},{key:"bindUniformBuffers",value:function(t,e){t.bind({target:35345,index:0}),e.bind({target:35345,index:1})}},{key:"unbindUniformBuffers",value:function(t,e){t.unbind({target:35345,index:0}),e.unbind({target:35345,index:1})}},{key:"getDomainUniforms",value:function(){var t=this.props,e=t.colorDomain,n=t.elevationDomain,r={};return null!==e?(r.colorDomainValid=!0,r.colorDomain=e):r.colorDomainValid=!1,null!==n?(r.elevationDomainValid=!0,r.elevationDomain=n):r.elevationDomainValid=!1,r}},{key:"_setupUniformBuffer",value:function(t){var e=this.context.gl,n=t.program.handle,r=e.getUniformBlockIndex(n,"ColorData"),i=e.getUniformBlockIndex(n,"ElevationData");e.uniformBlockBinding(n,r,0),e.uniformBlockBinding(n,i,1)}}]),n}(st.a);function sr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ur(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?sr(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function cr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}A()(ar,"layerName","GPUGridCellLayer"),A()(ar,"defaultProps",or);var lr={colorDomain:null,colorRange:ut,getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",elevationDomain:null,elevationRange:[0,1e3],getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationScale:{type:"number",min:0,value:1},cellSize:{type:"number",min:1,max:1e3,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:function(t){return t.position}},extruded:!1,material:!0},fr={data:{props:["cellSize","colorAggregation","elevationAggregation"]}},hr=function(t){p()(n,t);var e=cr(n);function n(){return a()(this,n),e.apply(this,arguments)}return u()(n,[{key:"initializeState",value:function(t){var e,r=t.gl,i=nt.isSupported(r);i||_.a.error("GPUGridLayer is not supported on this browser, use GridLayer instead")(),h()(m()(n.prototype),"initializeAggregationLayer",this).call(this,{dimensions:fr}),this.setState({gpuAggregation:!0,projectPoints:!1,isSupported:i,weights:{color:{needMin:!0,needMax:!0,combineMaxMin:!0,maxMinBuffer:new Pt.a(r,{byteLength:16,accessor:{size:4,type:5126,divisor:1}})},elevation:{needMin:!0,needMax:!0,combineMaxMin:!0,maxMinBuffer:new Pt.a(r,{byteLength:16,accessor:{size:4,type:5126,divisor:1}})}},positionAttributeName:"positions"}),this.getAttributeManager().add((e={},A()(e,"positions",{size:3,accessor:"getPosition",type:5130,fp64:this.use64bitPositions()}),A()(e,"color",{size:3,accessor:"getColorWeight"}),A()(e,"elevation",{size:3,accessor:"getElevationWeight"}),e))}},{key:"updateState",value:function(t){!1!==this.state.isSupported&&(h()(m()(n.prototype),"updateState",this).call(this,t),this.state.aggregationDirty&&this.setState({gridHash:null}))}},{key:"getHashKeyForIndex",value:function(t){var e=this.state,n=e.numRow,r=e.numCol,i=e.boundingBox,o=e.gridOffset,a=[r,n],s=[i.xMin,i.yMin],u=[o.xOffset,o.yOffset],c=Math.floor(t/a[0]),l=t-c*a[0],f=Math.floor((c*u[1]+s[1]+90+u[1]/2)/u[1]),h=Math.floor((l*u[0]+s[0]+180+u[0]/2)/u[0]);return"".concat(f,"-").concat(h)}},{key:"getPositionForIndex",value:function(t){var e=this.state,n=e.numRow,r=e.numCol,i=e.boundingBox,o=e.gridOffset,a=[r,n],s=[i.xMin,i.yMin],u=[o.xOffset,o.yOffset],c=Math.floor(t/a[0]);return[(t-c*a[0])*u[0]+s[0],c*u[1]+s[1]]}},{key:"getPickingInfo",value:function(t){var e=t.info,n=t.mode,r=e.index,i=null;if(r>=0){var o=this.state.gpuGridAggregator,a=this.getPositionForIndex(r),s=nt.getAggregationData(ur({pixelIndex:r},o.getData("color"))),u=nt.getAggregationData(ur({pixelIndex:r},o.getData("elevation")));if(i={colorValue:s.cellWeight,elevationValue:u.cellWeight,count:s.cellCount||u.cellCount,position:a,totalCount:s.totalCount||u.totalCount},"hover"!==n){var c=this.props,l=this.state.gridHash;if(!l){var f=this.state,h=f.gridOffset,d=f.translation,p=f.boundingBox,v=this.context.viewport;l=ue(c,{gridOffset:h,attributes:this.getAttributes(),viewport:v,translation:d,boundingBox:p}).gridHash,this.setState({gridHash:l})}var g=l[this.getHashKeyForIndex(r)];Object.assign(i,g)}}return e.picked=Boolean(i),e.object=i,e}},{key:"renderLayers",value:function(){if(!this.state.isSupported)return null;var t=this.props,e=t.elevationScale,n=t.extruded,r=t.cellSize,i=t.coverage,o=t.material,a=t.elevationRange,s=t.colorDomain,u=t.elevationDomain,c=this.state,l=c.weights,f=c.numRow,h=c.numCol,d=c.gridOrigin,p=c.gridOffset,v=l.color,g=l.elevation,y=ct(this.props.colorRange);return new(this.getSubLayerClass("gpu-grid-cell",ar))({gridSize:[h,f],gridOrigin:d,gridOffset:[p.xOffset,p.yOffset],colorRange:y,elevationRange:a,colorDomain:s,elevationDomain:u,cellSize:r,coverage:i,material:o,elevationScale:e,extruded:n},this.getSubLayerProps({id:"gpu-grid-cell"}),{data:{attributes:{colors:v.aggregationBuffer,elevations:g.aggregationBuffer}},colorMaxMinBuffer:v.maxMinBuffer,elevationMaxMinBuffer:g.maxMinBuffer,numInstances:h*f})}},{key:"finalizeState",value:function(t){var e=this.state.weights;[e.color,e.elevation].forEach((function(t){var e=t.aggregationBuffer;t.maxMinBuffer.delete(),null==e||e.delete()})),h()(m()(n.prototype),"finalizeState",this).call(this,t)}},{key:"updateAggregationState",value:function(t){var e=t.props,n=t.oldProps,r=e.cellSize,i=e.coordinateSystem,o=this.context.viewport,a=n.cellSize!==r,s=this.state.dimensions,u=this.isAttributeChanged("positions"),c=u||this.isAttributeChanged(),l=this.state.boundingBox;if(u&&(l=$t(this.getAttributes(),this.getNumInstances()),this.setState({boundingBox:l})),u||a){var f=ne(l,r,o,i),h=f.gridOffset,d=f.translation,p=f.width,v=f.height,g=f.numCol,y=f.numRow;this.allocateResources(y,g),this.setState({gridOffset:h,translation:d,gridOrigin:[-1*d[0],-1*d[1]],width:p,height:v,numCol:g,numRow:y})}var m=c||this.isAggregationDirty(t,{dimension:s.data,compareAll:!0});m&&this._updateAccessors(t),this.setState({aggregationDataDirty:m})}},{key:"_updateAccessors",value:function(t){var e=t.props,n=e.colorAggregation,r=e.elevationAggregation,i=this.state.weights,o=i.color,a=i.elevation;o.operation=T[n],a.operation=T[r]}}]),n}(he);function dr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}function pr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function vr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pr(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}A()(hr,"layerName","GPUGridLayer"),A()(hr,"defaultProps",lr);var gr=vr(vr(vr({},hr.defaultProps),je.defaultProps),{},{gpuAggregation:!1}),yr=function(t){p()(n,t);var e=dr(n);function n(){var t;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),A()(l()(t),"state",void 0),t}return u()(n,[{key:"initializeState",value:function(){this.state={useGPUAggregation:!0}}},{key:"updateState",value:function(t){var e=t.props;this.setState({useGPUAggregation:this.canUseGPUAggregation(e)})}},{key:"renderLayers",value:function(){var t=this.props,e=t.data,n=t.updateTriggers,r=this.state.useGPUAggregation?"GPU":"CPU";return new(this.state.useGPUAggregation?this.getSubLayerClass("GPU",hr):this.getSubLayerClass("CPU",je))(this.props,this.getSubLayerProps({id:r,updateTriggers:n}),{data:e})}},{key:"canUseGPUAggregation",value:function(t){var e=t.gpuAggregation,n=t.lowerPercentile,r=t.upperPercentile,i=t.getColorValue,o=t.getElevationValue,a=t.colorScaleType;return!!e&&(!!nt.isSupported(this.context.gl)&&(0===n&&100===r&&(null===i&&null===o&&("quantile"!==a&&"ordinal"!==a))))}}]),n}(At.a);function mr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return br(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return br(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function br(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ar(t){var e=t.map((function(t){return t[0]})),n=t.map((function(t){return t[1]})),r=Math.min.apply(null,e),i=Math.max.apply(null,e);return[r,Math.min.apply(null,n),i,Math.max.apply(null,n)]}function _r(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}A()(yr,"layerName","GridLayer"),A()(yr,"defaultProps",gr);var Or=new Float32Array(12);function wr(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=0,i=mr(t);try{for(i.s();!(e=i.n()).done;)for(var o=e.value,a=0;a<n;a++)Or[r++]=o[a]||0}catch(t){i.e(t)}finally{i.f()}return Or}function xr(t,e,n){var r=Bt()(t,4),i=r[0],o=r[1],a=r[2],s=r[3],u=a-i,c=s-o,l=u,f=c;u/c<e/n?l=e/n*c:f=n/e*u,l<e&&(l=e,f=n);var h=(a+i)/2,d=(s+o)/2;return[h-l/2,d-f/2,h+l/2,d+f/2]}function Cr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Pr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Cr(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Sr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var Br=function(t){p()(n,t);var e=Sr(n);function n(){return a()(this,n),e.apply(this,arguments)}return u()(n,[{key:"getShaders",value:function(){return{vs:"#define SHADER_NAME heatp-map-layer-vertex-shader\n\nuniform sampler2D maxTexture;\nuniform float intensity;\nuniform vec2 colorDomain;\nuniform float threshold;\nuniform float aggregationMode;\n\nattribute vec3 positions;\nattribute vec2 texCoords;\n\nvarying vec2 vTexCoords;\nvarying float vIntensityMin;\nvarying float vIntensityMax;\n\nvoid main(void) {\n  gl_Position = project_position_to_clipspace(positions, vec3(0.0), vec3(0.0));\n  vTexCoords = texCoords;\n  vec4 maxTexture = texture2D(maxTexture, vec2(0.5));\n  float maxValue = aggregationMode < 0.5 ? maxTexture.r : maxTexture.g;\n  float minValue = maxValue * threshold;\n  if (colorDomain[1] > 0.) {\n    // if user specified custom domain use it.\n    maxValue = colorDomain[1];\n    minValue = colorDomain[0];\n  }\n  vIntensityMax = intensity / maxValue;\n  vIntensityMin = intensity / minValue;\n}\n",fs:"#define SHADER_NAME triangle-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D texture;\nuniform sampler2D colorTexture;\nuniform float aggregationMode;\n\nvarying vec2 vTexCoords;\nvarying float vIntensityMin;\nvarying float vIntensityMax;\n\nvec4 getLinearColor(float value) {\n  float factor = clamp(value * vIntensityMax, 0., 1.);\n  vec4 color = texture2D(colorTexture, vec2(factor, 0.5));\n  color.a *= min(value * vIntensityMin, 1.0);\n  return color;\n}\n\nvoid main(void) {\n  vec4 weights = texture2D(texture, vTexCoords);\n  float weight = weights.r;\n\n  if (aggregationMode > 0.5) {\n    weight /= max(1.0, weights.a);\n  }\n\n  // discard pixels with 0 weight.\n  if (weight <= 0.) {\n     discard;\n  }\n\n  vec4 linearColor = getLinearColor(weight);\n  linearColor.a *= opacity;\n  gl_FragColor =linearColor;\n}\n",modules:[E.a]}}},{key:"initializeState",value:function(t){var e=t.gl;this.getAttributeManager().add({positions:{size:3,noAlloc:!0},texCoords:{size:2,noAlloc:!0}}),this.setState({model:this._getModel(e)})}},{key:"_getModel",value:function(t){var e=this.props.vertexCount;return new P.a(t,Pr(Pr({},this.getShaders()),{},{id:this.props.id,geometry:new ot.a({drawMode:6,vertexCount:e})}))}},{key:"draw",value:function(t){var e=t.uniforms,n=this.state.model,r=this.props,i=r.texture,o=r.maxTexture,a=r.colorTexture,s=r.intensity,u=r.threshold,c=r.aggregationMode,l=r.colorDomain;n.setUniforms(Pr(Pr({},e),{},{texture:i,maxTexture:o,colorTexture:a,intensity:s,threshold:u,aggregationMode:c,colorDomain:l})).draw()}}]),n}(st.a);A()(Br,"layerName","TriangleLayer");var kr;function Er(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Tr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Er(Object(n),!0).forEach((function(e){A()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Er(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function jr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m()(t);if(e){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g()(this,n)}}var Mr={mipmaps:!1,parameters:(kr={},A()(kr,10240,9729),A()(kr,10241,9729),A()(kr,10242,33071),A()(kr,10243,33071),kr),dataFormat:6408},Ir=[0,0],Rr={SUM:0,MEAN:1},Dr={getPosition:{type:"accessor",value:function(t){return t.position}},getWeight:{type:"accessor",value:1},intensity:{type:"number",min:0,value:1},radiusPixels:{type:"number",min:1,max:100,value:50},colorRange:ut,threshold:{type:"number",min:0,max:1,value:.05},colorDomain:{type:"array",value:null,optional:!0},aggregation:"SUM",weightsTextureSize:{type:"number",min:128,max:2048,value:2048},debounceTimeout:{type:"number",min:0,max:1e3,value:500}},Lr=[O.a.BLEND_EQUATION_MINMAX,O.a.TEXTURE_FLOAT],Fr=[O.a.COLOR_ATTACHMENT_RGBA32F,O.a.FLOAT_BLEND],Gr={data:{props:["radiusPixels"]}},Nr=function(t){p()(n,t);var e=jr(n);function n(){var t;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),A()(l()(t),"state",void 0),t}return u()(n,[{key:"initializeState",value:function(){var t=this.context.gl;if(!Object(x.c)(t,Lr))return this.setState({supported:!1}),void _.a.error("HeatmapLayer: ".concat(this.id," is not supported on this browser"))();h()(m()(n.prototype),"initializeAggregationLayer",this).call(this,Gr),this.setState({supported:!0,colorDomain:Ir}),this._setupTextureParams(),this._setupAttributes(),this._setupResources()}},{key:"shouldUpdateState",value:function(t){return t.changeFlags.somethingChanged}},{key:"updateState",value:function(t){this.state.supported&&(h()(m()(n.prototype),"updateState",this).call(this,t),this._updateHeatmapState(t))}},{key:"_updateHeatmapState",value:function(t){var e=t.props,n=t.oldProps,r=this._getChangeFlags(t);(r.dataChanged||r.viewportChanged)&&(r.boundsChanged=this._updateBounds(r.dataChanged),this._updateTextureRenderingBounds()),r.dataChanged||r.boundsChanged?(clearTimeout(this.state.updateTimer),this.setState({isWeightMapDirty:!0})):r.viewportZoomChanged&&this._debouncedUpdateWeightmap(),e.colorRange!==n.colorRange&&this._updateColorTexture(t),this.state.isWeightMapDirty&&this._updateWeightmap(),this.setState({zoom:t.context.viewport.zoom})}},{key:"renderLayers",value:function(){if(!this.state.supported)return[];var t=this.state,e=t.weightsTexture,n=t.triPositionBuffer,r=t.triTexCoordBuffer,i=t.maxWeightsTexture,o=t.colorTexture,a=t.colorDomain,s=this.props,u=s.updateTriggers,c=s.intensity,l=s.threshold,f=s.aggregation;return new(this.getSubLayerClass("triangle",Br))(this.getSubLayerProps({id:"triangle-layer",updateTriggers:u}),{coordinateSystem:Zt.a.DEFAULT,data:{attributes:{positions:n,texCoords:r}},vertexCount:4,maxTexture:i,colorTexture:o,aggregationMode:Rr[f]||0,texture:e,intensity:c,threshold:l,colorDomain:a})}},{key:"finalizeState",value:function(t){h()(m()(n.prototype),"finalizeState",this).call(this,t);var e=this.state,r=e.weightsTransform,i=e.weightsTexture,o=e.maxWeightTransform,a=e.maxWeightsTexture,s=e.triPositionBuffer,u=e.triTexCoordBuffer,c=e.colorTexture,l=e.updateTimer;null==r||r.delete(),null==i||i.delete(),null==o||o.delete(),null==a||a.delete(),null==s||s.delete(),null==u||u.delete(),null==c||c.delete(),l&&clearTimeout(l)}},{key:"_getAttributeManager",value:function(){return new bt.a(this.context.gl,{id:this.props.id,stats:this.context.stats})}},{key:"_getChangeFlags",value:function(t){var e={},n=this.state.dimensions;e.dataChanged=this.isAttributeChanged()||this.isAggregationDirty(t,{compareAll:!0,dimension:n.data}),e.viewportChanged=t.changeFlags.viewportChanged;var r=this.state.zoom;return t.context.viewport&&t.context.viewport.zoom===r||(e.viewportZoomChanged=!0),e}},{key:"_createTextures",value:function(){var t=this.context.gl,e=this.state,n=e.textureSize,r=e.format,i=e.type;this.setState({weightsTexture:new V.a(t,Tr({width:n,height:n,format:r,type:i},Mr)),maxWeightsTexture:new V.a(t,Tr({format:r,type:i},Mr))})}},{key:"_setupAttributes",value:function(){this.getAttributeManager().add({positions:{size:3,type:5130,accessor:"getPosition"},weights:{size:1,accessor:"getWeight"}}),this.setState({positionAttributeName:"positions"})}},{key:"_setupTextureParams",value:function(){var t=this.context.gl,e=this.props.weightsTextureSize,n=Math.min(e,Object(w.f)(t,3379)),r=Object(x.c)(t,Fr),i=function(t){var e=t.gl;return t.floatTargetSupport?{format:Object(w.j)(e)?34836:6408,type:5126}:{format:6408,type:5121}}({gl:t,floatTargetSupport:r}),o=i.format,a=i.type,s=r?1:1/255;this.setState({textureSize:n,format:o,type:a,weightsScale:s}),r||_.a.warn("HeatmapLayer: ".concat(this.id," rendering to float texture not supported, fallingback to low precession format"))()}},{key:"getShaders",value:function(t){return h()(m()(n.prototype),"getShaders",this).call(this,"max-weights-transform"===t?{vs:"attribute vec4 inTexture;\nvarying vec4 outTexture;\n\nvoid main()\n{\noutTexture = inTexture;\ngl_Position = vec4(0, 0, 0, 1.);\n// Enforce default value for ANGLE issue (https://bugs.chromium.org/p/angleproject/issues/detail?id=3941)\ngl_PointSize = 1.0;\n}\n",_fs:"varying vec4 outTexture;\nvoid main() {\n  gl_FragColor = outTexture;\n  gl_FragColor.g = outTexture.r / max(1.0, outTexture.a);\n}\n"}:{vs:"attribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float weights;\nvarying vec4 weightsTexture;\nuniform float radiusPixels;\nuniform float textureWidth;\nuniform vec4 commonBounds;\nuniform float weightsScale;\nvoid main()\n{\n  weightsTexture = vec4(weights * weightsScale, 0., 0., 1.);\n\n  float radiusTexels  = project_pixel_size(radiusPixels) * textureWidth / (commonBounds.z - commonBounds.x);\n  gl_PointSize = radiusTexels * 2.;\n\n  vec3 commonPosition = project_position(positions, positions64Low);\n\n  // map xy from commonBounds to [-1, 1]\n  gl_Position.xy = (commonPosition.xy - commonBounds.xy) / (commonBounds.zw - commonBounds.xy) ;\n  gl_Position.xy = (gl_Position.xy * 2.) - (1.);\n}\n",_fs:"varying vec4 weightsTexture;\n// Epanechnikov function, keeping for reference\n// float epanechnikovKDE(float u) {\n//   return 0.75 * (1.0 - u * u);\n// }\nfloat gaussianKDE(float u){\n  return pow(2.71828, -u*u/0.05555)/(1.77245385*0.166666);\n}\nvoid main()\n{\n  float dist = length(gl_PointCoord - vec2(0.5, 0.5));\n  if (dist > 0.5) {\n    discard;\n  }\n  gl_FragColor = weightsTexture * gaussianKDE(2. * dist);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"})}},{key:"_createWeightsTransform",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.context.gl,r=this.state.weightsTransform,i=this.state.weightsTexture;null===(t=r)||void 0===t||t.delete(),r=new S.a(n,Tr({id:"".concat(this.id,"-weights-transform"),elementCount:1,_targetTexture:i,_targetTextureVarying:"weightsTexture"},e)),this.setState({weightsTransform:r})}},{key:"_setupResources",value:function(){var t=this.context.gl;this._createTextures();var e=this.state,n=e.textureSize,r=e.weightsTexture,i=e.maxWeightsTexture,o=this.getShaders("weights-transform");this._createWeightsTransform(o);var a=this.getShaders("max-weights-transform"),s=new S.a(t,Tr(Tr({id:"".concat(this.id,"-max-weights-transform"),_sourceTextures:{inTexture:r},_targetTexture:i,_targetTextureVarying:"outTexture"},a),{},{elementCount:n*n}));this.setState({weightsTexture:r,maxWeightsTexture:i,maxWeightTransform:s,zoom:null,triPositionBuffer:new Pt.a(t,{byteLength:48,accessor:{size:3}}),triTexCoordBuffer:new Pt.a(t,{byteLength:48,accessor:{size:2}})})}},{key:"updateShaders",value:function(t){this._createWeightsTransform(t)}},{key:"_updateMaxWeightValue",value:function(){this.state.maxWeightTransform.run({parameters:{blend:!0,depthTest:!1,blendFunc:[1,1],blendEquation:32776}})}},{key:"_updateBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.context.viewport,n=[e.unproject([0,0]),e.unproject([e.width,0]),e.unproject([e.width,e.height]),e.unproject([0,e.height])].map((function(t){return t.map(Math.fround)})),r=Ar(n),i={visibleWorldBounds:r,viewportCorners:n},o=!1;if(t||!this.state.worldBounds||!_r(this.state.worldBounds,r)){var a=this._worldToCommonBounds(r),s=this._commonToWorldBounds(a);this.props.coordinateSystem===Zt.a.LNGLAT&&(s[1]=Math.max(s[1],-85.051129),s[3]=Math.min(s[3],85.051129),s[0]=Math.max(s[0],-360),s[2]=Math.min(s[2],360));var u=this._worldToCommonBounds(s);i.worldBounds=s,i.normalizedCommonBounds=u,o=!0}return this.setState(i),o}},{key:"_updateTextureRenderingBounds",value:function(){var t=this.state,e=t.triPositionBuffer,n=t.triTexCoordBuffer,r=t.normalizedCommonBounds,i=t.viewportCorners,o=this.context.viewport;e.subData(wr(i,3));var a=i.map((function(t){return e=o.projectPosition(t),n=r,i=Bt()(n,4),a=i[0],s=i[1],u=i[2],c=i[3],[(e[0]-a)/(u-a),(e[1]-s)/(c-s)];var e,n,i,a,s,u,c}));n.subData(wr(a,2))}},{key:"_updateColorTexture",value:function(t){var e=t.props.colorRange,n=this.state.colorTexture,r=ct(e,!1,Uint8Array);n?n.setImageData({data:r,width:e.length}):n=new V.a(this.context.gl,Tr({data:r,width:e.length,height:1},Mr)),this.setState({colorTexture:n})}},{key:"_updateWeightmap",value:function(){var t,e=this,n=this.props,r=n.radiusPixels,i=n.colorDomain,o=n.aggregation,a=this.state,s=a.weightsTransform,u=a.worldBounds,c=a.textureSize,l=a.weightsTexture,f=a.weightsScale;this.state.isWeightMapDirty=!1;var h=this._worldToCommonBounds(u,{useLayerCoordinateSystem:!0});if(i&&"SUM"===o){var d=this.context.viewport.distanceScales.metersPerUnit[2]*(h[2]-h[0])/c;this.state.colorDomain=i.map((function(t){return t*d*f}))}else this.state.colorDomain=i||Ir;var p={radiusPixels:r,commonBounds:h,textureWidth:c,weightsScale:f};s.update({elementCount:this.getNumInstances()}),Object(w.o)(this.context.gl,{clearColor:[0,0,0,0]},(function(){s.run({uniforms:p,parameters:{blend:!0,depthTest:!1,blendFunc:[1,1],blendEquation:32774},clearRenderTarget:!0,attributes:e.getAttributes(),moduleSettings:e.getModuleSettings()})})),this._updateMaxWeightValue(),l.setParameters((t={},A()(t,10240,9729),A()(t,10241,9729),t))}},{key:"_debouncedUpdateWeightmap",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.state.updateTimer,n=this.props.debounceTimeout;t?(e=null,this._updateBounds(!0),this._updateTextureRenderingBounds(),this.setState({isWeightMapDirty:!0})):(this.setState({isWeightMapDirty:!1}),clearTimeout(e),e=setTimeout(this._debouncedUpdateWeightmap.bind(this,!0),n)),this.setState({updateTimer:e})}},{key:"_worldToCommonBounds",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.useLayerCoordinateSystem,o=void 0!==i&&i,a=Bt()(t,4),s=a[0],u=a[1],c=a[2],l=a[3],f=this.context.viewport,h=this.state.textureSize,d=this.props.coordinateSystem,p=o&&(d===Zt.a.LNGLAT_OFFSETS||d===Zt.a.METER_OFFSETS),v=p?f.projectPosition(this.props.coordinateOrigin):[0,0],g=2*h/f.scale;return o&&!p?(e=this.projectPosition([s,u,0]),n=this.projectPosition([c,l,0])):(e=f.projectPosition([s,u,0]),n=f.projectPosition([c,l,0])),xr([e[0]-v[0],e[1]-v[1],n[0]-v[0],n[1]-v[1]],g,g)}},{key:"_commonToWorldBounds",value:function(t){var e=Bt()(t,4),n=e[0],r=e[1],i=e[2],o=e[3],a=this.context.viewport,s=a.unprojectPosition([n,r]),u=a.unprojectPosition([i,o]);return s.slice(0,2).concat(u.slice(0,2))}}]),n}(Ct);A()(Nr,"layerName","HeatmapLayer"),A()(Nr,"defaultProps",Dr),n.d(e,"ScreenGridLayer",(function(){return me})),n.d(e,"CPUGridLayer",(function(){return je})),n.d(e,"HexagonLayer",(function(){return Je})),n.d(e,"ContourLayer",(function(){return Yn})),n.d(e,"GridLayer",(function(){return yr})),n.d(e,"GPUGridLayer",(function(){return hr})),n.d(e,"AGGREGATION_OPERATION",(function(){return T})),n.d(e,"HeatmapLayer",(function(){return Nr})),n.d(e,"_GPUGridAggregator",(function(){return nt})),n.d(e,"_CPUAggregator",(function(){return Be})),n.d(e,"_AggregationLayer",(function(){return Ct})),n.d(e,"_BinSorter",(function(){return qt}))},function(t,e,n){"use strict";n.r(e);var r=n(194),i=n(349),o=n(210),a=n(344),s=n(12),u=n(198),c=n(264),l=n(212),f=n(250),h=n(49),d=n(348),p=n(95),v=n(125),g=n(123),y=n(251),m=n(252),b=n(343),A=n(82),_=n(0),O=n.n(_),w=n(1),x=n.n(w),C=n(5),P=n.n(C),S=n(7),B=n.n(S),k=n(2),E=n.n(k),T=n(67);function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){O()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function I(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B()(this,n)}}var R={x:[2,0,1],y:[0,1,2],z:[1,2,0]},D=function(t){P()(n,t);var e=I(n);function n(){x()(this,n);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,i=void 0===r?Object(T.c)("truncated-code-geometry"):r,o=L(t),a=o.indices,s=o.attributes;return e.call(this,M(M({},t),{},{id:i,indices:a,attributes:M(M({},s),t.attributes)}))}return n}(A.a);function L(t){for(var e=t.bottomRadius,n=void 0===e?0:e,r=t.topRadius,i=void 0===r?0:r,o=t.height,a=void 0===o?1:o,s=t.nradial,u=void 0===s?10:s,c=t.nvertical,l=void 0===c?10:c,f=t.verticalAxis,h=void 0===f?"y":f,d=t.topCap,p=void 0!==d&&d,v=t.bottomCap,g=void 0!==v&&v,y=(p?2:0)+(g?2:0),m=(u+1)*(l+1+y),b=Math.atan2(n-i,a),A=Math.sin,_=Math.cos,O=Math.PI,w=_(b),x=A(b),C=p?-2:0,P=l+(g?2:0),S=u+1,B=new Uint16Array(u*(l+y)*6),k=R[h],E=new Float32Array(3*m),T=new Float32Array(3*m),j=new Float32Array(2*m),M=0,I=0,D=C;D<=P;D++){var L=D/l,F=a*L,G=void 0;D<0?(F=0,L=1,G=n):D>l?(F=a,L=1,G=i):G=n+D/l*(i-n),-2!==D&&D!==l+2||(G=0,L=0),F-=a/2;for(var N=0;N<S;N++){var U=A(N*O*2/u),z=_(N*O*2/u);E[M+k[0]]=U*G,E[M+k[1]]=F,E[M+k[2]]=z*G,T[M+k[0]]=D<0||D>l?0:U*w,T[M+k[1]]=D<0?-1:D>l?1:x,T[M+k[2]]=D<0||D>l?0:z*w,j[I+0]=N/u,j[I+1]=L,I+=2,M+=3}}for(var H=0;H<l+y;H++)for(var V=0;V<u;V++){var J=6*(H*u+V);B[J+0]=S*(H+0)+0+V,B[J+1]=S*(H+0)+1+V,B[J+2]=S*(H+1)+1+V,B[J+3]=S*(H+0)+0+V,B[J+4]=S*(H+1)+1+V,B[J+5]=S*(H+1)+0+V}return{indices:B,attributes:{POSITION:{size:3,value:E},NORMAL:{size:3,value:T},TEXCOORD_0:{size:2,value:j}}}}function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function G(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){O()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function N(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B()(this,n)}}var U=function(t){P()(n,t);var e=N(n);function n(){x()(this,n);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,i=void 0===r?Object(T.c)("cone-geometry"):r,o=t.radius,a=void 0===o?1:o,s=t.cap,u=void 0===s||s;return e.call(this,G(G({},t),{},{id:i,topRadius:0,topCap:Boolean(u),bottomCap:Boolean(u),bottomRadius:a}))}return n}(D),z=n(327);function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function V(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){O()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function J(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B()(this,n)}}var W=function(t){P()(n,t);var e=J(n);function n(){x()(this,n);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,i=void 0===r?Object(T.c)("cylinder-geometry"):r,o=t.radius,a=void 0===o?1:o;return e.call(this,V(V({},t),{},{id:i,bottomRadius:a,topRadius:a}))}return n}(D),K=n(106);function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){O()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B()(this,n)}}var Z=[-1,0,0,0,1,0,0,0,-1,0,0,1,0,-1,0,1,0,0],Y=[3,4,5,3,5,1,3,1,0,3,0,4,4,0,2,4,2,5,2,0,1,5,2,1],$=function(t){P()(n,t);var e=Q(n);function n(){x()(this,n);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,i=void 0===r?Object(T.c)("ico-sphere-geometry"):r,o=tt(t),a=o.indices,s=o.attributes;return e.call(this,q(q({},t),{},{id:i,indices:a,attributes:q(q({},s),t.attributes)}))}return n}(A.a);function tt(t){var e=t.iterations,n=void 0===e?0:e,r=Math.PI,i=2*r,o=[].concat(Z),a=[].concat(Y);o.push(),a.push();for(var s,u=(s={},function(t,e){var n=(t*=3)>(e*=3)?t:e,r="".concat(t<e?t:e,"|").concat(n);if(r in s)return s[r];var i=o[t],a=o[t+1],u=o[t+2],c=(i+o[e])/2,l=(a+o[e+1])/2,f=(u+o[e+2])/2,h=Math.sqrt(c*c+l*l+f*f);return c/=h,l/=h,f/=h,o.push(c,l,f),s[r]=o.length/3-1}),c=0;c<n;c++){for(var l=[],f=0;f<a.length;f+=3){var h=u(a[f+0],a[f+1]),d=u(a[f+1],a[f+2]),p=u(a[f+2],a[f+0]);l.push(p,a[f+0],h,h,a[f+1],d,d,a[f+2],p,h,d,p)}a=l}for(var v=new Array(o.length),g=new Array(o.length/3*2),y=a.length-3;y>=0;y-=3){var m=a[y+0],b=a[y+1],A=a[y+2],_=3*m,O=3*b,w=3*A,x=2*m,C=2*b,P=2*A,S=o[_+0],B=o[_+1],k=o[_+2],E=Math.acos(k/Math.sqrt(S*S+B*B+k*k))/r,T=1-(Math.atan2(B,S)+r)/i,j=o[O+0],M=o[O+1],I=o[O+2],R=Math.acos(I/Math.sqrt(j*j+M*M+I*I))/r,D=1-(Math.atan2(M,j)+r)/i,L=o[w+0],F=o[w+1],G=o[w+2],N=Math.acos(G/Math.sqrt(L*L+F*F+G*G))/r,U=1-(Math.atan2(F,L)+r)/i,z=[L-j,F-M,G-I],H=[S-j,B-M,k-I],V=new K.a(z).cross(H).normalize(),J=void 0;(0===T||0===D||0===U)&&(0===T||T>.5)&&(0===D||D>.5)&&(0===U||U>.5)&&(o.push(o[_+0],o[_+1],o[_+2]),J=o.length/3-1,a.push(J),g[2*J+0]=1,g[2*J+1]=E,v[3*J+0]=V.x,v[3*J+1]=V.y,v[3*J+2]=V.z,o.push(o[O+0],o[O+1],o[O+2]),J=o.length/3-1,a.push(J),g[2*J+0]=1,g[2*J+1]=R,v[3*J+0]=V.x,v[3*J+1]=V.y,v[3*J+2]=V.z,o.push(o[w+0],o[w+1],o[w+2]),J=o.length/3-1,a.push(J),g[2*J+0]=1,g[2*J+1]=N,v[3*J+0]=V.x,v[3*J+1]=V.y,v[3*J+2]=V.z),v[_+0]=v[O+0]=v[w+0]=V.x,v[_+1]=v[O+1]=v[w+1]=V.y,v[_+2]=v[O+2]=v[w+2]=V.z,g[x+0]=T,g[x+1]=E,g[C+0]=D,g[C+1]=R,g[P+0]=U,g[P+1]=N}return{indices:{size:1,value:new Uint16Array(a)},attributes:{POSITION:{size:3,value:new Float32Array(o)},NORMAL:{size:3,value:new Float32Array(v)},TEXCOORD_0:{size:2,value:new Float32Array(g)}}}}function et(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?et(Object(n),!0).forEach((function(e){O()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):et(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B()(this,n)}}var it=function(t){P()(n,t);var e=rt(n);function n(){x()(this,n);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,i=void 0===r?Object(T.c)("plane-geometry"):r,o=ot(t),a=o.indices,s=o.attributes;return e.call(this,nt(nt({},t),{},{id:i,indices:a,attributes:nt(nt({},s),t.attributes)}))}return n}(A.a);function ot(t){var e=t.type,n=void 0===e?"x,y":e,r=t.offset,i=void 0===r?0:r,o=t.flipCull,a=void 0!==o&&o,s=t.unpack,u=void 0!==s&&s,c=n.split(","),l=t["".concat(c[0],"len")]||1,f=t["".concat(c[1],"len")]||1,h=t["n".concat(c[0])]||1,d=t["n".concat(c[1])]||1,p=(h+1)*(d+1),v=new Float32Array(3*p),g=new Float32Array(3*p),y=new Float32Array(2*p);a&&(l=-l);for(var m=0,b=0,A=0;A<=d;A++)for(var _=0;_<=h;_++){var O=_/h,w=A/d;switch(y[m+0]=a?1-O:O,y[m+1]=w,n){case"x,y":v[b+0]=l*O-.5*l,v[b+1]=f*w-.5*f,v[b+2]=i,g[b+0]=0,g[b+1]=0,g[b+2]=a?1:-1;break;case"x,z":v[b+0]=l*O-.5*l,v[b+1]=i,v[b+2]=f*w-.5*f,g[b+0]=0,g[b+1]=a?1:-1,g[b+2]=0;break;case"y,z":v[b+0]=i,v[b+1]=l*O-.5*l,v[b+2]=f*w-.5*f,g[b+0]=a?1:-1,g[b+1]=0,g[b+2]=0;break;default:throw new Error("PlaneGeometry: unknown type")}m+=2,b+=3}for(var x=h+1,C=new Uint16Array(h*d*6),P=0;P<d;P++)for(var S=0;S<h;S++){var B=6*(P*h+S);C[B+0]=(P+0)*x+S,C[B+1]=(P+1)*x+S,C[B+2]=(P+0)*x+S+1,C[B+3]=(P+1)*x+S,C[B+4]=(P+1)*x+S+1,C[B+5]=(P+0)*x+S+1}var k={indices:{size:1,value:C},attributes:{POSITION:{size:3,value:v},NORMAL:{size:3,value:g},TEXCOORD_0:{size:2,value:y}}};return u?function(t){var e=t.indices,n=t.attributes;if(!e)return t;var r=e.value.length,i={};for(var o in n){var a=n[o],s=a.constant,u=a.value,c=a.size;if(!s&&c){for(var l=new u.constructor(r*c),f=0;f<r;++f)for(var h=e.value[f],d=0;d<c;d++)l[f*c+d]=u[h*c+d];i[o]={size:c,value:l}}}return{attributes:Object.assign({},n,i)}}(k):k}function at(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function st(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?at(Object(n),!0).forEach((function(e){O()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ut(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var i=E()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B()(this,n)}}var ct=function(t){P()(n,t);var e=ut(n);function n(){x()(this,n);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,i=void 0===r?Object(T.c)("sphere-geometry"):r,o=lt(t),a=o.indices,s=o.attributes;return e.call(this,st(st({},t),{},{id:i,indices:a,attributes:st(st({},s),t.attributes)}))}return n}(A.a);function lt(t){var e=t.nlat,n=void 0===e?10:e,r=t.nlong,i=void 0===r?10:r,o=t.radius,a=void 0===o?1:o,s=Math.PI-0,u=2*Math.PI-0,c=(n+1)*(i+1);if("number"==typeof a){var l=a;a=function(t,e,n,r,i){return l}}for(var f=new Float32Array(3*c),h=new Float32Array(3*c),d=new Float32Array(2*c),p=new(c>65535?Uint32Array:Uint16Array)(n*i*6),v=0;v<=n;v++)for(var g=0;g<=i;g++){var y=g/i,m=v/n,b=g+v*(i+1),A=2*b,_=3*b,O=u*y,w=s*m,x=Math.sin(O),C=Math.cos(O),P=Math.sin(w),S=C*P,B=Math.cos(w),k=x*P,E=a(S,B,k,y,m);f[_+0]=E*S,f[_+1]=E*B,f[_+2]=E*k,h[_+0]=S,h[_+1]=B,h[_+2]=k,d[A+0]=y,d[A+1]=1-m}for(var T=i+1,j=0;j<i;j++)for(var M=0;M<n;M++){var I=6*(j*n+M);p[I+0]=M*T+j,p[I+1]=M*T+j+1,p[I+2]=(M+1)*T+j,p[I+3]=(M+1)*T+j,p[I+4]=M*T+j+1,p[I+5]=(M+1)*T+j+1}return{indices:{size:1,value:p},attributes:{POSITION:{size:3,value:f},NORMAL:{size:3,value:h},TEXCOORD_0:{size:2,value:d}}}}n.d(e,"Model",(function(){return r.a})),n.d(e,"Transform",(function(){return i.a})),n.d(e,"ProgramManager",(function(){return o.a})),n.d(e,"Timeline",(function(){return a.a})),n.d(e,"instrumentGLContext",(function(){return s.h})),n.d(e,"isWebGL2",(function(){return s.j})),n.d(e,"FEATURES",(function(){return u.a})),n.d(e,"hasFeatures",(function(){return c.c})),n.d(e,"getParameters",(function(){return s.f})),n.d(e,"setParameters",(function(){return s.n})),n.d(e,"withParameters",(function(){return s.o})),n.d(e,"cssToDeviceRatio",(function(){return s.e})),n.d(e,"readPixelsToBuffer",(function(){return l.d})),n.d(e,"copyToTexture",(function(){return l.b})),n.d(e,"cloneTextureFrom",(function(){return f.a})),n.d(e,"Buffer",(function(){return h.a})),n.d(e,"Program",(function(){return d.a})),n.d(e,"Framebuffer",(function(){return p.a})),n.d(e,"Renderbuffer",(function(){return v.a})),n.d(e,"Texture2D",(function(){return g.a})),n.d(e,"TextureCube",(function(){return y.a})),n.d(e,"Texture3D",(function(){return m.a})),n.d(e,"TransformFeedback",(function(){return b.a})),n.d(e,"Geometry",(function(){return A.a})),n.d(e,"ConeGeometry",(function(){return U})),n.d(e,"CubeGeometry",(function(){return z.a})),n.d(e,"CylinderGeometry",(function(){return W})),n.d(e,"IcoSphereGeometry",(function(){return $})),n.d(e,"PlaneGeometry",(function(){return it})),n.d(e,"SphereGeometry",(function(){return ct})),n.d(e,"TruncatedConeGeometry",(function(){return D}))},function(t,e,n){"use strict";n.r(e);var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(0),u=n.n(s),c=n(15),l=n.n(c),f=n(165),h=n(240),d=n(102),p=n(89);function v(t){var e=t.map,n=t.gl,r=t.deck;if(e.__deck)return e.__deck;var i,o=null==r?void 0:r.props._customRender,a={useDevicePixels:!0,_customRender:function(){e.triggerRepaint(),null==o||o("")},parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774},views:r&&r.props.views||[new f.a({id:"mapbox"})]};return r&&r.props.gl!==n||(Object.assign(a,{gl:n,width:null,height:null,touchAction:"unset",viewState:g(e)}),e.on("move",(function(){return function(t,e){t.setProps({viewState:g(e)}),t.needsRedraw({clearRedrawFlags:!0})}(i,e)}))),r?(i=r,r.setProps(a),r.userData.isExternal=!0):(i=new h.a(a),e.on("remove",(function(){i.finalize(),e.__deck=null}))),i.userData.mapboxLayers=new Set,i.userData.mapboxVersion=function(t){var e=0,n=0,r=t.version;if(r){var i=r.split(".").slice(0,2).map(Number),o=l()(i,2);e=o[0],n=o[1]}return{major:e,minor:n}}(e),e.__deck=i,e.on("render",(function(){i.isInitialized&&function(t,e){var n=t.userData,r=n.mapboxLayers;if(n.isExternal){var i=Array.from(r,(function(t){return t.id})),o=Object(p.b)(t.props.layers,Boolean).some((function(t){return t&&!i.includes(t.id)})),a=t.getViewports(),s=a.findIndex((function(t){return"mapbox"===t.id})),u=a.length>1||s<0;(o||u)&&(s>=0&&((a=a.slice())[s]=y(t,e,!1)),t._drawLayers("mapbox-repaint",{viewports:a,layerFilter:function(e){return(!t.props.layerFilter||t.props.layerFilter(e))&&("mapbox"!==e.viewport.id||!i.includes(e.layer.id))},clearCanvas:!1}))}t.userData.currentViewport=null}(i,e)})),i}function g(t){var e=t.getCenter();return{longitude:(e.lng+540)%360-180,latitude:e.lat,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()}}function y(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.userData,i=r.mapboxVersion;return new d.a(Object.assign({id:"mapbox",x:0,y:0,width:t.width,height:t.height},g(e),n?{nearZMultiplier:1===i.major&&i.minor>=3||i.major>=2?.02:1/(t.height||1)}:{nearZMultiplier:.1}))}function m(t){if(!t.userData.isExternal){var e=[];t.userData.mapboxLayers.forEach((function(t){var n=new(0,t.props.type)(t.props);e.push(n)})),t.setProps({layers:e})}}var b=function(){function t(e){if(i()(this,t),u()(this,"id",void 0),u()(this,"type",void 0),u()(this,"renderingMode",void 0),u()(this,"map",void 0),u()(this,"deck",void 0),u()(this,"props",void 0),!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}return a()(t,[{key:"onAdd",value:function(t,e){var n,r;this.map=t,this.deck=v({map:t,gl:e,deck:this.props.deck}),n=this.deck,r=this,n.userData.mapboxLayers.add(r),m(n)}},{key:"onRemove",value:function(){var t,e;this.deck&&(t=this.deck,e=this,t.userData.mapboxLayers.delete(e),m(t))}},{key:"setProps",value:function(t){Object.assign(this.props,t,{id:this.id}),this.deck&&m(this.deck)}},{key:"render",value:function(){var t,e,n,r,i;t=this.deck,e=this.map,n=this,r=t.userData.currentViewport,i=!1,r||(r=y(t,e,!0),t.userData.currentViewport=r,i=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[r],layerFilter:function(t){var e=t.layer;return n.id===e.id},clearStack:i,clearCanvas:!1})}}]),t}(),A=n(140),_=n.n(A),O=n(44);function w(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function C(t,e,n,r){if(t&&e&&t.style&&t.style._loaded){var i=Object(p.b)(r,Boolean);if(n!==r){var o,a=Object(p.b)(n,Boolean),s=new Set(a.map((function(t){return t.id}))),u=w(i);try{for(u.s();!(o=u.n()).done;){var c=o.value;s.delete(c.id)}}catch(t){u.e(t)}finally{u.f()}var l,f=w(s);try{for(f.s();!(l=f.n()).done;){var h=l.value;t.getLayer(h)&&t.removeLayer(h)}}catch(t){f.e(t)}finally{f.f()}}var d,v=w(i);try{for(v.s();!(d=v.n()).done;){var g=d.value,y=t.getLayer(g.id);y?y.implementation.setProps(g.props):t.addLayer(new b({id:g.id,deck:e}),g.props.beforeId)}}catch(t){v.e(t)}finally{v.f()}var m,A=t.style._order,_={},O=w(i);try{for(O.s();!(m=O.n()).done;){var x=m.value,C=x.props.beforeId;C&&A.includes(C)||(C="__UNDEFINED__"),_[C]=_[C]||[],_[C].push(x.id)}}catch(t){O.e(t)}finally{O.f()}for(var P in _)for(var S=_[P],B="__UNDEFINED__"===P?A.length:A.indexOf(P),k="__UNDEFINED__"===P?void 0:P,E=S.length-1;E>=0;E--){var T=S[E],j=A.indexOf(T);j!==B-1&&(t.moveLayer(T,k),j>B&&B++),B--,k=T}}}var P=["interleaved"];function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function B(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var k=function(){function t(e){var n=this;i()(this,t),u()(this,"_props",void 0),u()(this,"_deck",void 0),u()(this,"_map",void 0),u()(this,"_container",void 0),u()(this,"_interleaved",void 0),u()(this,"_handleStyleChange",(function(){C(n._map,n._deck,n._props.layers,n._props.layers)})),u()(this,"_updateContainerSize",(function(){if(n._map&&n._container){var t=n._map.getContainer(),e=t.clientWidth,r=t.clientHeight;Object.assign(n._container.style,{width:"".concat(e,"px"),height:"".concat(r,"px")})}})),u()(this,"_updateViewState",(function(){var t=n._deck;t&&(t.setProps({viewState:g(n._map)}),t.redraw())})),u()(this,"_handleMouseEvent",(function(t){var e=n._deck;if(e){var r={type:t.type,offsetCenter:t.point,srcEvent:t};switch(t.type){case"click":r.tapCount=1,e._onPointerDown(r),e._onEvent(r);break;case"dblclick":r.type="click",r.tapCount=2,e._onEvent(r);break;case"mousemove":r.type="pointermove",e._onPointerMove(r);break;case"mouseout":r.type="pointerleave",e._onPointerMove(r);break;default:return}}}));var r=e.interleaved,o=void 0!==r&&r,a=_()(e,P);this._interleaved=o,this._props=a}return a()(t,[{key:"setProps",value:function(t){this._interleaved&&t.layers&&C(this._map,this._deck,this._props.layers,t.layers),Object.assign(this._props,t),this._deck&&this._deck.setProps(this._props)}},{key:"onAdd",value:function(t){return this._map=t,this._interleaved?this._onAddInterleaved(t):this._onAddOverlaid(t)}},{key:"_onAddOverlaid",value:function(t){var e=document.createElement("div");return Object.assign(e.style,{position:"absolute",left:0,top:0,pointerEvents:"none"}),this._container=e,this._deck=new h.a(B(B({},this._props),{},{parent:e,viewState:g(t)})),t.on("resize",this._updateContainerSize),t.on("render",this._updateViewState),t.on("mousemove",this._handleMouseEvent),t.on("mouseout",this._handleMouseEvent),t.on("click",this._handleMouseEvent),t.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),e}},{key:"_onAddInterleaved",value:function(t){return this._deck=new h.a(B(B({},this._props),{},{gl:t.painter.context.gl})),t.on("styledata",this._handleStyleChange),C(t,this._deck,[],this._props.layers),document.createElement("div")}},{key:"onRemove",value:function(){var t,e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),null===(t=this._deck)||void 0===t||t.finalize(),this._deck=void 0,this._map=void 0,this._container=void 0}},{key:"_onRemoveOverlaid",value:function(t){t.off("resize",this._updateContainerSize),t.off("render",this._updateViewState),t.off("mousemove",this._handleMouseEvent),t.off("mouseout",this._handleMouseEvent),t.off("click",this._handleMouseEvent),t.off("dblclick",this._handleMouseEvent)}},{key:"_onRemoveInterleaved",value:function(t){t.off("styledata",this._handleStyleChange),C(t,this._deck,this._props.layers,[])}},{key:"getDefaultPosition",value:function(){return"top-left"}},{key:"pickObject",value:function(t){return Object(O.a)(this._deck),this._deck.pickObject(t)}},{key:"pickMultipleObjects",value:function(t){return Object(O.a)(this._deck),this._deck.pickMultipleObjects(t)}},{key:"pickObjects",value:function(t){return Object(O.a)(this._deck),this._deck.pickObjects(t)}},{key:"finalize",value:function(){this._map&&this._map.removeControl(this)}}]),t}();n.d(e,"MapboxLayer",(function(){return b})),n.d(e,"MapboxOverlay",(function(){return k}))},function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(10),l=n.n(c),f=n(5),h=n.n(f),d=n(7),p=n.n(d),v=n(2),g=n.n(v);function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var m=n(13),b=n(45),A=n.n(b),_=("undefined"!=typeof window?window:global,"undefined"!=typeof global?global:window,"undefined"!=typeof document?document:{});var O={container:A.a.object,gl:A.a.object,mapboxApiAccessToken:A.a.string,mapboxApiUrl:A.a.string,attributionControl:A.a.bool,preserveDrawingBuffer:A.a.bool,reuseMaps:A.a.bool,transformRequest:A.a.func,mapOptions:A.a.object,mapStyle:A.a.oneOfType([A.a.string,A.a.object]),visible:A.a.bool,asyncRender:A.a.bool,onLoad:A.a.func,onError:A.a.func,width:A.a.number,height:A.a.number,viewState:A.a.object,longitude:A.a.number,latitude:A.a.number,zoom:A.a.number,bearing:A.a.number,pitch:A.a.number,altitude:A.a.number},w={container:_.body,mapboxApiAccessToken:function(){var t=null;if("undefined"!=typeof window&&window.location){var e=window.location.search.match(/access_token=([^&\/]*)/);t=e&&e[1]}t||"undefined"==typeof process||(t=t||process.env.MapboxAccessToken||process.env.REACT_APP_MAPBOX_ACCESS_TOKEN);return t||"no-token"}(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",visible:!0,asyncRender:!1,onLoad:function(){},onError:function(t){t&&console.error(t.error)},width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function x(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"component";t.debug&&A.a.checkPropTypes(O,t,"prop",e)}var C=function(){function t(e){var n=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object(m.a)(this,"mapboxgl",void 0),Object(m.a)(this,"props",w),Object(m.a)(this,"_map",null),Object(m.a)(this,"width",0),Object(m.a)(this,"height",0),Object(m.a)(this,"_fireLoadEvent",(function(){n.props.onLoad({type:"load",target:n._map})})),!e.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=e.mapboxgl,t.initialized||(t.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(e)}var e,n,r;return e=t,(n=[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(t){return this._update(this.props,t),this}},{key:"resize",value:function(){return this._map.resize(),this}},{key:"redraw",value:function(){var t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(e){this._map=t.savedMap;var n=this._map.getContainer(),r=e.container;for(r.classList.add("mapboxgl-map");n.childNodes.length>0;)r.appendChild(n.childNodes[0]);this._map._container=r,t.savedMap=null,e.mapStyle&&this._map.setStyle(e.mapStyle,{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(e){if(e.reuseMaps&&t.savedMap)this._reuse(e);else{if(e.gl){var n=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=n,e.gl}}var r={container:e.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:e.mapStyle,interactive:!1,trackResize:!1,attributionControl:e.attributionControl,preserveDrawingBuffer:e.preserveDrawingBuffer};e.transformRequest&&(r.transformRequest=e.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},r,e.mapOptions)),this._map.once("load",e.onLoad),this._map.on("error",e.onError)}return this}},{key:"_destroy",value:function(){this._map&&(t.savedMap?this._map.remove():(t.savedMap=this._map,this._map.off("load",this.props.onLoad),this._map.off("error",this.props.onError),this._map.off("styledata",this._fireLoadEvent)),this._map=null)}},{key:"_initialize",value:function(t){var e=this;x(t=Object.assign({},w,t),"Mapbox"),this.mapboxgl.accessToken=t.mapboxApiAccessToken||w.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=t.mapboxApiUrl,this._create(t);var n=t.container;Object.defineProperty(n,"offsetWidth",{get:function(){return e.width}}),Object.defineProperty(n,"clientWidth",{get:function(){return e.width}}),Object.defineProperty(n,"offsetHeight",{get:function(){return e.height}}),Object.defineProperty(n,"clientHeight",{get:function(){return e.height}});var r=this._map.getCanvas();r&&(r.style.outline="none"),this._updateMapViewport({},t),this._updateMapSize({},t),this.props=t}},{key:"_update",value:function(t,e){if(this._map){x(e=Object.assign({},this.props,e),"Mapbox");var n=this._updateMapViewport(t,e),r=this._updateMapSize(t,e);e.asyncRender||!n&&!r||this.redraw(),this.props=e}}},{key:"_updateMapSize",value:function(t,e){var n=t.width!==e.width||t.height!==e.height;return n&&(this.width=e.width,this.height=e.height,this.resize()),n}},{key:"_updateMapViewport",value:function(t,e){var n=this._getViewState(t),r=this._getViewState(e),i=r.latitude!==n.latitude||r.longitude!==n.longitude||r.zoom!==n.zoom||r.pitch!==n.pitch||r.bearing!==n.bearing||r.altitude!==n.altitude;return i&&(this._map.jumpTo(this._viewStateToMapboxProps(r)),r.altitude!==n.altitude&&(this._map.transform.altitude=r.altitude)),i}},{key:"_getViewState",value:function(t){var e=t.viewState||t,n=e.longitude,r=e.latitude,i=e.zoom,o=e.pitch,a=void 0===o?0:o,s=e.bearing,u=void 0===s?0:s,c=e.altitude;return{longitude:n,latitude:r,zoom:i,pitch:a,bearing:u,altitude:void 0===c?1.5:c}}},{key:"_checkStyleSheet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.47.0";if(void 0!==_)try{var e=_.createElement("div");e.className="mapboxgl-map",e.style.display="none",_.body.append(e);var n="static"!==window.getComputedStyle(e).position;if(!n){var r=_.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(t,"/mapbox-gl.css")),_.head.append(r)}}catch(t){}}},{key:"_viewStateToMapboxProps",value:function(t){return{center:[t.longitude,t.latitude],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}}}])&&y(e.prototype,n),r&&y(e,r),t}();Object(m.a)(C,"initialized",!1),Object(m.a)(C,"propTypes",O),Object(m.a)(C,"defaultProps",w),Object(m.a)(C,"savedMap",null);var P=n(240);function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function B(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=g()(t);if(e){var i=g()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p()(this,n)}}n.d(e,"default",(function(){return j}));var E={position:"absolute",left:0,top:0,width:"100%",height:"100%"};function T(t){var e=t.container,n=void 0===e?document.body:e;if("string"==typeof n&&(n=document.getElementById(n)),!n)throw Error("Deck: container not found");"static"===window.getComputedStyle(n).position&&(n.style.position="relative");var r=document.createElement("div");n.appendChild(r),Object.assign(r.style,E);var i=document.createElement("canvas");return n.appendChild(i),Object.assign(i.style,E),{container:n,mapCanvas:r,deckCanvas:i}}var j=function(t){h()(n,t);var e=k(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(a()(this,n),"undefined"==typeof document)throw Error("Deck can only be used in the browser");var i=T(r),o=i.mapCanvas,s=i.deckCanvas,u=r.viewState||r.initialViewState,c=Number.isFinite(u&&u.latitude),l=r.map,f=void 0===l?window.mapboxgl:l;return t=e.call(this,B({canvas:s},r)),f&&f.Map?t._map=c&&new C(B(B({},r),{},{viewState:u,container:o,mapboxgl:f})):t._map=f,t._onBeforeRender=function(e){if(t.onBeforeRender(e),t._map){var n=t.getViewports()[0];t._map.setProps({width:n.width,height:n.height,viewState:n})}},t}return u()(n,[{key:"getMapboxMap",value:function(){return this._map&&this._map.getMap()}},{key:"finalize",value:function(){this._map&&this._map.finalize(),l()(g()(n.prototype),"finalize",this).call(this)}},{key:"setProps",value:function(t){"onBeforeRender"in t&&this._onBeforeRender&&t.onBeforeRender!==this._onBeforeRender&&(this.onBeforeRender=t.onBeforeRender,t.onBeforeRender=this._onBeforeRender),"mapStyle"in t&&this._map&&this._map._map.setStyle(t.mapStyle),l()(g()(n.prototype),"setProps",this).call(this,t)}}]),n}(P.a)},function(t,e,n){"use strict";n.r(e);var r=n(140),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s),c=n(0),l=n.n(c),f=n(12),h=n(240),d=n(346),p=n(98);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function y(t,e,n,r){if(n){if(n.userData._googleMap===t)return n;b(n)}var i={click:null,dblclick:null,mousemove:null,mouseout:null},o=new h.a(g(g({},r),{},{useDevicePixels:!!r.interleaved||r.useDevicePixels,style:r.interleaved?null:{pointerEvents:"none"},parent:m(e,r.style),initialViewState:{longitude:0,latitude:0,zoom:1},controller:!1})),a=function(e){i[e]=t.addListener(e,(function(t){return function(t,e,n){var r={type:e,offsetCenter:w(n,t),srcEvent:n};switch(e){case"click":r.tapCount=1,t._onPointerDown(r),t._onEvent(r);break;case"dblclick":r.type="click",r.tapCount=2,t._onEvent(r);break;case"mousemove":r.type="pointermove",t._onPointerMove(r);break;case"mouseout":r.type="pointerleave",t._onPointerMove(r);break;default:return}}(o,e,t)}))};for(var s in i)a(s);return o.userData._googleMap=t,o.userData._eventListeners=i,o}function m(t,e){var n,r,i=document.createElement("div");(i.style.position="absolute",Object.assign(i.style,e),"getPanes"in t)?null===(n=t.getPanes())||void 0===n||n.overlayLayer.appendChild(i):null===(r=t.getMap())||void 0===r||r.getDiv().appendChild(i);return i}function b(t){var e=t.userData._eventListeners;for(var n in e)e[n]&&e[n].remove();t.finalize()}function A(t,e){var n=_(t),r=n.width,i=n.height,o=e.getCameraParams(),a=o.center,s=o.heading,u=o.tilt,c=o.zoom,l=i?r/i:1,f=(new p.a).perspective({fovy:25*Math.PI/180,aspect:l,near:.75,far:3e14});return{width:r,height:i,viewState:{altitude:.5*f[5],bearing:s,latitude:a.lat(),longitude:a.lng(),pitch:u,projectionMatrix:f,repeat:!0,zoom:c-1}}}function _(t){var e=t.getDiv().firstChild;return{width:e.offsetWidth,height:e.offsetHeight}}function O(t,e,n){var r=new google.maps.Point(e,n),i=t.fromContainerPixelToLatLng(r);return[i.lng(),i.lat()]}function w(t,e){if(t.pixel)return t.pixel;var n=e.getViewports()[0].project([t.latLng.lng(),t.latLng.lat()]);return{x:n[0],y:n[1]}}var x=["width","height","left","top"];function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var S=function(){return!1},B={depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],blendEquation:32774};function k(){}var E={interleaved:!0},T=function(){function t(e){a()(this,t),l()(this,"props",{}),l()(this,"_map",null),l()(this,"_deck",null),l()(this,"_overlay",null),this.setProps(P(P({},E),e))}return u()(t,[{key:"setMap",value:function(t){var e=this;if(t!==this._map){var n;if(this._map)null===(n=this._overlay)||void 0===n||n.setMap(null),this._map=null;if(t){this._map=t;var r=google.maps.RenderingType.UNINITIALIZED;t.getRenderingType()!==r?this._createOverlay(t):t.addListener("renderingtype_changed",(function(){e._createOverlay(t)}))}}}},{key:"setProps",value:function(t){if(Object.assign(this.props,t),this._deck){if(t.style){var e=this._deck.canvas.parentElement.style;Object.assign(e,t.style),t.style=null}this._deck.setProps(t)}}},{key:"pickObject",value:function(t){return this._deck&&this._deck.pickObject(t)}},{key:"pickMultipleObjects",value:function(t){return this._deck&&this._deck.pickMultipleObjects(t)}},{key:"pickObjects",value:function(t){return this._deck&&this._deck.pickObjects(t)}},{key:"finalize",value:function(){this.setMap(null),this._deck&&(b(this._deck),this._deck=null)}},{key:"_createOverlay",value:function(t){var e=this.props.interleaved,n=google.maps.RenderingType,r=n.VECTOR,i=n.UNINITIALIZED,o=t.getRenderingType();if(o!==i){var a=new(o===r&&google.maps.WebGLOverlayView?google.maps.WebGLOverlayView:google.maps.OverlayView);a instanceof google.maps.WebGLOverlayView?(e?(a.onAdd=k,a.onContextRestored=this._onContextRestored.bind(this),a.onDraw=this._onDrawVectorInterleaved.bind(this)):(a.onAdd=this._onAdd.bind(this),a.onContextRestored=k,a.onDraw=this._onDrawVectorOverlay.bind(this)),a.onContextLost=this._onContextLost.bind(this)):(a.onAdd=this._onAdd.bind(this),a.draw=this._onDrawRaster.bind(this)),a.onRemove=this._onRemove.bind(this),this._overlay=a,this._overlay.setMap(t)}}},{key:"_onAdd",value:function(){this._deck=y(this._map,this._overlay,this._deck,this.props)}},{key:"_onContextRestored",value:function(t){var e=this,n=t.gl;if(this._map&&this._overlay){var r=y(this._map,this._overlay,this._deck,P({gl:n,_customRender:function(){e._overlay&&e._overlay.requestRedraw()}},this.props));this._deck=r;var i=r.animationLoop;i._renderFrame=function(){var t=n.getParameter(34964);Object(f.o)(n,{},(function(){i.onRender()})),n.bindBuffer(34962,t)}}}},{key:"_onContextLost",value:function(){this._deck&&(b(this._deck),this._deck=null)}},{key:"_onRemove",value:function(){var t;null===(t=this._deck)||void 0===t||t.setProps({layerFilter:S})}},{key:"_onDrawRaster",value:function(){if(this._deck&&this._map){var t=this._deck,e=function(t,e){var n=_(t),r=n.width,i=n.height,o=e.getProjection(),a=t.getBounds();if(!a)return{width:r,height:i,left:0,top:0};var s=a.getNorthEast(),u=a.getSouthWest(),c=o.fromLatLngToDivPixel(s),l=o.fromLatLngToDivPixel(u),f=O(o,r/2,i/2),h=new google.maps.LatLng(0,f[0]),p=o.fromLatLngToContainerPixel(h),v=o.fromLatLngToDivPixel(h);if(!(c&&l&&v&&p))return{width:r,height:i,left:0,top:0};var g=Math.round(v.x-p.x),y=v.y-p.y,m=O(o,r/2,0),b=O(o,r/2,i),A=f[1],w=f[0];if(Math.abs(A)>85.05113){A=A>0?85.05113:-85.05113;var x=new google.maps.LatLng(A,w);y+=o.fromLatLngToContainerPixel(x).y-i/2}y=Math.round(y);var C=180*new d.a(m).sub(b).verticalAngle()/Math.PI;C<0&&(C+=360);var P,S=t.getHeading()||0,B=t.getZoom()-1;if(0===C)P=i?(l.y-c.y)/i:1;else if(C===S){var k=new d.a([c.x,c.y]).sub([l.x,l.y]).len(),E=new d.a([r,-i]).len();P=E?k/E:1}return{width:r,height:i,left:g,top:y,zoom:B+=Math.log2(P||1),bearing:C,pitch:t.getTilt(),latitude:A,longitude:w}}(this._map,this._overlay),n=e.width,r=e.height,o=e.left,a=e.top,s=i()(e,x),u=t.canvas.parentElement.style;u.left="".concat(o,"px"),u.top="".concat(a,"px");t.setProps({width:n,height:r,viewState:P({altitude:1e4,repeat:!0},s)}),t.redraw()}}},{key:"_onDrawVectorInterleaved",value:function(t){var e=t.gl,n=t.transformer;if(this._deck&&this._map){var r=this._deck;if(r.setProps(P(P({},A(this._map,n)),{},{width:null,height:null})),r.isInitialized){var i=Object(f.f)(e,36006);r.setProps({_framebuffer:i}),r.needsRedraw({clearRedrawFlags:!0}),Object(f.n)(e,{viewport:[0,0,e.canvas.width,e.canvas.height],scissor:[0,0,e.canvas.width,e.canvas.height],stencilFunc:[519,0,255,519,0,255]}),Object(f.o)(e,B,(function(){r._drawLayers("google-vector",{clearCanvas:!1})}))}}}},{key:"_onDrawVectorOverlay",value:function(t){var e=t.transformer;if(this._deck&&this._map){var n=this._deck;n.setProps(P({},A(this._map,e))),n.redraw()}}}]),t}();n.d(e,"GoogleMapsOverlay",(function(){return T}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));var r=n(0),i=n.n(r),o=n(1),a=n.n(o),s=n(5),u=n.n(s),c=n(7),l=n.n(c),f=n(2),h=n.n(f),d=n(82),p=n(67);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){i()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var m=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),b=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),A=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),_=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),O={POSITION:{size:3,value:new Float32Array(b)},NORMAL:{size:3,value:new Float32Array(A)},TEXCOORD_0:{size:2,value:new Float32Array(_)}},w=function(t){u()(n,t);var e=y(n);function n(){a()(this,n);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,i=void 0===r?Object(p.c)("cube-geometry"):r;return e.call(this,g(g({},t),{},{id:i,indices:{size:1,value:new Uint16Array(m)},attributes:g(g({},O),t.attributes)}))}return n}(d.a)},function(t,e,n){"use strict";var r=n(26),i=n.n(r),o=n(27),a=n.n(o),s=n(0),u=n.n(s),c=n(1),l=n.n(c),f=n(3),h=n.n(f),d=n(13),p=n(152);Object(p.a)();function v(t){try{var e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(t){return null}}var g,y=function(){function t(e){l()(this,t);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";Object(d.a)(this,"storage",void 0),Object(d.a)(this,"id",void 0),Object(d.a)(this,"config",{}),this.storage=v(r),this.id=e,this.config={},Object.assign(this.config,n),this._loadConfiguration()}return h()(t,[{key:"getConfiguration",value:function(){return this.config}},{key:"setConfiguration",value:function(t){return this.config={},this.updateConfiguration(t)}},{key:"updateConfiguration",value:function(t){if(Object.assign(this.config,t),this.storage){var e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}return this}},{key:"_loadConfiguration",value:function(){var t={};if(this.storage){var e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}]),t}();function m(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600,i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));var o=t.width*n,a=t.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),s]}function b(t){return"string"==typeof t?g[t.toUpperCase()]||g.WHITE:t}function A(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function O(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"],r=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(r),o=A(i);try{var a=function(){var r=e.value;"function"==typeof t[r]&&(n.find((function(t){return r===t}))||(t[r]=t[r].bind(t)))};for(o.s();!(e=o.n()).done;)a()}catch(t){o.e(t)}finally{o.f()}}function w(t,e){if(!t)throw new Error(e||"Assertion failed")}!function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(g||(g={}));var x={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":i()(process))&&process},C=(globalThis,x.window||x.self||x.global),P=x.process||{};console;function S(){var t,e,n;if(p.a&&"performance"in C)t=null==C?void 0:null===(e=C.performance)||void 0===e?void 0:null===(n=e.now)||void 0===n?void 0:n.call(e);else if("hrtime"in P){var r,i=null==P?void 0:null===(r=P.hrtime)||void 0===r?void 0:r.call(P);t=1e3*i[0]+i[1]/1e6}else t=Date.now();return t}n.d(e,"a",(function(){return M}));var B={debug:p.a&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},k={enabled:!0,level:0};function E(){}var T={},j={once:!0},M=function(){function t(){l()(this,t);var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""},n=e.id;Object(d.a)(this,"id",void 0),Object(d.a)(this,"VERSION","8.8.20"),Object(d.a)(this,"_startTs",S()),Object(d.a)(this,"_deltaTs",S()),Object(d.a)(this,"_storage",void 0),Object(d.a)(this,"userData",{}),Object(d.a)(this,"LOG_THROTTLE_TIMEOUT",0),this.id=n,this._storage=new y("__probe-".concat(this.id,"__"),k),this.userData={},this.timeStamp("".concat(this.id," started")),O(this),Object.seal(this)}return h()(t,[{key:"level",get:function(){return this.getLevel()},set:function(t){this.setLevel(t)}},{key:"isEnabled",value:function(){return this._storage.config.enabled}},{key:"getLevel",value:function(){return this._storage.config.level}},{key:"getTotal",value:function(){return Number((S()-this._startTs).toPrecision(10))}},{key:"getDelta",value:function(){return Number((S()-this._deltaTs).toPrecision(10))}},{key:"priority",get:function(){return this.level},set:function(t){this.level=t}},{key:"getPriority",value:function(){return this.level}},{key:"enable",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.updateConfiguration({enabled:t}),this}},{key:"setLevel",value:function(t){return this._storage.updateConfiguration({level:t}),this}},{key:"get",value:function(t){return this._storage.config[t]}},{key:"set",value:function(t,e){this._storage.updateConfiguration(u()({},t,e))}},{key:"settings",value:function(){console.table?console.table(this._storage.config):console.log(this._storage.config)}},{key:"assert",value:function(t,e){w(t,e)}},{key:"warn",value:function(t){return this._getLogFunction(0,t,B.warn,arguments,j)}},{key:"error",value:function(t){return this._getLogFunction(0,t,B.error,arguments)}},{key:"deprecated",value:function(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}},{key:"removed",value:function(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}},{key:"probe",value:function(t,e){return this._getLogFunction(t,e,B.log,arguments,{time:!0,once:!0})}},{key:"log",value:function(t,e){return this._getLogFunction(t,e,B.debug,arguments)}},{key:"info",value:function(t,e){return this._getLogFunction(t,e,console.info,arguments)}},{key:"once",value:function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this._getLogFunction(t,e,B.debug||B.info,arguments,j)}},{key:"table",value:function(t,e,n){return e?this._getLogFunction(t,e,console.table||E,n&&[n],{tag:D(e)}):E}},{key:"image",value:function(t){var e=t.logLevel,r=t.priority,i=t.image,o=t.message,s=void 0===o?"":o,u=t.scale,c=void 0===u?1:u;return this._shouldLog(e||r)?p.a?function(t){var e=t.image,n=t.message,r=void 0===n?"":n,i=t.scale,o=void 0===i?1:i;if("string"==typeof e){var s=new Image;return s.onload=function(){var t,e=m(s,r,o);(t=console).log.apply(t,a()(e))},s.src=e,E}var u=e.nodeName||"";if("img"===u.toLowerCase()){var c;return(c=console).log.apply(c,a()(m(e,r,o))),E}if("canvas"===u.toLowerCase()){var l=new Image;return l.onload=function(){var t;return(t=console).log.apply(t,a()(m(l,r,o)))},l.src=e.toDataURL(),E}return E}({image:i,message:s,scale:c}):function(t){var e=t.image,r=(t.message,t.scale),i=void 0===r?1:r,o=null;try{o=n(282)}catch(t){}if(o)return function(){return o(e,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then((function(t){return console.log(t)}))};return E}({image:i,message:s,scale:c}):E}},{key:"time",value:function(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}},{key:"timeEnd",value:function(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}},{key:"timeStamp",value:function(t,e){return this._getLogFunction(t,e,console.timeStamp||E)}},{key:"group",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1},r=R({logLevel:t,message:e,opts:n}),i=n.collapsed;return r.method=(i?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}},{key:"groupCollapsed",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}},{key:"groupEnd",value:function(t){return this._getLogFunction(t,"",console.groupEnd||E)}},{key:"withGroup",value:function(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}},{key:"trace",value:function(){console.trace&&console.trace()}},{key:"_shouldLog",value:function(t){return this.isEnabled()&&this.getLevel()>=I(t)}},{key:"_getLogFunction",value:function(t,e,n,r,i){if(this._shouldLog(t)){var o;i=R({logLevel:t,message:e,args:r,opts:i}),w(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=S();var s=i.tag||i.message;if(i.once){if(T[s])return E;T[s]=S()}return e=function(t,e,n){if("string"==typeof e){var r=n.time?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}((s=n.total)<10?"".concat(s.toFixed(2),"ms"):s<100?"".concat(s.toFixed(1),"ms"):s<1e3?"".concat(s.toFixed(0),"ms"):"".concat((s/1e3).toFixed(2),"s")):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),i=e,o=n.color,a=n.background,p.a||"string"!=typeof i||(o&&(o=b(o),i="[".concat(o,"m").concat(i,"[39m")),a&&(o=b(a),i="[".concat(a+10,"m").concat(i,"[49m"))),e=i}var i,o,a;var s;return e}(this.id,i.message,i),(o=n).bind.apply(o,[console,e].concat(a()(i.args)))}return E}}]),t}();function I(t){if(!t)return 0;var e;switch(i()(t)){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return w(Number.isFinite(e)&&e>=0),e}function R(t){var e=t.logLevel,n=t.message;t.logLevel=I(e);for(var r=t.args?Array.from(t.args):[];r.length&&r.shift()!==n;);switch(i()(e)){case"string":case"function":void 0!==n&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"==typeof t.message&&(t.message=t.message());var o=i()(t.message);return w("string"===o||"object"===o),Object.assign(t,{args:r},t.opts)}function D(t){for(var e in t)for(var n in t[e])return n||"untitled";return"empty"}Object(d.a)(M,"VERSION","8.8.20")},,,,,,,,,,,,,,function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(152),i=n(185),o=globalThis;function a(t){if(!t&&!Object(r.a)())return"Node";if(Object(i.a)(t))return"Electron";var e="undefined"!=typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var a=-1!==n.indexOf("MSIE "),s=-1!==n.indexOf("Trident/");return a||s?"IE":o.chrome?"Chrome":o.safari?"Safari":o.mozInnerScreenX?"Firefox":"Unknown"}},function(t,e,n){"use strict";n.d(e,"a",(function(){return A}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(9),u=n.n(s),c=n(5),l=n.n(c),f=n(7),h=n.n(f),d=n(2),p=n.n(d),v=n(12),g=n(57),y=n(49),m=n(67);function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p()(t);if(e){var i=p()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var A=function(t,e){l()(r,t);var n=b(r);function r(t){var e;i()(this,r);var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(v.a)(t),(e=n.call(this,t,o)).initialize(o),e.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(u()(e)),e}return a()(r,[{key:e,get:function(){return"TransformFeedback"}},{key:"initialize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Object(m.a)(this.buffers)||this.bind((function(){return t._unbindBuffers()})),this.setProps(e),this}},{key:"setProps",value:function(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}},{key:"setBuffers",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind((function(){for(var n in e)t.setBuffer(n,e[n])})),this}},{key:"setBuffer",value:function(t,e){var n=this._getVaryingIndex(t),r=this._getBufferParams(e),i=r.buffer,o=r.byteSize,a=r.byteOffset;return n<0?(this.unused[t]=i,v.k.warn("".concat(this.id," unused varying buffer ").concat(t))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,i,a,o),this)}},{key:"begin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}},{key:"end",value:function(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}},{key:"_getBufferParams",value:function(t){var e,n,r;return t instanceof y.a==!1?(r=t.buffer,n=t.byteSize,e=t.byteOffset):r=t,void 0===e&&void 0===n||(e=e||0,n=n||r.byteLength-e),{buffer:r,byteOffset:e,byteSize:n}}},{key:"_getVaryingInfo",value:function(t){return this.configuration&&this.configuration.getVaryingInfo(t)}},{key:"_getVaryingIndex",value:function(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;var e=Number(t);return Number.isFinite(e)?e:-1}},{key:"_bindBuffers",value:function(){if(this.bindOnUse)for(var t in this.buffers){var e=this._getBufferParams(this.buffers[t]),n=e.buffer,r=e.byteSize,i=e.byteOffset;this._bindBuffer(t,n,i,r)}}},{key:"_unbindBuffers",value:function(){if(this.bindOnUse)for(var t in this.buffers)this._bindBuffer(t,null)}},{key:"_bindBuffer",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=e&&e.handle;return i&&void 0!==r?this.gl.bindBufferRange(35982,t,i,n,r):this.gl.bindBufferBase(35982,t,i),this}},{key:"_createHandle",value:function(){return this.gl.createTransformFeedback()}},{key:"_deleteHandle",value:function(){this.gl.deleteTransformFeedback(this.handle)}},{key:"_bindHandle",value:function(t){this.gl.bindTransformFeedback(36386,this.handle)}}],[{key:"isSupported",value:function(t){return Object(v.j)(t)}}]),r}(g.a,Symbol.toStringTag)},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(15),i=n.n(r),o=n(1),a=n.n(o),s=n(3),u=n.n(s);function c(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var f=1,h=1,d=function(){function t(){a()(this,t),this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}return u()(t,[{key:"addChannel",value:function(t){var e=t.delay,n=void 0===e?0:e,r=t.duration,i=void 0===r?Number.POSITIVE_INFINITY:r,o=t.rate,a=void 0===o?1:o,s=t.repeat,u=f++,c={time:0,delay:n,duration:i,rate:a,repeat:void 0===s?1:s};return this._setChannelTime(c,this.time),this.channels.set(u,c),u}},{key:"removeChannel",value:function(t){this.channels.delete(t);var e,n=c(this.animations);try{for(n.s();!(e=n.n()).done;){var r=i()(e.value,2),o=r[0];r[1].channel===t&&this.detachAnimation(o)}}catch(t){n.e(t)}finally{n.f()}}},{key:"isFinished",value:function(t){var e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}},{key:"getTime",value:function(t){if(void 0===t)return this.time;var e=this.channels.get(t);return void 0===e?-1:e.time}},{key:"setTime",value:function(t){this.time=Math.max(0,t);var e,n=c(this.channels.values());try{for(n.s();!(e=n.n()).done;){var r=e.value;this._setChannelTime(r,this.time)}}catch(t){n.e(t)}finally{n.f()}var i,o=c(this.animations.values());try{for(o.s();!(i=o.n()).done;){var a=i.value,s=a.animation,u=a.channel;s.setTime(this.getTime(u))}}catch(t){o.e(t)}finally{o.f()}}},{key:"play",value:function(){this.playing=!0}},{key:"pause",value:function(){this.playing=!1,this.lastEngineTime=-1}},{key:"reset",value:function(){this.setTime(0)}},{key:"attachAnimation",value:function(t,e){var n=h++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}},{key:"detachAnimation",value:function(t){this.animations.delete(t)}},{key:"update",value:function(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}},{key:"_setChannelTime",value:function(t,e){var n=e-t.delay;n>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}]),t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(26),i=("undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document,Boolean("object"!==("undefined"==typeof process?"undefined":n.n(r)()(process))||"[object process]"!==String(process)||process.browser)),o="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);o&&parseFloat(o[1])},function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n(54),i=n.n(r),o=n(55),a=n.n(o),s=n(58),u=n.n(s),c=n(59),l=n.n(c),f=n(43),h=n.n(f),d=n(134),p=n(24),v=n(34),g=n(50),y=n(78);function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h()(t);if(e){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var b=function(t){u()(n,t);var e=m(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return i()(this,n),t=e.call(this,2),Object(p.f)(r)&&1===arguments.length?t.copy(r):(p.b.debug&&(Object(v.a)(r),Object(v.a)(o)),t[0]=r,t[1]=o),t}return a()(n,[{key:"set",value:function(t,e){return this[0]=t,this[1]=e,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this.check()}},{key:"fromObject",value:function(t){return p.b.debug&&(Object(v.a)(t.x),Object(v.a)(t.y)),this[0]=t.x,this[1]=t.y,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t}},{key:"ELEMENTS",get:function(){return 2}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return g.j(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return Object(y.a)(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return g.i(this,this,t),this.check()}},{key:"transformByMatrix2x3",value:function(t){return g.h(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){return g.g(this,this,t),this.check()}}]),n}(d.a)},function(t,e,n){"use strict";var r=n(19),i=n.n(r),o=n(14),a=n.n(o),s=n(207),u=n(345),c=globalThis._parseImageNode,l="undefined"!=typeof Image,f="undefined"!=typeof ImageBitmap,h=Boolean(c),d=!!u.a||h;var p=n(26),v=n.n(p);function g(t){var e=m(t);if(!e)throw new Error("Not an image");return e}function y(t){switch(g(t)){case"data":return t;case"image":case"imagebitmap":var e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function m(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"===v()(t)&&t.data&&t.width&&t.height?"data":null}var b=/^data:image\/svg\+xml/,A=/\.svg((\?|#).*)?$/;function _(t){return t&&(b.test(t)||A.test(t))}function O(t,e){if(_(e)){var n=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(n=unescape(encodeURIComponent(n)))}catch(t){throw new Error(t.message)}return"data:image/svg+xml;base64,".concat(btoa(n))}return w(t,e)}function w(t,e){if(_(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}function x(t,e,n){return C.apply(this,arguments)}function C(){return(C=i()(a.a.mark((function t(e,n,r){var i,o,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=O(e,r),o=self.URL||self.webkitURL,s="string"!=typeof i&&o.createObjectURL(i),t.prev=3,t.next=6,P(s||i,n);case 6:return t.abrupt("return",t.sent);case 7:return t.prev=7,s&&o.revokeObjectURL(s),t.finish(7);case 10:case"end":return t.stop()}}),t,null,[[3,,7,10]])})))).apply(this,arguments)}function P(t,e){return S.apply(this,arguments)}function S(){return(S=i()(a.a.mark((function t(e,n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=new Image).src=e,!(n.image&&n.image.decode&&r.decode)){t.next=6;break}return t.next=5,r.decode();case 5:return t.abrupt("return",r);case 6:return t.next=8,new Promise((function(t,n){try{r.onload=function(){return t(r)},r.onerror=function(t){return n(new Error("Could not load image ".concat(e,": ").concat(t)))}}catch(t){n(t)}}));case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var B={},k=!0;function E(t,e,n){return T.apply(this,arguments)}function T(){return(T=i()(a.a.mark((function t(e,n,r){var i,o,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!_(r)){t.next=7;break}return t.next=3,x(e,n,r);case 3:o=t.sent,i=o,t.next=8;break;case 7:i=w(e,r);case 8:return s=n&&n.imagebitmap,t.next=11,j(i,s);case 11:return t.abrupt("return",t.sent);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function j(t){return M.apply(this,arguments)}function M(){return(M=i()(a.a.mark((function t(e){var n,r=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!I(n=r.length>1&&void 0!==r[1]?r[1]:null)&&k||(n=null),!n){t.next=13;break}return t.prev=3,t.next=6,createImageBitmap(e,n);case 6:return t.abrupt("return",t.sent);case 9:t.prev=9,t.t0=t.catch(3),console.warn(t.t0),k=!1;case 13:return t.next=15,createImageBitmap(e);case 15:return t.abrupt("return",t.sent);case 16:case"end":return t.stop()}}),t,null,[[3,9]])})))).apply(this,arguments)}function I(t){for(var e in t||B)return!1;return!0}var R=n(192);function D(t,e){return L.apply(this,arguments)}function L(){return(L=i()(a.a.mark((function t(e,n){var r,i,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(R.a)(e)||{},i=r.mimeType,o=globalThis._parseImageNode,Object(s.a)(o),t.next=5,o(e,i);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function F(){return(F=i()(a.a.mark((function t(e,n,r){var i,o,u,c,l;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=(n=n||{}).image||{},o=i.type||"auto",u=(r||{}).url,c=G(o),t.t0=c,t.next="imagebitmap"===t.t0?8:"image"===t.t0?12:"data"===t.t0?16:20;break;case 8:return t.next=10,E(e,n,u);case 10:return l=t.sent,t.abrupt("break",21);case 12:return t.next=14,x(e,n,u);case 14:return l=t.sent,t.abrupt("break",21);case 16:return t.next=18,D(e,n);case 18:return l=t.sent,t.abrupt("break",21);case 20:Object(s.a)(!1);case 21:return"data"===o&&(l=y(l)),t.abrupt("return",l);case 23:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function G(t){switch(t){case"auto":case"data":return function(){if(f)return"imagebitmap";if(l)return"image";if(d)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return f||l||d;case"imagebitmap":return f;case"image":return l;case"data":return d;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}(t),t}}n.d(e,"a",(function(){return N}));var N={id:"image",module:"images",name:"Images",version:"3.2.10",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function(t,e,n){return F.apply(this,arguments)},tests:[function(t){return Boolean(Object(R.a)(new DataView(t)))}],options:{image:{type:"auto",decode:!0}}}},function(t,e,n){"use strict";var r,i=n(1),o=n.n(i),a=n(3),s=n.n(a),u=n(9),c=n.n(u),l=n(10),f=n.n(l),h=n(5),d=n.n(h),p=n(7),v=n.n(p),g=n(2),y=n.n(g),m=n(57),b=n(77),A=n(95),_=n(0),O=n.n(_),w=n(12),x=n(125),C=n(17),P=(r={},O()(r,5126,U.bind(null,"uniform1fv",j,1,z)),O()(r,35664,U.bind(null,"uniform2fv",j,2,z)),O()(r,35665,U.bind(null,"uniform3fv",j,3,z)),O()(r,35666,U.bind(null,"uniform4fv",j,4,z)),O()(r,5124,U.bind(null,"uniform1iv",M,1,z)),O()(r,35667,U.bind(null,"uniform2iv",M,2,z)),O()(r,35668,U.bind(null,"uniform3iv",M,3,z)),O()(r,35669,U.bind(null,"uniform4iv",M,4,z)),O()(r,35670,U.bind(null,"uniform1iv",M,1,z)),O()(r,35671,U.bind(null,"uniform2iv",M,2,z)),O()(r,35672,U.bind(null,"uniform3iv",M,3,z)),O()(r,35673,U.bind(null,"uniform4iv",M,4,z)),O()(r,35674,U.bind(null,"uniformMatrix2fv",j,4,H)),O()(r,35675,U.bind(null,"uniformMatrix3fv",j,9,H)),O()(r,35676,U.bind(null,"uniformMatrix4fv",j,16,H)),O()(r,35678,N),O()(r,35680,N),O()(r,5125,U.bind(null,"uniform1uiv",I,1,z)),O()(r,36294,U.bind(null,"uniform2uiv",I,2,z)),O()(r,36295,U.bind(null,"uniform3uiv",I,3,z)),O()(r,36296,U.bind(null,"uniform4uiv",I,4,z)),O()(r,35685,U.bind(null,"uniformMatrix2x3fv",j,6,H)),O()(r,35686,U.bind(null,"uniformMatrix2x4fv",j,8,H)),O()(r,35687,U.bind(null,"uniformMatrix3x2fv",j,6,H)),O()(r,35688,U.bind(null,"uniformMatrix3x4fv",j,12,H)),O()(r,35689,U.bind(null,"uniformMatrix4x2fv",j,8,H)),O()(r,35690,U.bind(null,"uniformMatrix4x3fv",j,12,H)),O()(r,35678,N),O()(r,35680,N),O()(r,35679,N),O()(r,35682,N),O()(r,36289,N),O()(r,36292,N),O()(r,36293,N),O()(r,36298,N),O()(r,36299,N),O()(r,36300,N),O()(r,36303,N),O()(r,36306,N),O()(r,36307,N),O()(r,36308,N),O()(r,36311,N),r),S={},B={},k={},E=[0];function T(t,e,n,r){1===e&&"boolean"==typeof t&&(t=t?1:0),Number.isFinite(t)&&(E[0]=t,t=E);var i=t.length;if(i%e&&w.k.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;var o=r[i];o||(o=new n(i),r[i]=o);for(var a=0;a<i;a++)o[a]=t[a];return o}function j(t,e){return T(t,e,Float32Array,S)}function M(t,e){return T(t,e,Int32Array,B)}function I(t,e){return T(t,e,Uint32Array,k)}function R(t,e,n){var r=P[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function D(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};var e=t.match(/([^[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function L(t,e,n){for(var r in t){var i=t[r];if((!n||Boolean(n[r]))&&!F(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function F(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;for(var e=Math.min(t.length,16),n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||(!0===t||!1===t||(t instanceof b.a||(t instanceof x.a||t instanceof A.a&&Boolean(t.texture))))}function G(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e])for(var r=t[e],i=0,o=n.length;i<o;++i)r[i]=n[i];else t[e]=n.slice();else t[e]=n}function N(){var t=null;return function(e,n,r){var i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function U(t,e,n,r){var i=null,o=null;return function(a,s,u){var c=e(u,n),l=c.length,f=!1;if(null===i)i=new Float32Array(l),o=l,f=!0;else{Object(C.a)(o===l,"Uniform length cannot change.");for(var h=0;h<l;++h)if(c[h]!==i[h]){f=!0;break}}return f&&(r(a,t,s,c),i.set(c)),f}}function z(t,e,n,r){t[e](n,r)}function H(t,e,n,r){t[e](n,!1,r)}function V(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed",n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}function J(t,e,n,r){for(var i=t.split(/\r?\n/),o={},a={},s=r||V(e)||"(unnamed)",u="".concat(function(t){switch(t){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)," shader ").concat(s),c=0;c<i.length;c++){var l=i[c];if(!(l.length<=1)){var f=l.split(":"),h=f[0],d=parseInt(f[2],10);if(isNaN(d))throw new Error("GLSL compilation error in ".concat(u,": ").concat(t));"WARNING"!==h?o[d]=l:a[d]=l}}var p=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ",r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((function(t,r){var o=String(r+e),a=o.length;return K(o,i-a)+n+t}))}(e);return{shaderName:u,errors:W(o,p),warnings:W(a,p)}}function W(t,e){for(var n="",r=0;r<e.length;r++){var i=e[r];if((t[r+3]||t[r+2]||t[r+1])&&(n+="".concat(i,"\n"),t[r+1])){var o=t[r+1],a=o.split(":",3),s=a[0],u=parseInt(a[1],10)||0,c=o.substring(a.join(":").length+1).trim();n+=K("^^^ ".concat(s,": ").concat(c,"\n\n"),u)}}return n}function K(t,e){for(var n="",r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}var X=n(67);function q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}var Q=function(t,e){d()(r,t);var n=q(r);function r(t,e){var i;o()(this,r),Object(w.b)(t),Object(C.a)("string"==typeof e.source,"Shader: GLSL source code must be a JavaScript string");var a=V(e.source,null)||e.id||Object(X.c)("unnamed ".concat(r.getTypeName(e.shaderType)));return(i=n.call(this,t,{id:a})).shaderType=e.shaderType,i.source=e.source,i.initialize(e),i}return s()(r,[{key:e,get:function(){return"Shader"}},{key:"initialize",value:function(t){var e=t.source,n=V(e,null);n&&(this.id=Object(X.c)(n)),this._compile(e)}},{key:"getParameter",value:function(t){return this.gl.getShaderParameter(this.handle,t)}},{key:"toString",value:function(){return"".concat(r.getTypeName(this.shaderType),":").concat(this.id)}},{key:"getName",value:function(){return V(this.source)||"unnamed-shader"}},{key:"getSource",value:function(){return this.gl.getShaderSource(this.handle)}},{key:"getTranslatedSource",value:function(){var t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}},{key:"_compile",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;t.startsWith("#version ")||(t="#version 100\n".concat(t)),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle);var e=this.getParameter(35713);if(!e){var n=this.gl.getShaderInfoLog(this.handle),r=J(n,this.source,this.shaderType,this.id),i=r.shaderName,o=r.errors,a=r.warnings;throw w.k.error("GLSL compilation errors in ".concat(i,"\n").concat(o))(),w.k.warn("GLSL compilation warnings in ".concat(i,"\n").concat(a))(),new Error("GLSL compilation errors in ".concat(i))}}},{key:"_deleteHandle",value:function(){this.gl.deleteShader(this.handle)}},{key:"_getOptsFromHandle",value:function(){return{type:this.getParameter(35663),source:this.getSource()}}}],[{key:"getTypeName",value:function(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Object(C.a)(!1),"unknown"}}}]),r}(m.a,Symbol.toStringTag),Z=function(t,e){d()(r,t);var n=q(r);function r(t,e){return o()(this,r),"string"==typeof e&&(e={source:e}),n.call(this,t,Object.assign({},e,{shaderType:35633}))}return s()(r,[{key:e,get:function(){return"VertexShader"}},{key:"_createHandle",value:function(){return this.gl.createShader(35633)}}]),r}(Q,Symbol.toStringTag),Y=function(t,e){d()(r,t);var n=q(r);function r(t,e){return o()(this,r),"string"==typeof e&&(e={source:e}),n.call(this,t,Object.assign({},e,{shaderType:35632}))}return s()(r,[{key:e,get:function(){return"FragmentShader"}},{key:"_createHandle",value:function(){return this.gl.createShader(35632)}}]),r}(Q,Symbol.toStringTag),$=n(85),tt=n(103),et=function(){function t(e){o()(this,t),this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}return s()(t,[{key:"getAttributeInfo",value:function(t){var e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}},{key:"getAttributeLocation",value:function(t){var e=this.getAttributeInfo(t);return e?e.location:-1}},{key:"getAttributeAccessor",value:function(t){var e=this.getAttributeInfo(t);return e?e.accessor:null}},{key:"getVaryingInfo",value:function(t){var e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}},{key:"getVaryingIndex",value:function(t){var e=this.getVaryingInfo();return e?e.location:-1}},{key:"getVaryingAccessor",value:function(t){var e=this.getVaryingInfo();return e?e.accessor:null}},{key:"_readAttributesFromProgram",value:function(t){for(var e=t.gl,n=e.getProgramParameter(t.handle,35721),r=0;r<n;r++){var i=e.getActiveAttrib(t.handle,r),o=i.name,a=i.type,s=i.size,u=e.getAttribLocation(t.handle,o);u>=0&&this._addAttribute(u,o,a,s)}this.attributeInfos.sort((function(t,e){return t.location-e.location}))}},{key:"_readVaryingsFromProgram",value:function(t){var e=t.gl;if(Object(w.j)(e)){for(var n=e.getProgramParameter(t.handle,35971),r=0;r<n;r++){var i=e.getTransformFeedbackVarying(t.handle,r),o=i.name,a=i.type,s=i.size;this._addVarying(r,o,a,s)}this.varyingInfos.sort((function(t,e){return t.location-e.location}))}}},{key:"_addAttribute",value:function(t,e,n,r){var i=Object(tt.a)(n),o={type:i.type,size:r*i.components};this._inferProperties(t,e,o);var a={location:t,name:e,accessor:new $.a(o)};this.attributeInfos.push(a),this.attributeInfosByLocation[t]=a,this.attributeInfosByName[a.name]=a}},{key:"_inferProperties",value:function(t,e,n){/instance/i.test(e)&&(n.divisor=1)}},{key:"_addVarying",value:function(t,e,n,r){var i=Object(tt.a)(n),o=i.type,a=i.components,s={location:t,name:e,accessor:new $.a({type:o,size:r*a})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}]),t}(),nt=n(69);function rt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return it(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y()(t);if(e){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v()(this,n)}}n.d(e,"a",(function(){return st}));var at=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"],st=function(t,e){d()(r,t);var n=ot(r);function r(t){var e;o()(this,r);var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(e=n.call(this,t,i)).stubRemovedMethods("Program","v6.0",at),e._isCached=!1,e.initialize(i),Object.seal(c()(e)),e._setId(i.id),e}return s()(r,[{key:e,get:function(){return"Program"}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.hash,n=t.vs,r=t.fs,i=t.varyings,o=t.bufferMode,a=void 0===o?35981:o;return this.hash=e||"",this.vs="string"==typeof n?new Z(this.gl,{id:"".concat(t.id,"-vs"),source:n}):n,this.fs="string"==typeof r?new Y(this.gl,{id:"".concat(t.id,"-fs"),source:r}):r,Object(C.a)(this.vs instanceof Z),Object(C.a)(this.fs instanceof Y),this.uniforms={},this._textureUniforms={},i&&i.length>0&&(Object(w.a)(this.gl),this.varyings=i,this.gl2.transformFeedbackVaryings(this.handle,i,a)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new et(this),this.setProps(t)}},{key:"delete",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isCached?this:f()(y()(r.prototype),"delete",this).call(this,t)}},{key:"setProps",value:function(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}},{key:"draw",value:function(t){var e=this,n=t.logPriority,r=t.drawMode,i=void 0===r?4:r,o=t.vertexCount,a=t.offset,s=void 0===a?0:a,u=t.start,c=t.end,l=t.isIndexed,f=void 0!==l&&l,h=t.indexType,d=void 0===h?5123:h,p=t.instanceCount,v=void 0===p?0:p,g=t.isInstanced,y=void 0===g?v>0:g,m=t.vertexArray,b=void 0===m?null:m,A=t.transformFeedback,_=t.framebuffer,O=t.parameters,x=void 0===O?{}:O,P=t.uniforms,S=t.samplers;if((P||S)&&(w.k.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(P||{})),w.k.priority>=n){var B=_?_.id:"default",k="mode=".concat(Object(nt.a)(this.gl,i)," verts=").concat(o," ")+"instances=".concat(v," indexType=").concat(Object(nt.a)(this.gl,d)," ")+"isInstanced=".concat(y," isIndexed=").concat(f," ")+"Framebuffer=".concat(B);w.k.log(n,k)()}return Object(C.a)(b),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===o||y&&0===v)&&(b.bindForDraw(o,v,(function(){if(void 0!==_&&(x=Object.assign({},x,{framebuffer:_})),A){var t=Object(tt.c)(i);A.begin(t)}e._bindTextures(),Object(w.o)(e.gl,x,(function(){f&&y?e.gl2.drawElementsInstanced(i,o,d,s,v):f&&Object(w.j)(e.gl)&&!isNaN(u)&&!isNaN(c)?e.gl2.drawRangeElements(i,u,c,o,d,s):f?e.gl.drawElements(i,o,d,s):y?e.gl2.drawArraysInstanced(i,s,o,v):e.gl.drawArrays(i,s,o)})),A&&A.end()})),!0)}},{key:"setUniforms",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var e in w.k.priority>=2&&L(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle),t){var n=t[e],r=this._uniformSetters[e];if(r){var i=n,o=!1;if(i instanceof A.a&&(i=i.texture),i instanceof b.a)if(o=this.uniforms[e]!==n){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);var a=i,s=r.textureIndex;a.bind(s),i=s,this._textureUniforms[e]=a}else i=r.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(r(i)||o)&&G(this.uniforms,e,n)}}return this}},{key:"_areTexturesRenderable",value:function(){var t=!0;for(var e in this._textureUniforms){var n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}},{key:"_bindTextures",value:function(){for(var t in this._textureUniforms){var e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}},{key:"_createHandle",value:function(){return this.gl.createProgram()}},{key:"_deleteHandle",value:function(){this.gl.deleteProgram(this.handle)}},{key:"_getOptionsFromHandle",value:function(t){var e,n={},r=rt(this.gl.getAttachedShaders(t));try{for(r.s();!(e=r.n()).done;){var i=e.value;switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new Z({handle:i});break;case 35632:n.fs=new Y({handle:i})}}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"_getParameter",value:function(t){return this.gl.getProgramParameter(this.handle,t)}},{key:"_setId",value:function(t){if(!t){var e=this._getName();this.id=Object(X.c)(e)}}},{key:"_getName",value:function(){var t=this.vs.getName()||this.fs.getName();return t=(t=t.replace(/shader/i,""))?"".concat(t,"-program"):"program"}},{key:"_compileAndLink",value:function(){var t=this.gl;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),w.k.time(4,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),w.k.timeEnd(4,"linkProgram for ".concat(this._getName()))(),t.debug||w.k.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)));if(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(t.getProgramInfoLog(this.handle)))}}},{key:"_readUniformLocationsFromLinkedProgram",value:function(){var t=this.gl;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(var e=0;e<this._uniformCount;e++){var n=this.gl.getActiveUniform(this.handle,e),r=D(n.name).name,i=t.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=R(t,i,n),n.size>1)for(var o=0;o<n.size;o++)i=t.getUniformLocation(this.handle,"".concat(r,"[").concat(o,"]")),this._uniformSetters["".concat(r,"[").concat(o,"]")]=R(t,i,n)}this._textureIndexCounter=0}},{key:"getActiveUniforms",value:function(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}},{key:"getUniformBlockIndex",value:function(t){return this.gl2.getUniformBlockIndex(this.handle,t)}},{key:"getActiveUniformBlockParameter",value:function(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}},{key:"uniformBlockBinding",value:function(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}]),r}(m.a,Symbol.toStringTag)},function(t,e,n){"use strict";var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(15),u=n.n(s),c=n(196),l="void main() {gl_FragColor = vec4(0);}",f="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",h="#version 300 es\n".concat(f);function d(t,e){e=Array.isArray(e)?e:[e];var n=t.replace(/^\s+/,"").split(/\s+/),r=u()(n,3),i=r[0],o=r[1],a=r[2];return e.includes(i)&&o&&a?{qualifier:i,type:o,name:a.split(";")[0]}:null}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.version,n=void 0===e?100:e,r=t.input,i=t.inputType,o=t.output;if(!r)return 300===n?h:n>300?"#version ".concat(n,"\n").concat(f):l;var a=g(r,i);return n>=300?"#version ".concat(n," ").concat(300===n?"es":"","\nin ").concat(i," ").concat(r,";\nout vec4 ").concat(o,";\nvoid main() {\n  ").concat(o," = ").concat(a,";\n}"):"varying ".concat(i," ").concat(r,";\nvoid main() {\n  gl_FragColor = ").concat(a,";\n}")}function v(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Object(c.a)(!1),null}}function g(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Object(c.a)(!1),null}}var y=n(12),m=n(49),b=n(343),A=n(17);function _(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var w=function(){function t(e){i()(this,t);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}return a()(t,[{key:"setupResources",value:function(t){var e,n=_(this.bindings);try{for(n.s();!(e=n.n()).done;){var r=e.value;this._setupTransformFeedback(r,t)}}catch(t){n.e(t)}finally{n.f()}}},{key:"updateModelProps",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.varyings;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}},{key:"getDrawOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.bindings[this.currentIndex],n=e.sourceBuffers,r=e.transformFeedback,i=Object.assign({},n,t.attributes);return{attributes:i,transformFeedback:r}}},{key:"swap",value:function(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t)}},{key:"getBuffer",value:function(t){var e=this.bindings[this.currentIndex].feedbackBuffers,n=t?e[t]:null;return n?n instanceof m.a?n:n.buffer:null}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.varyingName,n=this.getBuffer(e);return n?n.getData():null}},{key:"delete",value:function(){for(var t in this.resources)this.resources[t].delete()}},{key:"_initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Object(A.a)(Object(y.j)(this.gl))}},{key:"_getFeedbackBuffers",value:function(t){var e=t.sourceBuffers,n=void 0===e?{}:e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(var i in this.feedbackMap){var o=this.feedbackMap[i];i in n&&(r[o]=i)}for(var a in Object.assign(r,t.feedbackBuffers),r){var s=r[a];if("string"==typeof s){var u=n[s],c=u.byteLength,l=u.usage,f=u.accessor;r[a]=this._createNewBuffer(a,{byteLength:c,usage:l,accessor:f})}}return r}},{key:"_setupBuffers",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.sourceBuffers,n=void 0===e?null:e;Object.assign(this.feedbackMap,t.feedbackMap);var r=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}},{key:"_setupTransformFeedback",value:function(t,e){var n=e.model.program;t.transformFeedback=new b.a(this.gl,{program:n,buffers:t.feedbackBuffers})}},{key:"_updateBindings",value:function(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){var e=this._swapBuffers(this.bindings[this.currentIndex]),n=e.sourceBuffers,r=e.feedbackBuffers,i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}},{key:"_updateBinding",value:function(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}},{key:"_swapBuffers",value:function(t){if(!this.feedbackMap)return null;var e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(var r in this.feedbackMap){var i=this.feedbackMap[r];e[r]=t.feedbackBuffers[i],n[i]=t.sourceBuffers[r],Object(A.a)(n[i]instanceof m.a)}return{sourceBuffers:e,feedbackBuffers:n}}},{key:"_createNewBuffer",value:function(t,e){var n=new m.a(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}},{key:"_getNextIndex",value:function(){return(this.currentIndex+1)%2}}]),t}(),x=n(0),C=n.n(x),P=n(212),S=n(123),B=n(95),k=n(250);function E(t){var e=100,n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){var r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}var T,j=n(200),M={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null};function I(t){var e=t.vs,n=t.sourceTextureMap,r=t.targetTextureVarying,i=t.targetTexture,o=Object.keys(n).length,a=null,s={},u=e,l={};if(o>0||r){var f=u.split("\n"),h=f.slice();if(f.forEach((function(t,e,i){if(o>0){var u=function(t,e){var n={},r=function(t){return d(t,["attribute","in"])}(t);if(!r)return null;var i=r.type,o=r.name;if(o&&e[o]){var a="// ".concat(t," => Replaced by Transform with a sampler"),s=function(t){var e="".concat("transform_uSampler_").concat(t),n="".concat("transform_uSize_").concat(t),r="  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}(o),u=s.samplerName,l=s.sizeName,f=s.uniformDeclerations,h=function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Object(c.a)(!1),null}}(i),p="  ".concat(i," ").concat(o," = transform_getInput(").concat(u,", ").concat(l,").").concat(h,";\n");return n[u]=o,{updatedLine:a,inject:{"vs:#decl":f,"vs:#main-start":p},samplerTextureMap:n}}return null}(t,n);if(u){var f=u.updatedLine,p=u.inject;h[e]=f,l=Object(j.b)([l,p]),Object.assign(s,u.samplerTextureMap),o--}}r&&!a&&(a=function(t,e){var n=d(t,["varying","out"]);if(!n)return null;return n.name===e?n.type:null}(t,r))})),r){Object(A.a)(i);var p="".concat("transform_uSize_").concat(r),v={"vs:#decl":"uniform vec2 ".concat(p,";\n"),"vs:#main-start":"     vec2 ".concat("transform_position"," = transform_getPos(").concat(p,");\n     gl_Position = vec4(").concat("transform_position",", 0, 1.);\n")};l=Object(j.b)([l,v])}u=h.join("\n")}return{vs:u,targetTextureType:a,inject:l,samplerTextureMap:s}}function R(t){var e,n,r=t.sourceTextureMap,i=t.targetTextureVarying,o=t.targetTexture,a={};for(var s in i&&(e=o.width,n=o.height,a["".concat("transform_uSize_").concat(i)]=[e,n]),r){var u=r[s];e=u.width,n=u.height,a["".concat("transform_uSize_").concat(s)]=[e,n]}return a}var D=(T={},C()(T,10241,9728),C()(T,10240,9728),C()(T,10242,33071),C()(T,10243,33071),T),L=function(){function t(e){i()(this,t);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}return a()(t,[{key:"updateModelProps",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._processVertexShader(t);return Object.assign({},t,e)}},{key:"getDrawOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.bindings[this.currentIndex],n=e.sourceBuffers,r=e.sourceTextures,i=e.framebuffer,o=e.targetTexture,a=Object.assign({},n,t.attributes),s=Object.assign({},t.uniforms),u=Object.assign({},t.parameters),c=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){for(var l in a.transform_elementID=this.elementIDBuffer,this.samplerTextureMap){var f=this.samplerTextureMap[l];s[l]=r[f]}this._setSourceTextureParameters();var h=R({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:o});Object.assign(s,h)}return this.hasTargetTexture&&(c=!1,u.viewport=[0,0,i.width,i.height]),{attributes:a,framebuffer:i,uniforms:s,discard:c,parameters:u}}},{key:"swap",value:function(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupTextures(t)}},{key:"getTargetTexture",value:function(){return this.bindings[this.currentIndex].targetTexture}},{key:"getData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.packed,n=void 0!==e&&e,r=this.bindings[this.currentIndex].framebuffer,i=Object(P.c)(r);if(!n)return i;for(var o=i.constructor,a=v(this.targetTextureType),s=new o(i.length*a/4),u=0,c=0;c<i.length;c+=4)for(var l=0;l<a;l++)s[u++]=i[c+l];return s}},{key:"getFramebuffer",value:function(){return this.bindings[this.currentIndex].framebuffer}},{key:"delete",value:function(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}},{key:"_initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t._targetTextureVarying,n=t._swapTexture;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}},{key:"_createTargetTexture",value:function(t){var e=t.sourceTextures,n=t.textureOrReference;if(n instanceof S.a)return n;var r=e[n];return r?(this._targetRefTexName=n,this._createNewTexture(r)):null}},{key:"_setupTextures",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.sourceBuffers,n=t._sourceTextures,r=void 0===n?{}:n,i=t._targetTexture,o=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:r,targetTexture:o}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}},{key:"_updateElementIDBuffer",value:function(t){if(!("number"!=typeof t||this.elementCount>=t)){var e=new Float32Array(t);e.forEach((function(t,e,n){n[e]=e})),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new m.a(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}}},{key:"_updateBindings",value:function(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){var e=this._swapTextures(this.bindings[this.currentIndex]),n=e.sourceTextures,r=e.targetTexture,i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}},{key:"_updateBinding",value:function(t,e){var n=e.sourceBuffers,r=e.sourceTextures,i=e.targetTexture;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,r),Object.assign(t.sourceBuffers,n),i){t.targetTexture=i;var o=i.width,a=i.height,s=t.framebuffer;s?(s.update({attachments:C()({},36064,i),resizeAttachments:!1}),s.resize({width:o,height:a})):t.framebuffer=new B.a(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:C()({},36064,i)})}return t}},{key:"_setSourceTextureParameters",value:function(){var t=this.currentIndex,e=this.bindings[t].sourceTextures;for(var n in e)e[n].setParameters(D)}},{key:"_swapTextures",value:function(t){if(!this._swapTexture)return null;var e=Object.assign({},t.sourceTextures);return e[this._swapTexture]=t.targetTexture,{sourceTextures:e,targetTexture:t.sourceTextures[this._swapTexture]}}},{key:"_createNewTexture",value:function(t){var e,n=Object(k.a)(t,{parameters:(e={},C()(e,10241,9728),C()(e,10240,9728),C()(e,10242,33071),C()(e,10243,33071),e),pixelStore:C()({},37440,!1)});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}},{key:"_getNextIndex",value:function(){return(this.currentIndex+1)%2}},{key:"_processVertexShader",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.bindings[this.currentIndex],n=e.sourceTextures,r=e.targetTexture,i=I({vs:t.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),o=i.vs,a=i.uniforms,s=i.targetTextureType,u=i.inject,c=i.samplerTextureMap,l=Object(j.b)([t.inject||{},u]);this.targetTextureType=s,this.samplerTextureMap=c;var f=t._fs||p({version:E(o),input:this.targetTextureVarying,inputType:s,output:"transform_output"}),h=this.hasSourceTextures||this.targetTextureVarying?[M].concat(t.modules||[]):t.modules;return{vs:o,fs:f,modules:h,uniforms:a,inject:l}}}]),t}(),F=n(67),G=n(194);function N(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return U(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,"a",(function(){return z}));var z=function(){function t(e){i()(this,t);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}return a()(t,[{key:"delete",value:function(){var t=this.model,e=this.bufferTransform,n=this.textureTransform;t&&t.delete(),e&&e.delete(),n&&n.delete()}},{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.clearRenderTarget,n=void 0===e||e,r=this._updateDrawOptions(t);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}},{key:"swap",value:function(){var t,e=!1,n=N([this.bufferTransform,this.textureTransform].filter(Boolean));try{for(n.s();!(t=n.n()).done;){var r=t.value;e=e||r.swap()}}catch(t){n.e(t)}finally{n.f()}Object(A.a)(e,"Nothing to swap")}},{key:"getBuffer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(t)}},{key:"getData",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=[this.bufferTransform,this.textureTransform].filter(Boolean),r=N(n);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=i.getData(e);if(o)return o}}catch(t){r.e(t)}finally{r.f()}return null}},{key:"getFramebuffer",value:function(){return this.textureTransform&&this.textureTransform.getFramebuffer()}},{key:"update",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in t&&this.model.setVertexCount(t.elementCount);var e,n=[this.bufferTransform,this.textureTransform].filter(Boolean),r=N(n);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.update(t)}}catch(t){r.e(t)}finally{r.f()}}},{key:"_initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.gl;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new G.a(e,Object.assign({},t,{fs:t.fs||p({version:E(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}},{key:"_updateModelProps",value:function(t){var e,n=Object.assign({},t),r=N([this.bufferTransform,this.textureTransform].filter(Boolean));try{for(r.s();!(e=r.n()).done;){n=e.value.updateModelProps(n)}}catch(t){r.e(t)}finally{r.f()}return n}},{key:"_buildResourceTransforms",value:function(t,e){(function(t){if(!Object(F.a)(t.feedbackBuffers)||!Object(F.a)(t.feedbackMap)||t.varyings&&t.varyings.length>0)return!0;return!1})(e)&&(this.bufferTransform=new w(t,e)),function(t){if(!Object(F.a)(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)return!0;return!1}(e)&&(this.textureTransform=new L(t,e)),Object(A.a)(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}},{key:"_updateDrawOptions",value:function(t){var e,n=Object.assign({},t),r=N([this.bufferTransform,this.textureTransform].filter(Boolean));try{for(r.s();!(e=r.n()).done;){var i=e.value;n=Object.assign(n,i.getDrawOptions(n))}}catch(t){r.e(t)}finally{r.f()}return n}}],[{key:"isSupported",value:function(t){return Object(y.j)(t)}}]),t}()},function(t,e,n){"use strict";function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}function i(t){return t-Math.fround(t)}function o(t){for(var e=new Float32Array(32),n=0;n<4;++n)for(var i=0;i<4;++i){var o=4*n+i;r(t[4*i+n],e,2*o)}return e}n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return u}));var a={ONE:1};var s={name:"fp64-arithmetic",vs:"uniform float ONE;\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",fs:null,getUniforms:function(){return a},fp64ify:r,fp64LowPart:i,fp64ifyMatrix4:o},u={name:"fp64",vs:"const vec2 E_FP64 = vec2(2.7182817459106445e+00, 8.254840366817007e-08);\nconst vec2 LOG2_FP64 = vec2(0.6931471824645996e+00, -1.9046542121259336e-09);\nconst vec2 PI_FP64 = vec2(3.1415927410125732, -8.742278012618954e-8);\nconst vec2 TWO_PI_FP64 = vec2(6.2831854820251465, -1.7484556025237907e-7);\nconst vec2 PI_2_FP64 = vec2(1.5707963705062866, -4.371139006309477e-8);\nconst vec2 PI_4_FP64 = vec2(0.7853981852531433, -2.1855695031547384e-8);\nconst vec2 PI_16_FP64 = vec2(0.19634954631328583, -5.463923757886846e-9);\nconst vec2 PI_16_2_FP64 = vec2(0.39269909262657166, -1.0927847515773692e-8);\nconst vec2 PI_16_3_FP64 = vec2(0.5890486240386963, -1.4906100798128818e-9);\nconst vec2 PI_180_FP64 = vec2(0.01745329238474369, 1.3519960498364902e-10);\n\nconst vec2 SIN_TABLE_0_FP64 = vec2(0.19509032368659973, -1.6704714833615242e-9);\nconst vec2 SIN_TABLE_1_FP64 = vec2(0.3826834261417389, 6.22335089017767e-9);\nconst vec2 SIN_TABLE_2_FP64 = vec2(0.5555702447891235, -1.1769521357507529e-8);\nconst vec2 SIN_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617041793133e-8);\n\nconst vec2 COS_TABLE_0_FP64 = vec2(0.9807852506637573, 2.9739473106360492e-8);\nconst vec2 COS_TABLE_1_FP64 = vec2(0.9238795042037964, 2.8307490351764386e-8);\nconst vec2 COS_TABLE_2_FP64 = vec2(0.8314695954322815, 1.6870263741530778e-8);\nconst vec2 COS_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617152815436e-8);\n\nconst vec2 INVERSE_FACTORIAL_3_FP64 = vec2(1.666666716337204e-01, -4.967053879312289e-09);\nconst vec2 INVERSE_FACTORIAL_4_FP64 = vec2(4.16666679084301e-02, -1.2417634698280722e-09);\nconst vec2 INVERSE_FACTORIAL_5_FP64 = vec2(8.333333767950535e-03, -4.34617203337595e-10);\nconst vec2 INVERSE_FACTORIAL_6_FP64 = vec2(1.3888889225199819e-03, -3.3631094437103215e-11);\nconst vec2 INVERSE_FACTORIAL_7_FP64 = vec2(1.9841270113829523e-04,  -2.725596874933456e-12);\nconst vec2 INVERSE_FACTORIAL_8_FP64 = vec2(2.4801587642286904e-05, -3.406996025904184e-13);\nconst vec2 INVERSE_FACTORIAL_9_FP64 = vec2(2.75573188446287533e-06, 3.7935713937038186e-14);\nconst vec2 INVERSE_FACTORIAL_10_FP64 = vec2(2.755731998149713e-07, -7.575112367869873e-15);\n\nfloat nint(float d) {\n    if (d == floor(d)) return d;\n    return floor(d + 0.5);\n}\n\nvec2 nint_fp64(vec2 a) {\n    float hi = nint(a.x);\n    float lo;\n    vec2 tmp;\n    if (hi == a.x) {\n        lo = nint(a.y);\n        tmp = quickTwoSum(hi, lo);\n    } else {\n        lo = 0.0;\n        if (abs(hi - a.x) == 0.5 && a.y < 0.0) {\n            hi -= 1.0;\n        }\n        tmp = vec2(hi, lo);\n    }\n    return tmp;\n}\n\nvec2 exp_fp64(vec2 a) {\n\n  const int k_power = 4;\n  const float k = 16.0;\n\n  const float inv_k = 1.0 / k;\n\n  if (a.x <= -88.0) return vec2(0.0, 0.0);\n  if (a.x >= 88.0) return vec2(1.0 / 0.0, 1.0 / 0.0);\n  if (a.x == 0.0 && a.y == 0.0) return vec2(1.0, 0.0);\n  if (a.x == 1.0 && a.y == 0.0) return E_FP64;\n\n  float m = floor(a.x / LOG2_FP64.x + 0.5);\n  vec2 r = sub_fp64(a, mul_fp64(LOG2_FP64, vec2(m, 0.0))) * inv_k;\n  vec2 s, t, p;\n\n  p = mul_fp64(r, r);\n  s = sum_fp64(r, p * 0.5);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_3_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_4_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_5_FP64);\n\n\n\n\n\n\n  s = sum_fp64(s, t);\n  for (int i = 0; i < k_power; i++) {\n    s = sum_fp64(s * 2.0, mul_fp64(s, s));\n  }\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = sum_fp64(s, vec2(ONE, 0.0));\n#else\n  s = sum_fp64(s, vec2(1.0, 0.0));\n#endif\n\n  return s * pow(2.0, m);\n}\n\nvec2 log_fp64(vec2 a)\n{\n  if (a.x == 1.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x <= 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n  vec2 x = vec2(log(a.x), 0.0);\n  vec2 s;\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = vec2(ONE, 0.0);\n#else\n  s = vec2(1.0, 0.0);\n#endif\n\n  x = sub_fp64(sum_fp64(x, mul_fp64(a, exp_fp64(-x))), s);\n  return x;\n}\n\nvec2 sin_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(0.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  s = a;\n  r = a;\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_3_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_5_FP64);\n  s = sum_fp64(s, t);\n\n\n\n\n\n\n  return s;\n}\n\nvec2 cos_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(1.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  r = x;\n  s = sum_fp64(vec2(1.0, 0.0), r * 0.5);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_4_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_6_FP64);\n  s = sum_fp64(s, t);\n\n\n\n\n\n\n  return s;\n}\n\nvoid sincos_taylor_fp64(vec2 a, out vec2 sin_t, out vec2 cos_t) {\n  if (a.x == 0.0 && a.y == 0.0) {\n    sin_t = vec2(0.0, 0.0);\n    cos_t = vec2(1.0, 0.0);\n  }\n\n  sin_t = sin_taylor_fp64(a);\n  cos_t = sqrt_fp64(sub_fp64(vec2(1.0, 0.0), mul_fp64(sin_t, sin_t)));\n}\n\nvec2 sin_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return sin_taylor_fp64(t);\n        } else if (j == 1) {\n            return cos_taylor_fp64(t);\n        } else if (j == -1) {\n            return -cos_taylor_fp64(t);\n        } else {\n            return -sin_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 cos_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(1.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return cos_taylor_fp64(t);\n        } else if (j == 1) {\n            return -sin_taylor_fp64(t);\n        } else if (j == -1) {\n            return sin_taylor_fp64(t);\n        } else {\n            return -cos_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 tan_fp64(vec2 a) {\n    vec2 sin_a;\n    vec2 cos_a;\n\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n    vec2 sin_t, cos_t;\n    vec2 s, c;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#else\n        if (abs_k == 1) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs_k == 2) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs_k == 3) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs_k == 4) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#endif\n        if (k > 0) {\n            s = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            s = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return div_fp64(sin_a, cos_a);\n}\n\nvec2 radians_fp64(vec2 degree) {\n  return mul_fp64(degree, PI_180_FP64);\n}\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid vec2_sum_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sum_fp64(a[0], b[0]);\n    out_val[1] = sum_fp64(a[1], b[1]);\n}\n\nvoid vec2_sub_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sub_fp64(a[0], b[0]);\n    out_val[1] = sub_fp64(a[1], b[1]);\n}\n\nvoid vec2_mul_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = mul_fp64(a[0], b[0]);\n    out_val[1] = mul_fp64(a[1], b[1]);\n}\n\nvoid vec2_div_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = div_fp64(a[0], b[0]);\n    out_val[1] = div_fp64(a[1], b[1]);\n}\n\nvoid vec2_mix_fp64(vec2 x[2], vec2 y[2], float a, out vec2 out_val[2]) {\n  vec2 range[2];\n  vec2_sub_fp64(y, x, range);\n  vec2 portion[2];\n  portion[0] = range[0] * a;\n  portion[1] = range[1] * a;\n  vec2_sum_fp64(x, portion, out_val);\n}\n\nvec2 vec2_length_fp64(vec2 x[2]) {\n  return sqrt_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])));\n}\n\nvoid vec2_normalize_fp64(vec2 x[2], out vec2 out_val[2]) {\n  vec2 length = vec2_length_fp64(x);\n  vec2 length_vec2[2];\n  length_vec2[0] = length;\n  length_vec2[1] = length;\n\n  vec2_div_fp64(x, length_vec2, out_val);\n}\n\nvec2 vec2_distance_fp64(vec2 x[2], vec2 y[2]) {\n  vec2 diff[2];\n  vec2_sub_fp64(x, y, diff);\n  return vec2_length_fp64(diff);\n}\n\nvec2 vec2_dot_fp64(vec2 a[2], vec2 b[2]) {\n  vec2 v[2];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n\n  return sum_fp64(v[0], v[1]);\n}\nvoid vec3_sub_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec3_sum_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvec2 vec3_length_fp64(vec2 x[3]) {\n  return sqrt_fp64(sum_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])),\n    mul_fp64(x[2], x[2])));\n}\n\nvec2 vec3_distance_fp64(vec2 x[3], vec2 y[3]) {\n  vec2 diff[3];\n  vec3_sub_fp64(x, y, diff);\n  return vec3_length_fp64(diff);\n}\nvoid vec4_fp64(vec4 a, out vec2 out_val[4]) {\n  out_val[0].x = a[0];\n  out_val[0].y = 0.0;\n\n  out_val[1].x = a[1];\n  out_val[1].y = 0.0;\n\n  out_val[2].x = a[2];\n  out_val[2].y = 0.0;\n\n  out_val[3].x = a[3];\n  out_val[3].y = 0.0;\n}\n\nvoid vec4_scalar_mul_fp64(vec2 a[4], vec2 b, out vec2 out_val[4]) {\n  out_val[0] = mul_fp64(a[0], b);\n  out_val[1] = mul_fp64(a[1], b);\n  out_val[2] = mul_fp64(a[2], b);\n  out_val[3] = mul_fp64(a[3], b);\n}\n\nvoid vec4_sum_fp64(vec2 a[4], vec2 b[4], out vec2 out_val[4]) {\n  for (int i = 0; i < 4; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec4_dot_fp64(vec2 a[4], vec2 b[4], out vec2 out_val) {\n  vec2 v[4];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n  v[2] = mul_fp64(a[2], b[2]);\n  v[3] = mul_fp64(a[3], b[3]);\n\n  out_val = sum_fp64(sum_fp64(v[0], v[1]), sum_fp64(v[2], v[3]));\n}\n\nvoid mat4_vec4_mul_fp64(vec2 b[16], vec2 a[4], out vec2 out_val[4]) {\n  vec2 tmp[4];\n\n  for (int i = 0; i < 4; i++)\n  {\n    for (int j = 0; j < 4; j++)\n    {\n      tmp[j] = b[j + i * 4];\n    }\n    vec4_dot_fp64(a, tmp, out_val[i]);\n  }\n}\n",fs:null,dependencies:[s],fp64ify:r,fp64LowPart:i,fp64ifyMatrix4:o}},function(t,e,n){"use strict";var r,i=n(54),o=n.n(i),a=n(55),s=n.n(a),u=n(58),c=n.n(u),l=n(59),f=n.n(l),h=n(43),d=n.n(h),p=n(135),v=n(34),g=n(134),y=n(24),m=n(39),b=n(78);function A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var _=function(t){c()(n,t);var e=A(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return o()(this,n),t=e.call(this,-0,-0,-0,-0),Object(y.f)(r)&&1===arguments.length?t.copy(r):(y.b.debug&&(Object(v.a)(r),Object(v.a)(i),Object(v.a)(a),Object(v.a)(s)),t[0]=r,t[1]=i,t[2]=a,t[3]=s),t}return s()(n,[{key:"set",value:function(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}},{key:"fromObject",value:function(t){return y.b.debug&&(Object(v.a)(t.x),Object(v.a)(t.y),Object(v.a)(t.z),Object(v.a)(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}},{key:"ELEMENTS",get:function(){return 4}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=Object(v.a)(t)}},{key:"w",get:function(){return this[3]},set:function(t){this[3]=Object(v.a)(t)}},{key:"transform",value:function(t){return m.q(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return Object(b.e)(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){return Object(b.d)(this,this,t),this.check()}},{key:"transformByQuaternion",value:function(t){return m.r(this,this,t),this.check()}},{key:"applyMatrix4",value:function(t){return t.transform(this,this),this}}],[{key:"ZERO",get:function(){return r||(r=new n(0,0,0,0),Object.freeze(r)),r}}]),n}(g.a),O=n(18),w=n(79),x=n(53);function C(){var t=new O.a(4);return O.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function P(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function S(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+a*s+i*c-o*u,t[1]=i*l+a*u+o*s-r*c,t[2]=o*l+a*c+r*u-i*s,t[3]=a*l-r*s-i*u-o*c,t}function B(t,e,n,r){var i,o,a,s,u,c=e[0],l=e[1],f=e[2],h=e[3],d=n[0],p=n[1],v=n[2],g=n[3];return(o=c*d+l*p+f*v+h*g)<0&&(o=-o,d=-d,p=-p,v=-v,g=-g),1-o>O.b?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-r)*i)/a,u=Math.sin(r*i)/a):(s=1-r,u=r),t[0]=s*c+u*d,t[1]=s*l+u*p,t[2]=s*f+u*v,t[3]=s*h+u*g,t}function k(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+a]-e[3*a+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[a]=(e[3*a+i]+e[3*i+a])*n}return t}x.b,x.g,x.c,x.l;var E,T,j,M,I,R,D=x.a,L=x.k,F=x.d,G=x.i,N=x.h,U=x.m,z=x.j,H=(x.f,x.e,E=m.c(),T=m.g(1,0,0),j=m.g(0,1,0),function(t,e,n){var r=m.f(e,n);return r<-.999999?(m.d(E,T,e),m.h(E)<1e-6&&m.d(E,j,e),m.l(E,E),P(t,E,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(m.d(E,e,n),t[0]=E[0],t[1]=E[1],t[2]=E[2],t[3]=1+r,z(t,t))});M=C(),I=C(),R=w.a();function V(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}n.d(e,"a",(function(){return W}));var J=[0,0,0,1],W=function(t){c()(n,t);var e=V(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return o()(this,n),t=e.call(this,-0,-0,-0,-0),Array.isArray(r)&&1===arguments.length?t.copy(r):t.set(r,i,a,s),t}return s()(n,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}},{key:"set",value:function(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}},{key:"fromObject",value:function(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}},{key:"fromMatrix3",value:function(t){return k(this,t),this.check()}},{key:"fromAxisRotation",value:function(t,e){return P(this,t,e),this.check()}},{key:"identity",value:function(){var t;return(t=this)[0]=0,t[1]=0,t[2]=0,t[3]=1,this.check()}},{key:"setAxisAngle",value:function(t,e){return this.fromAxisRotation(t,e)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(t){this[0]=Object(v.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=Object(v.a)(t)}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=Object(v.a)(t)}},{key:"w",get:function(){return this[3]},set:function(t){this[3]=Object(v.a)(t)}},{key:"len",value:function(){return N(this)}},{key:"lengthSquared",value:function(){return U(this)}},{key:"dot",value:function(t){return F(this,t)}},{key:"rotationTo",value:function(t,e){return H(this,t,e),this.check()}},{key:"add",value:function(t){return D(this,this,t),this.check()}},{key:"calculateW",value:function(){var t,e,n,r,i;return t=this,n=(e=this)[0],r=e[1],i=e[2],t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),this.check()}},{key:"conjugate",value:function(){var t,e;return e=this,(t=this)[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],this.check()}},{key:"invert",value:function(){var t,e,n,r,i,o,a,s;return t=this,n=(e=this)[0],r=e[1],i=e[2],o=e[3],s=(a=n*n+r*r+i*i+o*o)?1/a:0,t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,this.check()}},{key:"lerp",value:function(t,e,n){return void 0===n?this.lerp(this,t,e):(G(this,t,e,n),this.check())}},{key:"multiplyRight",value:function(t){return S(this,this,t),this.check()}},{key:"multiplyLeft",value:function(t){return S(this,t,this),this.check()}},{key:"normalize",value:function(){var t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}},{key:"rotateX",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-r*s}(this,this,t),this.check()}},{key:"rotateY",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);t[0]=r*u-o*s,t[1]=i*u+a*s,t[2]=o*u+r*s,t[3]=a*u-i*s}(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=o*u+a*s,t[3]=a*u-o*s}(this,this,t),this.check()}},{key:"scale",value:function(t){return L(this,this,t),this.check()}},{key:"slerp",value:function(t,e,n){var r,i,o;switch(arguments.length){case 1:var a=t.start;r=void 0===a?J:a,i=t.target,o=t.ratio;break;case 2:r=this,i=t,o=e;break;default:r=t,i=e,o=n}return B(this,r,i,o),this.check()}},{key:"transformVector4",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new _;return x.o(e,t,this),Object(v.b)(e,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(t,e){return this.setAxisAngle(t,e)}},{key:"premultiply",value:function(t){return this.multiplyLeft(t)}},{key:"multiply",value:function(t){return this.multiplyRight(t)}}]),n}(p.a)},function(t,e,n){"use strict";var r=n(156);n.d(e,"a",(function(){return i}));var i={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[r.a]}}])}));